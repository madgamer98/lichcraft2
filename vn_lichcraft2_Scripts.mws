# CountWizardSpells ===========================================================
Begin CountWizardSpells

;runs ONCE from Aryon's Greeting
short hasLevitate
short hasFire

Set hasLevitate to 0
Set hasFire to 0

if ( Player->GetSpell "levitate" == 1 )
	Set hasLevitate to 1
endif

if ( Player->GetSpell "wild levitate" == 1 )
	Set hasLevitate to 1
endif

if ( Player->GetSpell "great levitate" == 1 )
	Set hasLevitate to 1
endif

if ( Player->GetSpell "fire storm" == 1 )
	Set hasFire to 1
endif

if ( Player->GetSpell "fireball" == 1 )
	Set hasFire to 1
endif

if ( Player->GetSpell "Fireball_large" == 1 )
	Set hasFire to 1
endif

if ( Player->GetSpell "Recall" == 1 )
	if ( hasLevitate == 1 )
		if ( hasFire == 1 )
			set Aryon.learnedWizardSpells to 1
		else
			set Aryon.learnedWizardSpells to 0
		endif
	endif
endif

StopScript CountWizardSpells

End

# mlAdjust ====================================================================
Begin mlAdjust

short DoOnce

if ( DoOnce == 0 )
	MessageBox "You are getting this message because you have not set Mad Leveller to run AFTER LichCraft, as the readme expressely points out. Please do so and restart, or else you'll get SERIOUS compatability issues. Also make sure that the Mad Leveller Lichcraft fix is NOT running. It is no longer compatible." "Ok"
	set DoOnce to 1
endif

End

# order_lichscript ============================================================
Begin order_lichscript

set pcordlich to 1

End

# vn_addfollower ==============================================================
Begin vn_addfollower

if ( Random100 < 5 )
	PlaceAtPC "vn_mage1" 1 30 1
elseif ( Random100 < 10 )
	PlaceAtPC "vn_mage2" 1 30 1
elseif ( Random100 < 15 )
	PlaceAtPC "vn_mage3" 1 30 1
elseif ( Random100 < 20 )
	PlaceAtPC "vn_mage4" 1 30 1
elseif ( Random100 < 25 )
	PlaceAtPC "vn_mage5" 1 30 1
elseif ( Random100 < 30 )
	PlaceAtPC "vn_mage6" 1 30 1
elseif ( Random100 < 35 )
	PlaceAtPC "vn_mage7" 1 30 1
elseif ( Random100 < 40 )
	PlaceAtPC "vn_mage8" 1 30 1
elseif ( Random100 < 45 )
	PlaceAtPC "vn_mage9" 1 30 1
elseif ( Random100 < 50 )
	PlaceAtPC "vn_mage10" 1 30 1
elseif ( Random100 < 55 )
	PlaceAtPC "vn_mage11" 1 30 1
elseif ( Random100 < 60 )
	PlaceAtPC "vn_mage12" 1 30 1
elseif ( Random100 < 65 )
	PlaceAtPC "vn_mage13" 1 30 1
elseif ( Random100 < 70 )
	PlaceAtPC "vn_mage14" 1 30 1
elseif ( Random100 < 75 )
	PlaceAtPC "vn_mage15" 1 30 1
elseif ( Random100 < 80 )
	PlaceAtPC "vn_mage16" 1 30 1
elseif ( Random100 < 85 )
	PlaceAtPC "vn_mage17" 1 30 1
elseif ( Random100 < 90 )
	PlaceAtPC "vn_mage18" 1 30 1
elseif ( Random100 < 95 )
	PlaceAtPC "vn_mage19" 1 30 1
elseif ( Random100 < 100 )
	PlaceAtPC "vn_mage20" 1 30 1
endif

StopScript "vn_addfollower"

End

# vn_addfollowercheck =========================================================
Begin vn_addfollowercheck

short state
long level
long chance
long temp
long rand

if ( state == 0 )
	MessageBox "Checking for daily follower add"
	set level to ( Player->GetLevel )
	set state to 1
endif

if ( state == 1 )

	; chance is ( psionic - 2 )^2 + lev/2 ( capped at 100 ) then / by 2.
	set chance to ( ( vn_avenue_psionics - 2 ) * ( vn_avenue_psionics - 2 ) )

	if ( vn_avenue_psionics < 2 )
		set chance to ( 0 - chance )
	endif

	set temp to ( level / 2 )

	set chance to ( chance + temp )

	if ( chance > 100 )
		set chance to 100
	endif

	set chance to ( chance / 2 )
	set rand to Random100
	set state to 2

endif

if ( state == 2 )
	if ( rand < chance )
		; MessageBox "New follower Added"
		set state to 3
	else
		; MessageBox "No new follower came to you"
		set state to 4
	endif
endif

if ( state == 3 )
	StopScript "vn_addfollowercheck"
endif

if ( state == 4 )
	set state to 0
	StopScript "vn_addfollowercheck"
endif

End

# vn_addingredients ===========================================================
Begin vn_addingredients

Player->AddItem "ingred_coprinus_01" 1
Player->AddItem "ingred_noble_sedge_01" 1
Player->AddItem "ingred_russula_01" 1
Player->AddItem "ingred_lloramor_spines_01" 1
Player->AddItem "ingred_daedras_heart_01" 1
Player->AddItem "ingred_ghoul_heart_01" 1
Player->AddItem "ingred_belladonna_01" 1
Player->AddItem "ingred_belladonna_02" 1

Player->AddItem "ingred_ash_salts_01" 1
Player->AddItem "ingred_bonemeal_01" 1
Player->AddItem "ingred_corprus_weepings_01" 1
Player->AddItem "ingred_ectoplasm_01" 2
Player->AddItem "ingred_fire_salts_01" 1
Player->AddItem "ingred_frost_salts_01" 1
Player->AddItem "ingred_gravedust_01" 1
Player->AddItem "ingred_void_salts_01" 1
Player->AddItem "ingred_red_lichen_01" 1
Player->AddItem "ingred_vampire_dust_01" 1

StopScript "vn_addingredients"

End

# vn_apparatus_preparer_script ================================================
Begin vn_apparatus_preparer_script

short OnPCDrop
short DoOnce

; Some messages about how to use this? Or put that in the book?

if ( OnPCDrop == 1 )
	if ( DoOnce == 0 )
		PlaceAtPC "vn_container_preparer" 1 0 0
		set DoOnce to 1
		SetDelete 1
		Disable
	endif
endif

End

# vn_bloodscript ==============================================================
Begin vn_bloodscript

long hour
long currenthour
long vampefficieny
float bloodloss
short feed
short doonce
long max_blood
float timer
float penalty
float currenthealth
float targethealth
long blooddrank
float temp

; initial blood setting
if ( doonce == 0 )
	set penalty to -0.5
	set vn_blood to 200
	set doonce to 1
endif

; health/fatigue/magicka loss from being underfed
if ( vn_blood < 100 )
	set timer to ( timer + ( GetSecondsPassed ) )
	if ( timer > 10 )
		if ( vn_blood <= 0 )
			ModCurrentHealth -20000
		endif
		set timer to 0
		if ( penalty > -3 ) ; max loss if ( never below 50 is 18 health/min )
			set penalty to ( penalty - 0.01 )
		endif
		if ( vn_blood < 50 ) ; no max limit otherwise...
			set penalty to ( penalty - 0.01 )
		endif
		; MessageBox "penalty: %.2f" penalty
		Player->ModCurrentHealth penalty
		Player->ModCurrentFatigue penalty
		Player->ModCurrentMagicka penalty
	endif
endif

; hourly blood loss
set hour to GameHour
if ( currenthour != hour )
	; penalty reduction -->1 hour of over 250 blood makes up for 10 secs under 100.
	if ( vn_blood >= 250 )
		if ( penalty <= -0.51 )
			set penalty to ( penalty + 0.01 )
		endif
	endif

	set currenthour to hour
	; calculate skill
	set vampefficieny to ( vn_avenue_vampirism + 5 )
	set bloodloss to ( vn_blood / vampefficieny )
	set bloodloss to ( bloodloss + 5 )
	set bloodloss to ( bloodloss / 15 )

	; degradation effect for failed vamps.
	if ( vn_vamp_degradation > 0 )
		; lets Say it takes 60 hours for the full effects to kick in 
		; which is bloodloss * 3
		; no point increasing past 61
		if ( vn_vamp_degradation < 61 )	
			set vn_vamp_degradation to ( vn_vamp_degradation + 1 )
		endif

		if ( vn_vamp_degradation > 60 )
			set bloodloss to ( bloodloss * 3 )
		elseif ( vn_vamp_degradation > 50 )
			set bloodloss to ( bloodloss * 2.5 )
		elseif ( vn_vamp_degradation > 40 )
			set bloodloss to ( bloodloss * 2.0 )
		elseif ( vn_vamp_degradation > 30 )
			set bloodloss to ( bloodloss * 1.6 )
		elseif ( vn_vamp_degradation > 20 )
			set bloodloss to ( bloodloss * 1.2 )
		endif

		; initial messages... these shoudl scare the Player without fully alerting them.
		if ( vn_vamp_degradation == 20 )
			MessageBox "A spasm of pain shoots through your stomach. You double over, but then the pain subsides as quickly as it came. What could it have been?" "Ok"
		elseif ( vn_vamp_degradation == 30 )
			MessageBox "Without warning you suffer a violent coughing fit like nothing you've even known before. You recover, but you can't help noticing your veins still look swollen. Something doesn't feel right." "Ok"
		elseif ( vn_vamp_degradation == 40 )
			MessageBox "You're starting to feel hungry again... something's not right. You shouldn't need to feed this often. You look awful too. Your skin is starting to look blotched and cracked." "Ok"
		elseif ( vn_vamp_degradation == 50 )
			MessageBox "Fear grips your soul as you realise something must have gone wrong with the ritual. There's no other explanation. Your very body is falling apart in front of your eyes" "Ok"
		elseif ( vn_vamp_degradation == 60 )
			MessageBox "And so the fullness of the curse is in place. You may be gifted with the powers of a Lich, but you are cused to feed almost constantly just to stop yourself rotting alive. Such is the price of power" "Ok"
		endif
		
	endif

	; reduce blood
	set vn_blood to ( vn_blood - bloodloss )

	; also I think we really need some kind of warning for low blood
	if ( vn_blood <= 0 )
		MessageBox "You collapse to the ground. Too weak to Move, there is nothing you can do besides await your own inevitable death." "Ok"
		Player->ModCurrentFatigue -10000
		FadeOut 10
	elseif ( vn_blood < 10 )
		MessageBox "You have nothing left. It's now or never. feed or die" "Ok"
	elseif ( vn_blood < 50 )
		MessageBox "You MUST feed. As a Vampire Lich you draw no innate powers from other planes, but directly from the lifeforce of living beings. if you don't feed, you die." "Ok"
	elseif ( vn_blood < 100 )
		MessageBox "You urgently need to feed... you can feel yourself growing weaker every second"
	elseif ( vn_blood < 125 )
		MessageBox "You need to feed soon.... your powers are all but gone" 
	endif

	MessageBox "bloodloss: %.2f Remaining: %.2f" bloodloss vn_blood

	; apply effects
	StartScript "vn_lichlevelup"
endif

if ( feed == 0 )
	; blood drinking
	; 1 vamp touch spell
	; 2 vampire embrace blood drinking
	
	; 1
	; absorb health detected in body script sets vn_feeding when the spell finishes
	if ( vn_feeding > 0 )
		set feed to 1
		return
	endif
	
	; 2
	; check VE for some way to implement this
	; hooray! cortex has added a global 'hook' emb_hook_blooddrank - records amount of health gained.
	if ( emb_hook_blooddrank == 0 ) 
		set blooddrank to 0 ; reset on load prevents overflow
	endif
	if ( emb_hook_blooddrank > blooddrank ) ; is it greater than our local tracking variable?
		set vn_feeding to ( emb_hook_blooddrank - blooddrank )
		set vn_feeding to ( vn_feeding * 1.5 ) ; 50% increase in efficiency for direct feeding.
		set blooddrank to emb_hook_blooddrank
		set feed to 1
		return
	endif
endif

; apply max blood rule after feed

if ( feed == 1 )
	set temp to vn_feeding 
	set temp to ( temp * vn_avenue_vampirism ) ; so likely from 50-100% -- but possibly higher!
	if ( Player->GetSpellEffects "vn_pv_frenzy" == 1 )
		MessageBox "In your frenzied bloodlust, you scream as you sense the sweet taste of another's stolen life force"
		set temp to ( temp * 3 )
	endif
	set temp to ( temp / 10 )
	set vn_feeding to 0
	set feed to 0
	set vn_blood to ( vn_blood + temp )
	MessageBox "Feeding detected -- gained %.2f blood point" temp

	set max_blood to ( vn_avenue_vampirism * 100 )
	if ( vn_blood > max_blood )
		set vn_blood to max_blood
	endif
endif

End

# vn_body_steal_script ========================================================
Begin vn_body_steal_script

short steal
short stealskill
short brainwash
short feedmagickaflag
short state
short doonce
float timer
float alarm
float feedflag
float endtimer

float currenthealth
float maxHealth
float difference
float newmax
float premagicka
float aftermagicka
float mdiff
		
short rat
short dissolved
float t2

float prehealth
float afterhealth

if ( MenuMode == 1 )
	return
endif

if ( CellChanged )
	set state to 10
endif

if ( doonce == 0 )
	set vn_bodyscript1_flag to 1
;	MessageBox "Testing Body Script 1"
	set alarm to GetAlarm
	SetAlarm -5
	set doonce to 1
endif

if ( state == 10 )
	SetAlarm alarm ; Have to run it here instead of in the CellChanged if statement, otherwise it will not change the alarm
	set endtimer to ( endtimer + ( GetSecondsPassed ) )
	if ( endtimer > 1 )
		set currenthealth to 0
		set maxHealth to 0
		set difference to 0
		set newmax to 0
		set doonce to 0
		set timer to 0
		set t2 to 0
		set steal to 0
		set rat to 0
		set dissolved to 0
		set alarm to 0
;		MessageBox "Body Script Stopped"
		set vn_bodyscript1_flag to 0
		set state to 0
		set endtimer to 0
		StopScript "vn_body_steal_script"
	endif		
endif

if ( GetSpellEffects "vn_pv_stealskills" == 1 )
	if ( stealskill == 0 )
		MessageBox "Stealing skill"
		set stealskill to 1
		; assign the skill
		; 27 skills approx 4 pts each
		if ( Random100 <= 3 )
			MessageBox "You have gained a point in Acrobatics"
			Player->ModAcrobatics 1
			ModAcrobatics -1
		elseif ( Random100 <= 7 )
			MessageBox "You have gained a point in Alchemy"
			Player->ModAlchemy 1
			ModAlchemy -1
		elseif ( Random100 <= 11 )
			MessageBox "You have gained a point in Alteration"
			Player->ModAlteration 1
			ModAlteration -1
		elseif ( Random100 <= 15 )
			MessageBox "You have gained a point in Athletics"
			Player->ModAthletics 1
			ModAthletics -1
		elseif ( Random100 <= 19 )
			MessageBox "You have gained a point in Axe"
			Player->ModAxe 1
			ModAxe -1
		elseif ( Random100 <= 23 )
			MessageBox "You have gained a point in Block"
			Player->ModBlock 1
			ModBlock -1
		elseif ( Random100 <= 27 )
			MessageBox "You have gained a point in Blunt Weapon"
			Player->ModBluntWeapon 1
			ModBluntWeapon -1
		elseif ( Random100 <= 31 )
			MessageBox "You have gained a point in Conjuration"
			Player->ModConjuration 1
			ModConjuration -1
		elseif ( Random100 <= 35 )
			MessageBox "You have gained a point in Destruction"
			Player->ModDestruction 1
			ModDestruction -1
		elseif ( Random100 <= 39 )
			MessageBox "You have gained a point in Enchant"
			Player->ModEnchant 1
			ModEnchant -1
		elseif ( Random100 <= 43 )
			MessageBox "You have gained a point in Hand to Hand"
			Player->ModHandToHand 1
			ModHandToHand -1
		elseif ( Random100 <= 47 )
			MessageBox "You have gained a point in Heavy Armor"
			Player->ModHeavyArmor 1
			ModHeavyArmor -1
		elseif ( Random100 <= 51 )
			MessageBox "You have gained a point in Illusion"
			Player->ModIllusion 1
			ModIllusion -1
		elseif ( Random100 <= 55 )
			MessageBox "You have gained a point in Light Armor"
			Player->ModLightArmor 1
			ModLightArmor -1
		elseif ( Random100 <= 59 )
			MessageBox "You have gained a point in long Blade"
			Player->ModLongBlade 1
			ModLongBlade -1
		elseif ( Random100 <= 63 )
			MessageBox "You have gained a point in Marksman"
			Player->ModMarksman 1
			ModMarksman -1
		elseif ( Random100 <= 67 )
			MessageBox "You have gained a point in Medium Armor"
			Player->ModMediumArmor 1
			ModMediumArmor -1
		elseif ( Random100 <= 71 )
			MessageBox "You have gained a point in Mercantile"
			Player->ModMercantile 1
			ModMercantile -1
		elseif ( Random100 <= 75 )
			MessageBox "You have gained a point in Mysticism"
			Player->ModMysticism 1
			ModMysticism -1
		elseif ( Random100 <= 79 )
			MessageBox "You have gained a point in Restoration"
			Player->ModRestoration 1
			ModRestoration -1
		elseif ( Random100 <= 83 )
			MessageBox "You have gained a point in Security"
			Player->ModSecurity 1
			ModSecurity -1
		elseif ( Random100 <= 87 )
			MessageBox "You have gained a point in short Blade"
			Player->ModShortblade 1
			ModShortblade -1
		elseif ( Random100 <= 90 )
			MessageBox "You have gained a point in Sneak"
			Player->ModSneak 1
			ModSneak -1
		elseif ( Random100 <= 93 )
			MessageBox "You have gained a point in Spear"
			Player->ModSpear 1
			ModSpear -1
		elseif ( Random100 <= 96 )
			MessageBox "You have gained a point in Speechcraft"
			Player->ModSpeechcraft 1
			ModSpeechcraft -1
		elseif ( Random100 <= 100 )
			MessageBox "You have gained a point in Unarmored"
			Player->ModUnarmored 1
			ModUnarmored -1
		endif
	endif
else
	if ( stealskill == 1 )
		set stealskill to 0
	endif
endif

; if ( GetSpellEffects vn_pv_brainwash == 1 )
;	if ( brainwash == 0 )
;		MessageBox "^Name Brainwashed"
;		set brainwash to 1
;		StopCombat
;		AiFollow Player 30 0 0 0
;	endif
; else
;	if ( brainwash == 1 )
;		MessageBox "^Name recovers from being brainwashed"
;		set brainwash to 0
;		StopCombat
;		AiWander 0 0 0 0
;		StartCombat Player
;	endif
; endif

if ( GetEffect sEffectAbsorbHealth == 1 )
	if ( feedflag == 0 )
		set prehealth to GetHealth
		set feedflag to 1
	endif
endif

if ( feedflag == 1 )
	if ( GetEffect sEffectAbsorbHealth == 0 )
		set feedflag to 0
		set afterhealth to GetHealth
		set vn_feeding to ( prehealth - afterhealth )
	endif
endif

if ( GetSpellEffects "vn_pv_absorbmagicka" == 1 )
	if ( feedmagickaflag == 0 )
		MessageBox "Absorbing magicka"
		set premagicka to GetMagicka
		set feedmagickaflag to 1
	endif
endif

if ( feedmagickaflag == 1 )
	if ( GetSpellEffects "vn_pv_absorbmagicka" == 0 )
		set aftermagicka to GetMagicka
		set mdiff to ( premagicka - aftermagicka )
		MessageBox "Absorbed %.2f magicka" mdiff
		Player->ModCurrentMagicka mdiff
		set feedmagickaflag to 0
	endif
endif

set timer to ( timer + ( GetSecondsPassed ) )
set t2 to ( t2 + ( GetSecondsPassed ) )

if ( t2 > 2 )
	set t2 to 0
endif

if ( GetSpellEffects "vn_ps_chicken" == 1 )
	if ( rat == 0 )
		; MessageBox "Turning NPC into chicken"
		set rat to 1
		PlaceAtMe "vn_chicken" 1 0 0
		SetAlarm alarm
		Disable
		set state to 10
		return
	endif
endif

if ( timer > 60 )
	if ( steal == 0 )
		SetAlarm alarm
		set state to 10
		return
	endif
endif

if ( GetHealth <= 1 )
	if ( GetSpellEffects "vn_bodysteal" == 1 )
		set vn_host_str to GetStrength
		set vn_host_agl to GetAgility
		set vn_host_end to GetEndurance
		set vn_host_spd to GetSpeed
		StartScript "vn_possession"
		SetAlarm alarm
		Disable
		set state to 10
		return
	elseif ( GetSpellEffects "vn_pn_dissolve_flesh" == 1 )
		if ( dissolved == 0 )
			AddItem "vn_lich_shirt" 1
			AddItem "vn_lich_pants" 1
			AddItem "vn_lich_glove_right" 1
			AddItem "vn_lich_glove_left" 1
			AddItem "vn_lich_boots" 1
;			MessageBox "^Name flesh dissolved" 
			set dissolved to 1
			SetAlarm alarm
			set state to 10
		endif
	elseif ( GetSpellEffects "vn_ps_consume_soul" == 1 )
		if ( state != 10 )
			set currenthealth to ( Player->GetHealth )
			set maxHealth to ( currenthealth / Player->GetHealthGetRatio )
			set difference to ( currenthealth - maxHealth ) 
			set newmax to ( maxHealth + 2 )
			Player->SetHealth newmax
			Player->ModCurrentHealth difference
			MessageBox "You consume the soul. Your maximum health is increased"
			set state to 10
		endif
	elseif ( GetSpellEffects "vn_pv_consume" == 1 )
		if ( state != 10 )
			set currenthealth to ( Player->GetHealth )
			set maxHealth to ( currenthealth / Player->GetHealthGetRatio )
			set difference to ( currenthealth - maxHealth ) 
			set newmax to ( maxHealth + 1 )
			Player->SetHealth newmax
			Player->ModCurrentHealth difference
			if ( ScriptRunning "vn_inc_vamplich_mr" == 0 )
				set vn_vamplich_mr to ( vn_vamplich_mr + 1 )
				MessageBox "You consume the soul. Your magicka restoration and maximum health are increased"
				StartScript "vn_inc_vamplich_mr"
			endif
			set state to 10
		endif
	else
		set state to 10
	endif
	; SetHealth -1000
endif

if ( steal == 0 )
	if ( GetSpellEffects "vn_bodysteal" == 1 )
		set steal to 1
	endif
endif

End

# vn_body_steal_script2 =======================================================
Begin vn_body_steal_script2

short steal
short stealskill
short brainwash
short feedmagickaflag
short state
short doonce
float timer
float alarm
float feedflag
float endtimer

float currenthealth
float maxHealth
float difference
float newmax
float premagicka
float aftermagicka
float mdiff
		
short rat
short dissolved
float t2

float prehealth
float afterhealth

if ( MenuMode == 1 )
	return
endif

if ( CellChanged )
	set state to 10
endif

if ( doonce == 0 )
	set vn_bodyscript2_flag to 0
;	MessageBox "Testing Body Script 2"
	set alarm to GetAlarm
	SetAlarm -5
	set doonce to 1
endif

if ( state == 10 )
	SetAlarm alarm ; Have to run it here instead of in the CellChanged if statement, otherwise it will not change the alarm
	set endtimer to ( endtimer + ( GetSecondsPassed ) )
	if ( endtimer > 1 )
		set currenthealth to 0
		set maxHealth to 0
		set difference to 0
		set newmax to 0
		set doonce to 0
		set timer to 0
		set t2 to 0
		set steal to 0
		set rat to 0
		set dissolved to 0
		set alarm to 0
;		MessageBox "Body Script Stopped"
		set vn_bodyscript2_flag to 0
		set state to 0
		set endtimer to 0
		StopScript "vn_body_steal_script2"
	endif		
endif

if ( GetSpellEffects "vn_pv_stealskills" == 1 )
	if ( stealskill == 0 )
		MessageBox "Stealing skill"
		set stealskill to 1
		; assign the skill
		; 27 skills approx 4 pts each
		if ( Random100 <= 3 )
			MessageBox "You have gained a point in Acrobatics"
			Player->ModAcrobatics 1
			ModAcrobatics -1
		elseif ( Random100 <= 7 )
			MessageBox "You have gained a point in Alchemy"
			Player->ModAlchemy 1
			ModAlchemy -1
		elseif ( Random100 <= 11 )
			MessageBox "You have gained a point in Alteration"
			Player->ModAlteration 1
			ModAlteration -1
		elseif ( Random100 <= 15 )
			MessageBox "You have gained a point in Athletics"
			Player->ModAthletics 1
			ModAthletics -1
		elseif ( Random100 <= 19 )
			MessageBox "You have gained a point in Axe"
			Player->ModAxe 1
			ModAxe -1
		elseif ( Random100 <= 23 )
			MessageBox "You have gained a point in Block"
			Player->ModBlock 1
			ModBlock -1
		elseif ( Random100 <= 27 )
			MessageBox "You have gained a point in Blunt Weapon"
			Player->ModBluntWeapon 1
			ModBluntWeapon -1
		elseif ( Random100 <= 31 )
			MessageBox "You have gained a point in Conjuration"
			Player->ModConjuration 1
			ModConjuration -1
		elseif ( Random100 <= 35 )
			MessageBox "You have gained a point in Destruction"
			Player->ModDestruction 1
			ModDestruction -1
		elseif ( Random100 <= 39 )
			MessageBox "You have gained a point in Enchant"
			Player->ModEnchant 1
			ModEnchant -1
		elseif ( Random100 <= 43 )
			MessageBox "You have gained a point in Hand to Hand"
			Player->ModHandToHand 1
			ModHandToHand -1
		elseif ( Random100 <= 47 )
			MessageBox "You have gained a point in Heavy Armor"
			Player->ModHeavyArmor 1
			ModHeavyArmor -1
		elseif ( Random100 <= 51 )
			MessageBox "You have gained a point in Illusion"
			Player->ModIllusion 1
			ModIllusion -1
		elseif ( Random100 <= 55 )
			MessageBox "You have gained a point in Light Armor"
			Player->ModLightArmor 1
			ModLightArmor -1
		elseif ( Random100 <= 59 )
			MessageBox "You have gained a point in long Blade"
			Player->ModLongBlade 1
			ModLongBlade -1
		elseif ( Random100 <= 63 )
			MessageBox "You have gained a point in Marksman"
			Player->ModMarksman 1
			ModMarksman -1
		elseif ( Random100 <= 67 )
			MessageBox "You have gained a point in Medium Armor"
			Player->ModMediumArmor 1
			ModMediumArmor -1
		elseif ( Random100 <= 71 )
			MessageBox "You have gained a point in Mercantile"
			Player->ModMercantile 1
			ModMercantile -1
		elseif ( Random100 <= 75 )
			MessageBox "You have gained a point in Mysticism"
			Player->ModMysticism 1
			ModMysticism -1
		elseif ( Random100 <= 79 )
			MessageBox "You have gained a point in Restoration"
			Player->ModRestoration 1
			ModRestoration -1
		elseif ( Random100 <= 83 )
			MessageBox "You have gained a point in Security"
			Player->ModSecurity 1
			ModSecurity -1
		elseif ( Random100 <= 87 )
			MessageBox "You have gained a point in short Blade"
			Player->ModShortblade 1
			ModShortblade -1
		elseif ( Random100 <= 90 )
			MessageBox "You have gained a point in Sneak"
			Player->ModSneak 1
			ModSneak -1
		elseif ( Random100 <= 93 )
			MessageBox "You have gained a point in Spear"
			Player->ModSpear 1
			ModSpear -1
		elseif ( Random100 <= 96 )
			MessageBox "You have gained a point in Speechcraft"
			Player->ModSpeechcraft 1
			ModSpeechcraft -1
		elseif ( Random100 <= 100 )
			MessageBox "You have gained a point in Unarmored"
			Player->ModUnarmored 1
			ModUnarmored -1
		endif
	endif
else
	if ( stealskill == 1 )
		set stealskill to 0
	endif
endif

; if ( GetSpellEffects vn_pv_brainwash == 1 )
;	if ( brainwash == 0 )
;		MessageBox "^Name Brainwashed"
;		set brainwash to 1
;		StopCombat
;		AiFollow Player 30 0 0 0
;	endif
; else
;	if ( brainwash == 1 )
;		MessageBox "^Name recovers from being brainwashed"
;		set brainwash to 0
;		StopCombat
;		AiWander 0 0 0 0
;		StartCombat Player
;	endif
; endif

if ( GetEffect sEffectAbsorbHealth == 1 )
	if ( feedflag == 0 )
		set prehealth to GetHealth
		set feedflag to 1
	endif
endif

if ( feedflag == 1 )
	if ( GetEffect sEffectAbsorbHealth == 0 )
		set feedflag to 0
		set afterhealth to GetHealth
		set vn_feeding to ( prehealth - afterhealth )
	endif
endif

if ( GetSpellEffects "vn_pv_absorbmagicka" == 1 )
	if ( feedmagickaflag == 0 )
		MessageBox "Absorbing magicka"
		set premagicka to GetMagicka
		set feedmagickaflag to 1
	endif
endif

if ( feedmagickaflag == 1 )
	if ( GetSpellEffects "vn_pv_absorbmagicka" == 0 )
		set aftermagicka to GetMagicka
		set mdiff to ( premagicka - aftermagicka )
		MessageBox "Absorbed %.2f magicka" mdiff
		Player->ModCurrentMagicka mdiff
		set feedmagickaflag to 0
	endif
endif

set timer to ( timer + ( GetSecondsPassed ) )
set t2 to ( t2 + ( GetSecondsPassed ) )

if ( t2 > 2 )
	set t2 to 0
endif

if ( GetSpellEffects "vn_ps_chicken" == 1 )
	if ( rat == 0 )
		; MessageBox "Turning NPC into chicken"
		set rat to 1
		PlaceAtMe "vn_chicken" 1 0 0
		SetAlarm alarm
		Disable
		set state to 10
		return
	endif
endif

if ( timer > 60 )
	if ( steal == 0 )
		SetAlarm alarm
		set state to 10
		return
	endif
endif

if ( GetHealth <= 1 )
	if ( GetSpellEffects "vn_bodysteal" == 1 )
		set vn_host_str to GetStrength
		set vn_host_agl to GetAgility
		set vn_host_end to GetEndurance
		set vn_host_spd to GetSpeed
		StartScript "vn_possession"
		SetAlarm alarm
		Disable
		set state to 10
		return
	elseif ( GetSpellEffects "vn_pn_dissolve_flesh" == 1 )
		if ( dissolved == 0 )
			AddItem "vn_lich_shirt" 1
			AddItem "vn_lich_pants" 1
			AddItem "vn_lich_glove_right" 1
			AddItem "vn_lich_glove_left" 1
			AddItem "vn_lich_boots" 1
;			MessageBox "^Name flesh dissolved" 
			set dissolved to 1
			SetAlarm alarm
			set state to 10
		endif
	elseif ( GetSpellEffects "vn_ps_consume_soul" == 1 )
		if ( state != 10 )
			set currenthealth to ( Player->GetHealth )
			set maxHealth to ( currenthealth / Player->GetHealthGetRatio )
			set difference to ( currenthealth - maxHealth ) 
			set newmax to ( maxHealth + 2 )
			Player->SetHealth newmax
			Player->ModCurrentHealth difference
			MessageBox "You consume the soul. Your maximum health is increased"
			set state to 10
		endif
	elseif ( GetSpellEffects "vn_pv_consume" == 1 )
		if ( state != 10 )
			set currenthealth to ( Player->GetHealth )
			set maxHealth to ( currenthealth / Player->GetHealthGetRatio )
			set difference to ( currenthealth - maxHealth ) 
			set newmax to ( maxHealth + 1 )
			Player->SetHealth newmax
			Player->ModCurrentHealth difference
			if ( ScriptRunning "vn_inc_vamplich_mr" == 0 )
				set vn_vamplich_mr to ( vn_vamplich_mr + 1 )
				MessageBox "You consume the soul. Your magicka restoration and maximum health are increased"
				StartScript "vn_inc_vamplich_mr"
			endif
			set state to 10
		endif
	else
		set state to 10
	endif
	; SetHealth -1000
endif

if ( steal == 0 )
	if ( GetSpellEffects "vn_bodysteal" == 1 )
		set steal to 1
	endif
endif

End

# vn_body_steal_script3 =======================================================
Begin vn_body_steal_script3

short steal
short stealskill
short brainwash
short feedmagickaflag
short state
short doonce
float timer
float alarm
float feedflag
float endtimer

float currenthealth
float maxHealth
float difference
float newmax
float premagicka
float aftermagicka
float mdiff
		
short rat
short dissolved
float t2

float prehealth
float afterhealth

if ( MenuMode == 1 )
	return
endif

if ( CellChanged )
	set state to 10
endif

if ( doonce == 0 )
	set vn_bodyscript3_flag to 0
;	MessageBox "Testing Body Script 3"
	set alarm to GetAlarm
	SetAlarm -5
	set doonce to 1
endif

if ( state == 10 )
	SetAlarm alarm ; Have to run it here instead of in the CellChanged if statement, otherwise it will not change the alarm
	set endtimer to ( endtimer + ( GetSecondsPassed ) )
	if ( endtimer > 1 )
		set currenthealth to 0
		set maxHealth to 0
		set difference to 0
		set newmax to 0
		set doonce to 0
		set timer to 0
		set t2 to 0
		set steal to 0
		set rat to 0
		set dissolved to 0
		set alarm to 0
;		MessageBox "Body Script Stopped"
		set vn_bodyscript3_flag to 0
		set state to 0
		set endtimer to 0
		StopScript "vn_body_steal_script3"
	endif		
endif

if ( GetSpellEffects "vn_pv_stealskills" == 1 )
	if ( stealskill == 0 )
		MessageBox "Stealing skill"
		set stealskill to 1
		; assign the skill
		; 27 skills approx 4 pts each
		if ( Random100 <= 3 )
			MessageBox "You have gained a point in Acrobatics"
			Player->ModAcrobatics 1
			ModAcrobatics -1
		elseif ( Random100 <= 7 )
			MessageBox "You have gained a point in Alchemy"
			Player->ModAlchemy 1
			ModAlchemy -1
		elseif ( Random100 <= 11 )
			MessageBox "You have gained a point in Alteration"
			Player->ModAlteration 1
			ModAlteration -1
		elseif ( Random100 <= 15 )
			MessageBox "You have gained a point in Athletics"
			Player->ModAthletics 1
			ModAthletics -1
		elseif ( Random100 <= 19 )
			MessageBox "You have gained a point in Axe"
			Player->ModAxe 1
			ModAxe -1
		elseif ( Random100 <= 23 )
			MessageBox "You have gained a point in Block"
			Player->ModBlock 1
			ModBlock -1
		elseif ( Random100 <= 27 )
			MessageBox "You have gained a point in Blunt Weapon"
			Player->ModBluntWeapon 1
			ModBluntWeapon -1
		elseif ( Random100 <= 31 )
			MessageBox "You have gained a point in Conjuration"
			Player->ModConjuration 1
			ModConjuration -1
		elseif ( Random100 <= 35 )
			MessageBox "You have gained a point in Destruction"
			Player->ModDestruction 1
			ModDestruction -1
		elseif ( Random100 <= 39 )
			MessageBox "You have gained a point in Enchant"
			Player->ModEnchant 1
			ModEnchant -1
		elseif ( Random100 <= 43 )
			MessageBox "You have gained a point in Hand to Hand"
			Player->ModHandToHand 1
			ModHandToHand -1
		elseif ( Random100 <= 47 )
			MessageBox "You have gained a point in Heavy Armor"
			Player->ModHeavyArmor 1
			ModHeavyArmor -1
		elseif ( Random100 <= 51 )
			MessageBox "You have gained a point in Illusion"
			Player->ModIllusion 1
			ModIllusion -1
		elseif ( Random100 <= 55 )
			MessageBox "You have gained a point in Light Armor"
			Player->ModLightArmor 1
			ModLightArmor -1
		elseif ( Random100 <= 59 )
			MessageBox "You have gained a point in long Blade"
			Player->ModLongBlade 1
			ModLongBlade -1
		elseif ( Random100 <= 63 )
			MessageBox "You have gained a point in Marksman"
			Player->ModMarksman 1
			ModMarksman -1
		elseif ( Random100 <= 67 )
			MessageBox "You have gained a point in Medium Armor"
			Player->ModMediumArmor 1
			ModMediumArmor -1
		elseif ( Random100 <= 71 )
			MessageBox "You have gained a point in Mercantile"
			Player->ModMercantile 1
			ModMercantile -1
		elseif ( Random100 <= 75 )
			MessageBox "You have gained a point in Mysticism"
			Player->ModMysticism 1
			ModMysticism -1
		elseif ( Random100 <= 79 )
			MessageBox "You have gained a point in Restoration"
			Player->ModRestoration 1
			ModRestoration -1
		elseif ( Random100 <= 83 )
			MessageBox "You have gained a point in Security"
			Player->ModSecurity 1
			ModSecurity -1
		elseif ( Random100 <= 87 )
			MessageBox "You have gained a point in short Blade"
			Player->ModShortblade 1
			ModShortblade -1
		elseif ( Random100 <= 90 )
			MessageBox "You have gained a point in Sneak"
			Player->ModSneak 1
			ModSneak -1
		elseif ( Random100 <= 93 )
			MessageBox "You have gained a point in Spear"
			Player->ModSpear 1
			ModSpear -1
		elseif ( Random100 <= 96 )
			MessageBox "You have gained a point in Speechcraft"
			Player->ModSpeechcraft 1
			ModSpeechcraft -1
		elseif ( Random100 <= 100 )
			MessageBox "You have gained a point in Unarmored"
			Player->ModUnarmored 1
			ModUnarmored -1
		endif
	endif
else
	if ( stealskill == 1 )
		set stealskill to 0
	endif
endif

; if ( GetSpellEffects vn_pv_brainwash == 1 )
;	if ( brainwash == 0 )
;		MessageBox "^Name Brainwashed"
;		set brainwash to 1
;		StopCombat
;		AiFollow Player 30 0 0 0
;	endif
; else
;	if ( brainwash == 1 )
;		MessageBox "^Name recovers from being brainwashed"
;		set brainwash to 0
;		StopCombat
;		AiWander 0 0 0 0
;		StartCombat Player
;	endif
; endif

if ( GetEffect sEffectAbsorbHealth == 1 )
	if ( feedflag == 0 )
		set prehealth to GetHealth
		set feedflag to 1
	endif
endif

if ( feedflag == 1 )
	if ( GetEffect sEffectAbsorbHealth == 0 )
		set feedflag to 0
		set afterhealth to GetHealth
		set vn_feeding to ( prehealth - afterhealth )
	endif
endif

if ( GetSpellEffects "vn_pv_absorbmagicka" == 1 )
	if ( feedmagickaflag == 0 )
		MessageBox "Absorbing magicka"
		set premagicka to GetMagicka
		set feedmagickaflag to 1
	endif
endif

if ( feedmagickaflag == 1 )
	if ( GetSpellEffects "vn_pv_absorbmagicka" == 0 )
		set aftermagicka to GetMagicka
		set mdiff to ( premagicka - aftermagicka )
		MessageBox "Absorbed %.2f magicka" mdiff
		Player->ModCurrentMagicka mdiff
		set feedmagickaflag to 0
	endif
endif

set timer to ( timer + ( GetSecondsPassed ) )
set t2 to ( t2 + ( GetSecondsPassed ) )

if ( t2 > 2 )
	set t2 to 0
endif

if ( GetSpellEffects "vn_ps_chicken" == 1 )
	if ( rat == 0 )
		; MessageBox "Turning NPC into chicken"
		set rat to 1
		PlaceAtMe "vn_chicken" 1 0 0
		SetAlarm alarm
		Disable
		set state to 10
		return
	endif
endif

if ( timer > 60 )
	if ( steal == 0 )
		SetAlarm alarm
		set state to 10
		return
	endif
endif

if ( GetHealth <= 1 )
	if ( GetSpellEffects "vn_bodysteal" == 1 )
		set vn_host_str to GetStrength
		set vn_host_agl to GetAgility
		set vn_host_end to GetEndurance
		set vn_host_spd to GetSpeed
		StartScript "vn_possession"
		SetAlarm alarm
		Disable
		set state to 10
		return
	elseif ( GetSpellEffects "vn_pn_dissolve_flesh" == 1 )
		if ( dissolved == 0 )
			AddItem "vn_lich_shirt" 1
			AddItem "vn_lich_pants" 1
			AddItem "vn_lich_glove_right" 1
			AddItem "vn_lich_glove_left" 1
			AddItem "vn_lich_boots" 1
;			MessageBox "^Name flesh dissolved" 
			set dissolved to 1
			SetAlarm alarm
			set state to 10
		endif
	elseif ( GetSpellEffects "vn_ps_consume_soul" == 1 )
		if ( state != 10 )
			set currenthealth to ( Player->GetHealth )
			set maxHealth to ( currenthealth / Player->GetHealthGetRatio )
			set difference to ( currenthealth - maxHealth ) 
			set newmax to ( maxHealth + 2 )
			Player->SetHealth newmax
			Player->ModCurrentHealth difference
			MessageBox "You consume the soul. Your maximum health is increased"
			set state to 10
		endif
	elseif ( GetSpellEffects "vn_pv_consume" == 1 )
		if ( state != 10 )
			set currenthealth to ( Player->GetHealth )
			set maxHealth to ( currenthealth / Player->GetHealthGetRatio )
			set difference to ( currenthealth - maxHealth ) 
			set newmax to ( maxHealth + 1 )
			Player->SetHealth newmax
			Player->ModCurrentHealth difference
			if ( ScriptRunning "vn_inc_vamplich_mr" == 0 )
				set vn_vamplich_mr to ( vn_vamplich_mr + 1 )
				MessageBox "You consume the soul. Your magicka restoration and maximum health are increased"
				StartScript "vn_inc_vamplich_mr"
			endif
			set state to 10
		endif
	else
		set state to 10
	endif
	; SetHealth -1000
endif

if ( steal == 0 )
	if ( GetSpellEffects "vn_bodysteal" == 1 )
		set steal to 1
	endif
endif

End

# vn_body_steal_script4 =======================================================
Begin vn_body_steal_script4

short steal
short stealskill
short brainwash
short feedmagickaflag
short state
short doonce
float timer
float alarm
float feedflag
float endtimer

float currenthealth
float maxHealth
float difference
float newmax
float premagicka
float aftermagicka
float mdiff
		
short rat
short dissolved
float t2

float prehealth
float afterhealth

if ( MenuMode == 1 )
	return
endif

if ( CellChanged )
	set state to 10
endif

if ( doonce == 0 )
	set vn_bodyscript4_flag to 1
;	MessageBox "Testing Body Script 4"
	set alarm to GetAlarm
	SetAlarm -5
	set doonce to 1
endif

if ( state == 10 )
	SetAlarm alarm ; Have to run it here instead of in the CellChanged if statement, otherwise it will not change the alarm
	set endtimer to ( endtimer + ( GetSecondsPassed ) )
	if ( endtimer > 1 )
		set currenthealth to 0
		set maxHealth to 0
		set difference to 0
		set newmax to 0
		set doonce to 0
		set timer to 0
		set t2 to 0
		set steal to 0
		set rat to 0
		set dissolved to 0
		set alarm to 0
;		MessageBox "Body Script Stopped"
		set vn_bodyscript4_flag to 0
		set state to 0
		set endtimer to 0
		StopScript "vn_body_steal_script4"
	endif		
endif

if ( GetSpellEffects "vn_pv_stealskills" == 1 )
	if ( stealskill == 0 )
		MessageBox "Stealing skill"
		set stealskill to 1
		; assign the skill
		; 27 skills approx 4 pts each
		if ( Random100 <= 3 )
			MessageBox "You have gained a point in Acrobatics"
			Player->ModAcrobatics 1
			ModAcrobatics -1
		elseif ( Random100 <= 7 )
			MessageBox "You have gained a point in Alchemy"
			Player->ModAlchemy 1
			ModAlchemy -1
		elseif ( Random100 <= 11 )
			MessageBox "You have gained a point in Alteration"
			Player->ModAlteration 1
			ModAlteration -1
		elseif ( Random100 <= 15 )
			MessageBox "You have gained a point in Athletics"
			Player->ModAthletics 1
			ModAthletics -1
		elseif ( Random100 <= 19 )
			MessageBox "You have gained a point in Axe"
			Player->ModAxe 1
			ModAxe -1
		elseif ( Random100 <= 23 )
			MessageBox "You have gained a point in Block"
			Player->ModBlock 1
			ModBlock -1
		elseif ( Random100 <= 27 )
			MessageBox "You have gained a point in Blunt Weapon"
			Player->ModBluntWeapon 1
			ModBluntWeapon -1
		elseif ( Random100 <= 31 )
			MessageBox "You have gained a point in Conjuration"
			Player->ModConjuration 1
			ModConjuration -1
		elseif ( Random100 <= 35 )
			MessageBox "You have gained a point in Destruction"
			Player->ModDestruction 1
			ModDestruction -1
		elseif ( Random100 <= 39 )
			MessageBox "You have gained a point in Enchant"
			Player->ModEnchant 1
			ModEnchant -1
		elseif ( Random100 <= 43 )
			MessageBox "You have gained a point in Hand to Hand"
			Player->ModHandToHand 1
			ModHandToHand -1
		elseif ( Random100 <= 47 )
			MessageBox "You have gained a point in Heavy Armor"
			Player->ModHeavyArmor 1
			ModHeavyArmor -1
		elseif ( Random100 <= 51 )
			MessageBox "You have gained a point in Illusion"
			Player->ModIllusion 1
			ModIllusion -1
		elseif ( Random100 <= 55 )
			MessageBox "You have gained a point in Light Armor"
			Player->ModLightArmor 1
			ModLightArmor -1
		elseif ( Random100 <= 59 )
			MessageBox "You have gained a point in long Blade"
			Player->ModLongBlade 1
			ModLongBlade -1
		elseif ( Random100 <= 63 )
			MessageBox "You have gained a point in Marksman"
			Player->ModMarksman 1
			ModMarksman -1
		elseif ( Random100 <= 67 )
			MessageBox "You have gained a point in Medium Armor"
			Player->ModMediumArmor 1
			ModMediumArmor -1
		elseif ( Random100 <= 71 )
			MessageBox "You have gained a point in Mercantile"
			Player->ModMercantile 1
			ModMercantile -1
		elseif ( Random100 <= 75 )
			MessageBox "You have gained a point in Mysticism"
			Player->ModMysticism 1
			ModMysticism -1
		elseif ( Random100 <= 79 )
			MessageBox "You have gained a point in Restoration"
			Player->ModRestoration 1
			ModRestoration -1
		elseif ( Random100 <= 83 )
			MessageBox "You have gained a point in Security"
			Player->ModSecurity 1
			ModSecurity -1
		elseif ( Random100 <= 87 )
			MessageBox "You have gained a point in short Blade"
			Player->ModShortblade 1
			ModShortblade -1
		elseif ( Random100 <= 90 )
			MessageBox "You have gained a point in Sneak"
			Player->ModSneak 1
			ModSneak -1
		elseif ( Random100 <= 93 )
			MessageBox "You have gained a point in Spear"
			Player->ModSpear 1
			ModSpear -1
		elseif ( Random100 <= 96 )
			MessageBox "You have gained a point in Speechcraft"
			Player->ModSpeechcraft 1
			ModSpeechcraft -1
		elseif ( Random100 <= 100 )
			MessageBox "You have gained a point in Unarmored"
			Player->ModUnarmored 1
			ModUnarmored -1
		endif
	endif
else
	if ( stealskill == 1 )
		set stealskill to 0
	endif
endif

; if ( GetSpellEffects vn_pv_brainwash == 1 )
;	if ( brainwash == 0 )
;		MessageBox "^Name Brainwashed"
;		set brainwash to 1
;		StopCombat
;		AiFollow Player 30 0 0 0
;	endif
; else
;	if ( brainwash == 1 )
;		MessageBox "^Name recovers from being brainwashed"
;		set brainwash to 0
;		StopCombat
;		AiWander 0 0 0 0
;		StartCombat Player
;	endif
; endif

if ( GetEffect sEffectAbsorbHealth == 1 )
	if ( feedflag == 0 )
		set prehealth to GetHealth
		set feedflag to 1
	endif
endif

if ( feedflag == 1 )
	if ( GetEffect sEffectAbsorbHealth == 0 )
		set feedflag to 0
		set afterhealth to GetHealth
		set vn_feeding to ( prehealth - afterhealth )
	endif
endif

if ( GetSpellEffects "vn_pv_absorbmagicka" == 1 )
	if ( feedmagickaflag == 0 )
		MessageBox "Absorbing magicka"
		set premagicka to GetMagicka
		set feedmagickaflag to 1
	endif
endif

if ( feedmagickaflag == 1 )
	if ( GetSpellEffects "vn_pv_absorbmagicka" == 0 )
		set aftermagicka to GetMagicka
		set mdiff to ( premagicka - aftermagicka )
		MessageBox "Absorbed %.2f magicka" mdiff
		Player->ModCurrentMagicka mdiff
		set feedmagickaflag to 0
	endif
endif

set timer to ( timer + ( GetSecondsPassed ) )
set t2 to ( t2 + ( GetSecondsPassed ) )

if ( t2 > 2 )
	set t2 to 0
endif

if ( GetSpellEffects "vn_ps_chicken" == 1 )
	if ( rat == 0 )
		; MessageBox "Turning NPC into chicken"
		set rat to 1
		PlaceAtMe "vn_chicken" 1 0 0
		SetAlarm alarm
		Disable
		set state to 10
		return
	endif
endif

if ( timer > 60 )
	if ( steal == 0 )
		SetAlarm alarm
		set state to 10
		return
	endif
endif

if ( GetHealth <= 1 )
	if ( GetSpellEffects "vn_bodysteal" == 1 )
		set vn_host_str to GetStrength
		set vn_host_agl to GetAgility
		set vn_host_end to GetEndurance
		set vn_host_spd to GetSpeed
		StartScript "vn_possession"
		SetAlarm alarm
		Disable
		set state to 10
		return
	elseif ( GetSpellEffects "vn_pn_dissolve_flesh" == 1 )
		if ( dissolved == 0 )
			AddItem "vn_lich_shirt" 1
			AddItem "vn_lich_pants" 1
			AddItem "vn_lich_glove_right" 1
			AddItem "vn_lich_glove_left" 1
			AddItem "vn_lich_boots" 1
;			MessageBox "^Name flesh dissolved" 
			set dissolved to 1
			SetAlarm alarm
			set state to 10
		endif
	elseif ( GetSpellEffects "vn_ps_consume_soul" == 1 )
		if ( state != 10 )
			set currenthealth to ( Player->GetHealth )
			set maxHealth to ( currenthealth / Player->GetHealthGetRatio )
			set difference to ( currenthealth - maxHealth ) 
			set newmax to ( maxHealth + 2 )
			Player->SetHealth newmax
			Player->ModCurrentHealth difference
			MessageBox "You consume the soul. Your maximum health is increased"
			set state to 10
		endif
	elseif ( GetSpellEffects "vn_pv_consume" == 1 )
		if ( state != 10 )
			set currenthealth to ( Player->GetHealth )
			set maxHealth to ( currenthealth / Player->GetHealthGetRatio )
			set difference to ( currenthealth - maxHealth ) 
			set newmax to ( maxHealth + 1 )
			Player->SetHealth newmax
			Player->ModCurrentHealth difference
			if ( ScriptRunning "vn_inc_vamplich_mr" == 0 )
				set vn_vamplich_mr to ( vn_vamplich_mr + 1 )
				MessageBox "You consume the soul. Your magicka restoration and maximum health are increased"
				StartScript "vn_inc_vamplich_mr"
			endif
			set state to 10
		endif
	else
		set state to 10
	endif
	; SetHealth -1000
endif

if ( steal == 0 )
	if ( GetSpellEffects "vn_bodysteal" == 1 )
		set steal to 1
	endif
endif

End

# vn_body_steal_script5 =======================================================
Begin vn_body_steal_script5

short steal
short stealskill
short brainwash
short feedmagickaflag
short state
short doonce
float timer
float alarm
float feedflag
float endtimer

float currenthealth
float maxHealth
float difference
float newmax
float premagicka
float aftermagicka
float mdiff
		
short rat
short dissolved
float t2

float prehealth
float afterhealth

if ( MenuMode == 1 )
	return
endif

if ( CellChanged )
	set state to 10
endif

if ( doonce == 0 )
	set vn_bodyscript5_flag to 1
;	MessageBox "Testing Body Script 5"
	set alarm to GetAlarm
	SetAlarm -5
	set doonce to 1
endif

if ( state == 10 )
	SetAlarm alarm ; Have to run it here instead of in the CellChanged if statement, otherwise it will not change the alarm
	set endtimer to ( endtimer + ( GetSecondsPassed ) )
	if ( endtimer > 1 )
		set currenthealth to 0
		set maxHealth to 0
		set difference to 0
		set newmax to 0
		set doonce to 0
		set timer to 0
		set t2 to 0
		set steal to 0
		set rat to 0
		set dissolved to 0
		set alarm to 0
;		MessageBox "Body Script Stopped"
		set vn_bodyscript5_flag to 0
		set state to 0
		set endtimer to 0
		StopScript "vn_body_steal_script5"
	endif		
endif

if ( GetSpellEffects "vn_pv_stealskills" == 1 )
	if ( stealskill == 0 )
		MessageBox "Stealing skill"
		set stealskill to 1
		; assign the skill
		; 27 skills approx 4 pts each
		if ( Random100 <= 3 )
			MessageBox "You have gained a point in Acrobatics"
			Player->ModAcrobatics 1
			ModAcrobatics -1
		elseif ( Random100 <= 7 )
			MessageBox "You have gained a point in Alchemy"
			Player->ModAlchemy 1
			ModAlchemy -1
		elseif ( Random100 <= 11 )
			MessageBox "You have gained a point in Alteration"
			Player->ModAlteration 1
			ModAlteration -1
		elseif ( Random100 <= 15 )
			MessageBox "You have gained a point in Athletics"
			Player->ModAthletics 1
			ModAthletics -1
		elseif ( Random100 <= 19 )
			MessageBox "You have gained a point in Axe"
			Player->ModAxe 1
			ModAxe -1
		elseif ( Random100 <= 23 )
			MessageBox "You have gained a point in Block"
			Player->ModBlock 1
			ModBlock -1
		elseif ( Random100 <= 27 )
			MessageBox "You have gained a point in Blunt Weapon"
			Player->ModBluntWeapon 1
			ModBluntWeapon -1
		elseif ( Random100 <= 31 )
			MessageBox "You have gained a point in Conjuration"
			Player->ModConjuration 1
			ModConjuration -1
		elseif ( Random100 <= 35 )
			MessageBox "You have gained a point in Destruction"
			Player->ModDestruction 1
			ModDestruction -1
		elseif ( Random100 <= 39 )
			MessageBox "You have gained a point in Enchant"
			Player->ModEnchant 1
			ModEnchant -1
		elseif ( Random100 <= 43 )
			MessageBox "You have gained a point in Hand to Hand"
			Player->ModHandToHand 1
			ModHandToHand -1
		elseif ( Random100 <= 47 )
			MessageBox "You have gained a point in Heavy Armor"
			Player->ModHeavyArmor 1
			ModHeavyArmor -1
		elseif ( Random100 <= 51 )
			MessageBox "You have gained a point in Illusion"
			Player->ModIllusion 1
			ModIllusion -1
		elseif ( Random100 <= 55 )
			MessageBox "You have gained a point in Light Armor"
			Player->ModLightArmor 1
			ModLightArmor -1
		elseif ( Random100 <= 59 )
			MessageBox "You have gained a point in long Blade"
			Player->ModLongBlade 1
			ModLongBlade -1
		elseif ( Random100 <= 63 )
			MessageBox "You have gained a point in Marksman"
			Player->ModMarksman 1
			ModMarksman -1
		elseif ( Random100 <= 67 )
			MessageBox "You have gained a point in Medium Armor"
			Player->ModMediumArmor 1
			ModMediumArmor -1
		elseif ( Random100 <= 71 )
			MessageBox "You have gained a point in Mercantile"
			Player->ModMercantile 1
			ModMercantile -1
		elseif ( Random100 <= 75 )
			MessageBox "You have gained a point in Mysticism"
			Player->ModMysticism 1
			ModMysticism -1
		elseif ( Random100 <= 79 )
			MessageBox "You have gained a point in Restoration"
			Player->ModRestoration 1
			ModRestoration -1
		elseif ( Random100 <= 83 )
			MessageBox "You have gained a point in Security"
			Player->ModSecurity 1
			ModSecurity -1
		elseif ( Random100 <= 87 )
			MessageBox "You have gained a point in short Blade"
			Player->ModShortblade 1
			ModShortblade -1
		elseif ( Random100 <= 90 )
			MessageBox "You have gained a point in Sneak"
			Player->ModSneak 1
			ModSneak -1
		elseif ( Random100 <= 93 )
			MessageBox "You have gained a point in Spear"
			Player->ModSpear 1
			ModSpear -1
		elseif ( Random100 <= 96 )
			MessageBox "You have gained a point in Speechcraft"
			Player->ModSpeechcraft 1
			ModSpeechcraft -1
		elseif ( Random100 <= 100 )
			MessageBox "You have gained a point in Unarmored"
			Player->ModUnarmored 1
			ModUnarmored -1
		endif
	endif
else
	if ( stealskill == 1 )
		set stealskill to 0
	endif
endif

; if ( GetSpellEffects vn_pv_brainwash == 1 )
;	if ( brainwash == 0 )
;		MessageBox "^Name Brainwashed"
;		set brainwash to 1
;		StopCombat
;		AiFollow Player 30 0 0 0
;	endif
; else
;	if ( brainwash == 1 )
;		MessageBox "^Name recovers from being brainwashed"
;		set brainwash to 0
;		StopCombat
;		AiWander 0 0 0 0
;		StartCombat Player
;	endif
; endif

if ( GetEffect sEffectAbsorbHealth == 1 )
	if ( feedflag == 0 )
		set prehealth to GetHealth
		set feedflag to 1
	endif
endif

if ( feedflag == 1 )
	if ( GetEffect sEffectAbsorbHealth == 0 )
		set feedflag to 0
		set afterhealth to GetHealth
		set vn_feeding to ( prehealth - afterhealth )
	endif
endif

if ( GetSpellEffects "vn_pv_absorbmagicka" == 1 )
	if ( feedmagickaflag == 0 )
		MessageBox "Absorbing magicka"
		set premagicka to GetMagicka
		set feedmagickaflag to 1
	endif
endif

if ( feedmagickaflag == 1 )
	if ( GetSpellEffects "vn_pv_absorbmagicka" == 0 )
		set aftermagicka to GetMagicka
		set mdiff to ( premagicka - aftermagicka )
		MessageBox "Absorbed %.2f magicka" mdiff
		Player->ModCurrentMagicka mdiff
		set feedmagickaflag to 0
	endif
endif

set timer to ( timer + ( GetSecondsPassed ) )
set t2 to ( t2 + ( GetSecondsPassed ) )

if ( t2 > 2 )
	set t2 to 0
endif

if ( GetSpellEffects "vn_ps_chicken" == 1 )
	if ( rat == 0 )
		; MessageBox "Turning NPC into chicken"
		set rat to 1
		PlaceAtMe "vn_chicken" 1 0 0
		SetAlarm alarm
		Disable
		set state to 10
		return
	endif
endif

if ( timer > 60 )
	if ( steal == 0 )
		SetAlarm alarm
		set state to 10
		return
	endif
endif

if ( GetHealth <= 1 )
	if ( GetSpellEffects "vn_bodysteal" == 1 )
		set vn_host_str to GetStrength
		set vn_host_agl to GetAgility
		set vn_host_end to GetEndurance
		set vn_host_spd to GetSpeed
		StartScript "vn_possession"
		SetAlarm alarm
		Disable
		set state to 10
		return
	elseif ( GetSpellEffects "vn_pn_dissolve_flesh" == 1 )
		if ( dissolved == 0 )
			AddItem "vn_lich_shirt" 1
			AddItem "vn_lich_pants" 1
			AddItem "vn_lich_glove_right" 1
			AddItem "vn_lich_glove_left" 1
			AddItem "vn_lich_boots" 1
;			MessageBox "^Name flesh dissolved" 
			set dissolved to 1
			SetAlarm alarm
			set state to 10
		endif
	elseif ( GetSpellEffects "vn_ps_consume_soul" == 1 )
		if ( state != 10 )
			set currenthealth to ( Player->GetHealth )
			set maxHealth to ( currenthealth / Player->GetHealthGetRatio )
			set difference to ( currenthealth - maxHealth ) 
			set newmax to ( maxHealth + 2 )
			Player->SetHealth newmax
			Player->ModCurrentHealth difference
			MessageBox "You consume the soul. Your maximum health is increased"
			set state to 10
		endif
	elseif ( GetSpellEffects "vn_pv_consume" == 1 )
		if ( state != 10 )
			set currenthealth to ( Player->GetHealth )
			set maxHealth to ( currenthealth / Player->GetHealthGetRatio )
			set difference to ( currenthealth - maxHealth ) 
			set newmax to ( maxHealth + 1 )
			Player->SetHealth newmax
			Player->ModCurrentHealth difference
			if ( ScriptRunning "vn_inc_vamplich_mr" == 0 )
				set vn_vamplich_mr to ( vn_vamplich_mr + 1 )
				MessageBox "You consume the soul. Your magicka restoration and maximum health are increased"
				StartScript "vn_inc_vamplich_mr"
			endif
			set state to 10
		endif
	else
		set state to 10
	endif
	; SetHealth -1000
endif

if ( steal == 0 )
	if ( GetSpellEffects "vn_bodysteal" == 1 )
		set steal to 1
	endif
endif

End

# vn_chat =====================================================================
Begin vn_chat

if ( vn_donegreeting == 1 )
	if ( MenuMode == 0 )
		; MessageBox "resetting chat globals"
		set vn_donegreeting to 0
	endif
endif

End

# vn_chestscript ==============================================================
Begin vn_chestscript

short state
short button
short flag

if ( flag == 0 )
	PlaySound "vn_done"
	set flag to 1
endif

if ( vn_booksadded == 0 )
	if ( GetDistance Player < 500 )
		Player->AddItem "vn_lichdom" 1
		Player->AddItem "vn_book_powers" 1
		Player->AddItem "vn_book_necromancyguide" 1
		MessageBox " 'On Being a Lich' has been added to your inventory"
		MessageBox " 'Avenues of Lichdom' has been added to your inventory"
		MessageBox " 'Summoning the Dead' has been added to your inventory"
		set vn_booksadded to 1
	endif
endif

if ( Player->GetSpell "vn_phy_levitation" == 0 )
	EnableLevitation
	Player->AddSpell "vn_phy_levitation"
endif

; if ( teleportdisabled == 0 )
;	DisableTeleporting
; endif

; check you've been returned because of a possess host
if ( vn_attributeswitch == 1 )
	; MessageBox "tat==1 detected"
	if ( ScriptRunning "vn_set_host_attributes" == 0 )
		StartScript "vn_set_host_attributes"
	endif
endif

if ( OnActivate == 1 )
	MessageBox "Of what purpose? You don't yet know..."
endif

End

# vn_companion_skeleton =======================================================
Begin vn_companion_skeleton

short Companion
short NoLore
short undeadfollower
short state
short button
short following
float myx
float myy
float myz
float warptimer

if ( GetDistance Player < 1000 )
	set vn_lichscript.canbeseen to 0
endif

if ( GetCurrentAiPackage == 3 )
	if ( GetWeaponDrawn )
		; do nothing
	elseif ( GetSpellReadied )
		; do nothing
	elseif ( GetDistance Player > 800 )
		if ( GetFlee < 1000 )
			set warptimer to ( warptimer + ( GetSecondsPassed ) )
			if ( warptimer > 8 )
				set warptimer to 0
				set myx to ( Player->GetPos x )
				set myy to ( Player->GetPos y )	
				set myz to ( Player->GetPos z )
				SetPos x myx
				SetPos y myy
				SetPos z myz
          	endif
     	endif
   endif
endif

if ( vn_undead_follow == -1 ) ; global cancel
	if ( following == 1 )
		AiWander 0 0 0
		set following to 0
	endif
endif

if ( vn_undead_follow == 1 ) ; global follow
	if ( following == 0 )
		AiFollow Player 0 0 0 0
		set following to 1
	endif
endif

if ( Companion == 0 )
	set Companion to 1
endif

if ( undeadfollower == 0 )
	set undeadfollower to 1
endif

if ( GetSpellEffects "vn_pn_heal_undead_horde" == 1 )
	ModCurrentHealth 100
endif

if ( GetHealth < 1 )
	if ( Player->GetSpellEffects "vn_pn_reanimate" == 1 )
		if ( GetDistance Player < 150 ) ; have to test distance since this skeleton is dead and cannot be Cast upon
			MessageBox "Reanimating Skeleton"
			Resurrect
		endif
	endif
endif

if ( state == 0 )
	if ( GetSpellEffects "vn_follower_teleport" )
		; um.... now how to do this?
		MessageBox "Choose a location" "Vivec" "Balmora" "Ghostgate" "Ald-ruhn" "Gnisis" "Dagon Fel" "Sadrith Mora" "More options" "Nowhere"
		set state to 1
	endif
endif

if ( state == 1 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set vn_travel_loc to 1
		set state to 4
	elseif ( button == 1 )
		set vn_travel_loc to 2
		set state to 4
	elseif ( button == 2 )
		set vn_travel_loc to 3
		set state to 4
	elseif ( button == 3 )
		set vn_travel_loc to 4
		set state to 4
	elseif ( button == 4 )
		set vn_travel_loc to 5
		set state to 4
	elseif ( button == 5 )
		set vn_travel_loc to 6
		set state to 4
	elseif ( button == 6 )
		set vn_travel_loc to 7
		set state to 4
	elseif ( button == 7 )
		; more choices
		set state to 2
	elseif ( button == 8 )
		; cancel
		set state to 10
	endif
	set button to -1
endif

if ( state == 2 )
	MessageBox "Choose a location" "Vos" "Valenvaryon" "Molag Mar" "Fort Frostmouth" "Skaal Village" "Forget it"
	set state to 3
endif 

if ( state == 3 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set vn_travel_loc to 10
		set state to 4
	elseif ( button == 1 )
		set vn_travel_loc to 11
		set state to 4
	elseif ( button == 2 )
		set vn_travel_loc to 12
		set state to 4
	elseif ( button == 3 )
		set vn_travel_loc to 13
		set state to 4
	elseif ( button == 4 )
		set vn_travel_loc to 14
		set state to 4
	elseif ( button == 5 )
		set vn_travel_loc to 15
		set state to 4
	elseif ( button == 6 )
		; set vn_travel_loc to 16
		; set state to 4
	; elseif ( button == 7 )
		; set vn_travel_loc to 17
		; set state to 4
	; elseif ( button == 8 )
		; cancel
		set state to 10
	endif
	set button to -1
endif

if ( state == 4 )
	; set some variable then trigger the follower travel script? Will it be correctly targeted from here?
	set vn_follower_travel_flag to 1
	StartScript "vn_follower_travel"
	set state to 10
endif

if ( state == 10 )
	if ( GetSpellEffects "vn_follower_teleport" == 0 )
		set state to 0
	endif
endif

End

# vn_container_preparer_script ================================================
Begin vn_container_preparer_script

short state
short button
long large
long med
long small
float total
long temp

if ( vn_lichfought == 0 )
	if ( GetDistance Player < 400 )
		PlaceAtPC "vn_relvel" 1 300 1
		set vn_lichfought to 1
	endif
endif

; states
; 1 button check. -->2|3|5
; 2 potion mixing. -- > 6
; 3 to be disabled. -->4.
; 4 nulls script.

if ( state == 4 )
	return
endif

if ( state == 3 )
	Disable ; still exists in the game world... 
	; but shouldn't be too much of a problem since it only returns.
	set state to 4
endif

if ( OnActivate == 1 )
	MessageBox "What do you wish to do?" "Add corprusmeat" "Prepare corprusmeat" "Pick up"
	set state to 1
endif

if ( state == 7 ) 
	set state to 8
	Activate
endif

if ( state == 1 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	endif
	if ( button == 0 )
		set state to 7
		return
	endif
	if ( button == 1 )
		set state to 2
		return
	endif
	if ( button == 2 )
		set state to 3
		Player->AddItem "vn_apparatus_preparer" 1
	endif
endif

if ( state == 2 )
	; 1 0.5 0.2
	if ( GetItemCount "ingred_6th_corprusmeat_05" > 0 )
		RemoveItem "ingred_6th_corprusmeat_05" 1
		AddItem "ingred_6th_corprusmeat_01" 1
		return
	endif
	if ( GetItemCount "ingred_6th_corprusmeat_04" > 0 )
		RemoveItem "ingred_6th_corprusmeat_04" 1
		AddItem "ingred_6th_corprusmeat_01" 1
		return
	endif

	if ( GetItemCount "ingred_6th_corprusmeat_06" > 0 )
		RemoveItem "ingred_6th_corprusmeat_06" 1
		AddItem "ingred_6th_corprusmeat_03" 1
		return
	endif

	if ( GetItemCount "ingred_6th_corprusmeat_07" > 0 )
		RemoveItem "ingred_6th_corprusmeat_07" 1
		AddItem "ingred_6th_corprusmeat_02" 1
		return
	endif
	
	set state to 5
endif

if ( state == 5 )
	set large to ( GetItemCount "ingred_6th_corprusmeat_01" )
	set med to ( GetItemCount "ingred_6th_corprusmeat_03" )
	set small to ( GetItemCount "ingred_6th_corprusmeat_02" )
	MessageBox "Small %.2f med %.2f large %.2f" small med large
	set state to 6
endif

if ( state == 6 )
	if ( large > 0 )
		AddItem "vn_preparedmeat" 1
		set temp to ( large - 1 )
		set large to temp
		if ( GetItemCount "ingred_6th_corprusmeat_01" > 0 )
			RemoveItem "ingred_6th_corprusmeat_01" 1
			return
		else
			MessageBox "Error removing large meat"
		endif
	elseif ( med > 1 )
		AddItem "vn_preparedmeat" 1
		set temp to ( med - 2 )
		set med to temp
		if ( GetItemCount "ingred_6th_corprusmeat_03" > 1 )
			; MessageBox "removign med"
			RemoveItem "ingred_6th_corprusmeat_03" 2
			return
		else
			; MessageBox "med error"
		endif
	elseif ( small > 4 )
		AddItem "vn_preparedmeat" 1
		set temp to ( small - 5 )
		set small to temp
		if ( GetItemCount "ingred_6th_corprusmeat_02" > 4 )
			RemoveItem "ingred_6th_corprusmeat_02" 5
			return
		else
			; MessageBox "small error"
		endif
	else
		; MessageBox "adjusting done"
		set state to 0
	endif
endif

End

# vn_crown_of_souls_script ====================================================
Begin vn_crown_of_souls_script

long power
short hunger
long lasthour
long currentHour
float timer
long soultype
long temp
short state
short OnPCEquip
short PCSkipEquip
short button
float maxtime

if ( vn_wearinglich == 0 )
	if ( PCSkipEquip == 0 )
		set PCSkipEquip to 1
	endif
else
	if ( PCSkipEquip == 1 )
		set PCSkipEquip to 0
	endif
endif

if ( PCSkipEquip == 1 )
	return
endif

; Crown of Souls
if ( Player->HasItemEquipped "vn_crown_of_souls" == 0 )
	if ( Player->GetSpell "vn_crown_gift" == 1 )
		Player->RemoveSpell "vn_crown_gift"
	endif
else
	if ( Player->GetSpell "vn_crown_gift" == 0 )
		Player->AddSpell "vn_crown_gift"
	endif
endif

; Hooded Crown of Souls
if ( Player->HasItemEquipped "vn_crown_of_souls" == 0 )
	if ( Player->GetSpell "vn_crown_gift" == 1 )
		Player->RemoveSpell "vn_crown_gift"
	endif
else
	if ( Player->GetSpell "vn_crown_gift" == 0 )
		Player->AddSpell "vn_crown_gift"
	endif
endif

set currentHour to GameHour

if ( lasthour != currentHour )

	; MessageBox "hour changed to %.2f" currentHour
	if ( hunger >= 0 )
		set temp to ( hunger - 5 )
		if ( temp < 0 )
			set hunger to 0
		else
			set hunger to temp
		endif
	endif

	if ( power > 0 )
		set temp to ( power - 2 )
		if ( temp < 0 )
			set power to 0
		else
			set power to temp
		endif
	endif

	; MessageBox "hunger now %.2f and power is %.2f" hunger power
	set lasthour to currentHour

endif

if ( power >= 350 )

	MessageBox "The Crown of Souls rewards you. Your Intelligence, luck, and willpower increase."

	if ( mlRunOnce != 0 )
		MessageBox "Mad leveller detecting: Using alternative stat bonus"
		set Adj_Intelligence to 1
		set Adj_Willpower to 1
		set Adj_Luck to 1
		StartScript "mlAdjust"
	else
		Player->ModIntelligence 1
		Player->ModWillpower 1
		Player->ModLuck 1
	endif

	if ( Gals_Natural_Intelligence > 0 )
		set Gals_Natural_Intelligence to ( Gals_Natural_Intelligence + 1 )
		set Gals_Natural_Willpower to ( Gals_Natural_Willpower + 1 )
		set Gals_Natural_Luck to ( Gals_Natural_Luck + 1 )
	endif

	set temp to ( power - 500 )
	set power to temp

endif

if ( state == 0 )
	if ( hunger == 0 )
		set timer to ( timer + ( GetSecondsPassed ) )
		if ( timer > maxtime )
			set state to 1
			set timer to 0.0
		endif
	endif
endif

if ( state == 1 )
	if ( MenuMode == 0 )
		if ( Player->HasSoulGem "ancestor_ghost" )
			MessageBox "Allow the crown to feed on the soul of the Ancestor Ghost?" "Yes" "No"
			set soultype to 1
			set state to 2
		elseif ( Player->HasSoulGem "ash_slave" )
			MessageBox "Allow the crown to feed on the soul of the Ash Slave?" "Yes" "No"
			set soultype to 2
			set state to 2
		elseif ( Player->HasSoulGem "Dwarven Ghost" )
			MessageBox "Allow the crown to feed on the soul of the Dwarven Spectre?" "Yes" "No"
			set soultype to 3
			set state to 2
		elseif ( Player->HasSoulGem "Atronach_flame" )
			MessageBox "Allow the crown to feed on the soul of the Flame Atronach?" "Yes" "No"
			set soultype to 4
			set state to 2
		elseif ( Player->HasSoulGem "bonelord" )
			MessageBox "Allow the crown to feed on the soul of the Bonelord?" "Yes" "No"
			set soultype to 5
			set state to 2
		elseif ( Player->HasSoulGem "atronach_frost" )
			MessageBox "Allow the crown to feed on the soul of the Frost Atronach?" "Yes" "No"
			set soultype to 6
			set state to 2
		elseif ( Player->HasSoulGem "dremora" )
			MessageBox "Allow the crown to feed on the soul of the Dremora?" "Yes" "No"
			set soultype to 7
			set state to 2
		elseif ( Player->HasSoulGem "Hunger" )
			MessageBox "Allow the crown to feed on the soul of the Hunger?" "Yes" "No"
			set soultype to 8
			set state to 2
		elseif ( Player->HasSoulGem "Daedroth" )
			MessageBox "Allow the crown to feed on the soul of the Daedroth?" "Yes" "No"
			set soultype to 9
			set state to 2
		elseif ( Player->HasSoulGem "dremora_lord" )
			MessageBox "Allow the crown to feed on the soul of the Dremora Lord?" "Yes" "No"
			set soultype to 10
			set state to 2
		elseif ( Player->HasSoulGem "ash_ghoul" )
			MessageBox "Allow the crown to feed on the soul of the Ash Ghoul?" "Yes" "No"
			set soultype to 11
			set state to 2
		elseif ( Player->HasSoulGem "atronach_storm" )
			MessageBox "Allow the crown to feed on the soul of the Storm Atronach?" "Yes" "No"
			set soultype to 12
			set state to 2
		elseif ( Player->HasSoulGem "Winged Twilight" )
			MessageBox "Allow the crown to feed on the soul of the Winged Twilight?" "Yes" "No"
			set soultype to 13
			set state to 2
		elseif ( Player->HasSoulGem "lich" )
			MessageBox "Allow the crown to feed on the soul of the Lich?" "Yes" "No"
			set soultype to 14
			set state to 2
		elseif ( Player->HasSoulGem "lich_profane_unique" )
			MessageBox "Allow the crown to feed on the soul of the Profane Acolyte?" "Yes" "No"
			set soultype to 15
			set state to 2
		else
			set state to 0
		endif
	endif
endif

if ( state == 2 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set maxtime to 10
		set state to 3
	elseif ( button == 1 )
		set maxtime to 300
		set state to 0
	endif
endif

if ( state == 3 )
	if ( soultype == 1 ) ; hunger = soul/2 + 20 -->so faster to feed on bigger souls.
		MessageBox "The crown consumes the soul of the Ancestor Ghost"
		Player->RemoveSoulGem "ancestor_ghost"
		set hunger to ( hunger + 70 ) 
		set power to ( power + 100 )
	elseif ( soultype == 2 )
		MessageBox "The crown consumes the soul of the Ash Slave"
		Player->RemoveSoulGem "ash_slave"
		set hunger to ( hunger + 70 )
		set power to ( power + 100 )
	elseif ( soultype == 3 )
		MessageBox "The crown consumes the soul of the Dwarven Spectre"
		Player->RemoveSoulGem "Dwarven Ghost"
		set hunger to ( hunger + 120 )
		set power to ( power + 200 )
	elseif ( soultype == 4 )
		MessageBox "The crown consumes the soul of the Flame Atronach"
		Player->RemoveSoulGem "atronach_flame"
		set hunger to ( hunger + 72 )
		set power to ( power + 105 )
	elseif ( soultype == 5 )
		MessageBox "The crown consumes the soul of the Bonelord"
		Player->RemoveSoulGem "bonelord"
		set hunger to ( hunger + 70 )
		set power to ( power + 100 )
	elseif ( soultype == 6 )
		MessageBox "The crown consumes the soul of the Frost Atronach"
		Player->RemoveSoulGem "atronach_frost"
		set hunger to ( hunger + 88 )
		set power to ( power + 138 )
	elseif ( soultype == 7 )
		MessageBox "The crown consumes the soul of the Dremora"
		Player->RemoveSoulGem "dremora"
		set hunger to ( hunger + 70 )
		set power to ( power + 100 )
	elseif ( soultype == 8 )
		MessageBox "The crown consumes the soul of the Hunger"
		Player->RemoveSoulGem "hunger"
		set hunger to ( hunger + 145 )
		set power to ( power + 250 )
	elseif ( soultype == 9 )
		MessageBox "The crown consumes the soul of the Daedroth"
		Player->RemoveSoulGem "daedroth"
		set hunger to ( hunger + 117 )
		set power to ( power + 195 )
	elseif ( soultype == 10 )
		MessageBox "The crown consumes the soul of the Dremora Lord"
		Player->RemoveSoulGem "dremora_lord"
		set hunger to ( hunger + 120 )
		set power to ( power + 200 )
	elseif ( soultype == 11 )
		MessageBox "The crown consumes the soul of the Ash Ghoul"
		Player->RemoveSoulGem "ash_ghoul"
		set hunger to ( hunger + 145 )
		set power to ( power + 250 )
	elseif ( soultype == 12 )
		MessageBox "The crown consumes the soul of the Storm Atronach"
		Player->RemoveSoulGem "atronach_storm"
		set hunger to ( hunger + 95 )
		set power to ( power + 150 )
	elseif ( soultype == 13 )
		MessageBox "The crown consumes the soul of the Winged Twilight"
		Player->RemoveSoulGem "winged twilight"
		set hunger to ( hunger + 170 )
		set power to ( power + 300 )
	elseif ( soultype == 14 )
		MessageBox "The crown consumes the soul of the Lich"
		Player->RemoveSoulGem "lich"
		set hunger to ( hunger + 170 )
		set power to ( power + 300 )
	elseif ( soultype == 15 )
		MessageBox "The crown consumes the soul of the Profane Acolyte"
		Player->RemoveSoulGem "lich_profane_unique"
		set hunger to ( hunger + 170 )
		set power to ( power + 300 )
	endif
	set state to 0
endif

End

# vn_dialogue_script ==========================================================
Begin vn_dialogue_script

; this script is responsible for NPC's response to the lich before they've been converted
; it should find the chance of being converted
; also loads a global for whether the Player has 'revealed their identity' to the NPC
; anything else

float counters
float rcounters
float disposition
float level
float pclevel
float leveldifference
float intelligence
float pcpersonality
float pcspeechcraft
float max
float chance
float score
float temp1
float temp2
float temp3
float temp4
float temp5
float timer
float timer2
float frange
short range
short state
short daytags

if ( state == 0 )
	; if ( GetItemCount vn_lich_shirt > 0 )
	;	set vn_npcislich to 1
	; else
	;	set vn_npcislich to 0
	; endif
	; DONE IN STATE 3
	; if ( GetItemCount vn_lichidentity > 0 )
	;	set vn_lichknown to 1
	; else
	;	set vn_lichknown to 0
	; endif
	
	; recruitment. The state must be entirely stored by the NPC in question. I can't attach a script but I can attach
	; items and have them processed by a script. 
	; how to do this? 
	; -- I can't have the NPC dissapear.
	; I can't accurately check time of Day -- have to have Day count...

	set daytags to ( GetItemCount "vn_daytags" )
	
	if ( daytags > 0 )
		if ( daytags <= DaysPassed )
			; search done. Success determined by successtoken - added when you issue the order
			if ( GetItemCount vn_recruittoken == 0 )
				set vn_lichrecruitment to 2 ; fail
				; MessageBox "Search fail report"
			else
				set vn_lichrecruitment to 3 ; succeed
				; MessageBox "Search suceed report"
			endif
		else
			; search in progress
			set vn_lichrecruitment to 1
			; MessageBox "Search in progress"
		endif
	else
		; no search
		; MessageBox "No recruitment"
		set vn_lichrecruitment to 0
	endif
	
	; recruitment. States required -- normal 'flagged' and 'result'
	; set counters to ( GetItemCount vn_powercounter )
	; set rcounters to ( GetItemCount vn_refusal )
	set disposition to GetDisposition
	set level to GetLevel
	set pclevel to ( Player->GetLevel )
	set leveldifference to ( pclevel - level )
	set intelligence to GetIntelligence
	set pcpersonality to ( Player->GetPersonality )
	set pcspeechcraft to ( Player->GetSpeechcraft )
	set state to 1
endif

if ( state == 1 )

	; get base chance
	set vn_reveal_chance to ( ( disposition - 100 ) * 2.5 )
	set vn_reveal_chance to ( vn_reveal_chance + ( vn_avenue_psionics * 10 ) )
	; MessageBox "Base chance %.2f", vn_reveal_chance

	; get accuracy range
	set frange to ( 5000 / ( vn_avenue_psionics * vn_avenue_psionics * vn_avenue_psionics ) )
	set range to frange

	set frange to Random100
	set frange to ( frange / 100 )
	set frange to ( frange * range )

	; MessageBox "frange decuctable -- %.2f", frange
	set vn_lower_estimate to  ( vn_reveal_chance - frange )
	set vn_upper_estimate to ( vn_lower_estimate + range )

	if ( vn_lower_estimate < 0 )
		set vn_lower_estimate to 0
	elseif ( vn_lower_estimate > 100 )
		set vn_lower_estimate to 0 
	endif

	if ( vn_upper_estimate > 100 )
		set vn_upper_estimate to 100
	elseif ( vn_upper_estimate < 0 )
		set vn_upper_estimate to 0
	endif

	; cap it ( AFTER getting estimates! - so it won't always show 0-40% for zero chance. )
	if ( vn_reveal_chance < 0 )
		set vn_reveal_chance to 0
	elseif ( vn_reveal_chance > 100 )
		set vn_reveal_chance to 100
	endif

	; MessageBox "Actual reveal chance: %.2f, current Random100: %.2f", vn_reveal_chance, Random100

	; set vn_powerchance to ( ( PClevel * 5 ) + vn_reveal_chance - GetWillpower + ( 10 * ( counters - rcounters ) ) )
	set temp1 to ( disposition/5 )
	set temp2 to ( ( intelligence + pcpersonality + pcspeechcraft ) / 10 )
	set temp3 to ( 2.5 * leveldifference )
	set temp4 to ( 0 - ( level / 5 ) )
	set temp5 to ( ( counters - rcounters ) * 5 )
	set score to ( temp1 + temp2 + temp3 + temp4 + temp5 - 40 )
	set state to 2

endif

if ( state == 2 )
	if ( score > 10 )
		set max to ( score + 10 )
	else
		set max to 20
	endif
	set chance to ( ( score / max ) *100 )
;	MessageBox "Convert Chance is %.2f%", chance
;	MessageBox "Reveal chance is %.2f%", vn_reveal_chance
;	MessageBox "Power accetpance chance is %.2f", vn_powerchance
	set vn_convert_chance to chance
	set state to 3
endif

if ( state == 3 )

	if ( GetItemCount "vn_lichidentity" > 0 )
		set vn_lichknown to 1
		SetAlarm -8 ; used as a variable to detect if ( this person knows the PC is a lich )
		; it prevents the hostile greetings the Player would otherwise get
		; which wouldn't make sense if ( the NPC has talked to the Player knowing he's a lich )
	else
		set vn_lichknown to 0
	endif

	if ( GetItemCount "vn_lich_shirt" > 0 )
		set vn_npcislich to 1
	else
		set vn_npcislich to 0
	endif

	if ( disposition != GetDisposition )
		set state to 0
		; MessageBox "Disposition changed"
	elseif ( counters != GetItemCount "vn_powercounter" )
		set state to 0
		; MessageBox, "Addiction level changed"
	elseif ( rcounters != GetItemCount "vn_refusal" )
		set state to 0
		; MessageBox "resolution changed"
	endif

endif

if ( MenuMode == 0 )
	StopScript "vn_dialogue_script"
endif

End

# vn_divider_east_script ======================================================
Begin vn_divider_east_script

short state
float buildpoints
float buildrate
float buildtarget
float constructionpercentage
float constructiontime

if ( OnActivate == 1 )
	if ( vn_lair_building == 2 )
		; get construction percentage
		set buildpoints to vn_build_points
		set buildrate to vn_build_rate
		set buildtarget to vn_build_target
		if ( buildtarget > 0 )
			set constructionpercentage to ( 100 * ( buildpoints / buildtarget ) )
			set constructiontime to ( buildtarget - vn_build_points )
		else
			set constructionpercentage to 0
		endif
		if ( buildrate > 0 )
			set constructiontime to ( constructiontime / buildrate )
			set constructiontime to ( constructiontime / 24 )
		endif
			
		if ( vn_build_rate > 0 )
			MessageBox "The East Side Chamber has not yet been built. It is estimated at %.2f percent complete, with %.2f days remaining at the current build rate. It will build faster if more human followers are working on it" constructionpercentage constructiontime
		else
			MessageBox "The East Side Chamber has not yet been built. It is estimated at %.2f percent complete. It will not build unless human followers are working on it" constructionpercentage
		endif
	else
		MessageBox "This area is not being constructed yet."
	endif
endif

if ( state == 0 )
	if ( vn_lair_side1 == 1 )
		set state to 1
	endif
endif

if ( state == 1 )
	SetPos z 3000 ; bump it miles away
	set state to 2
endif

if ( state == 2 )
	StopScript "vn_divider_east_script" ; stop this running
endif

End

# vn_divider_main_script ======================================================
Begin vn_divider_main_script

short state
float buildpoints
float buildrate
float buildtarget
float constructionpercentage
float constructiontime

if ( OnActivate == 1 )
	if ( vn_lair_building == 1 )
		; get construction percentage
		set buildpoints to vn_build_points
		set buildrate to vn_build_rate
		set buildtarget to vn_build_target
		if ( buildtarget > 0 )
			set constructionpercentage to ( 100 * ( buildpoints / buildtarget ) )
			set constructiontime to ( buildtarget - vn_build_points )
		else
			set constructionpercentage to 0
		endif
		if ( buildrate > 0 )
			set constructiontime to ( constructiontime / buildrate )
			set constructiontime to ( constructiontime / 24 )
		endif
			
		if ( vn_build_rate > 0 )
			MessageBox "The Main Chamber has not yet been built. It is estimated at %.2f percent complete, with %.2f days remaining at the current build rate. It will build faster if more human followers are working on it" constructionpercentage constructiontime
		else
			MessageBox "The Main Chamber has not yet been built. It is estimated at %.2f percent complete. It will not build unless human followers are working on it" constructionpercentage
		endif
	else
		MessageBox "This area is not being constructed yet."
	endif
endif

if ( state == 0 )
	if ( vn_lair_firstchamber > 1 )
		set state to 1
	endif
endif

if ( state == 1 )
	SetPos z 3000 ; bump it miles away
	set state to 2
endif

if ( state == 2 )
	StopScript "vn_divider_main_script" ; stop this running
endif

End

# vn_divider_sac_script =======================================================
Begin vn_divider_sac_script

short state
float buildpoints
float buildrate
float buildtarget
float constructionpercentage
float constructiontime

if ( OnActivate == 1 )
	if ( vn_lair_building == 5 )
		; get construction percentage
		set buildpoints to vn_build_points
		set buildrate to vn_build_rate
		set buildtarget to vn_build_target
		if ( buildtarget > 0 )
			set constructionpercentage to ( 100 * ( buildpoints / buildtarget ) )
			set constructiontime to ( buildtarget - vn_build_points )
		else
			set constructionpercentage to 0
		endif
		if ( buildrate > 0 )
			set constructiontime to ( constructiontime / buildrate )
			set constructiontime to ( constructiontime / 24 )
		endif
			
		if ( vn_build_rate > 0 )
			MessageBox "The Sacrificial Chamber has not yet been built. It is estimated at %.2f percent complete, with %.2f days remaining at the current build rate. It will build faster if more human followers are working on it" constructionpercentage constructiontime
		else
			MessageBox "The Sacrificial Chamber has not yet been built. It is estimated at %.2f percent complete. It will not build unless human followers are working on it" constructionpercentage
		endif
	else
		MessageBox "This area is not being constructed yet."
	endif
endif

if ( state == 0 )
	if ( vn_lair_sac == 1 )
		set state to 1
	endif
endif

if ( state == 1 )
	SetPos z 3000 ; bump it miles away
	set state to 2
endif

if ( state == 2 )
	StopScript "vn_divider_sac_script" ; stop this running
endif

End

# vn_divider_secret_script ====================================================
Begin vn_divider_secret_script

short state
float buildpoints
float buildrate
float buildtarget
float constructionpercentage
float constructiontime

if ( OnActivate == 1 )
	if ( vn_lair_building == 1 )
		; get construction percentage
		set buildpoints to vn_build_points
		set buildrate to vn_build_rate
		set buildtarget to vn_build_target
		if ( buildtarget > 0 )
			set constructionpercentage to ( 100 * ( buildpoints / buildtarget ) )
			set constructiontime to ( buildtarget - vn_build_points )
		else
			set constructionpercentage to 0
		endif
		if ( buildrate > 0 )
			set constructiontime to ( constructiontime / buildrate )
			set constructiontime to ( constructiontime / 24 )
		endif
			
		if ( vn_build_rate > 0 )
			MessageBox "The Secret Chamber has not yet been built. It is estimated at %.2f percent complete, with %.2f days remaining at the current build rate. It will build faster if more human followers are working on it" constructionpercentage constructiontime
		else
			MessageBox "The Secret Chamber has not yet been built. It is estimated at %.2f percent complete. It will not build unless human followers are working on it" constructionpercentage
		endif
	else
		MessageBox "This area is not being constructed yet."
	endif
endif

if ( state == 0 )
	if ( vn_lair_firstchamber > 3 )
		set state to 1
	endif
endif

if ( state == 1 )
	SetPos z 3000 ; bump it miles away
	set state to 2
endif

if ( state == 2 )
	StopScript "vn_divider_secret_script" ; stop this running
endif

End

# vn_divider_study_script =====================================================
Begin vn_divider_study_script

short state
float buildpoints
float buildrate
float buildtarget
float constructionpercentage
float constructiontime

if ( OnActivate == 1 )
	if ( vn_lair_building == 6 )
		; get construction percentage
		set buildpoints to vn_build_points
		set buildrate to vn_build_rate
		set buildtarget to vn_build_target
		if ( buildtarget > 0 )
			set constructionpercentage to ( 100 * ( buildpoints / buildtarget ) )
			set constructiontime to ( buildtarget - vn_build_points )
		else
			set constructionpercentage to 0
		endif
		if ( buildrate > 0 )
			set constructiontime to ( constructiontime / buildrate )
			set constructiontime to ( constructiontime / 24 )
		endif
			
		if ( vn_build_rate > 0 )
			MessageBox "The Study Chamber has not yet been built. It is estimated at %.2f percent complete, with %.2f days remaining at the current build rate. It will build faster if more human followers are working on it" constructionpercentage constructiontime
		else
			MessageBox "The Study Chamber has not yet been built. It is estimated at %.2f percent complete. It will not build unless human followers are working on it" constructionpercentage
		endif
	else
		MessageBox "This area is not being constructed yet."
	endif
endif

if ( state == 0 )
	if ( vn_lair_study == 1 )
		set state to 1
	endif
endif

if ( state == 1 )
	SetPos z 3000 ; bump it miles away
	set state to 2
endif

if ( state == 2 )
	StopScript "vn_divider_study_script" ; stop this running
endif

End

# vn_divider_tres_script ======================================================
Begin vn_divider_tres_script

short state
float buildpoints
float buildrate
float buildtarget
float constructionpercentage
float constructiontime

if ( OnActivate == 1 )
	if ( vn_lair_building == 1 )
		; get construction percentage
		set buildpoints to vn_build_points
		set buildrate to vn_build_rate
		set buildtarget to vn_build_target
		if ( buildtarget > 0 )
			set constructionpercentage to ( 100 * ( buildpoints / buildtarget ) )
			set constructiontime to ( buildtarget - vn_build_points )
		else
			set constructionpercentage to 0
		endif
		if ( buildrate > 0 )
			set constructiontime to ( constructiontime / buildrate )
			set constructiontime to ( constructiontime / 24 )
		endif
			
		if ( vn_build_rate > 0 )
			MessageBox "The Treasure Chamber has not yet been built. It is estimated at %.2f percent complete, with %.2f days remaining at the current build rate. It will build faster if more human followers are working on it" constructionpercentage constructiontime
		else
			MessageBox "The Treasure Chamber has not yet been built. It is estimated at %.2f percent complete. It will not build unless human followers are working on it" constructionpercentage
		endif
	else
		MessageBox "This area is not being constructed yet."
	endif
endif

if ( state == 0 )
	if ( vn_lair_firstchamber > 2 )
		set state to 1
	endif
endif

if ( state == 1 )
	SetPos z 3000 ; bump it miles away
	set state to 2
endif

if ( state == 2 )
	StopScript "vn_divider_tres_script" ; stop this running
endif

End

# vn_divider_west_script ======================================================
Begin vn_divider_west_script

short state
float buildpoints
float buildrate
float buildtarget
float constructionpercentage
float constructiontime

if ( OnActivate == 1 )
	if ( vn_lair_building == 3 )
		; get construction percentage
		set buildpoints to vn_build_points
		set buildrate to vn_build_rate
		set buildtarget to vn_build_target
		if ( buildtarget > 0 )
			set constructionpercentage to ( 100 * ( buildpoints / buildtarget ) )
			set constructiontime to ( buildtarget - vn_build_points )
		else
			set constructionpercentage to 0
		endif
		if ( buildrate > 0 )
			set constructiontime to ( constructiontime / buildrate )
			set constructiontime to ( constructiontime / 24 )
		endif
			
		if ( vn_build_rate > 0 )
			MessageBox "The West Side Chamber has not yet been built. It is estimated at %.2f percent complete, with %.2f days remaining at the current build rate. It will build faster if more human followers are working on it" constructionpercentage constructiontime
		else
			MessageBox "The West Side Chamber has not yet been built. It is estimated at %.2f percent complete. It will not build unless human followers are working on it" constructionpercentage
		endif
	else
		MessageBox "This area is not being constructed yet."
	endif
endif

if ( state == 0 )
	if ( vn_lair_side2 == 1 )
		set state to 1
	endif
endif

if ( state == 1 )
	SetPos z 3000 ; bump it miles away
	set state to 2
endif

if ( state == 2 )
	; UPDATE: This may need enabled, other similar scripts are like that. ?
	; StopScript, vn_divider_west_script ; stop this running
endif

End

# vn_divider_worship_script ===================================================
Begin vn_divider_worship_script

short state
float buildpoints
float buildrate
float buildtarget
float constructionpercentage
float constructiontime

if ( OnActivate == 1 )
	if ( vn_lair_building == 4 )
		; get construction percentage
		set buildpoints to vn_build_points
		set buildrate to vn_build_rate
		set buildtarget to vn_build_target
		if ( buildtarget > 0 )
			set constructionpercentage to ( 100 * ( buildpoints / buildtarget ) )
			set constructiontime to ( buildtarget - vn_build_points )
		else
			set constructionpercentage to 0
		endif
		if ( buildrate > 0 )
			set constructiontime to ( constructiontime / buildrate )
			set constructiontime to ( constructiontime / 24 )
		endif
			
		if ( vn_build_rate > 0 )
			MessageBox "The Worship Chamber has not yet been built. It is estimated at %.2f percent complete, with %.2f days remaining at the current build rate. It will build faster if more human followers are working on it" constructionpercentage constructiontime
		else
			MessageBox "The Worship Chamber has not yet been built. It is estimated at %.2f percent complete. It will not build unless human followers are working on it" constructionpercentage
		endif
	else
		MessageBox "This area is not being constructed yet."
	endif
endif

if ( state == 0 )
	if ( vn_lair_worship == 1 )
		set state to 1
	endif
endif

if ( state == 1 )
	SetPos z 3000 ; bump it miles away
	set state to 2
endif

if ( state == 2 )
	StopScript "vn_divider_worship_script" ; stop this running
endif

End

# vn_emptyscript ==============================================================
Begin vn_emptyscript

short OnPCDrop
short doonce

if ( vn_shownpotionmessage == 0 )
	MessageBox "Drop the vial and Activate it to add ingredients. Do not mix the potion until you have all the ingredients, and do not pick up an unmixed potion as the ingredients will be lost"
	set vn_shownpotionmessage to 1
endif

if ( OnPCDrop == 1 )
	if ( doonce == 0 )
		PlaceAtPC "vn_tempvial" 1 0 0
		set doonce to 1
		SetDelete 1
		Disable
	endif
endif

End

# vn_enchant_check ============================================================
Begin vn_enchant_check

short state
short button

if ( state == 0 )
	if ( Player->GetSpellEffects "vn_enchant" == 1 )
		if ( Player->HasItemEquipped "vn_lich_head_armor" == 1 )
			Player->RemoveItem "vn_lich_head_armor" 1
			Player->AddItem "vn_crown_of_souls" 1
			MessageBox "Your lich crown has been enchanted"
			set state to 2
		elseif ( Player->HasItemEquipped "vn_lich_head_armor2" == 1 )
			Player->RemoveItem "vn_lich_head_armor2" 1
			Player->AddItem "vn_crown_of_souls2" 1
			MessageBox "Your lich crown has been enchanted"
			set state to 2
		else
			MessageBox "Enchant which item?" "Phylactery" "Empty Vial" "None"
			; looks to the user like it will only work on these two.... but that's not the case. Cruel, eh?
			set state to 1
		endif
	endif
endif

if ( state == 1 )
	set button to GetButtonPressed
	; MessageBox, "state 1"
	if ( button == -1 )
		return
	endif
	if ( button == 0 )
		if ( Player->GetItemCount "vn_phylactery1_u" > 0 )
			Player->AddItem "vn_phylactery1_e" 1
			Player->RemoveItem "vn_phylactery1_u" 1
			MessageBox "Phylactery successfully enchanted"
			set state to 2
		else
			MessageBox "You don't have a Phlyactery to enchant"
			set state to 2
		endif
	endif
	if ( button == 1 )
		if ( Player->GetItemCount "misc_skooma_vial" > 0 )
			Player->AddItem "vn_enchantedvial" 1
			Player->RemoveItem "misc_skooma_vial" 1
			MessageBox "Vial successfully enchanted"
			set state to 2
		else
			MessageBox "You don't have an empty vial to enchant"
			set state to 2
		endif
	endif
	if ( button == 2 )
		set state to 2
		return
	endif
endif

if ( state == 2 )
	if ( Player->GetSpellEffects "vn_enchant" == 0 )
		; MessageBox, "resetting state"
		set state to 0
		set button to -1
	endif
endif

End

# vn_essence_script ===========================================================
Begin vn_essence_script

short OnPCEquip
short state
float temp
short button
float soulvalue

if ( state == 0 )
	if ( OnPCEquip == 1 )
		set state to 1
		set OnPCEquip to 0
	endif
endif

if ( state == 1 )
	MessageBox "Consume which soul?" "Cancel" "Ancestor Ghost" "Flame Atronach" "Frost Atronach"
	set state to 2
endif

if ( state == 2 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set state to 0
	elseif ( button == 1 )
		set state to 3
	elseif ( button == 2 )
		set state to 4
	elseif ( button == 3 )
		set state to 5
	endif
endif

if ( state == 3 )
	if ( Player->HasSoulGem "ancestor_ghost" > 0 )
		Player->RemoveSoulGem "ancestor_ghost"
		set soulvalue to 10
		set state to 100
	else
		MessageBox "You have no Ancestor Ghost souls"
		set state to 0
	endif
endif

if ( state == 4 )
	if ( Player->HasSoulGem "atronach_flame" > 0 )
		Player->RemoveSoulGem "atronach_flame"
		set soulvalue to 11
		set state to 100
	else
		MessageBox "You have no Flame Atronach souls"
		set state to 0
	endif
endif

if ( state == 5 )
	if ( Player->HasSoulGem "atronach_frost" > 0 )
		Player->RemoveSoulGem "atronach_frost"
		set soulvalue to 14
		set state to 100
	else
		MessageBox "You have no Frost Atronach souls"
		set state to 0
	endif
endif

if ( state == 100 )
	set temp to ( soulvalue * vn_avenue_vampirism )
	Player->ModCurrentMagicka temp
	MessageBox "You can feel your powers replenishing as you consume the soul"
	PlaySound "mysticism area"
	set state to 0
endif

End

# vn_explosive_rat_script =====================================================
Begin vn_explosive_rat_script

short doonce
float timer
short state 

set timer to ( timer + ( GetSecondsPassed ) )

if ( state == 0 )
	if ( GetMagicka < 100 )
		set timer to 0
		set state to 1
	endif
endif

if ( state == 1 )
	if ( timer > 1 ) 
		ModCurrentHealth -1000
		Disable
		StopScript "vn_explosive_Rat_script"
	endif
endif
		
; abandon this idea, ExplodeSpell is unreliable. Give rate more magcika, and it'll Cast it itself
; then check magicka and kill the rat
; if ( state == 0 )
;	if ( GetHealth > 0 ) 
;		if ( GetHealthGetRatio < 1 )
;			set state to 1
;			; AddSpell, vn_sanctuary
;			SetAgility, 1000
;			MessageBox "Rat detonating"
;			ExplodeSpell, vn_rat_explode_spell
;			set timer to 0
;		endif
;	endif
; endif
;
; if ( state == 1 )
;	if ( timer > 3 )
;		set timer to 0
;		MessageBox "Re-attempting detonation"
;		ModCurrentHealth, 1000
;		ExplodeSpell, vn_rat_explode_spell
;	endif
; endif

End

# vn_faithscript ==============================================================
Begin vn_faithscript

float addition
long last_gamehour
long next_gamehour
short checklevel ; boolean set when you want to check level of prayer points
short lastlevel
short level
short levelchanged
short flag1
short flag2
short flag3
short flag4
short flag5
short flag6
short flag7
short flag8
short flag9
short flag10

; if GetSpell effects....
; need to check for spells so I know to remove faith points!

if ( flag1 == 0 )
	if ( Player->GetSpellEffects "vn_faith1" == 1 )
		set vn_faith to ( vn_faith - 2 )
		MessageBox "Your faith magicka has been reduced to %.2f" vn_faith
		set checklevel to 1
		set flag1 to 1
	endif
else
	if ( Player->GetSpellEffects "vn_faith1" == 0 )
		set flag1 to 0
	endif
endif

if ( flag2 == 0 )
	if ( Player->GetSpellEffects "vn_faith2" == 1 )
		set vn_faith to ( vn_faith - 5 )
		MessageBox "Your faith magicka has been reduced to %.2f" vn_faith
		set checklevel to 1
		set flag2 to 1
	endif
else
	if ( Player->GetSpellEffects "vn_faith2" == 0 )
		set flag2 to 0
	endif
endif

if ( flag3 == 0 )
	if ( Player->GetSpellEffects "vn_faith3" == 1 )
		set vn_faith to ( vn_faith - 10 )
		MessageBox "Your faith magicka has been reduced to %.2f" vn_faith
		set checklevel to 1
		set flag3 to 1
	endif
else
	if ( Player->GetSpellEffects "vn_faith3" == 0 )
		set flag3 to 0
	endif
endif

if ( flag4 == 0 )
	if ( Player->GetSpellEffects "vn_faith4" == 1 )
		set vn_faith to ( vn_faith - 15 )
		MessageBox "Your faith magicka has been reduced to %.2f" vn_faith
		set checklevel to 1
		set flag4 to 1
	endif
else
	if ( Player->GetSpellEffects "vn_faith4" == 0 )
		set flag4 to 0
	endif
endif

if ( flag5 == 0 )
	if ( Player->GetSpellEffects "vn_faith5" == 1 )
		set vn_faith to ( vn_faith - 25 )
		MessageBox "Your faith magicka has been reduced to %.2f" vn_faith
		set checklevel to 1
		set flag5 to 1
	endif
else
	if ( Player->GetSpellEffects "vn_faith5" == 0 )
		set flag5 to 0
	endif
endif

if ( flag6 == 0 )
	if ( Player->GetSpellEffects "vn_faith6" == 1 )
		set vn_faith to ( vn_faith - 40 )
		MessageBox "Your faith magicka has been reduced to %.2f" vn_faith
		set checklevel to 1
		set flag6 to 1
	endif
else
	if ( Player->GetSpellEffects "vn_faith6" == 0 )
		set flag6 to 0
	endif
endif

if ( flag7 == 0 )
	if ( Player->GetSpellEffects "vn_faith7" == 1 )
		if ( vn_raise_dead_state == -1 )
			if ( ScriptRunning "vn_raise_dead_script" == 0 )
				MessageBox "Raise Dead detected"
				StartScript "vn_raise_dead_script"
				PlaySound "conjuration area"
				set vn_raise_dead_state to 0
			endif
		endif
		set vn_faith to ( vn_faith - 70 )
		MessageBox "Your faith magicka has been reduced to %.2f" vn_faith
		set checklevel to 1
		set flag7 to 1
	endif
else
	if ( Player->GetSpellEffects "vn_faith7" == 0 )
		set flag7 to 0
	endif
endif

if ( flag8 == 0 )
	if ( Player->GetSpellEffects "vn_faith8" == 1 )
		set vn_faith to ( vn_faith - 110 )
		MessageBox "Your faith magicka has been reduced to %.2f" vn_faith
		set checklevel to 1
		set flag8 to 1
	endif
else
	if ( Player->GetSpellEffects "vn_faith8" == 0 )
		set flag8 to 0
	endif
endif

if ( flag9 == 0 )
	if ( Player->GetSpellEffects "vn_faith9" == 1 )
		set vn_faith to ( vn_faith - 180 )
		MessageBox "Your faith magicka has been reduced to %.2f" vn_faith
		set checklevel to 1
		set flag9 to 1
	endif
else
	if ( Player->GetSpellEffects "vn_faith9" == 0 )
		set flag9 to 0
	endif
endif

if ( flag10 == 0 )
	if ( Player->GetSpellEffects "vn_faith10" == 1 )
		set vn_faith to ( vn_faith - 300 )
		MessageBox "Your faith magicka has been reduced to %.2f" vn_faith
		set checklevel to 1
		set flag10 to 1
	endif
else
	if ( Player->GetSpellEffects "vn_faith10" == 0 )
		set flag10 to 0
	endif
endif

if ( checklevel == 1 )
	if ( vn_faith >= 4450 )
		set level to 10
	elseif ( vn_faith >= 2750 )
		set level to 9
	elseif ( vn_faith >= 1700 )
		set level to 8
	elseif ( vn_faith >= 1050 )
		set level to 7
	elseif ( vn_faith >= 650 )
		set level to 6
	elseif ( vn_faith >= 400 )
		set level to 5
	elseif ( vn_faith >= 250 )
		set level to 4
	elseif ( vn_faith >= 150 )
		set level to 3
	elseif ( vn_faith >= 75 )
		set level to 2
	elseif ( vn_faith >= 25 )
		set level to 1
	else
		set level to 0
	endif
	if ( level < lastlevel )
		MessageBox "Your faith magicka level has reduced to %.2f" level
		set lastlevel to level
		set levelchanged to 1
	elseif ( lastlevel < level )
		MessageBox "Your faith magicka level has increased to %.2f" level
		set lastlevel to level
		set levelchanged to 1
	endif
endif

if ( levelchanged == 1 )
	; remove all spells
	; then add correct spells
	if ( Player->GetSpell "vn_faith1" == 1 )
		Player->RemoveSpell "vn_faith1"
	endif
	if ( Player->GetSpell "vn_faith2" == 1 )
		Player->RemoveSpell "vn_faith2"
	endif
	if ( Player->GetSpell "vn_faith3" == 1 )
		Player->RemoveSpell "vn_faith3"
	endif
	if ( Player->GetSpell "vn_faith4" == 1 )
		Player->RemoveSpell "vn_faith4"
	endif
	if ( Player->GetSpell "vn_faith5" == 1 )
		Player->RemoveSpell "vn_faith5"
	endif
	if ( Player->GetSpell "vn_faith6" == 1 )
		Player->RemoveSpell "vn_faith6"
	endif
	if ( Player->GetSpell "vn_faith7" == 1 )
		Player->RemoveSpell "vn_faith7"
	endif
	if ( Player->GetSpell "vn_faith8" == 1 )
		Player->RemoveSpell "vn_faith8"
	endif
	if ( Player->GetSpell "vn_faith9" == 1 )
		Player->RemoveSpell "vn_faith9"
	endif
	if ( Player->GetSpell "vn_faith10" == 1 )
		Player->RemoveSpell "vn_faith10"
	endif
	set levelchanged to 2
endif

if ( levelchanged == 2 )
	if ( Player->GetSpell "vn_faithbonus1" == 1 )
		Player->RemoveSpell "vn_faithbonus1"
	endif
	if ( Player->GetSpell "vn_faithbonus2" == 1 )
		Player->RemoveSpell "vn_faithbonus2"
	endif
	if ( Player->GetSpell "vn_faithbonus3" == 1 )
		Player->RemoveSpell "vn_faithbonus3"
	endif
	if ( Player->GetSpell "vn_faithbonus4" == 1 )
		Player->RemoveSpell "vn_faithbonus4"
	endif
	if ( Player->GetSpell "vn_faithbonus5" == 1 )
		Player->RemoveSpell "vn_faithbonus5"
	endif
	if ( Player->GetSpell "vn_faithbonus6" == 1 )
		Player->RemoveSpell "vn_faithbonus6"
	endif
	if ( Player->GetSpell "vn_faithbonus7" == 1 )
		Player->RemoveSpell "vn_faithbonus7"
	endif
	if ( Player->GetSpell "vn_faithbonus8" == 1 )
		Player->RemoveSpell "vn_faithbonus8"
	endif
	if ( Player->GetSpell "vn_faithbonus9" == 1 )
		Player->RemoveSpell "vn_faithbonus9"
	endif
	if ( Player->GetSpell "vn_faithbonus10" == 1 )
		Player->RemoveSpell "vn_faithbonus10"
	endif
	set levelchanged to 3
endif

if ( levelchanged == 3 )
	; add spells
	if ( level >= 1 )
		Player->AddSpell "vn_faith1"
	endif
	if ( level >= 2 )
		Player->AddSpell "vn_faith2"
	endif
	if ( level >= 3 )
		Player->AddSpell "vn_faith3"
	endif
	if ( level >= 4 )
		Player->AddSpell "vn_faith4"
	endif
	if ( level >= 5 )
		Player->AddSpell "vn_faith5"
	endif
	if ( level >= 6 )
		Player->AddSpell "vn_faith6"
	endif
	if ( level >= 7 )
		Player->AddSpell "vn_faith7"
	endif
	if ( level >= 8 )
		Player->AddSpell "vn_faith8"
	endif
	if ( level >= 9 )
		Player->AddSpell "vn_faith9"
	endif
	if ( level >= 10 )
		Player->AddSpell "vn_faith10"
	endif
	set levelchanged to 4
endif

if ( levelchanged == 4 )
	if ( level == 1 )
		Player->AddSpell "vn_faithbonus1"
	elseif ( level == 2 )
		Player->AddSpell "vn_faithbonus2"
	elseif ( level == 3 )
		Player->AddSpell "vn_faithbonus3"
	elseif ( level == 4 )
		Player->AddSpell "vn_faithbonus4"
	elseif ( level == 5 )
		Player->AddSpell "vn_faithbonus5"
	elseif ( level == 6 )
		Player->AddSpell "vn_faithbonus6"
	elseif ( level == 7 )
		Player->AddSpell "vn_faithbonus7"
	elseif ( level == 8 )
		Player->AddSpell "vn_faithbonus8"
	elseif ( level == 9 )
		Player->AddSpell "vn_faithbonus9"
	elseif ( level == 10 )
		Player->AddSpell "vn_faithbonus10"
	endif
	set levelchanged to 0
endif		

set next_gamehour to GameHour
if ( last_gamehour != next_gamehour )
	set last_gamehour to GameHour
	set addition to vn_prayer_rate
	set addition to ( addition / 10 )
	set vn_faith to ( vn_faith + addition )
	set checklevel to 1
	; MessageBox "Faith increased by %.2f to %.2f", addition, vn_faith
endif

End

# vn_follower_bonewalker ======================================================
Begin vn_follower_bonewalker

short doonce
short undeadfollower
short state 
short button
short following

float myx
float myy
float myz
float warptimer

if ( GetDistance Player < 1000 )
	set vn_lichscript.canbeseen to 0
endif

if ( GetCurrentAiPackage == 3 )
	if ( GetWeaponDrawn )
		; do nothing
	elseif ( GetSpellReadied )
		; do nothing
	elseif ( GetDistance Player > 800 )
		if ( GetFlee < 1000 )
			set warptimer to ( warptimer + ( GetSecondsPassed ) )
			if ( warptimer > 8 )
				set warptimer to 0
				set myx to ( Player->GetPos x )
				set myy to ( Player->GetPos y )	
				set myz to ( Player->GetPos z )
				SetPos x myx
				SetPos y myy
				SetPos z myz
          	endif
     	endif
   endif
endif

if ( vn_undead_follow == -1 ) ; global cancel
	if ( following == 1 )
		AiWander 0 0 0
		set following to 0
	endif
endif

if ( vn_undead_follow == 1 ) ; global follow
	if ( following == 0 )
		AiFollow Player 0 0 0 0
		set following to 1
	endif
endif

if ( undeadfollower == 0 )
	set undeadfollower to 1
endif

if ( GetSpellEffects "vn_pn_heal_undead_horde" == 1 )
	ModCurrentHealth 100
endif

if ( GetHealth < 1 )
	if ( Player->GetSpellEffects "vn_pn_reanimate" == 1 )
		if ( GetDistance Player < 150 )
			MessageBox "Reanimating Bonewalker"
			Resurrect
		endif
	endif
endif

if ( state == 0 )
	if ( GetSpellEffects "vn_follower_teleport" )
		; um.... now how to do this?
		MessageBox "Choose a location" "Vivec" "Balmora" "Ghostgate" "Ald-ruhn" "Gnisis" "Dagon Fel" "Sadrith Mora" "More options" "Nowhere"
		set state to 1
	endif
endif

if ( state == 1 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set vn_travel_loc to 1
		set state to 4
	elseif ( button == 1 )
		set vn_travel_loc to 2
		set state to 4
	elseif ( button == 2 )
		set vn_travel_loc to 3
		set state to 4
	elseif ( button == 3 )
		set vn_travel_loc to 4
		set state to 4
	elseif ( button == 4 )
		set vn_travel_loc to 5
		set state to 4
	elseif ( button == 5 )
		set vn_travel_loc to 6
		set state to 4
	elseif ( button == 6 )
		set vn_travel_loc to 7
		set state to 4
	elseif ( button == 7 )
		; more choices
		set state to 2
	elseif ( button == 8 )
		; cancel
		set state to 10
	endif
	set button to -1
endif

if ( state == 2 )
	MessageBox "Choose a location" "Vos" "Valenvaryon" "Molag Mar" "Fort Frostmouth" "Skaal Village" "Forget it"
	set state to 3
endif 

if ( state == 3 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set vn_travel_loc to 10
		set state to 4
	elseif ( button == 1 )
		set vn_travel_loc to 11
		set state to 4
	elseif ( button == 2 )
		set vn_travel_loc to 12
		set state to 4
	elseif ( button == 3 )
		set vn_travel_loc to 13
		set state to 4
	elseif ( button == 4 )
		set vn_travel_loc to 14
		set state to 4
	elseif ( button == 5 )
		set vn_travel_loc to 15
		set state to 4
	elseif ( button == 6 )
		; set vn_travel_loc to 16
		; set state to 4
	; elseif ( button == 7 )
		; set vn_travel_loc to 17
		; set state to 4
	; elseif ( button == 8 )
		; cancel
		set state to 10
	endif
	set button to -1
endif

if ( state == 4 )
	; set some variable then trigger the follower travel script? Will it be correctly targeted from here?
	set vn_follower_travel_flag to 1
	StartScript "vn_follower_travel"
	set state to 10
endif

if ( state == 10 )
	if ( GetSpellEffects "vn_follower_teleport" == 0 )
		set state to 0
	endif
endif

End

# vn_follower_ghost_script ====================================================
Begin vn_follower_ghost_script

short NoLore
; ghost will not carry any of PC's equipment
short doonce
short button
short undeadfollower
short shown
short state
short following

float myx
float myy
float myz
float warptimer

if ( GetDistance Player < 1000 )
	set vn_lichscript.canbeseen to 0
endif

if ( GetCurrentAiPackage == 3 )
	if ( GetWeaponDrawn )
		; do nothing
	elseif ( GetSpellReadied )
		; do nothing
	elseif ( GetDistance Player > 800 )
		if ( GetFlee < 1000 )
			set warptimer to ( warptimer + ( GetSecondsPassed ) )
			if ( warptimer > 8 )
				set warptimer to 0
				set myx to ( Player->GetPos x )
				set myy to ( Player->GetPos y )	
				set myz to ( Player->GetPos z )
				SetPos x myx
				SetPos y myy
				SetPos z myz
          	endif
     	endif
   endif
endif

if ( vn_undead_follow == -1 ) ; global cancel
	if ( following == 1 )
		AiWander 0 0 0
		set following to 0
	endif
endif

if ( vn_undead_follow == 1 ) ; global follow
	if ( following == 0 )
		AiFollow Player 0 0 0 0
		set following to 1
	endif
endif

if ( undeadfollower == 0 )
	set undeadfollower to 1
endif

if ( GetSpellEffects "vn_pn_heal_undead_horde" == 1 )
	ModCurrentHealth 100
endif

if ( GetHealth <= 0 )
	SetDelete 1
	Disable
endif

if ( state == 0 )
	if ( GetSpellEffects "vn_follower_teleport" )
		; um.... now how to do this?
		MessageBox "Choose a location" "Vivec" "Balmora" "Ghostgate" "Ald-ruhn" "Gnisis" "Dagon Fel" "Sadrith Mora" "More options" "Nowhere"
		set state to 1
	endif
endif

if ( state == 1 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set vn_travel_loc to 1
		set state to 4
	elseif ( button == 1 )
		set vn_travel_loc to 2
		set state to 4
	elseif ( button == 2 )
		set vn_travel_loc to 3
		set state to 4
	elseif ( button == 3 )
		set vn_travel_loc to 4
		set state to 4
	elseif ( button == 4 )
		set vn_travel_loc to 5
		set state to 4
	elseif ( button == 5 )
		set vn_travel_loc to 6
		set state to 4
	elseif ( button == 6 )
		set vn_travel_loc to 7
		set state to 4
	elseif ( button == 7 )
		; more choices
		set state to 2
	elseif ( button == 8 )
		; cancel
		set state to 10
	endif
	set button to -1
endif

if ( state == 2 )
	MessageBox "Choose a location" "Vos" "Valenvaryon" "Molag Mar" "Fort Frostmouth" "Skaal Village"  "Forget it"
	set state to 3
endif 

if ( state == 3 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set vn_travel_loc to 10
		set state to 4
	elseif ( button == 1 )
		set vn_travel_loc to 11
		set state to 4
	elseif ( button == 2 )
		set vn_travel_loc to 12
		set state to 4
	elseif ( button == 3 )
		set vn_travel_loc to 13
		set state to 4
	elseif ( button == 4 )
		set vn_travel_loc to 14
		set state to 4
	elseif ( button == 5 )
		set vn_travel_loc to 15
		set state to 4
	elseif ( button == 6 )
		; set vn_travel_loc to 16
		; set state to 4
	; elseif ( button == 7 )
		; set vn_travel_loc to 17
		; set state to 4
	; elseif ( button == 8 )
		; cancel
		set state to 10
	endif
	set button to -1
endif

if ( state == 4 )
	; set some variable then trigger the follower travel script? Will it be correctly targeted from here?
	set vn_follower_travel_flag to 1
	StartScript "vn_follower_travel"
	set state to 10
endif

if ( state == 10 )
	if ( GetSpellEffects "vn_follower_teleport" == 0 )
		set state to 0
	endif
endif

End

# vn_follower_mage_script =====================================================
Begin vn_follower_mage_script

short Companion
short building
short magefollower
short praying
short p_registered
short b_registered
short state
short dead
short button
short doonce

long experience
long level
long lastlevel
short levelcheck
short mark
short recall
short qhealth
short qmagicka
short difficulty 
short expgain

short time
short missionset
short mission
short potionloss
short success
long passtarget
long score
long lastday
long currentday
float timer ; used for both pray and teleport

float temp1
; I can't remember which is the bug.. I'll just do all 3
short xxx ; 32
short xxxx ; 33
short xxxxx ; 34;
long temp2
long temp3
long showlevelup

short following

float myx
float myy
float myz
float warptimer

; if disabled and dead, don't proces anything else ( not needed, just more efficient )
if ( dead == 2 )
	return
endif

if ( GetDistance Player < 1000 )
	set vn_lichscript.canbeseen to 0
endif

if ( GetCurrentAiPackage == 3 )
	if ( GetWeaponDrawn )
		; do nothing
	elseif ( GetSpellReadied )
		; do nothing
	elseif ( GetDistance Player > 800 )
		if ( GetFlee < 1000 )
			set warptimer to ( warptimer + ( GetSecondsPassed ) )
			if ( warptimer > 8 )
				set warptimer to 0
				set myx to ( Player->GetPos x )
				set myy to ( Player->GetPos y )	
				set myz to ( Player->GetPos z )
				SetPos x myx
				SetPos y myy
				SetPos z myz
          	endif
     	endif
   endif
endif

if ( vn_undead_follow == -1 ) ; global cancel
	if ( following == 1 )
		AiWander 0 0 0
		set following to 0
	endif
endif

if ( vn_undead_follow == 1 ) ; global follow
	if ( following == 0 )
		AiFollow Player 0 0 0 0
		set following to 1
	endif
endif

if ( magefollower == 0 )
	set magefollower to 1
	set level to 1
	set lastlevel to 1
endif

if ( Companion == 0 )
	set Companion to 1
endif

; if the mage dies, he becomes rather less effective at praying and building.
if ( GetHealth <= 0 )
	if ( p_registered == 1 ) ; is gaining us prayer points
		set temp1 to ( level + 5 )
		set vn_prayer_rate to ( vn_prayer_rate - temp1 )
		set praying to 0
		set p_registered to 0
	endif
	if ( b_registered == 1 ) ; is gaining us build points
		set temp1 to ( level + 10 )
		set temp1 to ( temp1 / 5 )
		set vn_build_rate to ( vn_build_rate - temp1 )
		set building to 0
		set b_registered to 0
	endif
endif

if ( building == 1 )
	if ( b_registered == 0 )
		; if ( CellChanged )
			; PositionCell, wherever the building is supposed to happen
			set b_registered to 1
			set temp1 to ( level + 10 )
			set temp1 to ( temp1 / 5 )
			set vn_build_rate to ( vn_build_rate + temp1 )
		; endif
	endif
	; cancel if there is nothing left to build
	if ( vn_lair_building == 0 )
		set building to -1 
	endif
elseif ( building == -1 ) ; build cancelled
	set temp1 to ( level + 10 )
	set vn_build_rate to ( vn_build_rate - temp1 )
	set building to 0
	set b_registered to 0
endif

; MessageBox "mage script running"

if ( praying == 1 )
	set timer to ( timer + ( GetSecondsPassed ) )
	if ( p_registered == 0 )
		set p_registered to 1
		set temp1 to ( level + 5 )
		set vn_prayer_rate to ( vn_prayer_rate + temp1 )
	endif
	if ( timer > 5 )
		ExplodeSpell vn_pray
		set timer to 0
	endif
elseif ( praying == -1 ) ; prayer cancelled
	set temp1 to ( level + 5 )
	set vn_prayer_rate to ( vn_prayer_rate - temp1 )
	set praying to 0
	set p_registered to 0
endif

; MessageBox "mage script running 2"

; DIALOGUE MUST CALL THE FOLLOWING WHEN SETTING MISSION
; set mission to x
; set missionset to 1

if ( missionset == 1 ) ; set counts
	set lastday to DaysPassed
	set currentday to DaysPassed
	set mark to GetItemCount p_mark_s
	set recall to GetItemCount p_recall_s
	set qhealth to GetItemCount p_restore_health_q
	set qmagicka to GetItemCount p_restore_magicka_q
	set missionset to 2
endif

if ( missionset == 2 ) ; buy items
	if ( mark < 1 )
		if ( GetItemCount gold_001 >= 35 )
			AddItem "p_mark_s" 1
			RemoveItem "gold_001" 35
			set missionset to 1
			return
		endif
	elseif ( recall < 1 )
		if ( GetItemCount gold_001 >= 35 )
			AddItem "p_recall_s" 1
			RemoveItem "gold_001" 35
			set missionset to 1
			return
		endif
	elseif ( qhealth < 3 )
		if ( GetItemCount gold_001 >= 80 )
			AddItem "p_restore_health_q" 1
			RemoveItem "gold_001" 80
			set missionset to 1
			return
		endif
	elseif ( qmagicka < 3 )
		if ( GetItemCount gold_001 >= 80 )
			AddItem "p_restore_magicka_q" 1
			RemoveItem "gold_001" 80
			set missionset to 1
			return
		endif
	endif
	set missionset to 3
endif

if ( missionset == 3 ) ; set mission dependant vars
	if ( mission == 1 ) ; bonemeal
		set difficulty to 1
		set expgain to 30
		set time to 1
	elseif ( mission == 2 ) ; ectoplasm
		set difficulty to 2
		set expgain to 60
		set time to 2
	elseif ( mission == 3 ) ; pearls
		set difficulty to 3
		set expgain to 80
		set time to 2
	elseif ( mission == 4 ) ; gravedust
		set difficulty to 4
		set expgain to 100
		set time to 2
	elseif ( mission == 5 ) ; corprusmeat
		set difficulty to 5
		set expgain to 170
		set time to 3
	elseif ( mission == 6 ) ; weepings
		set difficulty to 6
		set expgain to 200
		set time to 3
	elseif ( mission == 7 ) ; emeralds
		set difficulty to 7
		set expgain to 300
		set time to 4
	endif
	set missionset to 4
endif

if ( missionset == 4 ) ; chances/dissapear/death etc
	; MessageBox "Setting mission chances..."
	; base bonemeal mission should be 100% safe with max equipment
	; i.e, always greater than -35.
	; Base score is R100 - 20 + 15L - 20D
	; 10% reduced chance per difficulty level
	; 7% increased chance per mage level
	; 1/1 == R100 - 20 + 10 - 20 = R100 - 30 
	; at level 2, R100 - 20 + 20 - 20D = R100 - 20D = guaranteed success at diff 1
	; at level 10, R100 - 20 + 100 - 20D = R100 + 80 - 20D = guranateed success up to diff 4, easy for level 2.
	; at level 20, R100 - 20 + 200 - 20D = R100 + 180 -20D = guaranteed success up to diff 9, easy for level 7.

	set temp1 to ( difficulty * 20 )
	set temp2 to ( level * 10 )
	set temp3 to ( temp1 - temp2 )
	set passtarget to ( temp3 + 20 )
	set score to ( Random100 - passtarget )
	if ( score <= -60 )
		; MessageBox "Target %.2f, Score %.2f - The mage was killed during the mission", passtarget, Random100
		set dead to 1
	elseif ( score <= -35 )
		set potionloss to 4
		; MessageBox "Target %.2f, Score %.2f - Bad failure", passtarget, Random100
	elseif ( score <= -15 )
		set potionloss to 2
		set expgain to ( expgain * 0.75 )
		; MessageBox "Target %.2f, Score %.2f expgain %.2f - normal failure", passtarget, Random100, expgain
	elseif ( score < 0 )
		set potionloss to 1
		set expgain to ( expgain * 1.5 )
		; MessageBox "Target %.2f, Score %.2f expgain %.2f - slim failure", passtarget, Random100, expgain
	elseif ( score <= 25 )
		set potionloss to 1
		set expgain to ( expgain * 1.5 )
		; MessageBox "Target %.2f, Score %.2f expgain %.2f - slim success", passtarget, Random100, expgain
	else
		set potionloss to 0
		set expgain to ( expgain * 0.75 )
		; MessageBox "Target %.2f, Score %.2f expgain %.2f - easy success", passtarget, Random100, expgain
	endif
	set missionset to 5
endif

if ( missionset == 5 ) ; iterate to remove potions.
	if ( potionloss > 1 )
		if ( qhealth > 0 )
			set potionloss to ( potionloss - 1 )
			RemoveItem "p_restore_health_q" 1
			set qhealth to ( qhealth - 1 )
			return
		elseif ( qmagicka > 0 )
			set potionloss to ( potionloss - 1 )
			RemoveItem "p_restore_magicka_q" 1
			set qmagicka to ( qmagicka - 1 )
			return
		else
			; MessageBox "The mage did not have sufficient resources (potions).... and now lies dead"
			set missionset to 6
			set dead to 1
		endif
	elseif ( potionloss == 1 )
		if ( mark > 0 )
			if ( recall > 0 )
				set potionloss to ( potionloss - 1 )
				RemoveItem "p_mark_s" 1
				set mark to ( mark - 1 )
				RemoveItem "p_recall_s" 1
				set recall to ( recall - 1 )
			else
				; MessageBox "The mage did not have sufficient resources (recall).... and now lies dead"
				set missionset to 6
				set dead to 1
			endif
		else
			; MessageBox "The mage did not have sufficient resources (mark).... and now lies dead"
			set missionset to 6
			set dead to 1
		endif
	elseif ( potionloss == 0 )
		set missionset to 6
	endif
endif

if ( missionset == 6 ) ; exp rewards ingred rewards and dissapear
	set experience to ( experience + expgain )
	set levelcheck to 1
	
	if ( score > 0 )
		if ( mission == 1 )
			if ( Random100 > 80 )
				AddItem "ingred_bonemeal_01" 3
			elseif ( Random100 > 40 )
				AddItem "ingred_bonemeal_01" 2
			else
				AddItem "ingred_bonemeal_01" 1
			endif 
		elseif ( mission == 2 )
			if ( Random100 > 60 )
				AddItem "ingred_ectoplasm_01" 2
			else
				AddItem "ingred_ectoplasm_01" 1
			endif 
		elseif ( mission == 3 )
			if ( Random100 > 80 )
				AddItem "ingred_pearl_01" 3
			elseif ( Random100 > 40 )
				AddItem "ingred_pearl_01" 2
			else
				AddItem "ingred_pearl_01" 1
			endif 
		elseif ( mission == 4 )
			if ( Random100 > 80 )
				AddItem "ingred_gravedust_01" 4
			elseif ( Random100 > 40 )
				AddItem "ingred_gravedust_01" 3
			else
				AddItem "ingred_gravedust_01" 2
			endif 
		elseif ( mission == 5 )
			if ( Random100 > 80 )
				AddItem "ingred_6th_corprusmeat_05" 8
			elseif ( Random100 > 40 )
				AddItem "ingred_6th_corprusmeat_05" 6
			else
				AddItem "ingred_6th_corprusmeat_05" 3
			endif 
		elseif ( mission == 6 )
			if ( Random100 > 85 )
				AddItem "ingred_corprus_weepings_01" 3
			elseif ( Random100 > 60 )
				AddItem "ingred_corprus_weepings_01" 2
			else
				AddItem "ingred_corprus_weepings_01" 1
			endif 
		elseif ( mission == 7 )
			if ( Random100 > 85 )
				AddItem "ingred_emerald_01" 3
			elseif ( Random100 > 60 )
				AddItem "ingred_emerald_01" 2
			else
				AddItem "ingred_emerald_01" 1
			endif 
		endif
		set success to 1
	else
		set success to -1
	endif
	
	; Cast spell on self
	set timer to 0
	ExplodeSpell vn_teleport
	set missionset to 71
endif

if ( missionset == 71 )
	if ( GetSpellEffects "vn_teleport" == 1 )
		set missionset to 7
	else
		; try to Cast the spell on self
		set timer to ( timer + ( GetSecondsPassed ) )
		if ( timer > 3 )
			set timer to 0
			ExplodeSpell vn_teleport
		endif
	endif
endif

if ( missionset == 7 )
	if ( GetDisabled == 0 )
		if ( GetSpellEffects "vn_Teleport" == 1 )
			; MessageBox "Disabling mage"
			Disable
			if ( dead == 1 )
				set dead to 2 ; blocks script from running.
			endif
		endif
	endif
	set currentday to DaysPassed
	if ( currentday != lastday )
		set lastday to currentday
		; MessageBox "Reducing Day count"
		set temp1 to ( time - 1 )
		set time to temp1
	endif
	if ( time == 0 )
		; MessageBox "Enabling mage"
		set missionset to 0
		if ( GetDisabled == 1 )
			Enable
		endif
	endif
endif

if ( levelcheck == 1 )
	if ( experience >= 19000 )
		set level to 20
	elseif ( experience >= 17100 )
		set level to 19
	elseif ( experience >= 15300 )
		set level to 18
	elseif ( experience >= 13600 )
		set level to 17
	elseif ( experience >= 12000 )
		set level to 16
	elseif ( experience >= 10500 )
		set level to 15
	elseif ( experience >= 9100 )
		set level to 14
	elseif ( experience >= 7800 )
		set level to 13
	elseif ( experience >= 6600 )
		set level to 12
	elseif ( experience >= 5500 )
		set level to 11
	elseif ( experience >= 4500 )
		set level to 10
	elseif ( experience >= 3600 )
		set level to 9
	elseif ( experience >= 2800 )
		set level to 8
	elseif ( experience >= 2100 )
		set level to 7
	elseif ( experience >= 1500 )
		set level to 6
	elseif ( experience >= 1000 )
		set level to 5
	elseif ( experience >= 600 )
		set level to 4
	elseif ( experience >= 300 )
		set level to 3
	elseif ( experience >= 100 )
		set level to 2
	else
		set level to 1
	endif
	
	; levelup stats. Not exactly super-complex, but it's good enough to do the job for now
	if ( level > lastlevel )
		ModCurrentHealth 1000 ; restore to full health
		ModHealth 5
		ModMysticism 5
		ModDestruction 5
		ModConjuration 5
		ModIllusion 5
		ModAlteration 5
		ModEnchant 5
		ModRestoration 5
		ModIntelligence 5
		ModWillpower 5
		set lastlevel to level
		set showlevelup to 1
	endif
	
	set levelcheck to 0

endif

; MessageBox "0"

if ( state == 0 )
	if ( GetSpellEffects "vn_follower_teleport" == 1 )
		; um.... now how to do this?
		MessageBox "Choose a location" "Vivec" "Balmora" "Ghostgate" "Ald-ruhn" "Gnisis" "Dagon Fel" "Sadrith Mora" "More options" "Nowhere"
		set state to 1
	endif
endif

; MessageBox "1"

if ( state == 1 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set vn_travel_loc to 1
		set state to 4
	elseif ( button == 1 )
		set vn_travel_loc to 2
		set state to 4
	elseif ( button == 2 )
		set vn_travel_loc to 3
		set state to 4
	elseif ( button == 3 )
		set vn_travel_loc to 4
		set state to 4
	elseif ( button == 4 )
		set vn_travel_loc to 5
		set state to 4
	elseif ( button == 5 )
		set vn_travel_loc to 6
		set state to 4
	elseif ( button == 6 )
		set vn_travel_loc to 7
		set state to 4
	elseif ( button == 7 )
		; more choices
		set state to 2
	elseif ( button == 8 )
		; cancel
		set state to 10
	endif
	set button to -1
endif

; MessageBox "2"

if ( state == 2 )
	MessageBox "Choose a location" "Vos" "Valenvaryon" "Molag Mar" "Fort Frostmouth" "Skaal Village" "Forget it"
	set state to 3
endif 

; MessageBox "3"

if ( state == 3 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set vn_travel_loc to 10
		set state to 4
	elseif ( button == 1 )
		set vn_travel_loc to 11
		set state to 4
	elseif ( button == 2 )
		set vn_travel_loc to 12
		set state to 4
	elseif ( button == 3 )
		set vn_travel_loc to 13
		set state to 4
	elseif ( button == 4 )
		set vn_travel_loc to 14
		set state to 4
	elseif ( button == 5 )
		set vn_travel_loc to 15
		set state to 4
	elseif ( button == 6 )
		set state to 10
	endif
	set button to -1
endif

; MessageBox "4"

if ( state == 4 )
	; set some variable then trigger the follower travel script? Will it be correctly targeted from here?
	set vn_follower_travel_flag to 1
	StartScript "vn_follower_travel"
	set state to 10
endif

; MessageBox "10"

if ( state == 10 )
	if ( GetSpellEffects "vn_follower_teleport" == 0 )
		set state to 0
	endif
endif

; MessageBox "End of script"

; return		; stop script bailing out??

End

# vn_follower_travel ==========================================================
Begin vn_follower_travel

short state
short doonce
long location
float timer
long PosX
long PosY
long PosZ

; waypoints don't work, I've scrapped them from the scripts. They still appear here

if ( doonce == 0 )
	; MessageBox "New travel script started"
	set doonce to 1
endif

if ( state == 0 )
	if ( vn_travel_loc > 0 )
		set location to vn_travel_loc
		set vn_travel_loc to 0
		set state to 1
		; MessageBox "Dest detected by script"
	endif
endif

; this script is called when you tell a follower to teleport, or you teleport them yourself
; if you tell them to teleport, vn_follower_travel flag is OFF and they Cast on themselves
; otherwise, you've Cast so they just dissapear.
if ( state == 1 )
	if ( vn_follower_travel_flag == 1 )
		set state to 3
	else
		ExplodeSpell vn_teleport
		set state to 2
	endif
endif 

if ( state == 2 )
	; stay in this state until they've teleported themselves
	if ( GetSpellEffects "vn_teleport" == 1 )
		set state to 3
	else
		set timer to timer + ( GetSecondsPassed )
		if ( timer > 5 ) ; something went wrong so try again.
			set timer to 0
			ExplodeSpell vn_teleport
		endif
	endif
endif

if ( state == 3 )
	if ( location == 100 ) ; Lich Lair
		PositionCell 0 0 0 0 "Lich's Lair"
	elseif ( location == 1 )
		Position 30000 -74000 800 0 ; Vivec exterior
	elseif ( location == 2 )
		Position -22000 -22000 500 0 ; Balmora exterior
	elseif ( location == 3 )
		Position 20700 38300 1200 0 ; Ghostgate exterior
	elseif ( location == 4 )
		Position -21300 52400 1450 0 ; Ald-ruhn
	elseif ( location == 5 )
		Position 91000 94600 1400 0 ; Gnisis
	elseif ( location == 6 )
		Position 55000 181500 1900 0 ; Dagon Fel
	elseif ( location == 7 )
		Position 142000 36100 500 0 ; Sadrith Mora
	elseif ( location == 10 ) ; 8&9 don't exist in dialogue
		Position 90600 110500 900 0 ; Vos
	elseif ( location == 11 )
		Position -3800 153400 2500 0 ; Valenvaryon
	elseif ( location == 12 )
		Position 104200 -61000 1900 0 ; Molag Mar
	elseif ( location == 13 )
		Position -177100 141900 1100 0 ; Fort Frostmouth
	elseif ( location == 14 )
		Position 164500 214300 2300 0 ; Skaal Village
	elseif ( location == 15 )
		; set x to vn_waypoint1x
		; set y to vn_waypoint1y
		; set z to vn_waypoint1z
		; if ( x == 0 )
		;	MessageBox "Waypoint 1 has not been set" "Ok"
		; else
		;	Position x, y, z, 0, ; waypoint 1
		; endif
	elseif ( location == 16 )
		; set x to vn_waypoint2x
		; set y to vn_waypoint2y
		; set z to vn_waypoint2z
		; if ( x == 0 )
		;	MessageBox "Waypoint 2 has not been set" "Ok"
		; else
		;	Position x, y, z, 0 ; waypoint 2
		; endif
	elseif ( location == 17 )
		; set x to vn_waypoint3x
		; set y to vn_waypoint3y
		; set z to vn_waypoint3z
		; if ( x == 0 )
		;	MessageBox "Waypoint 3 has not been set" "Ok"
		; else
		;	Position x, y, z, 0 ; waypoint 3
		; endif
	else
		MessageBox "Error: Unknown location"
	endif
	; MessageBox "Teleport done"
	AiWander 128 5 0
	set state to 4
endif

if ( state == 4 )
	set state to 0
	StopScript "vn_follower_travel"
endif

End

# vn_getPosition ==============================================================
Begin vn_getPosition
; this script gets the current Position of the Player
; and saves it in the global vn_TeleportCell, vn_PosX, vn_PosY, vn_PosZ and vn_Angle variables 

short ScriptState

if ( ScriptState == 0 )
	set vn_TeleportPluginAction to 1
	set vn_TeleportCell to -1
	set vn_PosX to ( Player->GetPos X )
	set vn_PosY to ( Player->GetPos Y )
	set vn_PosZ to ( Player->GetPos Z )
	set vn_Angle to ( Player->GetAngle Z )
	
	if ( GetInterior == 1 )
		; MessageBox, "Setting teleport target to interior cell"
		StartScript "vn_Teleport_getCell_Sub1"
		StartScript "vn_Teleport_getCell_Sub2"
		StartScript "vn_Teleport_getCell_Sub3"
		StartScript "vn_Teleport_getCell_Sub4"
		StartScript "vn_Teleport_getCell_Sub5"
	else
		; MessageBox, "Setting teleport target to exterior cell"
		StartScript "vn_Teleport_getGrid_Sub1"
	endif
	set ScriptState to 1
	return
endif

if ( ScriptState == 1 )
	if ( vn_TeleportCell == -1 )
		if ( ScriptRunning "vn_Teleport_getGrid_Sub1" == 1 )
			return
		elseif ( ScriptRunning "vn_Teleport_getCell_Sub1" == 1 )
			return
		elseif ( ScriptRunning "vn_Teleport_getCell_Sub2" == 1 )
			return
		elseif ( ScriptRunning "vn_Teleport_getCell_Sub3" == 1 )
			return
		elseif ( ScriptRunning "vn_Teleport_getCell_Sub4" == 1 )
			return
		elseif ( ScriptRunning "vn_Teleport_getCell_Sub5" == 1 )
			return
		endif
	endif

	; MessageBox "Teleport target location has been set"

	set vn_TeleportPluginAction to 0
	set ScriptState to 0
	StopScript "vn_getposition"
	return
endif

End

# vn_globescript ==============================================================
Begin vn_globescript

short state
short button
short rot
float timer
short doonce

; don't Rotate as the axis is wrong! Maybe get someone to fix this...
; Rotate, x, 50
; Rotate, y, 20

; set timer to ( timer + ( GetSecondsPassed ) )
; if ( timer < 0.5 )
;	RotateWorld, x, 100
; elseif ( timer < 1 )
;	RotateWorld, x, 70
;	RotateWorld, y, 30
; elseif ( timer < 1.5 )
;	RotateWorld, x, 30
;	RotateWorld, y, 70
; elseif ( timer < 2 )
;	RotateWorld, y, 100
; elseif ( timer < 2.5 )
;	RotateWorld, y, 70
;	RotateWorld, x, -30
; elseif ( timer < 3 )
;	RotateWorld, y, 30
;	RotateWorld, x, -70
; elseif ( timer < 3.5 )
;	RotateWorld, x, -100
; elseif ( timer < 4 )
;	RotateWorld, y, 30
;	RotateWorld, x, -70
; elseif ( timer < 4.5 )
;	RotateWorld, y, 70
;	RotateWorld, x, -30
; elseif ( timer < 5 )
;	RotateWorld, y, 100
; elseif ( timer < 5.5 )
;	RotateWorld, x, 30
;	RotateWorld, y, 70
; elseif ( timer < 6 )
;	RotateWorld, x, 70
;	RotateWorld, y, 30
; else
;	set timer to 0
; endif
;

if ( state == 0 )
	if ( OnActivate == 1 )
		MessageBox "What lore do you seek from the globe?" "Special Artifacts" "Explain Lich Avenue powers"
		set state to 1
	endif
endif

if ( state == 1 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set state to 5
	elseif ( button == 1 )
		set state to 3
	endif
	set button to 0
endif

if ( state == 3 )
	PlaceAtPC "vn_power_tutor" 1 600 1
	set state to 0
endif

if ( state == 5 )
	if ( vn_globe_used == 1 )
		MessageBox "You focus your powers on the globe, but no voice speaks in your head, nor vision appears before you"
		set state to 15
	else
		MessageBox "What do you seek?" "Spirit Stone" "Lich's Mortar and Pestle" "Skulls of Power"
		set vn_globe_used to 1
		set state to 11
	endif
endif

if ( state == 11 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set state to 12
	elseif ( button == 1 )
		set state to 13
	elseif ( button == 2 )
		set state to 14
	endif
endif

if ( state == 12 ) ; spirit stone visions
	if ( Random100 > 90 )
		MessageBox "A voice speaks in your mind ---  Deep In The Dungeons Of The Doomed, Lies The Stone Of Spirits" "Ok"
	elseif ( Random100 > 80 )
		MessageBox "You sense disease... rotting flesh, swollen and bloated" "Ok"
	elseif ( Random100 > 70 )
		MessageBox "A voice speaks in your mind --- Who Knows What Treasures Lie In The Domain Of The Ancient Sorcerer?" "Ok"
	elseif ( Random100 > 60 )
		MessageBox "You see a tower... all roots and vines - a Telvanni tower. It stands alone on an island... the vision fades" "Ok"
	elseif ( Random100 > 50 )
		MessageBox "A voice speaks in your mind --- There Is No Cure! There Is No Cure!" "Ok" 
	elseif ( Random100 > 40 )
		MessageBox "You feel pain and anguish... decaying minds trapped in warped and twisted bodies." "Ok"
	elseif ( Random100 > 30 )
		MessageBox "A voice speaks in your mind --- He Who Is The Most Powerful Of All Telvanni Possesses What You Seek" "Ok"
	elseif ( Random100 > 20 )
		MessageBox "You see a white gem, behind a rock in a chamber of stone. You hear water dripping behind you. Turning to see, the vision fades" "Ok"
	elseif ( Random100 > 10 )
		MessageBox "A voice speaks in your mind --- Poor Souls Trapped In A Stony Prison Of Death Guard The Means to Trap Souls In a Prison Of Stone" "Ok"
	else
		MessageBox "Visions of a wooden gate... a gatekeeper... a and past that a compelling urge to take the passage you see on your right" "Ok"
	endif
	set state to 15
endif

if ( state == 13 ) ; lichs mortar and pestle
	if ( Random100 > 90 )
		MessageBox "A voice speaks in your mind -- In A Forgotten Crypt Lie Things Best Left Undisturbed" "Ok"
	elseif ( Random100 > 80 )
		MessageBox "You sense death and decay... a foreboding sense of Evil. An ancient and terrible power..." "Ok"
	elseif ( Random100 > 70 )
		MessageBox "A voice speaks in your mind.. nay, shouts. This is no mystical voice but a telepathic threat from one of your own kind! -- COME, FOOLISH ONE. I KNOW OF YOUR INTENTIONS. BEWARE..." "Ok"
	elseif ( Random100 > 60 )
		MessageBox "You sense disease... pestilence. A plague on the great city, and an ancient power freed from its tomb" "Ok"
	elseif ( Random100 > 50 )
		MessageBox "A voice speaks in your mind -- Beneath Mournhold Lie Great Treasures And Great Dangers" "Ok"
	elseif ( Random100 > 40 )
		MessageBox "You see a tomb, sealed from the outside. You're undergroud, in a system of caves. On your left is a shrine. The aura of pure evil is unmistakable" "Ok"
	elseif ( Random100 > 30 )
		MessageBox "A voice speaks in your mind -- Who Now Would Loose The Crimson Plague?" "Ok"
	elseif ( Random100 > 20 )
		MessageBox "You see sewers... a temple. A false god of mortals. A great city. Could it be Mournhold?" "Ok"
	elseif ( Random100 > 10 )
		MessageBox "A voice speaks in your mind -- Gedna Relvel Guards That Which You Seek" "Ok"
	else
		MessageBox "You see the artifact... there are sealed coffins to either side. You reach for the mortar and pestle, but hesitate. Something is behind you. Something terrible..." "Ok" 
	endif
	set state to 15
endif

if ( state == 14 ) ; power skull visions
	if ( Random100 > 90 )
		MessageBox "A hundred voices of long-dead spirits whipser in your ears. Is it one word they speak or many? All you can make out is 'Arethan'" "Ok"
	elseif ( Random100 > 80 )
		MessageBox "You sense the spirits of ages past.. an ancestral tomb lying dormant. No, wait - there's something there! It senses you, looks into your mind, and the vision ends abruptly" "Ok"
	elseif ( Random100 > 70 )
		MessageBox "A voice speaks in your mind -- That Which You Seek Lies In A Forgotten Mountain Tomb" "Ok"
	elseif ( Random100 > 60 )
		MessageBox "You see the entrance to a tomb... you feel drawn to it. It lies to the west of a crossroads cut into a mountain" "Ok"
	elseif ( Random100 > 50 )
		MessageBox "A voice speaks in your mind --- There Are Secrets Buried Deep In The Mountain, Look to Mount Kand" "Ok"
	elseif ( Random100 > 40 )
		MessageBox "You are at the center of two crossing valleys in the mountain... far south of you lies Molag Mar, and Northwest lie volcanic regions" "Ok"
	elseif ( Random100 > 30 )
		MessageBox "A voice speaks in your mind --- Beware... For They Are Not Unguarded. Creatures Of This World And The Next Bar Your Way" "Ok"
	elseif ( Random100 > 20 )
		MessageBox "You see skulls... the undead. Tombs, and corridors. FInally, at the End of one large chamber lie the skulls" "Ok"
	elseif ( Random100 > 10 )
		MessageBox "A voice speaks in your mind --- if The Dead Are Unseen, Whom Shall Know They Are There?" "Ok"
	else
		MessageBox "You see a passageway through the mountains... it passes from the east coast heading west, turning south and then west again. It turns south again, and leads to a crossroads..." "Ok"
	endif
	set state to 15
endif

if ( state == 15 )
	set button to -1
	set state to 0
endif

End

# vn_holy_amulet_script =======================================================
Begin vn_holy_amulet_script

short OnPCAdd
short OnPCEquip
short curseactive
short hoursworn
short init
short thishour
short lasthour

if ( init == 0 )
	set hoursworn to 0
	set curseactive to 0
	set lasthour to GameHour
endif

; don't wear this if you are a Lich!
if ( vn_lich != 0 )
	if ( OnPCAdd == 1 )
		MessageBox "The amulet gives off a great sense of power... but you feel an almost overpowering sense of foreboding. Maybe it would be best not to use it... ?" "Take it"
	endif
	if ( OnPCEquip == 1 )
		set curseactive to 1
	endif
	if ( OnPCEquip == 0 )
		set curseactive to 0
		if ( Player->GetSpellEffects "vn_holy_amulet_curse" == 1 )
			Player->RemoveSpell "vn_holy_amulet_curse"
		endif
		if ( Player->GetSpellEffects "vn_holy_amulet_curse_2" == 1 )
			Player->RemoveSpell "vn_holy_amulet_curse_2"
		endif
	endif
endif

if ( curseactive == 1 )
	; It's a time bomb.

	; Initially, you get only a very small bad effect (so the Player will probably keep wearing it )
	; eventually, they are punished for their greed.

	if ( Player->GetSpellEffects "vn_holy_amulet_curse" == 0 )
		Player->AddSpell "vn_holy_amulet_curse"
	endif

	; not stricly accurate, but this doesn't need to be an exact science
	set thishour to GameHour
	if ( lasthour != thishour )
		set hoursworn to ( hoursworn + 1 )
		set lasthour to thishour
	endif

	if ( hoursworn > 10 )
		set curseactive to 2
	endif
endif

if ( curseactive == 2 )
	; big punishment time.
	; bump up the curse effects
	; Permenantly whack the Player's Intelligence, every hour

	if ( Player->GetSpellEffects "vn_holy_amulet_curse" == 1 )
		Player->RemoveSpell "vn_holy_amulet_curse"
	endif

	if ( Player->GetSpellEffects "vn_holy_amulet_curse_2" == 0 )
		Player->AddSpell "vn_holy_amulet_curse_2"
	endif

	if ( lasthour != thishour )
		set hoursworn to ( hoursworn + 1 )
		set lasthour to thishour
		Player->ModIntelligence -5
		MessageBox "Terrible pain blurs your mind.... you can't think straight. You'd swear it's that damn amulet. What is it doing to you?" "Ok"
	endif
endif

End

# vn_inc_vamplich_mr ==========================================================
Begin vn_inc_vamplich_mr

short state
float endtimer

if ( state == 0 )
	; are we at max? if so, ignore
	if ( vn_vamplich_mr >= vn_avenue_vampirism )
		MessageBox "You can gain no more soul power"
		set state to 10
	else
		set state to 1
	endif
endif

if ( state == 1 )	
	; remove existing bonus. Max is 10
	if ( Player->GetSpellEffects "vn_soul_bonus_1" == 1 )
		Player->RemoveSpell "vn_soul_bonus_1"
	elseif ( Player->GetSpellEffects "vn_soul_bonus_2" == 1 )
		Player->RemoveSpell "vn_soul_bonus_2"
	elseif ( Player->GetSpellEffects "vn_soul_bonus_3" == 1 )
		Player->RemoveSpell "vn_soul_bonus_3"
	elseif ( Player->GetSpellEffects "vn_soul_bonus_4" == 1 )
		Player->RemoveSpell "vn_soul_bonus_4"
	elseif ( Player->GetSpellEffects "vn_soul_bonus_5" == 1 )
		Player->RemoveSpell "vn_soul_bonus_5"
	elseif ( Player->GetSpellEffects "vn_soul_bonus_6" == 1 )
		Player->RemoveSpell "vn_soul_bonus_6"
	elseif ( Player->GetSpellEffects "vn_soul_bonus_7" == 1 )
		Player->RemoveSpell "vn_soul_bonus_7"
	elseif ( Player->GetSpellEffects "vn_soul_bonus_8" == 1 )
		Player->RemoveSpell "vn_soul_bonus_8"
	elseif ( Player->GetSpellEffects "vn_soul_bonus_9" == 1 )
		Player->RemoveSpell "vn_soul_bonus_9"
	elseif ( Player->GetSpellEffects "vn_soul_bonus_10" == 1 )
		Player->RemoveSpell "vn_soul_bonus_10"
	endif

	set state to 2
endif

if ( state == 2 )

	if ( vn_vamplich_mr == 1 )
		Player->AddSpell "vn_soul_bonus_1"
	elseif ( vn_vamplich_mr == 2 )
		Player->AddSpell "vn_soul_bonus_2"
	elseif ( vn_vamplich_mr == 3 )
		Player->AddSpell "vn_soul_bonus_3"
	elseif ( vn_vamplich_mr == 4 )
		Player->AddSpell "vn_soul_bonus_4"
	elseif ( vn_vamplich_mr == 5 )
		Player->AddSpell "vn_soul_bonus_5"
	elseif ( vn_vamplich_mr == 6 )
		Player->AddSpell "vn_soul_bonus_6"
	elseif ( vn_vamplich_mr == 7 )
		Player->AddSpell "vn_soul_bonus_7"
	elseif ( vn_vamplich_mr == 8 )
		Player->AddSpell "vn_soul_bonus_8"
	elseif ( vn_vamplich_mr == 9 )
		Player->AddSpell "vn_soul_bonus_9"
	elseif ( vn_vamplich_mr == 10 )
		Player->AddSpell "vn_soul_bonus_10"
	endif

	set state to 10

endif

if ( state == 10 )
	; delay End for 3 seconds, to prevetn being run twice
	set endtimer to ( endtimer + ( GetSecondsPassed ) )
	if ( endtimer > 2 )
		set state to 0
		set endtimer to 0
		StopScript "vn_inc_vamplich_mr"
	endif
endif

End

# vn_lair_entrance ============================================================
Begin vn_lair_entrance

if ( OnActivate == 1 )
	set vn_lichscript2.returnto_lair to 1
endif

End

# vn_lich_crown_hood_script ===================================================
Begin vn_lich_crown_hood_script

; now, I'm sure there are some interesting things I could put here.
; How about possible crown upgrades?
; unknown magical effects?
; We'll see what I think of...

; short OnPCEquip
short PCSkipEquip
; short OnActivate
; short state
; short button

if ( vn_wearinglich == 0 )
	if ( PCSkipEquip == 0 )
		set PCSkipEquip to 1
	endif
else
	if ( PCSkipEquip == 1 )
		set PCSkipEquip to 0
	endif
endif

; if ( OnActivate == 1 )
;	MessageBox, "What do you wish to do?", "Take crown" "Take crown and remove hood" "Nothing"
;	set state to 1
; endif
;
; if ( state == 1 )
;	set button to GetButtonPressed
;	if ( button == -1 )
;		return
;	elseif ( button == 0 )
;		Activate
;		set state to 0
;	elseif ( button == 1 )
;		Player->AddItem, vn_lich_head_armor, 1
;		SetDelete, 1
;		Disable
;		set state to 0
;	elseif ( button == 2 )
;		set state to 0
;	endif
; endif
;	
End

# vn_lich_crown_script ========================================================
Begin vn_lich_crown_script

; now, I'm sure there are some interesting things I could put here.
; How about possible crown upgrades?
; unknown magical effects?
; We'll see what I think of...

short PCSkipEquip
; short state
; short button

; Why the hell won't OnActivate work on armor??
; if ( OnActivate == 1 )
;	MessageBox "What do you wish to do?" "Take crown" "Take crown and add a hood" "Nothing"
;	set state to 1
; endif

; if ( state == 1 )
;	set button to GetButtonPressed
;	if ( button == -1 )
;		return
;	elseif ( button == 0 )
;		Activate
;		set state to 0
;	elseif ( button == 1 )
;		Player->AddItem, vn_lich_head_armor2, 1
;		SetDelete, 1
;		Disable
;		set state to 0
;	elseif ( button == 2 )
;		set state to 0
;	endif
; endif

if ( vn_wearinglich == 0 )
	if ( PCSkipEquip == 0 )
		set PCSkipEquip to 1
	endif
else
	if ( PCSkipEquip == 1 )
		set PCSkipEquip to 0
	endif
endif

; MessageBox, "test"
	
End

# vn_lich_lair_marker_script ==================================================
Begin vn_lich_lair_marker_script

short OnPCEquip
short lairset ; 1=placed 2=set
short state
short button

if ( state == 0 )
	if ( lairset == 0 )
		if ( OnPCEquip == 1 )
			set OnPCEquip to 0
			set state to 1
			if ( GetInterior == 0 )
				MessageBox "set up your lair here?" "No" "Yes"
			else
				MessageBox "You cannot set up your lair here" "Ok"
			endif
		endif
	endif
	if ( lairset == 1 )
		if ( OnPCEquip == 1 )
			set OnPCEquip to 0
			set state to 2
			MessageBox "What do you wish to do?" "Nothing" "Confirm Location" "Reposition Lair" "Cancel Lair"
		endif
	endif
endif

if ( state == 1 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 1 )
		PlaceAtPC "vn_lich_lair_entrance" 1 500 0
		set lairset to 1
	endif
	set state to 0
	set button to -1
endif

if ( state == 2 ) ; equipped when lairset =1
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 ) ; nothing
		set state to 0
	elseif ( button == 1 ) ; confirm
		set state to 50
	elseif ( button == 2 ) ; reposition
		set state to 3
	elseif ( button == 3 ) ; cancel
		set state to 40		
	endif	
	set button to -1
endif

if ( state == 3 )
	MessageBox "Move in which direction?" "North" "South" "East" "West" "Rotate Clockwise" "Rotate Anticlockwise" "Up" "Down"
	set state to 4
endif

if ( state == 4 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set vn_lair_movetype to 1
	elseif ( button == 1 )
		set vn_lair_movetype to 2
	elseif ( button == 2 )
		set vn_lair_movetype to 3
	elseif ( button == 3 )
		set vn_lair_movetype to 4
	elseif ( button == 4 )
		set vn_lair_movetype to 5
	elseif ( button == 5 )
		set vn_lair_movetype to 6
	elseif ( button == 6 )
		set vn_lair_movetype to 7
	elseif ( button == 7 )
		set vn_lair_movetype to 8
	endif
	set state to 5
	set button to -1
endif

if ( state == 5 )
	if ( OnPCEquip == 1 )
		MessageBox "Cancel movement?" "Yes" "No"
		set state to 6
		set OnPCEquip to 0
	endif
endif

if ( state == 6 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set vn_lair_movetype to 0
		set state to 0
	elseif ( button == 1 )
		set state to 5
	endif
	set button to -1
endif

if ( state == 40 )
	set vn_lair_movetype to -1 ; delete flag detected in the other script
	set state to 0
	set lairset to 0
endif

if ( state == 50 )
	MessageBox "if you confirm this location, you will no longer be able to reposition the lair. Are you sure you wish to confirm?" "Yes" "No"
	set state to 51
endif
	
if ( state == 51 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 ) ; confirm
		MessageBox "Lair Position confirmed. Entrance will be solid next time you load a saved game or return to this cell" "Ok"
		set vn_lair_movetype to 10
		set lairset to 3
		set state to 0
	elseif ( button == 1 ) ; cancel
		set state to 0
	endif
	set button to -1
endif

End

# vn_lich_lair_script =========================================================
Begin vn_lich_lair_script

short locset
float buildpoints
float buildtarget
float buildrate
float constructionpercentage
float constructiontime

if ( MenuMode == 1 )
	return
endif

if ( vn_lair_firstchamber == 1 )
	if ( locset == 0 )
		if ( GetDistance Player < 500 )
			set vn_lichscript2.set_lair to 1 ; only ever needs to be set this once.
			set locset to 1
		endif
	endif
endif

; delete flag
if ( vn_lair_movetype == -1 )
	set vn_lair_movetype to 0
	Disable
	SetDelete 1
endif

; movement flags
if ( vn_lair_movetype == 1 )
	MoveWorld Y 15
elseif ( vn_lair_movetype == 2 )
	MoveWorld Y -15
elseif ( vn_lair_movetype == 3 )
	MoveWorld X 15
elseif ( vn_lair_movetype == 4 )
	MoveWorld X -15
elseif ( vn_lair_movetype == 5 )
	Rotate Z 5
elseif ( vn_lair_movetype == 6 )
	Rotate Z -5
elseif ( vn_lair_movetype == 7 )
	MoveWorld Z 10
elseif ( vn_lair_movetype == 8 )
	MoveWorld Z -10
endif

if ( OnActivate == 1 )
	if ( vn_lair_movetype == 10 ) ; set
		; get construction percentage
		set buildpoints to vn_build_points
		set buildrate to vn_build_rate
		set buildtarget to 1000
		set constructionpercentage to ( 100 * ( buildpoints / buildtarget ) )
		set constructiontime to ( buildtarget - vn_build_points )
		if ( buildrate > 0 )
			set constructiontime to ( constructiontime / buildrate )
			set constructiontime to ( constructiontime / 24 )
		endif
			
		if ( vn_lair_firstchamber > 0 ) ; built
			; allow Player to Move
			Player->PositionCell 0 0 100 0 "Lich's Lair"
		else
			if ( vn_build_rate > 0 )
				MessageBox "The entrance chamber has not yet been built. It is estimated at %.2f percent complete, with %.2f days remaining at the current build rate. It will build faster if more human followers are working on it" constructionpercentage constructiontime
			else
				MessageBox "The entrance chamber has not yet been built. It is estimated at %.2f percent complete. It will not build unless human followers are working on it" constructionpercentage
			endif
		endif
	else
		MessageBox "Re-Equip the marker to adjust or confirm the lair's Position, then construction can Begin"
	endif
endif

End

# vn_lichenchantingscript =====================================================
Begin vn_lichenchantingscript

short noattack
short nohit

long StartGold
long CurrentGold
long AfterGold1
short GoodbyeOnce
long pclevel
long pcenchantskill
long count
long temp
long temp2
long temp3
long temp4
long maxgold
float currenthealth
float healthratio
float maxhealth
float healthdiff

StopCombat

if ( vn_enchantState == 0 )
	; MessageBox, "Enchantcraft initiated"
	set pclevel to ( Player->GetLevel )
	set pcenchantskill to ( Player->GetEnchant )
	set vn_enchantstate to 1
	return
endif

if ( vn_enchantstate == 1 )
	; MessageBox, "state 1"
	if ( vn_ps_enchant_mastery == 1 )
		MessageBox "Your enchant mastery power allows you to make more powerful enchantments, and at only half the normal health cost"
		set temp to ( pcenchantskill + 50 )
	else
		set temp to ( pcenchantskill ) ; was level plus enchant skill
	endif
	set temp2 to ( temp - 50 ) ; was -100
	set maxgold to ( temp2 * 1000 )
	set vn_enchantstate to 2
	return
endif

if ( vn_enchantstate == 2 )
	if ( maxgold < 0 )
		MessageBox "You are not yet powerful enough to create enchantments"
		set vn_enchantstate to -1
		Disable
		SetDelete 1
	else
		set vn_enchantstate to 3
	endif
	return
endif

if ( vn_enchantstate == 3 )
	MessageBox "It takes you a moment or two to focus your powers for enchanting..."
	set StartGold to ( Player->GetItemCount "Gold_001" )
	set AfterGold1 to ( StartGold + maxgold )
	set vn_enchantstate to 4
	return
endif

if ( vn_enchantstate == 4 )
	set CurrentGold to ( Player->GetItemCount Gold_001 )
	; MessageBox, "Setting gold for enchanting...please wait... -- cur: %.2f target: %.2f", currentgold, maxgold
	if ( CurrentGold < ( maxgold - 8191 ) )
		Player->AddItem "Gold_001" 8192
	elseif ( CurrentGold < ( maxgold - 4095 ) )
		Player->AddItem "Gold_001" 4096
	elseif ( CurrentGold < ( maxgold - 2047 ) )
		Player->AddItem "Gold_001" 2048
	elseif ( CurrentGold < ( maxgold - 1023 ) )
		Player->AddItem "Gold_001" 1024
	elseif ( CurrentGold < ( maxgold - 511 ) )
		Player->AddItem "Gold_001" 512
     elseif ( CurrentGold < ( maxgold - 255 ) )
		Player->AddItem "Gold_001" 256
	elseif ( CurrentGold < ( maxgold - 127 ) )
		Player->AddItem "Gold_001" 128
	elseif ( CurrentGold < ( maxgold - 63 ) )
		Player->AddItem "Gold_001" 64
	elseif ( CurrentGold < ( maxgold - 15 ) )
		Player->AddItem "Gold_001" 16
	elseif ( CurrentGold < ( maxgold - 3 ) )
		Player->AddItem "Gold_001" 4
	elseif ( CurrentGold < maxgold )
		Player->AddItem "Gold_001" 1
	elseif ( CurrentGold > ( maxgold + 8191 ) )
		Player->RemoveItem "Gold_001" 8192
	elseif ( CurrentGold > ( maxgold + 2047 ) )
		Player->RemoveItem "Gold_001" 2048
	elseif ( CurrentGold > ( maxgold + 1023 ) )
		Player->RemoveItem "Gold_001" 1024
	elseif ( CurrentGold > ( maxgold + 255 ) )
		Player->RemoveItem "Gold_001" 256 
	elseif ( CurrentGold > ( maxgold + 63 ) )
		Player->RemoveItem "Gold_001" 64
	elseif ( CurrentGold > ( maxgold + 15 ) )
		Player->RemoveItem "Gold_001" 16
	elseif ( CurrentGold > ( maxgold + 3 ) )
		Player->RemoveItem "Gold_001" 4
	elseif ( CurrentGold > maxgold )
		Player->RemoveItem "Gold_001" 1
	elseif ( currentgold == maxgold )
		MessageBox "You have the power to create an enchantment up to the value of %.2f. Doing so will temporarily weaken your connection to this plane." currentgold
		ForceGreeting
		set vn_enchantstate to 5
		return
	endif
endif

if ( vn_enchantstate == 5 )
	if ( GoodbyeOnce == 0 )
		if ( Player->GetItemCount gold_001 != maxgold )
			Goodbye
			set GoodbyeOnce to 1
			set temp to ( Player->GetItemCount gold_001 )
			set temp2 to ( maxgold - temp ) ; amount of gold spent
			set temp3 to ( temp2 * 3 )
			if ( vn_ps_enchant_mastery == 1 )
				set temp4 to ( temp3 / 4000 ) 
			else
				set temp4 to ( temp3 / 2000 )  ; amount of health lost. Not sure if ( this is balanced )
			endif
			MessageBox "Creating this enchantment has drained you of %.2f health" temp4
			set vn_enchantstate to 6
			return
		endif
	endif
	if ( vn_enchanttalked == 1 )
		if ( MenuMode == 0 )
			; MessageBox "Player said Goodbye without creating enchantment"
			set goodbyeonce to 1
			set vn_enchantstate to 6
			set vn_enchanttalked to 0
			Disable
			SetDelete 1
			return
		endif
	endif
endif

if ( vn_enchantstate == 6 )
	; MessageBox, "state 6"
	set currentHealth to ( Player->GetHealth )	
	set healthratio to ( Player->GetHealthGetRatio )
	set temp to ( currenthealth / healthratio )
	set healthdiff to ( currenthealth - temp )
	set maxhealth to ( temp - temp4 )
	Player->SetHealth maxhealth
	Player->ModCurrentHealth healthdiff
	set vn_healthlost to ( vn_healthlost + temp4 )
	set vn_enchantstate to 7
	return
endif

if ( vn_enchantstate == 7 )
	if ( MenuMode == 0 ) 
	; MessageBox, "Resetting gold after enchanting... please wait"
	set CurrentGold to ( Player->GetItemCount Gold_001 )
		if ( CurrentGold > ( StartGold + 4095 ) )
			Player->RemoveItem "Gold_001" 4096
		elseif ( CurrentGold > ( StartGold + 2047 ) )
			Player->RemoveItem "Gold_001" 2048
		elseif ( CurrentGold > ( StartGold + 1023 ) )
			Player->RemoveItem "Gold_001" 1024
		elseif ( CurrentGold > ( StartGold + 511 ) )
			Player->RemoveItem "Gold_001" 512
		elseif ( CurrentGold > ( StartGold + 255 ) )
			Player->RemoveItem "Gold_001" 256 
		elseif ( CurrentGold > ( StartGold + 123 ) )
			Player->RemoveItem "Gold_001" 124
		elseif ( CurrentGold > ( StartGold + 63 ) )
			Player->RemoveItem "Gold_001" 64
		elseif ( CurrentGold > ( StartGold + 31 ) )
			Player->RemoveItem "Gold_001" 32
		elseif ( CurrentGold > ( StartGold + 15 ) )
			Player->RemoveItem "Gold_001" 16
		elseif ( CurrentGold > ( StartGold + 7 ) )
			Player->RemoveItem "Gold_001" 8
		elseif ( CurrentGold > ( StartGold + 3 ) )
			Player->RemoveItem "Gold_001" 4
		elseif ( CurrentGold > ( StartGold + 1 ) )
			Player->RemoveItem "Gold_001" 2
		elseif ( CurrentGold > StartGold )
			Player->RemoveItem "Gold_001" 1
		elseif ( CurrentGold < ( StartGold - 2047 ) )
			Player->AddItem "Gold_001" 2048
		elseif ( CurrentGold < ( StartGold - 1023 ) )
			Player->AddItem "Gold_001" 1024
		elseif ( CurrentGold < ( StartGold - 511 ) )
			Player->AddItem "Gold_001" 512
		elseif ( CurrentGold < ( StartGold - 255 ) )
			Player->AddItem "Gold_001" 256
		elseif ( CurrentGold < ( StartGold - 127 ) )
			Player->AddItem "Gold_001" 128
		elseif ( CurrentGold < ( StartGold - 63 ) )
			Player->AddItem "Gold_001" 64
		elseif ( CurrentGold < ( StartGold - 31 ) )
			Player->AddItem "Gold_001" 32
		elseif ( CurrentGold < ( StartGold - 15 ) )
			Player->AddItem "Gold_001" 16
		elseif ( CurrentGold < ( StartGold - 7 ) )
			Player->AddItem "Gold_001" 8
		elseif ( CurrentGold < ( StartGold - 3 ) )
			Player->AddItem "Gold_001" 4
		elseif ( CurrentGold < ( StartGold - 1 ) )
			Player->AddItem "Gold_001" 2
		elseif ( CurrentGold < StartGold )
			Player->AddItem "Gold_001" 1
		elseif ( CurrentGold == StartGold )
			; MessageBox, "Gold reset after enchanting"
			set vn_enchanttalked to 0
			set vn_enchantstate to -1
			Disable
			SetDelete 1
		endif
	endif  ; possibel have 'else' that closes menu if ( active? otherwise it's possible to exploit this )
endif

End vn_lichenchantingscript

# vn_lichfollowerinit =========================================================
Begin vn_lichfollowerinit

short a1
short a2
short a3
short a4

AddItem "vn_lich_shirt" 1
AddItem "vn_lich_pants" 1
AddItem "vn_lich_glove_right" 1
AddItem "vn_lich_glove_left" 1
AddItem "vn_lich_boots" 1

; 6 left gauntlet
; 7 right gauntlet
; 9 left bracer
; 10 right bracer
set a1 to GetArmorType 6
set a2 to GetArmorType 7
set a3 to GetArmorType 9
set a4 to GetArmorType 10

; MessageBox "6, 7, 9, 10 are %.2f, %.2f, %.2f, %.2f", a1, a2, a3, a4
if ( a3 != -1 )
	Equip vn_lich_glove_left
endif
if ( a4 != -1 )
	Equip vn_lich_glove_right
endif

StopScript "vn_lichfollowerinit"

End

# vn_lichHiddenArmorScript ====================================================
Begin vn_lichHiddenArmorScript

; a shameless exact copy of the existing script.
; but why reinvent the wheel?

float OrdLichTimer
short OrdLichfullarmor
short OrdLichfullhelm
short OrdLichhelmstate
short OrdLichArmorCount
short OrdLichArmorCheck

short OrdLichArmor0
short OrdLichArmor1
short OrdLichArmor2
short OrdLichArmor3
short OrdLichArmor4
short OrdLichArmor5
short OrdLichArmor6
short OrdLichArmor7

if ( MenuMode )
return
endif

set OrdLichArmorCount to 0

if ( OrdLichTimer < 0.5 )
	set OrdLichTimer to ( OrdLichTimer + ( GetSecondsPassed ) )
	return
else
set OrdLichArmor1 to ( Player->GetArmorType 1 )
set OrdLichArmor2 to ( Player->GetArmorType 2 )
set OrdLichArmor3 to ( Player->GetArmorType 3 )
set OrdLichArmor4 to ( Player->GetArmorType 4 )
set OrdLichArmor5 to ( Player->GetArmorType 5 )
set OrdLichArmor6 to ( Player->GetArmorType 6 )
set OrdLichArmor7 to ( Player->GetArmorType 7 )
set OrdLichArmor0 to ( Player->GetArmorType 0 )
; set OrdLichArmorCount to ( OrdLichArmor0 + OrdLichArmor1 + OrdLichArmor2 + OrdLichArmor3 + OrdLichArmor4 + OrdLichArmor5 + OrdLichArmor6 + OrdLichArmor7 )
endif

	if ( OrdLichArmor1 >= 0 )
	if ( OrdLichArmor2 >= 0 )
	if ( OrdLichArmor3 >= 0 )
	if ( OrdLichArmor4 >= 0 )
	if ( OrdLichArmor5 >= 0 )
	if ( OrdLichArmor6 >= 0 )
	if ( OrdLichArmor7 >= 0 )
	if ( OrdLichArmor0 >= 0 )
	set vn_LichHidden to 1
	set OrdLichHidden to 1
;	MessageBox, "vn_LichHidden has been set to 1"
	return
	endif
	endif
	endif
	endif
	endif
	endif
	endif
	endif

set vn_LichHidden to 0
set OrdLichHidden to 0
; MessageBox, "OrdLichHidden has been set to 0"

; if ( OrdLichArmorCount == -8 )
; set OrdLichHidden to 1
; MessageBox, "OrdLichHidden has been set to 1"
; else
; set OrdLichHidden to 0
; MessageBox, "OrdLichHidden has been set to 0"
; endif

; if ( OrdLichArmorCount == 8 )
;	set OrdLichHidden to 1
;	set OrdLichTimer to 0
;	MessageBox, "OrdLichArmor == 8"
; else
;	set OrdLichHidden to 0
;	set OrdLichTimer to 0
;	MessageBox, "OrdLichArmor doesn't equal 8"
; endif

End

# vn_lichinventory ============================================================
Begin vn_lichinventory

if ( MenuMode == 0 )
	MessageBox "Opening lich inventory"
	ModCurrentHealth -1000
	Activate
	Resurrect
	StopScript "vn_lichinventory"
endif

End

# vn_lichlevelloss ============================================================
Begin vn_lichlevelloss

long level
long loss
short state
float healthratio
long endurance
float health
float temp1
float temp2
float temp3
long statpen

; 13/7/05 -- edit to add GCD compatability -- test for Gals_Natural_Strength

if ( state == 0 )
	Player->ModCurrentHealth 1000
	set state to 1
endif

if ( state == 1 )
	set level to ( Player->GetLevel )
	set endurance to ( Player->GetEndurance )
	set healthratio to ( Player->GetHealthGetRatio )
	set health to ( Player->GetHealth )
	set loss to ( level / 2 )
	set statpen to ( 0 - loss )
	; MessageBox, "loss will be %.2f", loss
	set state to 2
endif

if ( state == 2 )
	; reduce skills/stats. Uses either Mad Leveller, GCD, or 'normal'

	if ( mlRunOnce != 0 )
		MessageBox "Using alternative stat loss as maddleveller is running"
		set Adj_strength to statpen
		set Adj_intelligence to statpen
		set Adj_endurance to statpen
		set Adj_willpower to statpen
		set Adj_agility to statpen
		set Adj_speed to statpen
		set Adj_personality to statpen
		set Adj_luck to statpen

		set Adj_alchemy to statpen
		set Adj_alteration to statpen
		set Adj_conjuration to statpen
		set Adj_destruction to statpen
		set Adj_enchant to statpen
		set Adj_illusion to statpen
		set Adj_mysticism to statpen
		set Adj_restoration to statpen

		set Adj_axe to statpen
		set Adj_armorer to statpen
		set Adj_bluntweapon to statpen
		set Adj_heavyarmor to statpen
		set Adj_mediumarmor to statpen
		set Adj_longblade to statpen
		set Adj_spear to statpen
		set Adj_block to statpen

		set Adj_shortblade to statpen
		set Adj_sneak to statpen
		set Adj_mercantile to statpen
		set Adj_speechcraft to statpen
		set Adj_acrobatics to statpen
		set Adj_athletics to statpen
		set Adj_marksman to statpen
		set Adj_lightarmor to statpen

		set Adj_unarmored to statpen
		set Adj_security to statpen
		set Adj_handtohand to statpen

		StartScript "mlAdjust"
	elseif ( Gals_Natural_Strength > 0 )
		; for GCD
		; hit skills ONLY - attributes/health will be automatically hit when you run the updater
		MessageBox "GCD detected. Skills now being reduced"
		set Gals_Natural_Alchemy to ( Gals_Natural_Alchemy + statpen ) ; statpen is negative
		set Gals_Natural_Alteration to ( Gals_Natural_Alteration + statpen )
		set Gals_Natural_Conjuration to ( Gals_Natural_Conjuration + statpen )
		set Gals_Natural_Destruction to ( Gals_Natural_Destruction + statpen )
		set Gals_Natural_Enchant to ( Gals_Natural_Enchant + statpen )
		set Gals_Natural_Illusion to ( Gals_Natural_Illusion + statpen )
		set Gals_Natural_Mysticism to ( Gals_Natural_Mysticism + statpen )
		set Gals_Natural_Restoration to ( Gals_Natural_Restoration + statpen )

		set Gals_Natural_Axe to ( Gals_Natural_Axe + statpen )
		set Gals_Natural_Armorer to ( Gals_Natural_Armorer + statpen )
		set Gals_Natural_BluntWeapon to ( Gals_Natural_BluntWeapon + statpen )
		set Gals_Natural_HeavyArmor to ( Gals_Natural_HeavyArmor + statpen )
		set Gals_Natural_MediumArmor to ( Gals_Natural_MediumArmor + statpen )
		set Gals_Natural_LongBlade to ( Gals_Natural_LongBlade + statpen )
		set Gals_Natural_Spear to ( Gals_Natural_Spear + statpen )
		set Gals_Natural_Block to ( Gals_Natural_Block + statpen )

		set Gals_Natural_ShortBlade to ( Gals_Natural_ShortBlade + statpen )
		set Gals_Natural_Sneak to ( Gals_Natural_Sneak + statpen )
		set Gals_Natural_Mercantile to ( Gals_Natural_Mercantile + statpen )
		set Gals_Natural_Speechcraft to ( Gals_Natural_Speechcraft + statpen )
		set Gals_Natural_Acrobatics to ( Gals_Natural_Acrobatics + statpen )
		set Gals_Natural_Athletics to ( Gals_Natural_Athletics + statpen )
		set Gals_Natural_Marksman to ( Gals_Natural_Marksman + statpen )
		set Gals_Natural_LightArmor to ( Gals_Natural_LightArmor + statpen )

		set Gals_Natural_Unarmored to ( Gals_Natural_Unarmored + statpen )
		set Gals_Natural_Security to ( Gals_Natural_Security + statpen )
		set Gals_Natural_HandToHand to ( Gals_Natural_HandToHand + statpen )

		set Gals_Reprocess to 1
	endif

	if ( Gals_Natural_Strength < 1 )
		MessageBox "Reducing stats"
		Player->ModStrength statpen
		Player->ModIntelligence statpen
		Player->ModEndurance statpen
		Player->ModWillpower statpen
		Player->ModAgility statpen
		Player->ModSpeed statpen
		Player->ModPersonality statpen
		Player->ModLuck statpen

		Player->ModAlchemy statpen
		Player->ModAlteration statpen
		Player->ModConjuration statpen
		Player->ModDestruction statpen
		Player->ModEnchant statpen
		Player->ModIllusion statpen
		Player->ModMysticism statpen
		Player->ModRestoration statpen
	
		Player->ModAxe statpen
		Player->ModArmorer statpen
		Player->ModBluntWeapon statpen
		Player->ModHeavyArmor statpen
		Player->ModMediumArmor statpen
		Player->ModLongBlade statpen
		Player->ModSpear statpen
		Player->ModBlock statpen
	
		Player->ModShortblade statpen
		Player->ModSneak statpen
		Player->ModMercantile statpen
		Player->ModSpeechcraft statpen
		Player->ModAcrobatics statpen
		Player->ModAthletics statpen
		Player->ModMarksman statpen
		Player->ModLightArmor statpen

		Player->ModUnarmored statpen
		Player->ModSecurity statpen
		Player->ModHandToHand statpen
	endif

	; check <1 since it's not a good idea to use equality when checking floats.
	if ( Gals_Natural_Strength < 1 ) ; ie not using GCD
		; finally reduce health and level. Not sure about endurance....
		set temp1 to ( health / healthratio )		; temp1 = max health
		set temp2 to ( endurance * loss / 10 )				; temp2 = health loss
		set temp3 to ( temp1 - temp2 )				; temp3 = new max health
		if ( temp3 < 30 )
			set temp3 to 30
		endif
		Player->SetHealth temp3 					; set new max health
		set state to 3 
	else
		set state to 6 ; if ( using GCD skip levelup function and re-assignment of levels )
	endif
endif

if ( state == 3 )
	; now reduce actual Player level
	set state to 4
endif

if ( state == 4 )
	if ( level < 2 )
		Player->SetLevel 0
	elseif ( level < 4 )				; all set to one less than expected since you get auto-advance
		Player->SetLevel 1
	elseif ( level < 6 )
		Player->SetLevel 2
	elseif ( level < 8 )
		Player->SetLevel 3
	elseif ( level < 10 )
		Player->SetLevel 4
	elseif ( level < 12 )
		Player->SetLevel 5
	elseif ( level < 14 )
		Player->SetLevel 6
	elseif ( level < 16 )
		Player->SetLevel 7
	elseif ( level < 18 )
		Player->SetLevel 8
	elseif ( level < 20 )
		Player->SetLevel 9
	elseif ( level < 22 )
		Player->SetLevel 10
	elseif ( level < 24 )
		Player->SetLevel 11
	elseif ( level < 26 )
		Player->SetLevel 12
	elseif ( level < 28 )
		Player->SetLevel 13
	elseif ( level < 30 )
		Player->SetLevel 14
	elseif ( level < 32 )
		Player->SetLevel 15
	elseif ( level < 34 )
		Player->SetLevel 16
	elseif ( level < 36 )
		Player->SetLevel 17
	elseif ( level < 38 )
		Player->SetLevel 18
	elseif ( level < 40 )
		Player->SetLevel 19
	elseif ( level < 42 )
		Player->SetLevel 20
	elseif ( level < 44 )
		Player->SetLevel 21
	elseif ( level < 46 )
		Player->SetLevel 22
	elseif ( level < 48 )
		Player->SetLevel 23
	elseif ( level < 50 )
		Player->SetLevel 24
	elseif ( level < 52 )
		Player->SetLevel 25
	elseif ( level < 54 )
		Player->SetLevel 26
	elseif ( level < 56 )
		Player->SetLevel 27
	elseif ( level < 58 )
		Player->SetLevel 28
	elseif ( level < 60 )
		Player->SetLevel 29
	elseif ( level < 62 )
		Player->SetLevel 30
	elseif ( level < 64 )
		Player->SetLevel 31
	elseif ( level < 66 )
		Player->SetLevel 32
	elseif ( level < 68 )
		Player->SetLevel 33
	elseif ( level < 70 )
		Player->SetLevel 34
	elseif ( level < 72 )
		Player->SetLevel 35
	elseif ( level < 74 )
		Player->SetLevel 36
	elseif ( level < 76 )
		Player->SetLevel 37
	elseif ( level < 78 )
		Player->SetLevel 38
	elseif ( level < 80 )
		Player->SetLevel 39
	else
		MessageBox "Higher than level 80? Start a new character you ponce."
		Player->ModHealth -1000000
	endif
	set state to 5
endif

if ( state == 5 )
	EnableLevelUpMenu
	set state to 6
endif

if ( state == 6 )
	; holding state. We stay here until Gals reprocess or the levelup menu are finished with. Then we can return.
	; when this script stops running, it triggers the ritual script to continue and ass the powers.
	
	; if running GCD, do not return until reprocess has finished
	if ( Gals_Natural_Strength > 0 ) 
		if ( Gals_Reprocess != 0 )
			return
		endif
	endif

	; do not return until levelup menu has gone ( will be gone anyway if using GCD - so no change needed )
	if ( MenuMode == 0 ) ; if ( Player has finished levlling up )
		set level to ( Player->GetLevel )
		set vn_next_power_level to ( level + 5 )
		MessageBox "Next power ritual at level %.2f" vn_next_power_level
		set state to 7
	endif
endif

if ( state == 7 )
	set vn_lichlevelsdone to 1 ; This is safer than checking if ( the script is running. )
	StopScript "vn_lichlevelloss"
endif

End

# vn_lichlevelup ==============================================================
Begin vn_lichlevelup

; called when your level changes, or your sorcery avenue skill changes

; remove all varying lich abilities, then add them again.
; does NOT remove lich powers
; does NOT remove avenue powers

; removes attributes
; removes skills
; removes bonuses
; removes abilities
; checks for power ritual
; triggers spell add script

; 13/7/05 -- GCD compatability requires that I track how much is removed from each attribute or skill.
; 11/10/05 -- recode! Horribly inefficient to have this code when I have perfectly good scripts which
; will already do this functionality

short state

if ( state == 0 )
;	MessageBox "IS this running"
	set vn_skillremove_done to 0
	set vn_spellremove_done to 0
	set state to 1
endif

if ( state == 1 )
	if ( ScriptRunning "vn_lichspellremove" == 0 ) ; in case it's already active. unlikely but feasable
		StartScript "vn_lichspellremove"
		set state to 2
	endif
endif

if ( state == 2 )
	if ( ScriptRunning "vn_lichskillremove" == 0 )
		if ( mlRemoved != 1 )
			StartScript "vn_lichskillremove" ; else it will run twice
		endif
		set state to 3
	endif
endif

if ( state == 3 )
	if ( vn_skillremove_done == 1 )
		if ( vn_spellremove_done == 1 )
			set state to 4
		endif
	endif
endif

if ( state == 4 )
	if ( ScriptRunning "vn_Lichspelladd" == 0 ) ; should already be running but be on the safe side.
		StartScript "vn_Lichspelladd"
		return				; return so it will have a frame to start running at least. Needed?
	elseif ( ScriptRunning "vn_lichspelladd" == 1 )
		set vn_lichspelladd.active to 1
	endif
	if ( Player->GetLevel >= vn_next_power_level ) ; Checking if you are above that way you can't miss a level if you level up twice somehow
		if ( vn_power_ritual_available == 0 ) ; Since we are now checking that you are above the level make sure you can't stack the progression unless used
			MessageBox "Power Ritual now available"
			set vn_next_power_level to ( vn_next_power_level + 5 )
			set vn_power_ritual_available to 1
		endif
	endif
	set state to 0
	StopScript "vn_Lichlevelup"
endif

; if ( state == 0 )
;	Player->RemoveSpell, "vn_lichattrlev1"
;	Player->RemoveSpell, "vn_lichattrlev5"
;	Player->RemoveSpell, "vn_lichattrlev10"
;	Player->RemoveSpell, "vn_lichattrlev15"
;	Player->RemoveSpell, "vn_lichattrlev20"
;	Player->RemoveSpell, "vn_lichattrlev25"
;	Player->RemoveSpell, "vn_lichattrlev30"
;	Player->RemoveSpell, "vn_lichattrlev35"
;	Player->RemoveSpell, "vn_lichattrlev40"
;	Player->RemoveSpell, "vn_lichattrlev45"
;	Player->RemoveSpell, "vn_lichattrlev50"
;	Player->RemoveSpell, "vn_lichattrlev55"
;	Player->RemoveSpell, "vn_lichattrlev60"
;	Player->RemoveSpell, "vn_lichattrlev65"
;	Player->RemoveSpell, "vn_lichattrlev70"
;	Player->RemoveSpell, "vn_lichattrlev75"
;	set state to 1
; endif
;
; if ( state ==1 )
;	Player->RemoveSpell, "vn_lichskillslev1"
;	Player->RemoveSpell, "vn_lichskillslev5"
;	Player->RemoveSpell, "vn_lichskillslev10"
;	Player->RemoveSpell, "vn_lichskillslev15"
;	Player->RemoveSpell, "vn_lichskillslev20"
;	Player->RemoveSpell, "vn_lichskillslev25"
;	Player->RemoveSpell, "vn_lichskillslev30"
;	Player->RemoveSpell, "vn_lichskillslev35"
;	Player->RemoveSpell, "vn_lichskillslev40"
;	Player->RemoveSpell, "vn_lichskillslev45"
;	Player->RemoveSpell, "vn_lichskillslev50"
;	Player->RemoveSpell, "vn_lichskillslev55"
;	Player->RemoveSpell, "vn_lichskillslev60"
;	Player->RemoveSpell, "vn_lichskillslev65"
;	Player->RemoveSpell, "vn_lichskillslev70"
;	Player->RemoveSpell, "vn_lichskillslev75"
;	set state to 2
; endif
;
; if ( state == 2 )
;	Player->RemoveSpell, "vn_lichbonuslev1"
;	Player->RemoveSpell, "vn_lichbonuslev5"
;	Player->RemoveSpell, "vn_lichbonuslev10"
;	Player->RemoveSpell, "vn_lichbonuslev15"
;	Player->RemoveSpell, "vn_lichbonuslev20"
;	Player->RemoveSpell, "vn_lichbonuslev25"
;	Player->RemoveSpell, "vn_lichbonuslev30"
;	Player->RemoveSpell, "vn_lichbonuslev35"
;	Player->RemoveSpell, "vn_lichbonuslev40"
;	Player->RemoveSpell, "vn_lichbonuslev45"
;	Player->RemoveSpell, "vn_lichbonuslev50"
;	Player->RemoveSpell, "vn_lichbonuslev55"
;	Player->RemoveSpell, "vn_lichbonuslev60"
;	Player->RemoveSpell, "vn_lichbonuslev65"
;	Player->RemoveSpell, "vn_lichbonuslev70"
;	Player->RemoveSpell, "vn_lichbonuslev75"
;	set state to 3
; endif
;
; if ( state == 3 )
;	Player->RemoveSpell, "vn_lichgood0"
;	Player->RemoveSpell, "vn_lichgood1"
;	Player->RemoveSpell, "vn_lichgood2"
;	Player->RemoveSpell, "vn_lichgood3"
;	Player->RemoveSpell, "vn_lichgood4"
;	Player->RemoveSpell, "vn_lichgood5"
;	Player->RemoveSpell, "vn_lichgood6"
;	Player->RemoveSpell, "vn_lichgood7"
;	Player->RemoveSpell, "vn_lichgood8"
;	Player->RemoveSpell, "vn_lichgood9"
;	Player->RemoveSpell, "vn_lichgood10"
;	Player->RemoveSpell, "vn_lichgood11"
;	Player->RemoveSpell, "vn_lichgood12"
;	set state to 4
; endif

; if ( state == 4 )
;	set vn_lichspelladd.active to 1
;	if ( Player->GetLevel == vn_next_power_level )
;		MessageBox "Power Ritual now available"
;		set vn_next_power_level to ( vn_next_power_level + 5 )
;		set vn_power_ritual_available to 1
;	endif
;	set state to 0
;	StopScript, vn_Lichlevelup
; endif

End

# vn_lichpotionscript =========================================================
Begin vn_lichpotionscript

short state
short button
short PCSkipEquip
short OnPCEquip
short drink
short doOnce

if ( doOnce == 0 )
	set PCSkipEquip to 1
	set doOnce to 1
endif

if ( drink == 0 )
	if ( OnPCEquip == 1 )
		MessageBox "Drink the lich potion?" "Yes" "No"
		set state to 1
		set OnPCEquip to 0
	endif
endif

if ( state == 1 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	endif
	if ( button == 0 )
		MessageBox "You consume the potion"
		set vn_lich_potion_consumed to 1
		set PCSkipEquip to 0
		set OnPCEquip to 0
		set drink to 1
		menutest 0
		Player->AddItem "vn_used_bottle" 1
		Player->Equip vn_lichpotion 
		set state to 0
	endif
	if ( button == 1 )
		set state to 2
	endif
endif

End

# vn_lichpotionscript_failed ==================================================
Begin vn_lichpotionscript_failed

short state
short button
short PCSkipEquip
short OnPCEquip
short drink
short doOnce

if ( doOnce == 0 )
	set PCSkipEquip to 1
	set doOnce to 1
endif

if ( drink == 0 )
	if ( OnPCEquip == 1 )
		MessageBox "Drink the lich potion?" "Yes" "No"
		set state to 1
		set OnPCEquip to 0
	endif
endif

if ( state == 1 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	endif
	if ( button == 0 )
		MessageBox "You consume the potion"
		set vn_lich_potion_consumed to -1
		set PCSkipEquip to 0
		set OnPCEquip to 0
		set drink to 1
		MenuTest 0
		Player->AddItem "vn_used_bottle_f" 1
		Player->Equip vn_lichpotion_failed 
		set state to 0
	endif
	if ( button == 1 )
		set state to 2
	endif
endif

End

# vn_lichpotionscript_vamp ====================================================
Begin vn_lichpotionscript_vamp

short state
short button
short PCSkipEquip
short OnPCEquip
short drink
short doOnce

if ( doOnce == 0 )
	set PCSkipEquip to 1
	set doOnce to 1
endif

if ( drink == 0 )
	if ( OnPCEquip == 1 )
		MessageBox "Drink the lich potion?" "Yes" "No"
		set state to 1
		set OnPCEquip to 0
	endif
endif

if ( state == 1 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	endif
	if ( button == 0 )
		MessageBox "You consume the potion"
		set vn_lich_potion_consumed to 2
		set PCSkipEquip to 0
		set OnPCEquip to 0
		set drink to 1
		MenuTest 0
		Player->AddItem "vn_used_bottle" 1
		Player->Equip vn_lichpotion_vamp 
		set state to 0
	endif
	if ( button == 1 )
		set state to 2
	endif
endif

End

# vn_lichquickinit ============================================================
Begin vn_lichquickinit

short state

if ( state == 0 )
	if ( PCVampire == 1 )
		if ( vn_lich_potion_consumed == 2 ) ; consumed the vamp-lich potion
			set vn_lich_vamp to 1
		endif
	endif

	if ( vn_lich_vamp == 0 )	; normal lich
		StartScript "Vampire_Cure_PC"
		set PCVampire to -1
		set VampClan to -1
	else
		; keep all innate vamp abilities
		; should I attempt to control these? Probably best not to. Too much chance of incompatability.
		Player->AddItem "vn_essence" 1
		StartScript "vn_bloodscript"
		set vn_avenue_vampirism to 5
	endif
	
	; the following are initialised regardless of whether you are a vamp or not
	set vn_WearingLich to 1
	set PCWearingLich to 1
	
	set vn_lich to 1
	set PCOrdLich to 1
	
	set PCWerewolf to -1
	StartScript "vn_lichspelladd"
	StartScript "vn_lichscript"
	StartScript "vn_lichscript2"
	StartScript "vn_lichscript3"
	StartScript "vn_faithscript"

	set vn_temp to -1
	set vn_waypointstate to -1
	set vn_power_ritual_state to -1
	set vn_raise_dead_state to -1
	set vn_enchantstate to -1
	set vn_spellmakestate to -1

	set vn_raise_dead_skill to 0

	; AddTopic "become a lich"
	AddTopic "reveal your true self"
	AddTopic "taste of power"
	; AddTopic "Lich inventory"
	AddTopic "return to spirit stone"
	AddTopic "your orders"
	AddTopic "meet me at"
	AddTopic "mission"
	AddTopic "level"
	AddTopic "recruit me a follower"
	set vn_avenue_necromancy to 5
	set vn_avenue_psionics to 5
	set vn_avenue_sorcery to 5

	Player->AddItem "vn_lair_activator" 1

	set vn_switch to 1
	set state to 1
endif

StopScript "vn_lichquickinit"

End vn_lichquickinit

# vn_lichracecheckscript ======================================================
Begin vn_lichracecheckscript

if ( vn_Lich == 0 )
StopScript "vn_lichracecheckscript"
endif

if ( vn_wearingLich == 1 )
set PCRace to -777
StopScript "vn_lichracecheckscript"
endif

if ( Player->GetRace "Argonian" == 1 )
	set PCRace to 1
elseif ( Player->GetRace "Breton" == 1 )
	set PCRace to 2
elseif ( Player->GetRace "Dark Elf" == 1 )
	set PCRace to 3
elseif ( Player->GetRace "High Elf" == 1 )
	set PCRace to 4
elseif ( Player->GetRace "Imperial" == 1 )
	set PCRace to 5
elseif ( Player->GetRace "Khajiit" == 1 )
	set PCRace to 6
elseif ( Player->GetRace "Nord" == 1 )
	set PCRace to 7
elseif ( Player->GetRace "Orc" == 1 )
	set PCRace to 8
elseif ( Player->GetRace "Redguard" == 1 )
	set PCRace to 9
elseif ( Player->GetRace "Wood Elf" == 1 )
	set PCRace to 10
endif

StopScript "vn_lichracecheckscript"

End

# vn_lichritual ===============================================================
Begin vn_lichritual

short state
short button
short button1
short temp
short doonce
float timer

if ( state == 0 )
	MessageBox "The Ritual of Becoming has commenced"
	StartScript "vn_getposition"
	set state to 1
endif

if ( vn_lich_potion_consumed != 0 )
	if ( MenuMode == 1 )
		MenuTest 0
	endif
	
	if ( Player->GetHealth > 60 )
		; MessageBox, "Reducing health"
		Player->ModCurrentHealth -30
	endif

endif

if ( state == 1 )
	if ( Player->GetHealth < 10 )
		; MessageBox "You body convulses in pure agony as the poison does its job. You've never known a pain like this before... none have, and lived. For one brief moment you realise, with absolute certainty, that you are going to die" "Ok"
		if ( vn_lich_potion_consumed == 1 )
			if ( Player->GetEffect sEffectDamageHealth == 1 )
				FadeOut 1.0
				; will fail if you are a vamp
				if ( PCVampire == 1 )
					set state to 3
				elseif ( GameHour < 1 ) ; only works at midnight!
					set state to 2
				else
					set state to 3
				endif
			endif
		elseif ( vn_lich_potion_consumed == 2 ) ; vampiric lich potion fails if ( you aren't a vampire. obviously. )
			if ( Player->GetEffect sEffectDamageHealth == 1 )
				FadeOut 1.0
				; fails if non-vamp
				if ( PCVampire == 0 )
					set state to 3
				elseif ( GameHour < 1 ) ; only works at midnight!
					set state to 2
				else
					set state to 3
				endif
			endif
		else ; correct potion not consumed
			set state to 3
		endif
	endif
endif

if ( state == 2 )
	Player->RemoveEffects 23
	Player->ModCurrentHealth 1000
	PlaceAtPC "vn_Phylactery1" 1 0 0
	Player->RemoveItem "vn_phylactery1_e" 1
	Player->PositionCell 0 0 100 0 "Phylactery - Inner Chamber"
	FadeIn 5.0
	if ( vn_lich_potion_consumed == 1 )
		MessageBox "Your body screams agony as the vile potion twists and warps your very being, and your mind goes black with pain. Your body dies, but you do not. Your soul is trapped in the Phylactery. The ritual was a success... you are now a Lich!" "Ok"
	else
		MessageBox "Your body screams agony as the vile potion twists and warps your very being, and your mind goes black with pain. Your body dies, but you do not. Your soul is trapped in the Phylactery. The ritual was a success... you are now a Vampiric-Lich!" "Ok"
	endif
	set state to 4
endif

if ( state == 3 )
	FadeIn 5
	if ( vn_lich_potion_consumed == 1 )
		MessageBox "Something has gone horribly wrong.... maybe the potion wasn't right, or maybe you didn't drink it at the right time. Who knows. Either way, it's too late to turn back the clock now..."
		StopScript "vn_lichritual"
	elseif ( vn_lich_potion_consumed == 2 )
		; vamp... so make it look like a success
		MessageBox "Something feels wrong...."
		set vn_vamp_degradation to 1 ; and so it starts : )
		set state to 2
	else
		; wrong potion, fail
		MessageBox "Something has gone horribly wrong.... maybe the potion wasn't right, or maybe you didn't drink it at the right time. Who knows. Either way, it's too late to turn back the clock now..."
		StopScript "vn_lichritual"
	endif
endif

if ( state == 4 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	else
		set state to 5
	endif
endif

if ( state == 5 )
	MessageBox "The transformation took a lot out of you... more than you'd ever imagined" "Ok"
	set state to 6
endif

if ( state == 6 )
	set button1 to GetButtonPressed
	if ( button1 == -1 )
		return
	else
		StartScript "vn_lichlevelloss"
		set state to 7
	endif
endif

if ( state == 7 )
	if ( vn_lichlevelsdone == 1 )	
		if ( vn_lichconfig == 1 )
			set state to 12
			return
		endif
		set state to 8
	endif
endif

if ( state == 12 )
	; adjust this to allow Vampire Lich race when we have one??
	MessageBox "You may now choose the Lich Race. And ONLY the Lich Race. You have been warned." "Ok"
	set state to 11
endif

if ( state == 11 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set state to 10
	endif
endif

if ( state == 10 )
	if ( MenuMode == 0 )
		EnableRaceMenu
		set state to 9
	endif
endif

if ( state == 9 )
	if ( MenuMode == 0 )
		set timer to ( timer + ( GetSecondsPassed ) )
		if ( timer > 3 )
			if ( Player->GetRace "Skel" != 1 )
				Player->SetHealth 0
			else
				set state to 8
			endif
		endif
	endif
endif	

if ( state == 8 )
	Player->ModCurrentHealth 10000
	MessageBox "now adding lich abilities"
	set vn_brotherhoodswitch to 1
	StartScript "vn_lichquickinit"
	StopScript "vn_lichritual"
endif

End

# vn_lichscript ===============================================================
Begin vn_lichscript

; 08/05/2005 - time to give this a proper overhaul...

; This script is responsible for switches between lich form and disguised form, and maintaining the disguise.
; ALL disguise/undisguise related spells and effects to be kept IN THIS SCRIPT

short loc_LichEquipped
; short loc_LichStateInit 
; 1 = lich skills & abilities present
; 2 = disguised, lich stuff removed

; short loc_LichHiddenCheck1

; short loc_LichSleepNoHeal
; short loc_LichPreSleepHealth
; short loc_LichHealthDiff

; short loc_LichRestoreattrCheck
; short loc_LichRestoreskillCheck
; short loc_LichWolfCheck

short ReduceBounty ; Used to remotely reduce bounty namely for the Reduce Notoriety spell..

long bounty		; stored bounty for disguised form
long reputation	; stores reputation
long crime		; temp store for when possession script runs
short crimeflag	; flag used when possesion script runs
short canbeseen

float timer		; for magicka/damage revert check
float detectedtimer
float currentfatigue	; see above
float healthratio	; see above
long bloodgiven

; -------INTRO-------
; script which verifies the spells checks the vn_WearingLich var
; The PCWearingLich global var determines the Lich state : 1 = Lich, 0 = Disguised
; now vn_wearinglich

; IMPORTANT
; now, does disguised form represent your original form, or a new disguised identity every time?
; I'll have to make this configurable. 

; vn_lichconfig = 0
; DEFAULT - you get lich 'aspects', retain your original appearance, but will be unable to Equip certain items,
; and you will have bounty accumulate on your disguised form
; people are allowed to remember you, and if you are 'discovered', you're f*cked...

; vn_lichconfig = 1
; ALTERNATIVE - you get disguise 'aspects', and reselect your race so that skeletal body parts are the default apprearance
; You will never again see your original form, and everyone who greets you will have disposition 50.

; ------End INTRO--------

; ------------------------------------------------------
; CONSTANTLY RUNNING CHECKS
; ------------------------------------------------------

; THRALL BLOOD DONATION RESET FLAG
if ( emb_hook_bloodlost == 0 ) ; this is set to zero by VE when you reload a game so I need to check it.
	set bloodgiven to 0
endif

; 'UNSAFE' FLAG

set detectedtimer to ( detectedtimer + ( GetSecondsPassed ) )
if ( detectedtimer > 5 )
;	MessageBox "Timer %G" detectedtimer
	if ( GetDetected Player ) ; not realtime but good because a ) means you get at least 5 seconds to change
		set canbeseen to 1 ; and also b ) less processor intensive
	else
		set canbeseen to 0
	endif
	set detectedtimer to 0
endif
if ( canbeseen == 1 )
	if ( Player->GetSpell "vn_unsafe" == 0 )
		Player->AddSpell "vn_unsafe"
	endif
else
	if ( Player->GetSpell "vn_unsafe" == 1 )
		Player->RemoveSpell "vn_unsafe"
	endif
endif

; NO MAGICKA RESTORATION while DISGUISED!
if ( vn_wearinglich == 0 )
	; this GetEffect doesn't work?
	; if ( Player->GetEffect, sEffectRestoreSpellPoints == 1 )
		Player->RemoveEffects 76
	; endif
endif

; PREVENT GUARDS ATTACKING DURING POSSESSION
if ( ScriptRunning "vn_possession" == 1 )
	set crimeflag to 1
	set crime to GetPCCrimeLevel
	SetPCCrimeLevel 0
elseif ( crimeflag == 1 ) ; script finished and flag set
	SetPCCrimeLevel crime
	; MessageBox "restoring crime level"
	set crimeflag to 0
endif

; CHECK LICH CRIME LEVEL
if ( vn_switch == 0 )
	; bounty. one for disguised, one for normal form. Disguised form bounty is maintained if vn_config = 0
	; vn_lichbountyflag =1 when in lich form, 0 in disguised form
	
	if ( ScriptRunning "vn_possession" == 0 )
		; if we're in lich form, and not hidden, this must always be at least 8k
		if ( vn_wearinglich == 1 )
			if ( vn_LichHidden == 0 )
				if ( GetPCCrimeLevel < 8000 )
					; MessageBox "Bumping Lich Crime level to 8k" "Ok"
					SetPCCrimeLevel 8000
				endif
			endif
		endif
		; again, if we're known to be a lich, and not hidden, it'll be at least 8k
		if ( vn_lichdiscovered == 1 )
			if ( vn_lichhidden == 0 )
				if ( GetPCCrimeLevel < 8000 )
					; MessageBox "Bumping known Lich Crime level to 8k" "Ok"
					SetPCCrimeLevel 8000
				endif
			endif
		endif
	endif
endif

; Reduce Bounty
if ( ReduceBounty == 1 )
	
	if ( bounty >= 500 )
		set bounty to ( bounty - 500 )
		MessageBox "Your crime level was reduced by 500"
	else
		set bounty to 0
		MessageBox "Your crime level was reduced by 500"
	endif
	
	set ReduceBounty to -1

endif

; CHECK if DISGUISE CAN BE MAINTAINED
if ( vn_wearinglich == 0 )
if ( Player->GetSpellEffects "vn_lichcurse" )
	set timer to ( timer + ( GetSecondsPassed ) )
	if ( Player->GetMagicka < 5 )
		if ( MenuMode == 0 )
			if ( vn_wearinglich == 0 )
				MessageBox "You can sustain this illusion no longer... you revert back to your true form"
				PlaySound "blackoutin" 
				set vn_WearingLich to 1
				set PCWearingLich to 1
				set currentfatigue to ( Player->GetFatigue )
				set currentfatigue to ( 1 - currentfatigue )
	 			Player->ModCurrentFatigue currentfatigue
				Player->ModCurrentFatigue -15
				set vn_switch to 1
			endif
		endif
	elseif ( timer > 0.5 ) ; if ( more than 1 sec since last health check... check again + reset timer )
		; IMPORTANT - must not trigger this if we're feeding a thrall/childe as a Vampiric Lich
		set timer to 0
		set healthratio to ( Player->GetHealthGetRatio )
		
		; if current healthratio not less than global tracking val, OR bloodgiven not equal to local tracking store,
		; then we haven't been damaged, so update health ratio and bloodgiven
		; otherwise, our disguise has been f*cked up.... so we revert back
		if ( healthratio < vn_healthratio )
			if ( bloodgiven == emb_hook_bloodlost ) ; so we didn't donate blood either.
				MessageBox "The damage breaks your concentration and you can sustain the illusion no longer... you revert back to your true form"
				PlaySound "blackoutin" 
				set vn_WearingLich to 1
				set PCWearingLich to 1
				set currentfatigue to ( Player->GetFatigue )
				set currentfatigue to ( 1 - currentfatigue )
	 			Player->ModCurrentFatigue currentfatigue
				Player->ModCurrentFatigue -15
				set vn_switch to 1
			endif
		endif
		set vn_healthratio to healthratio
		set bloodgiven to emb_hook_bloodlost
	endif
endif
endif

; CHECK if TRANSFORM SPELL IS Cast
; CHECK if REVERT SPELL IS Cast

if ( vn_switch == 0 )
	if ( Player->GetSpellEffects "vn_lich_transform" )
		; MessageBox "Setting switch to 21"
		set vn_switch to 21
	endif
	if ( Player->GetSpellEffects "vn_lich_transform_back" )
		; MessageBox "Setting switch to 21"
		set vn_switch to 21
	endif
endif

; DISGUISE RE-Equip
if ( vn_lichconfig == 0 )
	
	; only force force Equip if we're not disguised
	if ( vn_wearinglich == 1 )
		
		if ( Player->GetItemCount "vn_lich_pants" < 1 )
			Player->AddItem "vn_lich_pants" 1
		endif
		if ( Player->HasItemEquipped "vn_lich_pants" == 0 )
			Player->Equip "vn_lich_pants"
		endif
	
		if ( Player->GetItemCount "vn_lich_shirt" < 1 )
			Player->AddItem "vn_lich_shirt" 1
		endif
		if ( Player->HasItemEquipped "vn_lich_shirt" == 0 )
			Player->Equip "vn_lich_shirt"
		endif
	
		; boots. share the shoe slot, so you may wear armour instead. Also means I need to check quantity in inventory
		set loc_LichEquipped to ( Player->GetArmorType 5 )
		if ( loc_LichEquipped < 0 )
			if ( Player->GetItemCount "vn_lich_boots" < 1 )
				Player->AddItem "vn_lich_boots" 1
			endif
			if ( Player->HasItemEquipped "vn_lich_boots" == 0 )
				Player->Equip "vn_lich_boots"
			endif
		else
			if ( Player->GetItemCount "vn_lich_boots" > 0 )
				Player->RemoveItem "vn_lich_boots" 1
			endif
		endif
	
		; beware : if the Player's wearing a bracer, the normal hand will become visible
		set loc_LichEquipped to ( Player->GetArmorType 6 )
		if ( loc_LichEquipped < 0 )
			if ( Player->GetItemCount "vn_lich_glove_left" < 1 )
				Player->AddItem "vn_lich_glove_left" 1
			endif
			if ( Player->HasItemEquipped "vn_lich_glove_left" == 0 )
				Player->Equip "vn_lich_glove_left"
			endif
		else
			if ( Player->GetItemCount "vn_lich_glove_left" > 0 )
				Player->RemoveItem "vn_lich_glove_left" 1
			endif
		endif
		
		; beware : if the Player's wearing a bracer, the normal hand will become visible
		set loc_LichEquipped to ( Player->GetArmorType 7 )
		if ( loc_LichEquipped < 0 )
			if ( Player->GetItemCount "vn_lich_glove_right" < 1 )
				Player->AddItem "vn_lich_glove_right" 1
			endif
			if ( Player->HasItemEquipped "vn_lich_glove_right" == 0 )
				Player->Equip "vn_lich_glove_right"
			endif
		else
			if ( Player->GetItemCount "vn_lich_glove_right" > 0 )
				Player->RemoveItem "vn_lich_glove_right" 1
			endif
		endif
	endif	
elseif ( vn_lichconfig == 1 )
	
	; don't force Equip if we're not disguised
	if ( vn_wearinglich == 0 )
		
		if ( Player->GetItemCount "vn_lich_pants_d" < 1 )
			Player->AddItem "vn_lich_pants_d" 1
		endif
		if ( Player->HasItemEquipped "vn_lich_pants_d" == 0 )
			Player->Equip "vn_lich_pants_d"
		endif
	
		if ( Player->GetItemCount "vn_lich_shirt_d" < 1 )
			Player->AddItem "vn_lich_shirt_d" 1
		endif
		if ( Player->HasItemEquipped "vn_lich_shirt_d" == 0 )
			Player->Equip "vn_lich_shirt_d"
		endif
	
		; boots. share the shoe slot, so you may wear armour instead. Also means I need to check quantity in inventory
		set loc_LichEquipped to ( Player->GetArmorType 5 )
		if ( loc_LichEquipped < 0 )
			if ( Player->GetItemCount "vn_lich_boots_d" < 1 )
				Player->AddItem "vn_lich_boots_d" 1
			endif
			if ( Player->HasItemEquipped "vn_lich_boots_d" == 0 )
				Player->Equip "vn_lich_boots_d"
			endif
		else
			if ( Player->GetItemCount "vn_lich_boots_d" > 0 )
				Player->RemoveItem "vn_lich_boots_d" 1
			endif
		endif
	
		; beware : if the Player's wearing a bracer, the normal hand will become visible
		set loc_LichEquipped to ( Player->GetArmorType 6 )
		if ( loc_LichEquipped < 0 )
			if ( Player->GetItemCount "vn_lich_glove_left_d" < 1 )
				Player->AddItem "vn_lich_glove_left_d" 1
			endif
			if ( Player->HasItemEquipped "vn_lich_glove_left_d" == 0 )
				Player->Equip "vn_lich_glove_left_d"
			endif
		else
			if ( Player->GetItemCount "vn_lich_glove_left_d" > 0 )
				Player->RemoveItem "vn_lich_glove_left_d" 1
			endif
		endif
		
		; beware : if the Player's wearing a bracer, the normal hand will become visible
		set loc_LichEquipped to ( Player->GetArmorType 7 )
		if ( loc_LichEquipped < 0 )
			if ( Player->GetItemCount "vn_lich_glove_right_d" < 1 )
				Player->AddItem "vn_lich_glove_right_d" 1
			endif
			if ( Player->HasItemEquipped "vn_lich_glove_right_d" == 0 )
				Player->Equip "vn_lich_glove_right_d"
			endif
		else
			if ( Player->GetItemCount "vn_lich_glove_right_d" > 0 )
				Player->RemoveItem "vn_lich_glove_right_d" 1
			endif
		endif
	endif
endif

; ---------------------------------------	
; SWITCH BASED CODE
; ---------------------------------------

; vn_switch	
; =1 --- bounty checks
; =2 --- disguise/lich aspects
; ADD/REMOVE DISGUISE EFFECTS

if ( vn_switch == 21 )
	; MessageBox "Switch 21 (Before). Wearing: %.2f, config: %.2f", vn_wearinglich, vn_lichconfig

	if ( vn_wearinglich == 1 ) ; in lich mode - therfore putting disguise on
		if ( Player->HasItemEquipped vn_lich_head_armor == 1 )
			MessageBox "You cannot disguise yourself while wearing a lich crown"
		elseif ( Player->HasItemEquipped vn_crown_of_souls == 1 )
			MessageBox "You cannot disguise yourself while wearing the Crown Of Souls"
		elseif ( Player->HasItemEquipped vn_lich_head_armor2 == 1 )
			MessageBox "You cannot disguise yourself while wearing a lich crown"
		elseif ( Player->HasItemEquipped vn_crown_of_souls2 == 1 )
			MessageBox "You cannot disguise yourself while wearing the Crown Of Souls"
		else
			; MessageBox, "Adding disguise"
			PlaySound "blackoutin" 
			set vn_wearinglich to 0
			set PCWearingLich to 0
			set vn_healthratio to ( Player->GetHealthGetRatio )
			set vn_switch to 1
		endif
	else ; not wearing lich ( disguised ) add disguise
		; MessageBox "Removing disguise"
		PlaySound "blackoutin"
		set vn_wearinglich to 1
		set PCWearingLich to 1
		set vn_switch to 1
	endif
endif

; ---Bounty----
if ( vn_switch == 1 )
	; MessageBox "Switch state 1. Wearing: %.2f, config: %.2f", vn_wearinglich, vn_lichconfig

	; if we're a known lich, switch is not going to affect bounty or reputation
	if ( vn_lichdiscovered == 1 )
		set vn_switch to 2
		return
	endif

	; firstly, bounty. Have we been seen? if so, our bounty will be 8k at least - and we're in big trouble if config=0...
	if ( canbeseen == 1 )			; We've been seen!
		if ( vn_lichconfig == 0 )
			if ( vn_lichdiscovered == 0 )
				if ( Random100 < ( Player->GetReputation ) )
					MessageBox "You have been seen transforming! Your disguise is no longer safe..." "Ok"
					Player->ModReputation 5 				; 5pt bonus when you become known as a lich
					set vn_lichdiscovered to 1
					if ( bounty < 8000 )
						set bounty to 8000 			; set stored bounty for next time
					endif
				else
					MessageBox "You have been seen transforming! Luckily, you were not recognised this time" "Ok"
				endif
			endif
		endif
		; regardless of disguise or setting, bounty will now be at least 8k
		if ( GetPCCrimeLevel < 8000 )
			SetPCCrimeLevel 8000
		endif
	else		; yay we weren't detected!
		if ( vn_wearinglich == 1 )
			set bounty to GetPCCrimeLevel 			; only used if ( vn_lichconfig == 0 )
			set reputation to ( Player->GetReputation )
			; MessageBox "Setting stored crime level to %.2f", bounty
			Player->SetReputation 5 				; a lich always has a reputation of 5
			SetPCCrimeLevel 8000
		else 		; disguising
			if ( vn_lichconfig == 0 )
				; MessageBox "Setting crime level to %.2f", bounty
				Player->SetReputation reputation
				SetPCCrimeLevel bounty
			else
				SetPCCrimeLevel 0
				Player->SetReputation 5
			endif
		endif
	endif

	set vn_switch to 2
endif

; ---Clothing aspects----
; removal of extras
if ( vn_switch == 2 )
	; this switch is responsibel for adding/removing the lich/disguise aspcts.
	; they will then be auto-equipped by constantly running section

	; MessageBox "Removing aspects if necessary. Wearing: %.2f, config: %.2f", vn_wearinglich, vn_lichconfig

	if ( vn_wearinglich == 0 )
		; remove lich aspects
		if ( vn_lichconfig == 0 )
			if ( Player->GetItemCount "vn_lich_boots" > 0 )
				Player->RemoveItem "vn_lich_boots" 1
			endif
			if ( Player->GetItemCount "vn_lich_glove_left" > 0 )
				Player->RemoveItem "vn_lich_glove_left" 1
			endif
			if ( Player->GetItemCount "vn_lich_glove_right" > 0 )
				Player->RemoveItem "vn_lich_glove_right" 1
			endif
			if ( Player->GetItemCount "vn_lich_pants" > 0 )
				Player->RemoveItem "vn_lich_pants" 1
			endif
			if ( Player->GetItemCount "vn_lich_shirt" > 0 )
				Player->RemoveItem "vn_lich_shirt" 1
			endif
		endif
	endif
	if ( vn_wearinglich == 1 )
		if ( vn_lichconfig == 1 )
			if ( Player->GetItemCount "vn_lich_boots_d" > 0 ) ; --remember to create these items : )
				Player->RemoveItem "vn_lich_boots_d" 1
			endif
			if ( Player->GetItemCount "vn_lich_glove_left_d" > 0 )
				Player->RemoveItem "vn_lich_glove_left_d" 1
			endif
			if ( Player->GetItemCount "vn_lich_glove_right_d" > 0 )
				Player->RemoveItem "vn_lich_glove_right_d" 1
			endif
			if ( Player->GetItemCount "vn_lich_pants_d" > 0 )
				Player->RemoveItem "vn_lich_pants_d" 1
			endif
			if ( Player->GetItemCount "vn_lich_shirt_d" > 0 )
				Player->RemoveItem "vn_lich_shirt_d" 1
			endif
		endif
	endif

	set vn_switch to 3
endif

if ( vn_switch == 3 )

	; MessageBox "State 3"						
	if ( vn_wearinglich == 0 )			; things to check when you disguise yourself
		if ( ScriptRunning "vn_lichracecheckscript" == 0 )		; race
			StartScript "vn_lichracecheckscript"
		endif
		; MessageBox "removing lich abilities whilst not in lich form"
		if ( ScriptRunning "vn_Lichspellremove_partial" == 0 )		; remove non-innate bonuses
			StartScript "vn_lichspellremove_partial"
		endif
		if ( ScriptRunning "vn_lichHiddenArmorScript" == 1 )		; stop the armour script??
			StopScript "vn_lichHiddenArmorScript"
		endif
	else								; things to set when you become a lich
		if ( PCRace != -777 )
			set PCRace to -777
		endif

		; MessageBox "Assigning skills & stuff"
		if ( ScriptRunning "vn_Lichspelladd" == 0 ) ; should already be running but be on the safe side.
			StartScript "vn_Lichspelladd"
			return				; return so it will have a frame to start running at least. Needed?
		elseif ( ScriptRunning "vn_lichspelladd" == 1 )
			set vn_lichspelladd.active to 1
		endif

		if ( ScriptRunning "vn_lichHiddenArmorScript" == 0 )
			StartScript "vn_lichHiddenArmorScript"
		endif
	endif

	set vn_switch to 4
endif

if ( vn_switch == 4 )
	if ( Player->GetSpellEffects "vn_lich_transform" == 0 )
		if ( Player->GetSpellEffects "vn_lich_transform_back" == 0 )
			; safe to allow detection again
			set vn_switch to 0
		endif
	endif
endif

End

# vn_Lichscript2 ==============================================================
Begin vn_Lichscript2

float timer2
; short restoreskillcheck
; short restoreattrcheck
short sleeping
float presleephealth
float lichhealthdiff
float currenthealth
float currentfatigue
short deathstate
short vmr_bonus
float temp
float vmr_timer
short showonce
short pclev
short sorcerylevel
long numDaysPassed
float maxhealth
float difference
float newmax
float healthratio
short allowfollower
short decay

short madcheckflag
short adjust_Trigger

float phy_angle
float phy_x
float phy_y
float phy_z
long phy_cell
short set_phylactery
short returnto_phylactery

float lair_angle
float lair_x
float lair_y
float lair_z
long lair_cell
short set_lair
short returnto_lair

; responsible for spell effects triggering spellmaking + enchanting
; restores lost health from enchanting
; restoration check
; now also checks one chance/Day of getting new follower.

; Checks if the menu is open or not. Used for dialogue voice checks for body steal scripts
if ( MenuMode == 0 )
	if ( vn_done_chat_init == 1 )
		set vn_done_chat_init to 0
	endif
endif

if ( MenuMode == 1 )
	if ( vn_done_chat_init == 0 )
		set vn_done_chat_init to 1
	endif
endif

; NO RESTORE HEALTH/MAGICKA if VAMP
if ( vn_lich_vamp == 1 )
	; detect for this does not work, so I'll nuke it all the time
	Player->RemoveEffects 76

	; soul consumer bonus
	if ( MenuMode == 0 )
		if ( vn_vamplich_mr > 0 )
			set vmr_timer to ( vmr_timer + ( GetSecondsPassed ) )
			if ( vmr_timer > 1 )
				set vmr_bonus to vn_vamplich_mr
				Player->ModCurrentMagicka vmr_bonus
				set vmr_timer to 0
			endif			
		endif
	endif

	if ( Player->GetEffect sEffectRestoreHealth == 1 )
		MessageBox "A Vampic Lich cannot use restore health effects"
		Player->RemoveEffects 75
		; Player->ModHealth, -1
	endif
endif

; MAD LEVELLER CHECKS
if ( mlRemoved == 1 )
	set vn_lichspelladd.active to 1
endif
if ( mlReset == 1 )
	StartScript "vn_lichSpellRemove"
	StartScript "vn_lichskillremove"
endif
if ( mlReset == 4 )
	set vn_lichspelladd.active to 1
endif

if ( adjust_trigger == 1 )
	StartScript "mladjust"
	set adjust_Trigger to 0
endif

if ( madcheckflag == 0 )
	MessageBox "Checking mad leveller compatability"
	if ( mlRunOnce != 0 )
		StartScript "mlAdjust"
	else
		MessageBox "Mad leveller not loaded - no problems"
	endif
	set madcheckflag to 1
endif

; RESTORE CHECKS
; if ( Player->GetEffect, sEffectRestoreAttribute )
;	if ( restoreattrflag == 0 )
;		set restoreattrflag to 1
;	endif
; endif
;
; if ( Player->GetEffect, sEffectRestoreskill )
;	if ( restoreskillflag == 0 )
;		set restoreskillflag to 1
;	endif
; endif
;
; if ( restoreattrcheck == 1 )
;	if ( Player->GetEffect, sEffectRestoreAttribute == 0 )
;		MessageBox "Restore attributes effect finished. removing drains and reapplying"
;		; REMOVE CORRECT SPELLS - this mean +ve ones too.
;		Player->RemoveSpell vn_lichbad
;		Player->RemoveSpell vn_lichattrlev1
;		Player->RemoveSpell vn_lichattrlev5
;		Player->RemoveSpell vn_lichattrlev10
;		Player->RemoveSpell vn_lichattrlev15
;		Player->RemoveSpell vn_lichattrlev20
;		Player->RemoveSpell vn_lichattrlev25
;		Player->RemoveSpell vn_lichattrlev30
;		Player->RemoveSpell vn_lichattrlev35
;		Player->RemoveSpell vn_lichattrlev40
;		Player->RemoveSpell vn_lichattrlev45
;		Player->RemoveSpell vn_lichattrlev50
;		Player->RemoveSpell vn_lichattrlev55
;		Player->RemoveSpell vn_lichattrlev60
;		Player->RemoveSpell vn_lichattrlev65
;		Player->RemoveSpell vn_lichattrlev70
;		Player->RemoveSpell vn_lichattrlev75
;		set restoreattrcheck to 0
;	endif
; endif

; if ( restoreskillcheck == 1 )
;	if ( Player->GetEffect, sEffectrestoreskill == 0 )
;		MessageBox "Restore skills effect finished. removing drains and reapplying"
;		Player->RemoveSpell vn_lichbad
;		Player->RemoveSpell vn_lichskillslev1 ; note... test this. dont' know if it works.
;		Player->RemoveSpell vn_lichskillslev5
;		Player->RemoveSpell vn_lichskillslev10
;		Player->RemoveSpell vn_lichskillslev15
;		Player->RemoveSpell vn_lichskillslev20
;		Player->RemoveSpell vn_lichskillslev25
;		Player->RemoveSpell vn_lichskillslev30
;		Player->RemoveSpell vn_lichskillslev35
;		Player->RemoveSpell vn_lichskillslev40
;		Player->RemoveSpell vn_lichskillslev45
;		Player->RemoveSpell vn_lichskillslev50
;		Player->RemoveSpell vn_lichskillslev55
;		Player->RemoveSpell vn_lichskillslev60
;		Player->RemoveSpell vn_lichskillslev65
;		Player->RemoveSpell vn_lichskillslev70
;		Player->RemoveSpell vn_lichskillslev75
;		set restoreskillcheck to 0
;	endif
; endif

; DISALLOW HEALTH GAIN DURING SLEEP
if ( MenuMode )
	if ( GetPCSleep == 0 )
		if ( sleeping == 0 )
			set presleephealth to ( Player->GetHealth )
		endif
	endif
endif

if ( GetPCSleep == 1 )
	set sleeping to 1
endif

if ( sleeping == 1 )
	if ( GetPCSleep == 0 )
		set lichhealthdiff to ( Player->GetHealth - presleephealth ) * -1
		Player->ModCurrentHealth lichhealthdiff
		set sleeping to 0
	endif
endif

; NEW - phylactery/lair relocation
if ( set_phylactery == 1 )
	StartScript "vn_getposition"
	set set_phylactery to 2
endif
if ( set_phylactery == 2 )
	if ( ScriptRunning "vn_getposition" == 0 )
		set phy_cell to vn_TeleportCell
		set phy_angle to vn_Angle
		set phy_x to vn_PosX
		set phy_y to vn_PosY
		set phy_z to vn_PosZ
		set set_phylactery to 0
		; MessageBox "New Phylactey location stored"
	endif
endif
if ( returnto_phylactery == 1 )
	set vn_TeleportCell to phy_cell
	set vn_Angle to phy_angle
	set vn_PosX to phy_x
	set vn_PosY to phy_y
	set vn_PosZ to phy_z
	set returnto_phylactery to 2
endif
if ( returnto_phylactery == 2 )
	if ( ScriptRunning "vn_setposition" == 0 )
		StartScript "vn_setposition"
		set returnto_phylactery to 0
	endif
endif

if ( set_lair == 1 )
	StartScript "vn_getposition"
	set set_lair to 2
endif
if ( set_lair == 2 )
	if ( ScriptRunning "vn_getposition" == 0 )
		set lair_cell to vn_TeleportCell
		set lair_angle to vn_Angle
		set lair_x to vn_PosX
		set lair_y to vn_PosY
		set lair_z to vn_PosZ
		set set_lair to 0
		; MessageBox "Lair location stored"
	endif
endif
if ( returnto_lair == 1 )
	set vn_TeleportCell to lair_cell
	set vn_Angle to lair_angle
	set vn_PosX to lair_x
	set vn_PosY to lair_y
	set vn_PosZ to lair_z
	set returnto_lair to 2
endif
if ( returnto_lair == 2 )
	if ( ScriptRunning "vn_setposition" == 0 )
		StartScript "vn_setposition"
		set returnto_lair to 0
	endif
endif

; DEATH & RELOCATION
if ( Player->GetHealthGetRatio < 0.2 ) ; maybe check for less than 10%... 
	if ( vn_phylacteryset == 1 )
		if ( deathstate == 0 )
			; PlaySound, "mystH"
			set currenthealth to ( Player->GetHealth )
			set currentfatigue to ( Player->GetFatigue )
			set temp to ( 0 - currentfatigue )
			; or... reduce health to 1 but don't run this if we're in phylactery chamber
			if ( currenthealth > 0 ) ; screws up the game otherwise.
				set deathstate to 1
				Player->ModCurrentFatigue temp
				Player->ModCurrentHealth 1000 
			endif
			if ( vn_lich_vamp == 1 )
				; reduce blood
				if ( vn_blood > 200 )
					set vn_blood to ( vn_blood / 2 )
				elseif ( vn_blood > 100 )
					set vn_blood to ( vn_blood - 100 )
				else
					MessageBox "Your powers are too weak, your essence cannot be saved" "Ok"
					Player->ModCurrentHealth -10000
				endif
			endif
		endif
	elseif ( showonce == 0 )
		Player->ModCurrentHealth -1000
		MessageBox "Your body is broken, and your vulnerable phylactery will surely be destroyed. Nothing can save you this time"
		set showonce to 1
	endif
endif

if ( deathstate == 1 )
	FadeOut 1.0
	Player->PositionCell 0 0 100 0 "Phylactery - Inner Chamber"

	; could I use a global for this? Have to check sometime.

	if ( vn_pn_reduce_decay == 1 )	
		if ( mlRunOnce != 0 )
			set Adj_Strength to -1
			set Adj_Agility to -1
			set Adj_Endurance to -1
			set Adj_Speed to -1
			set adjust_trigger to 1
		else
			Player->ModStrength -1
			Player->ModAgility -1
			Player->ModEndurance -1
			Player->ModSpeed -1
		endif
		if ( Gals_Natural_Strength > 0 )
			set Gals_Natural_Strength to ( Gals_Natural_Strength - 1 )
			set Gals_Natural_Agility to ( Gals_Natural_Agility - 1 )
			set Gals_Natural_Endurance to ( Gals_Natural_Endurance - 1 )
			set Gals_Natural_Speed to ( Gals_Natural_Speed - 1 )
		endif
	else
		if ( mlRunOnce != 0 )
			set Adj_Strength to -2
			set Adj_Agility to -2
			set Adj_Endurance to -2
			set Adj_Speed to -2
			set adjust_trigger to 1
		else
			Player->ModStrength -2
			Player->ModAgility -2
			Player->ModEndurance -2
			Player->ModSpeed -2
		endif
		if ( Gals_Natural_Strength > 0 )
			set Gals_Natural_Strength to ( Gals_Natural_Strength - 2 )
			set Gals_Natural_Agility to ( Gals_Natural_Agility - 2 )
			set Gals_Natural_Endurance to ( Gals_Natural_Endurance - 2 )
			set Gals_Natural_Speed to ( Gals_Natural_Speed - 2 )
		endif
	endif
     set vn_brotherhoodswitch to 1
	MessageBox "Your broken body is returned to the pylactery. "
	FadeIn 1.0
	set deathstate to 0
endif

; LEVELUP TRIGGERS
; if your level OR sorcery avenue skill changes, run the level up script
; the levelup script removes & reassigns all spells & bonuses.
if ( vn_wearinglich == 1 ) ; don't levelup if ( not in lich form )
	if ( sorcerylevel != vn_avenue_sorcery )
		if ( ScriptRunning "vn_lichlevelup" == 0 )
			StartScript "vn_lichlevelup"
		endif
		set sorcerylevel to vn_avenue_sorcery
	endif
	if ( pclev != Player->GetLevel )
		if ( ScriptRunning "vn_lichlevelup" == 0 )
			; MessageBox "Calling spell assignment script"
			StartScript "vn_lichlevelup"
		endif
		set pclev to ( Player->GetLevel )
	endif
endif

; Disable BROTHERHOOD IN PYHLACTERY
; Removed... Needs fixed...

; ADD FOLLOWER CHECK
; no longer used. Followers gained through recruitment instead.
; if ( GetPCSleep == 1 )
;	MessageBox "Sleeping detected"
;	if ( allowFollower == 1 )
;		if ( ScriptRunning, vn_addfollowercheck == 0 )
;			MessageBox "Calling add follower check"
;			StartScript, vn_addfollowercheck
;		endif
;		set allowFollower to 0
;	endif
; endif

; LUNAR MAGICKA BONUS
if ( vn_ps_lunar_magicka == 1 )
	if ( GetSecundaPhase == 4 )
		if ( Player->GetSpell "vn_lunar_bonus2" == 0 )
			if ( GameHour > 18 )
				MessageBox "Adding Full Moon Lunar Magicka bonus"
				Player->AddSpell "vn_lunar_bonus2"
			elseif ( GameHour < 6 )
				MessageBox "Adding Full Moon Lunar Magicka bonus"
				Player->AddSpell "vn_lunar_bonus2"
			endif
		else ; lunar magicka bonus active
			if ( GameHour > 6 )
				if ( GameHour < 18 )
					MessageBox "Removing Full Moon Lunar Magicka bonus"
					Player->RemoveSpell "vn_lunar_bonus2"
				endif
			endif
		endif
	else
		if ( Player->GetSpell "vn_lunar_bonus" == 0 )
			if ( GameHour > 18 )
				MessageBox "Adding Lunar Magicka bonus"
				Player->AddSpell "vn_lunar_bonus"
			elseif ( GameHour < 6 )
				MessageBox "Adding Lunar Magicka bonus"
				Player->AddSpell "vn_lunar_bonus"
			endif
		else ; lunar magicka bonus active
			if ( GameHour > 6 )
				if ( GameHour < 18 )
					MessageBox "Removing Lunar Magicka bonus"
					Player->RemoveSpell "vn_lunar_bonus"
				endif
			endif
		endif
	endif
endif

	
; ENCHANTMENT RECOVERY AND DAILY RESETS
if ( DaysPassed != numDaysPassed )
	set numDaysPassed to DaysPassed
	set allowFollower to 1

	; in case either of these got stuck on the wrong value
	set vn_raise_dead_state to -1
	set vn_enchantstate to -1
	set vn_spellmakestate to -1
	set vn_waypointstate to -1
	set vn_power_ritual_state to -1
	set vn_ritualAttemptedToday to 0

	if ( ScriptRunning "vn_powerritual" )
		StopScript "vn_powerritual"
	endif

	; reduce soul bonus
	if ( vn_vamplich_mr >= 1 )
		set vn_vamplich_mr to ( vn_vamplich_mr - 2 ) ; since script will give +1
		StartScript "vn_inc_vamplich_mr"
	endif

	if ( vn_healthlost > 0 )
		set currentHealth to ( Player->GetHealth )
		set maxHealth to ( currentHealth / Player->GetHealthGetRatio )
		set difference to ( currentHealth - maxhealth ) 
		if ( vn_ps_enchant_mastery == 1 )
			set newmax to ( maxhealth + 3 )
		else
			set newmax to ( maxhealth + 2 )
		endif
		Player->SetHealth newmax
		Player->ModCurrentHealth difference
		if ( vn_ps_enchant_mastery == 1 )
			set temp to ( vn_healthlost - 3 )
		else
			set temp to ( vn_healthlost - 2 )
		endif
		set vn_healthlost to temp
		MessageBox "You recover slightly from the exertions of enchanting"
	endif
endif

End

# vn_lichscript3 ==============================================================
Begin vn_lichscript3

short beast_mastery_flag
short explosive_rat_flag
short godmode_flag
short fake_death_flag
short notoriety_flag
short fame_flag
short doppleganger_flag
short packrat_flag
short ritual_flag
short speedswitch
short bloodconversion
float conversion_timer

long NOMlasthour
long lastHour
long thishour

set thishour to GameHour

if ( thishour != NOMlasthour )
	; NOM/SOS globals... obviously liches don't need to eat, drink or sleep
	set NOM_addhunger to 0
	set NOM_addthirst to 0
	set NOM_hunger to 0
	set NOM_thirst_v to 0
	set NOM_sleep to 0
	set _sos_gh_total to 0
endif

; add build points
if ( lastHour != thishour )
	if ( vn_lair_building > 0 ) ; don't assign points if ( we've finished what we're working on )
		set vn_build_points to ( vn_build_points + vn_build_rate )
		set lastHour to thishour
		; MessageBox "Build Points: %.2f", vn_build_points 
	endif
endif

; anything finished?
if ( vn_build_rate > 0 )
	if ( vn_build_points > vn_build_target )
		
		; set as done
		if ( vn_lair_building == 1 ) ; opening chamber -- 1000 points ( <100 man hours )
			set vn_lair_firstchamber to ( vn_lair_firstchamber + 1 ) ; 1000->3000/2000/1000 in that order. up to 4.
		elseif ( vn_lair_building == 2 ) ; east chamber 700
			set vn_lair_side1 to 1
		elseif ( vn_lair_building == 3 ) ; west chamber 700
			set vn_lair_side2 to 1
		elseif ( vn_lair_building == 4 ) ; worship chamber 1500
			set vn_lair_worship to 1
		elseif ( vn_lair_building == 5 ) ; sacrifice chamber 800
			set vn_lair_sac to 1
		elseif ( vn_lair_building == 6 ) ; study chamber 1500
			set vn_lair_study to 1
		endif 

		; remove build points
		set vn_lair_building to 0 ; no part is being built
		set vn_build_points to 0 ; remove all build points

	;	if ( vn_lair_building == 2 ) ; lair open, building some other part
	;		set vn_lair_building to 0 ; no part is being built
	;		set vn_build_points to 0 ; remove all build points
	;		; set vn_lair_[NAME] to 1 ; Enable Lich lair
	;		; Activate/deactivate item
	;	endif 

		; NOTE; lair is built from statics and activators ( <100 can have scripts, statics hours )
		; for most structural work, activators form 'dividers' which are removed when building is complete.
		; for other items ( altar etc ) these ar activators which are enabled.

	endif
elseif ( vn_build_rate < 0 ) ; just in case
	MessageBox "Error - build rate < 0! Correcting" "Ok"
	set vn_build_rate to 0
endif

; this script contains checking for the scripted spells.

if ( Player->GetSpell "vn_phy_levitation" == 1 )
	if ( GetPCCell "Phylactery - Inner Chamber" == 0 )
		Player->RemoveSpell "vn_phy_levitation"
	endif
endif

; no longer used
if ( Player->GetSpellEffects "vn_set_waypoint" )
	if ( vn_waypointstate == -1 )
		StartScript "vn_waypointscript"
		set vn_waypointstate to 0
	endif
endif

if ( Player->GetSpellEffects "vn_lich_spellmaking" )
	; MessageBox "vn lich spellmaking detected"
	if ( vn_WearingLich == 1 )
		if ( vn_spellmakestate == -1 )
			; MessageBox "Initiating lich spellmaking"
			PlaySound "conjuration area"
			PlaceAtPC "vn_spellmaketalker"  1 600 1
			set vn_spellmakestate to 0
		endif
	endif
endif

if ( Player->GetSpellEffects "vn_lich_enchanting" )
	if ( vn_wearingLich == 1 )
		if ( vn_EnchantState == -1 )
			; MessageBox "vn lich enchanting detected"
			PlaySound "conjuration area"
			PlaceAtPC "vn_enchantmaketalker"  1 600 1
			set vn_enchantstate to 0
		endif
	endif
endif

if ( Player->GetSpellEffects "vn_raise_dead" )
	if ( vn_raise_dead_state == -1 )
		if ( ScriptRunning "vn_raise_dead_script" == 0 )
			; MessageBox "Raise Dead detected"
			StartScript "vn_raise_dead_script"
			PlaySound "conjuration area"
			set vn_raise_dead_state to 0
		else
			; script is already running
		endif
	endif
endif

if ( Player->GetSpellEffects "vn_pn_raise_dead" )
	if ( vn_raise_dead_state == -1 )
		if ( ScriptRunning "vn_raise_dead_script" == 0 )
			; MessageBox "Raise Dead detected"
			StartScript "vn_raise_dead_script"
			PlaySound "conjuration area"
			set vn_raise_dead_state to 0
		endif
	endif
endif

if ( Player->GetSpellEffects "vn_pn_unholy_animation" )
	if ( vn_raise_dead_state == -1 )
		if ( ScriptRunning "vn_raise_dead_script" == 0 )
			; MessageBox "Raise Dead detected"
			StartScript "vn_raise_dead_script"
			PlaySound "conjuration area"
			set vn_raise_dead_state to 0
		endif
	endif
endif

if ( vn_raise_dead_state == 21 ) ; finished state
	if ( ScriptRunning "vn_raise_dead_script" == 1 ) ; should be off but just in case stop it
		StopScript "vn_raise_dead_script"
		return ; I'm not convinced it stops in the same frame so I need to do this to be safe
	endif
	; if ( NONE of the raise dead spells are active, reset state so it can be used on the next Day. )
	if ( Player->GetSpellEffects "vn_raise_dead" == 0 )
		if ( Player->GetSpellEffects "vn_pn_unholy_animation" == 0 )
			if ( Player->GetSpellEffects "vn_pn_raise_dead" == 0 )
				set vn_raise_dead_state to -1 ; so now
			endif
		endif
	endif
endif

; most of the below effects are in paired flag statements to detect correctly if ( they are on/off )
; and ensure they're only triggered once per Cast!

if ( vn_pv_daywalker == 1 )
	if ( Player->GetEffect sEffectSunDamage )
		Player->RemoveEffects 135
	endif
endif

if ( Player->GetSpellEffects "vn_pv_superspeed_ON" )
	if ( speedswitch == 0 )
		set speedswitch to 1
	endif
elseif ( Player->GetSpellEffects "vn_pv_superspeed_OFF" ) 
	if ( speedswitch == 0 )
		set speedswitch to 1
	endif
endif

if ( speedswitch == 1 )
	if ( Player->GetSpellEffects "vn_superspeed" == 0 )
		MessageBox "Super speed activated"
		Player->RemoveSpell "vn_pv_superspeed_ON"
		Player->AddSpell "vn_superspeed"
		Player->AddSpell "vn_pv_superspeed_OFF"
		set speedswitch to 2
	else
		MessageBox "Super speed deactivated"
		Player->RemoveSpell "vn_pv_superspeed_OFF"
		Player->RemoveSpell "vn_superspeed"
		Player->AddSpell "vn_pv_superspeed_ON"
		set speedswitch to 2
	endif
endif

if ( speedswitch == 2 )
	if ( Player->GetSpellEffects "vn_pv_superspeed_ON" == 0 )
		if ( Player->GetSpellEffects "vn_pv_superspeed_OFF" == 0 )
			set speedswitch to 0
		endif
	endif
endif

if ( Player->GetSpellEffects "vn_pv_bloodconversion_ON" )
	if ( bloodconversion == 0 )
		set bloodconversion to 1
	endif
elseif ( Player->GetSpellEffects "vn_pv_bloodconversion_OFF" ) 
	if ( bloodconversion == 0 )
		set bloodconversion to 1
	endif
endif

if ( bloodconversion == 1 )
	if ( Player->GetSpellEffects "vn_bloodconversion" == 0 )
		MessageBox "Blood Conversion activated"
		Player->RemoveSpell "vn_pv_bloodconversion_ON"
		Player->AddSpell "vn_bloodconversion"
		Player->AddSpell "vn_pv_bloodconversion_OFF"
		set bloodconversion to 2
	else
		MessageBox "Blood Conversion deactivated"
		Player->RemoveSpell "vn_pv_bloodconversion_OFF"
		Player->RemoveSpell "vn_bloodconversion"
		Player->AddSpell "vn_pv_bloodconversion_ON"
		set bloodconversion to 2
	endif
endif

if ( bloodconversion == 2 )
	if ( Player->GetSpellEffects "vn_pv_bloodconversion_ON" == 0 )
		if ( Player->GetSpellEffects "vn_pv_bloodconversion_OFF" == 0 )
			set bloodconversion to 0
		endif
	endif
endif

if ( Player->GetSpellEffects "vn_bloodconversion" == 1 )
	; every 5 seconds, report blood points remaining
	set conversion_timer to ( conversion_timer + ( GetSecondsPassed ) )
	if ( conversion_timer > 5 )
		set conversion_timer to 0
		set vn_blood to ( vn_blood - 5 )
		if ( vn_pv_blood_conv_bonus == 1 )
			Player->ModCurrentMagicka 60
		else
			Player->ModCurrentMagicka 30
		endif
		if ( vn_blood <= 0 )
			set vn_blood to 0
			set bloodconversion to 1
		endif
		MessageBox "%.2f blood points remaining" vn_blood
	endif
endif

if ( explosive_rat_flag == 1 )
	if ( Player->GetSpellEffects "vn_ps_explosive_rat" == 0 )
		set explosive_rat_flag to 0
	endif
endif

if ( Player->GetSpellEffects "vn_pp_beast_mastery" )
	if ( beast_mastery_flag == 0 )
		PlaySound "conjuration area"
		PlaceAtPC "vn_rat_blighted" 12 200 0
		set beast_mastery_flag to 1
	endif
endif

if ( beast_mastery_flag == 1 )
	if ( Player->GetSpellEffects "vn_pp_beast_mastery" == 0 )
		set beast_mastery_flag to 0
	endif
endif

if ( Player->GetSpellEffects "vn_ps_explosive_rat" )
	if ( explosive_rat_flag == 0 )
		PlaySound "conjuration area"
		PlaceAtPC "vn_rat_explosive" 1 200 0
		set explosive_rat_flag to 1
	endif
endif

if ( explosive_rat_flag == 1 )
	if ( Player->GetSpellEffects "vn_ps_explosive_rat" == 0 )
		set explosive_rat_flag to 0
	endif
endif

if ( Player->GetSpellEffects "vn_pp_packrat" )
	if ( packrat_flag == 0 )
		PlaySound "conjuration area"
		PlaceAtPC "vn_packrat" 1 200 0
		set packrat_flag to 1
	endif
endif

if ( packrat_flag == 1 )
	if ( Player->GetSpellEffects "vn_pp_packrat" == 0 )
		set packrat_flag to 0
	endif
endif

if ( Player->GetSpellEffects "vn_ps_godmode" )
	if ( godmode_flag == 0 )
		PlaySound "conjuration area"
		MessageBox "Enabling Invulnerability"
		tgm
		set godmode_flag to 1
	endif
endif

if ( godmode_flag == 1 )
	if ( Player->GetSpellEffects "vn_ps_godmode" == 0 )
		MessageBox "Disabling Invulnerability"
		set godmode_flag to 0
		tgm
	endif
endif

if ( Player->GetSpellEffects "vn_pn_fake_death" )
	if ( fake_death_flag == 0 )
		FadeOut 1.0
		Player->PositionCell 0 0 100 0 "Phylactery - Inner Chamber"
		set vn_brotherhoodswitch to 1
		FadeIn 1.0
		set fake_death_flag to 1
	endif
endif

if ( fake_death_flag == 1 )
	if ( Player->GetSpellEffects "vn_pn_fake_death" == 0 )
		set fake_death_flag to 0
	endif
endif

if ( Player->GetSpellEffects "vn_pp_fame" )
	if ( fame_flag == 0 )
		MessageBox "Your reputation was increased by 1"
		Player->ModReputation 1
		set fame_flag to 1
	endif
endif

if ( fame_flag == 1 )
	if ( Player->GetSpellEffects "vn_pp_fame" == 0 )
		set fame_flag to 0
	endif
endif

; Reduce Notoriety
if ( Player->GetSpellEffects "vn_pp_reduce_notoriety" )
	if ( notoriety_flag == 0 )

		; Lich Form
		if ( vn_wearinglich == 1 )

			; Trigger Remote Function
			set vn_lichscript.ReduceBounty to 1

		else ; Disguised form.
			ModPCCrimeLevel -500.0
			MessageBox "Your crime level was reduced by 500"
		endif

		set notoriety_flag to 1
		if ( vn_lichdiscovered == 1 )
			MessageBox "People no longer remember that you're a Lich. You can now pay off your bounty when you are disguised." "Ok"
			set vn_lichdiscovered to 0
		endif
	endif
endif

if ( notoriety_flag == 1 )
	if ( Player->GetSpellEffects "vn_pp_reduce_notoriety" == 0 )
		set notoriety_flag to 0
	endif
endif

if ( Player->GetSpellEffects "vn_ps_doppleganger" )
	if ( doppleganger_flag == 0 )
		; MessageBox "adding doppleganger"
		PlaceAtPC "Player" 1 500 1
		set doppleganger_flag to 1
	endif
endif

if ( doppleganger_flag == 1 )
	if ( Player->GetSpellEffects "vn_ps_doppleganger" == 0 )
		set doppleganger_flag to 0
	endif
endif

if ( Player->GetSpellEffects "vn_power_ritual_spell" )
	if ( ritual_flag == 0 )
		if ( vn_power_ritual_state == -1 )
			if ( ScriptRunning "vn_powerritual" == 0 )
				set ritual_flag to 1
				PlaySound "conjuration area"
				StartScript "vn_powerritual"
				set vn_power_ritual_state to 0
			endif
		endif
	endif
endif

if ( ritual_flag == 1 )
	if ( Player->GetSpellEffects "vn_power_ritual_spell" == 0 )
		if ( ScriptRunning "vn_powerritual" == 0 )
			set vn_power_ritual_state to -1 
			set ritual_flag to 0
		endif
	endif
endif

End

# vn_lichskillremove ==========================================================
Begin vn_lichskillremove

short state
short removelevel
short temp
short temp2
short temp3

if ( state == 0 )

	if ( Player->GetSpell "vn_lichskillslev1" == 1 )
		Player->RemoveSpell "vn_lichskillslev1"
		set removelevel to 1
	endif
	if ( Player->GetSpell "vn_lichskillslev5" == 1 )
		Player->RemoveSpell "vn_lichskillslev5"
		set removelevel to 2
	endif
	if ( Player->GetSpell "vn_lichskillslev10" == 1 )
		Player->RemoveSpell "vn_lichskillslev10"
		set removelevel to 3
	endif
	if ( Player->GetSpell "vn_lichskillslev15" == 1 )
		Player->RemoveSpell "vn_lichskillslev15"
		set removelevel to 4
	endif
	if ( Player->GetSpell "vn_lichskillslev20" == 1 )
		Player->RemoveSpell "vn_lichskillslev20"
		set removelevel to 5
	endif
	if ( Player->GetSpell "vn_lichskillslev25" == 1 )
		Player->RemoveSpell "vn_lichskillslev25"
		set removelevel to 6
	endif
	if ( Player->GetSpell "vn_lichskillslev30" == 1 )
		Player->RemoveSpell "vn_lichskillslev30"
		set removelevel to 7
	endif
	if ( Player->GetSpell "vn_lichskillslev35" == 1 )
		Player->RemoveSpell "vn_lichskillslev35"
		set removelevel to 8
	endif
	if ( Player->GetSpell "vn_lichskillslev40" == 1 )
		Player->RemoveSpell "vn_lichskillslev40"
		set removelevel to 9
	endif
	if ( Player->GetSpell "vn_lichskillslev45" == 1 )
		Player->RemoveSpell "vn_lichskillslev45"
		set removelevel to 10
	endif
	if ( Player->GetSpell "vn_lichskillslev50" == 1 )
		Player->RemoveSpell "vn_lichskillslev50"
		set removelevel to 11
	endif

	if ( Player->GetSpell "vn_lichskillslev55" == 1 )
		Player->RemoveSpell "vn_lichskillslev55"
		set removelevel to 13
	endif
	if ( Player->GetSpell "vn_lichskillslev60" == 1 )
		Player->RemoveSpell "vn_lichskillslev60"
		set removelevel to 14
	endif
	if ( Player->GetSpell "vn_lichskillslev65" == 1 )
		Player->RemoveSpell "vn_lichskillslev65"
		set removelevel to 15
	endif
	if ( Player->GetSpell "vn_lichskillslev70" == 1 )
		Player->RemoveSpell "vn_lichskillslev70"
		set removelevel to 16
	endif
	if ( Player->GetSpell "vn_lichskillslev75" == 1 )
		Player->RemoveSpell "vn_lichskillslev75"
		set removelevel to 17
	endif
	set state to 1
endif

if ( state == 1 )
	if ( removelevel == 1 )
		set temp to 1
		set temp2 to 1
		set temp3 to 1
	else
		set removelevel to ( removelevel - 1 ) ; since lvl5 = 2 and should be 1
		set temp to ( removelevel * 4 )
		set temp2 to ( removelevel * 5 )
		set temp3 to ( removelevel * 6 )
	endif
	if ( removelevel > 0 )
		set Gals_Natural_Alchemy to ( Gals_Natural_Alchemy - temp )
		set Gals_Natural_Restoration to ( Gals_Natural_Restoration - temp )
		set Gals_Natural_Alteration to ( Gals_Natural_Alteration - temp2 )
		set Gals_Natural_Destruction to ( Gals_Natural_Destruction - temp2 )
		set Gals_Natural_Enchant to ( Gals_Natural_Enchant - temp2 )
		set Gals_Natural_Mysticism to ( Gals_Natural_Mysticism - temp2 )
		set Gals_Natural_Conjuration to ( Gals_Natural_Conjuration - temp3 )
		set Gals_Natural_Illusion to ( Gals_Natural_Illusion - temp3 )
	endif
	set state to 2
endif

if ( state == 2 )
	set state to 0
	set vn_skillremove_done to 1
	StopScript "vn_lichskillremove"
endif

End

# vn_lichspelladd =============================================================
Begin vn_lichspelladd

; is this script overcrowded? shoudl I split it?

long pclev
long temp
long temp2
short state
short active
; 5

short pnf_fake_death
short pnf_heal_undead
short pnf_reduced_decay	; non-spell power
short pnf_turn_undead
short pnf_reanimate
short pnf_dissolve_flesh
short pnf_raise_dead2
short pnf_regeneration
short pnf_undead_legion
short pnf_unholy_animation
; 15

short psf_lunar_magicka	; in other script
short psf_explosive_rat
short psf_enchant_mastery	; non-spell power
short psf_detection
short psf_resist_weapons
short psf_magicka_boon
short psf_consume_soul
short psf_godmode
short psf_petrify 
short psf_chicken
; 25

short ppf_pacify
short ppf_beast_detect
short ppf_reduce_bounty
short ppf_packrat
; short ppf_fear_aura	; non-spell power
short ppf_beast_mastery
short ppf_voice_of_the_lich
short ppf_terror
short ppf_fame
short ppf_command
; 37

short pvf_bloodrage
short pvf_stealskills
short xxx ; 32
short xxxx ; 33
short xxxxx ; 34
short pvf_superspeed 
short pvf_frenzy
; short pvf_daywalking
short pvf_brainwash
short pvf_vampbite
short pvf_absorbmagicka
short pvf_consume
; 45

short levelcount

if ( active == 0 )
	return
endif

if ( state == 0 )
	set state to 1
endif

if ( state == 1 )
	; MessageBox "state 1"
	if ( vn_lich_vamp == 1 )
		if ( vn_blood > 1475 )
			set temp2 to 10
		elseif ( vn_blood > 1225 )
			set temp2 to 9
		elseif ( vn_blood > 1000 )
			set temp2 to 8
		elseif ( vn_blood > 800 )
			set temp2 to 7
		elseif ( vn_blood > 625 )
			set temp2 to 6
		elseif ( vn_blood > 475 )
			set temp2 to 5
		elseif ( vn_blood > 350 )
			set temp2 to 4
		elseif ( vn_blood > 250 )
			set temp2 to 3
		elseif ( vn_blood > 175 )
			set temp2 to 2
		elseif ( vn_blood > 125 )
			set temp2 to 1
		else
			set temp2 to 0
		endif
		set pclev to ( temp2 * 5 ) 
		set pclev to ( pclev + 1 )
		; 4, 9, 14 etc.... so 1 = 1st bonus set.
		; MessageBox "Adjusted pclevel is %.2f", pclev
		set temp to ( temp2 + 1 )
	else
		set temp to ( vn_avenue_sorcery - 7 )
		set temp2 to ( temp * 2 )
		set temp to ( Player->GetLevel )
		set pclev to ( temp + temp2 ) ; sorcery skill compensation
		if ( pclev <= 0 )
			set pclev to 1 
		endif
		; MessageBox "Adjusted pclevel is %.2f", pclev
		if ( pclev < 5 )
			set temp to 1
		elseif ( pclev < 10 )
			set temp to 2
		elseif ( pclev < 15 )
			set temp to 3
		elseif ( pclev < 20 )
			set temp to 4
		elseif ( pclev < 25 )
			set temp to 5
		elseif ( pclev < 30 )
			set temp to 6
		elseif ( pclev < 35 )
			set temp to 7
		elseif ( pclev < 40 )
			set temp to 8
		elseif ( pclev < 45 )
			set temp to 9
		elseif ( pclev < 50 )
			set temp to 10
		elseif ( pclev < 55 )
			set temp to 11
		elseif ( pclev < 60 )
			set temp to 12
		elseif ( pclev < 65 )
			set temp to 13
		elseif ( pclev < 70 )
			set temp to 14
		elseif ( pclev < 75 )
			set temp to 15
		else
			set temp to 16
		endif
		; set HERE
	endif

	; TEMP now holds multiplyer.
	set temp2 to 0 ; override flag.
	if ( temp == 0 )
		set temp2 to 1
	endif

	set state to 21
endif

; ADD GCD STUFF
if ( state == 21 )
	; Check the bonuses aren't already there before you apply changes!
	; MessageBox "State 21"

	; attribute bonuses (will, int) are functions of the Player's level /5
	; 0 = 1
	; 1 = 5
	; 2 = 10
	if ( Player->GetSpell "vn_lichattrlev1" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev5" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev10" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev15" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev20" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev25" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev30" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev35" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev40" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev45" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev50" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev55" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev60" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev65" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev70" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichattrlev75" == 1 )
		set temp2 to 1
	endif

	; MessageBox "21 using"

	if ( temp2 != 1 )
		if ( temp == 1 )
			set Gals_Natural_Willpower to ( Gals_Natural_Willpower + 1 )
			set Gals_Natural_Intelligence to ( Gals_Natural_Intelligence + 1 )
		else
			set temp to ( temp - 1 )
			set temp2 to ( temp * 5 )
			set Gals_Natural_Willpower to ( Gals_Natural_Willpower + temp2 )
			set Gals_Natural_Intelligence to ( Gals_Natural_Intelligence + temp2 )
			set temp to ( temp + 1 )
		endif
	endif
	set state to 22
	set temp2 to 0

	; MessageBox "21 ending"
endif

if ( state == 22 )
	; now the attributes
	; MessageBox "22 starting"
	if ( Player->GetSpell "vn_lichskillslev1" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev5" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev10" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev15" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev20" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev25" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev30" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev35" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev40" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev45" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev50" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev55" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev60" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev65" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev70" == 1 )
		set temp2 to 1
	elseif ( Player->GetSpell "vn_lichskillslev75" == 1 )
		set temp2 to 1
	endif

	; MessageBox "22 using"

	if ( temp2 != 1 )
		if ( temp == 1 )
			set Gals_Natural_Alchemy to ( Gals_Natural_Alchemy + 1 )
			set Gals_Natural_Restoration to ( Gals_Natural_Restoration + 1 )
			set Gals_Natural_Alteration to ( Gals_Natural_Alteration + 1 )
			set Gals_Natural_Destruction to ( Gals_Natural_Destruction + 1 )
			set Gals_Natural_Enchant to ( Gals_Natural_Enchant + 1 )
			set Gals_Natural_Mysticism to ( Gals_Natural_Mysticism + 1 )
			set Gals_Natural_Conjuration to ( Gals_Natural_Conjuration + 1 )
			set Gals_Natural_Illusion to ( Gals_Natural_Illusion + 1 )
		else
			set temp to ( temp - 1 )
			set temp2 to ( temp * 4 )
			set Gals_Natural_Alchemy to ( Gals_Natural_Alchemy + temp2 )
			set Gals_Natural_Restoration to ( Gals_Natural_Restoration + temp2 )
			set temp2 to ( temp * 5 )
			set Gals_Natural_Alteration to ( Gals_Natural_Alteration + temp2 )
			set Gals_Natural_Destruction to ( Gals_Natural_Destruction + temp2 )
			set Gals_Natural_Enchant to ( Gals_Natural_Enchant + temp2 )
			set Gals_Natural_Mysticism to ( Gals_Natural_Mysticism + temp2 )
			set temp2 to ( temp * 6 )
			set Gals_Natural_Conjuration to ( Gals_Natural_Conjuration + temp2 )
			set Gals_Natural_Illusion to ( Gals_Natural_Illusion + temp2 )
			set temp to ( temp + 1 )
		endif
	endif
	; MessageBox "22 ending"
	set state to 2
endif

if ( state == 2 )
	if ( pclev < 5 )
		; MessageBox "Adding bonuses 1"
		if ( Player->GetSpell "vn_lichattrlev1" == 0 )
			Player->AddSpell "vn_lichattrlev1"
		endif
		if ( Player->GetSpell "vn_lichskillslev1" == 0 )
			Player->AddSpell "vn_lichskillslev1"
		endif
		if ( Player->GetSpell "vn_lichbonuslev1" == 0 )
			Player->AddSpell "vn_lichbonuslev1"
		endif
	elseif ( pclev < 10 )
		; MessageBox "Adding bonuses 5"
		if ( Player->GetSpell "vn_lichattrlev5" == 0 )
			Player->AddSpell "vn_lichattrlev5"
		endif
		if ( Player->GetSpell "vn_lichskillslev5" == 0 )
			Player->AddSpell "vn_lichskillslev5"
		endif
		if ( Player->GetSpell "vn_lichbonuslev5" == 0 )
			Player->AddSpell "vn_lichbonuslev5"
		endif
	elseif ( pclev < 15 )
		; MessageBox "Adding bonuses 10"
		if ( Player->GetSpell "vn_lichattrlev10" == 0 )
			Player->AddSpell "vn_lichattrlev10"
		endif
		if ( Player->GetSpell "vn_lichskillslev10" == 0 )
			Player->AddSpell "vn_lichskillslev10"
		endif
		if ( Player->GetSpell "vn_lichbonuslev10" == 0 )
			Player->AddSpell "vn_lichbonuslev10"
		endif
	elseif ( pclev < 20 )
		; MessageBox "Adding bonuses 15"
		if ( Player->GetSpell "vn_lichattrlev15" == 0 )
			Player->AddSpell "vn_lichattrlev15"
		endif
		if ( Player->GetSpell "vn_lichskillslev15" == 0 )
			Player->AddSpell "vn_lichskillslev15"
		endif
		if ( Player->GetSpell "vn_lichbonuslev15" == 0 )
			Player->AddSpell "vn_lichbonuslev15"
		endif
	elseif ( pclev < 25 ) 
		; MessageBox "Adding bonuses 20"
		if ( Player->GetSpell "vn_lichattrlev20" == 0 )
			Player->AddSpell "vn_lichattrlev20"
		endif
		if ( Player->GetSpell "vn_lichskillslev20" == 0 )
			Player->AddSpell "vn_lichskillslev20"
		endif
		if ( Player->GetSpell "vn_lichbonuslev20" == 0 )
			Player->AddSpell "vn_lichbonuslev20"
		endif
	elseif ( pclev < 30 )
		; MessageBox "Adding bonuses 25"
		if ( Player->GetSpell "vn_lichattrlev25" == 0 )
			Player->AddSpell "vn_lichattrlev25"
		endif
		if ( Player->GetSpell "vn_lichskillslev25" == 0 )
			Player->AddSpell "vn_lichskillslev25"
		endif
		if ( Player->GetSpell "vn_lichbonuslev25" == 0 )
			Player->AddSpell "vn_lichbonuslev25"
		endif
	elseif ( pclev < 35 ) 
		; MessageBox "Adding bonuses 30"
		if ( Player->GetSpell "vn_lichattrlev30" == 0 )
			Player->AddSpell "vn_lichattrlev30"
		endif
		if ( Player->GetSpell "vn_lichskillslev30" == 0 )
			Player->AddSpell "vn_lichskillslev30"
		endif
		if ( Player->GetSpell "vn_lichbonuslev30" == 0 )
			Player->AddSpell "vn_lichbonuslev30"
		endif
	elseif ( pclev < 40 )
		; MessageBox "Adding bonuses 35"
		if ( Player->GetSpell "vn_lichattrlev35" == 0 )
			Player->AddSpell "vn_lichattrlev35"
		endif
		if ( Player->GetSpell "vn_lichskillslev35" == 0 )
			Player->AddSpell "vn_lichskillslev35"
		endif
		if ( Player->GetSpell "vn_lichbonuslev35" == 0 )
			Player->AddSpell "vn_lichbonuslev35"
		endif
	elseif ( pclev < 45 ) 
		; MessageBox "Adding bonuses 40"
		if ( Player->GetSpell "vn_lichattrlev40" == 0 )
			Player->AddSpell "vn_lichattrlev40"
		endif
		if ( Player->GetSpell "vn_lichskillslev40" == 0 )
			Player->AddSpell "vn_lichskillslev40"
		endif
		if ( Player->GetSpell "vn_lichbonuslev40" == 0 )
			Player->AddSpell "vn_lichbonuslev40"
		endif
	elseif ( pclev < 50 )
		; MessageBox "Adding bonuses 45"
		if ( Player->GetSpell "vn_lichattrlev45" == 0 )
			Player->AddSpell "vn_lichattrlev45"
		endif
		if ( Player->GetSpell "vn_lichskillslev45" == 0 )
			Player->AddSpell "vn_lichskillslev45"
		endif
		if ( Player->GetSpell "vn_lichbonuslev45" == 0 )
			Player->AddSpell "vn_lichbonuslev45"
		endif
	elseif ( pclev < 55 )
		; MessageBox "Adding bonuses 50"
		if ( Player->GetSpell "vn_lichattrlev50" == 0 )
			Player->AddSpell "vn_lichattrlev50"
		endif
		if ( Player->GetSpell "vn_lichskillslev50" == 0 )
			Player->AddSpell "vn_lichskillslev50"
		endif
		if ( Player->GetSpell "vn_lichbonuslev50" == 0 )
			Player->AddSpell "vn_lichbonuslev50"
		endif	
	elseif ( pclev < 60 )
		; MessageBox "Adding bonuses 55"
		if ( Player->GetSpell "vn_lichattrlev55" == 0 )
			Player->AddSpell "vn_lichattrlev55"
		endif
		if ( Player->GetSpell "vn_lichskillslev55" == 0 )
			Player->AddSpell "vn_lichskillslev55"
		endif
		if ( Player->GetSpell "vn_lichbonuslev55" == 0 )
			Player->AddSpell "vn_lichbonuslev55"
		endif
	elseif ( pclev < 65 ) 
		; MessageBox "Adding bonuses 60"
		if ( Player->GetSpell "vn_lichattrlev60" == 0 )
			Player->AddSpell "vn_lichattrlev60"
		endif
		if ( Player->GetSpell "vn_lichskillslev60" == 0 )
			Player->AddSpell "vn_lichskillslev60"
		endif
		if ( Player->GetSpell "vn_lichbonuslev60" == 0 )
			Player->AddSpell "vn_lichbonuslev60"
		endif
	elseif ( pclev < 70 )
		; MessageBox "Adding bonuses 65"
		if ( Player->GetSpell "vn_lichattrlev65" == 0 )
			Player->AddSpell "vn_lichattrlev65"
		endif
		if ( Player->GetSpell "vn_lichskillslev65" == 0 )
			Player->AddSpell "vn_lichskillslev65"
		endif
		if ( Player->GetSpell "vn_lichbonuslev65" == 0 )
			Player->AddSpell "vn_lichbonuslev65"
		endif
	elseif ( pclev < 75 ) 
		; MessageBox "Adding bonuses 70"
		if ( Player->GetSpell "vn_lichattrlev70" == 0 )
			Player->AddSpell "vn_lichattrlev70"
		endif
		if ( Player->GetSpell "vn_lichskillslev70" == 0 )
			Player->AddSpell "vn_lichskillslev70"
		endif
		if ( Player->GetSpell "vn_lichbonuslev70" == 0 )
			Player->AddSpell "vn_lichbonuslev70"
		endif
	else
		; MessageBox "Adding bonuses 75"
		if ( Player->GetSpell "vn_lichattrlev75" == 0 )
			Player->AddSpell "vn_lichattrlev75"
		endif
		if ( Player->GetSpell "vn_lichskillslev75" == 0 )
			Player->AddSpell "vn_lichskillslev75"
		endif
		if ( Player->GetSpell "vn_lichbonuslev75" == 0 )
			Player->AddSpell "vn_lichbonuslev75"
		endif
	endif
	set state to 3
endif

if ( state == 3 )
	; lichgood is now dependant on sorcery level
	if ( vn_avenue_sorcery == 0 )
		if ( Player->GetSpell "vn_lichgood0" == 0 )
			Player->AddSpell "vn_lichgood0"
		endif
	elseif ( vn_avenue_sorcery == 1 )
		if ( Player->GetSpell "vn_lichgood1" == 0 )
			Player->AddSpell "vn_lichgood1"
		endif
	elseif ( vn_avenue_sorcery == 2 )
		if ( Player->GetSpell "vn_lichgood2" == 0 )
			Player->AddSpell "vn_lichgood2"
		endif
	elseif ( vn_avenue_sorcery == 3 )
		if ( Player->GetSpell "vn_lichgood3" == 0 )
			Player->AddSpell "vn_lichgood3"
		endif
	elseif ( vn_avenue_sorcery == 4 )
		if ( Player->GetSpell "vn_lichgood4" == 0 )
			Player->AddSpell "vn_lichgood4"
		endif
	elseif ( vn_avenue_sorcery == 5 )
		if ( Player->GetSpell "vn_lichgood5" == 0 )
			Player->AddSpell "vn_lichgood5"
		endif
	elseif ( vn_avenue_sorcery == 6 )
		if ( Player->GetSpell "vn_lichgood6" == 0 )
			Player->AddSpell "vn_lichgood6"
		endif
	elseif ( vn_avenue_sorcery == 7 )
		if ( Player->GetSpell "vn_lichgood7" == 0 )
			Player->AddSpell "vn_lichgood7"
		endif
	elseif ( vn_avenue_sorcery == 8 )
		if ( Player->GetSpell "vn_lichgood8" == 0 )
			Player->AddSpell "vn_lichgood8"
		endif
	elseif ( vn_avenue_sorcery == 9 )
		if ( Player->GetSpell "vn_lichgood9" == 0 )
			Player->AddSpell "vn_lichgood9"
		endif
	elseif ( vn_avenue_sorcery == 10 )
		if ( Player->GetSpell "vn_lichgood10" == 0 )
			Player->AddSpell "vn_lichgood10"
		endif
	elseif ( vn_avenue_sorcery == 11 )
		if ( Player->GetSpell "vn_lichgood11" == 0 )
			Player->AddSpell "vn_lichgood11"
		endif
	elseif ( vn_avenue_sorcery > 11 )
		if ( Player->GetSpell "vn_lichgood12" == 0 )
			Player->AddSpell "vn_lichgood12"
		endif
	endif
	set state to 4
endif

if ( state == 4 )
	if ( Player->GetSpell "vn_lichimmunities" == 0 )
		Player->AddSpell "vn_lichimmunities"
	endif
	if ( Player->GetSpell "vn_lich_spellmaking" == 0 )
		Player->AddSpell "vn_lich_spellmaking"
	endif
	if ( Player->GetSpell "vn_lich_enchanting" == 0 )
		Player->AddSpell "vn_lich_enchanting"
	endif
	if ( Player->GetSpell "vn_power_ritual_spell" == 0 )
		Player->AddSpell "vn_power_ritual_spell"
	endif
	if ( Player->GetSpell "vn_bodysteal" == 0 )
		Player->AddSpell "vn_bodysteal"
	endif
	if ( Player->GetSpell "vn_raise_dead" == 0 )
		Player->AddSpell "vn_raise_dead"
	endif
	if ( Player->GetSpell "vn_follower_teleport" == 0 )
		Player->AddSpell "vn_follower_teleport"
	endif
;	if ( Player->GetSpell "vn_set_waypoint" == 0 )
;		Player->AddSpell "vn_set_waypoint"
;	endif
	if ( Player->GetSpell "vn_lichbad" == 0 )
		Player->AddSpell "vn_lichbad"
		set Gals_Natural_Strength to ( Gals_Natural_Strength - 15 )
		set Gals_Natural_Agility to ( Gals_Natural_Agility - 25 )
		set Gals_Natural_Personality to ( Gals_Natural_Personality - 100 )
	endif
	if ( vn_wearinglich == 1 ) ; if ( lich add disguise spell )
		if ( Player->GetSpell "vn_lich_transform" == 0 )
			Player->AddSpell "vn_lich_transform"
		endif
		Player->RemoveSpell "vn_lich_transform_back"
		Player->RemoveSpell "vn_lichcurse"
	endif
	if ( vn_wearinglich == 0 ) ; if ( disguised ( should not happen but might  add revert and disguise penalty )
		Player->RemoveSpell "vn_lich_transform"
		if ( Player->GetSpell "vn_lich_transform_back" == 0 )
			Player->AddSpell "vn_lich_transform_back"
		endif
		if ( Player->GetSpell "vn_lichcurse" == 0 )
			Player->AddSpell "vn_lichcurse"	
		endif
	endif
	if ( vn_lich_vamp == 1 )
		if ( Player->GetSpell "vn_pv_bloodconversion_ON" == 0 )
			Player->AddSpell "vn_pv_bloodconversion_ON"
		endif
	endif
	set state to 5
endif

if ( state == 5 )
	if ( pnf_fake_death > 0 )
		if ( Player->GetSpell "vn_pn_fake_death" == 0 )
			Player->AddSpell "vn_pn_fake_death"
		endif
	endif
	if ( pnf_heal_undead > 0 )
		if ( Player->GetSpell "vn_pn_heal_undead_horde" == 0 )
			Player->AddSpell "vn_pn_heal_undead_horde"
		endif
	endif
	if ( pnf_turn_undead > 0 )
		if ( Player->GetSpell "vn_pn_turn_undead" == 0 )
			Player->AddSpell "vn_pn_turn_undead"
		endif
	endif
	if ( pnf_reanimate > 0 )
		if ( Player->GetSpell "vn_pn_reanimate" == 0 )
			Player->AddSpell "vn_pn_reanimate"
		endif
	endif
	if ( pnf_dissolve_flesh > 0 )
		if ( Player->GetSpell "vn_pn_dissolve_flesh" == 0 )
			Player->AddSpell "vn_pn_dissolve_flesh"
		endif
	endif
	if ( pnf_raise_dead2 > 0 )
		if ( Player->GetSpell "vn_pn_raise_dead" == 0 )
			Player->AddSpell "vn_pn_raise_dead"
		endif
	endif
	if ( pnf_regeneration > 0 )
		if ( Player->GetSpell "vn_pn_regeneration" == 0 )
			Player->AddSpell "vn_pn_regeneration"
		endif
	endif
	if ( pnf_undead_legion > 0 )
		if ( Player->GetSpell "vn_pn_undead_legion" == 0 )
			Player->AddSpell "vn_pn_undead_legion"
		endif
	endif
	if ( pnf_unholy_animation > 0 )
		if ( Player->GetSpell "vn_pn_unholy_animation" == 0 )
			Player->AddSpell "vn_pn_unholy_animation"
		endif
	endif
	set state to 6
endif

if ( state == 6 )
	if ( psf_explosive_rat > 0 )
		if ( Player->GetSpell "vn_ps_explosive_rat" == 0 )
			Player->AddSpell "vn_ps_explosive_rat"
		endif
	endif
	if ( psf_detection > 0 )
		if ( Player->GetSpell "vn_ps_detect" == 0 )
			Player->AddSpell "vn_ps_detect"
		endif
	endif
	if ( psf_resist_weapons > 0 )
		if ( Player->GetSpell "vn_ps_resist_weapons" == 0 )
			Player->AddSpell "vn_ps_resist_weapons"
		endif
	endif
	if ( psf_magicka_boon > 0 )
		if ( Player->GetSpell "vn_ps_magicka_boon" == 0 )
			Player->AddSpell "vn_ps_magicka_boon"
		endif
	endif
	if ( psf_consume_soul > 0 )
		if ( Player->GetSpell "vn_ps_consume_soul" == 0 )
			Player->AddSpell "vn_ps_consume_soul"
		endif
	endif
	if ( psf_godmode > 0 )
		if ( Player->GetSpell "vn_ps_godmode" == 0 )
			Player->AddSpell "vn_ps_godmode"
		endif
	endif
	if ( psf_petrify > 0 )
		if ( Player->GetSpell "vn_ps_petrify" == 0 )
			Player->AddSpell "vn_ps_petrify"
		endif
	endif
	if ( psf_chicken > 0 )
		if ( Player->GetSpell "vn_ps_chicken" == 0 )
			Player->AddSpell "vn_ps_chicken"
		endif
	endif
	set state to 7
endif

if ( state == 7 )
	if ( ppf_pacify > 0 )
		if ( Player->GetSpell "vn_pp_peace" == 0 )
			Player->AddSpell "vn_pp_peace"
		endif
	endif
	if ( ppf_beast_detect > 0 )
		if ( Player->GetSpell "vn_pp_beast_detect" == 0 )
			Player->AddSpell "vn_pp_beast_detect"
		endif
	endif
	if ( ppf_reduce_bounty > 0 )
		if ( Player->GetSpell "vn_pp_reduce_notoriety" == 0 )
			Player->AddSpell "vn_pp_reduce_notoriety"
		endif
	endif
	if ( ppf_packrat > 0 )
		if ( Player->GetSpell "vn_pp_packrat" == 0 )
			Player->AddSpell "vn_pp_packrat"
		endif
	endif
	if ( ppf_beast_mastery > 0 )
		if ( Player->GetSpell "vn_pp_beast_mastery" == 0 )
			Player->AddSpell "vn_pp_beast_mastery"
		endif
	endif
	if ( ppf_voice_of_the_lich > 0 )
		if ( Player->GetSpell "vn_pp_voice" == 0 )
			Player->AddSpell "vn_pp_voice"
		endif
	endif
	if ( ppf_terror > 0 )
		if ( Player->GetSpell "vn_pp_terror" == 0 )
			Player->AddSpell "vn_pp_terror"
		endif
	endif
	if ( ppf_fame > 0 )
		if ( Player->GetSpell "vn_pp_fame" == 0 )
			Player->AddSpell "vn_pp_fame"
		endif
	endif
	if ( ppf_command > 0 )
		if ( Player->GetSpell "vn_pp_command" == 0 )
			Player->AddSpell "vn_pp_command"
		endif
	endif
	set state to 8
endif

if ( state == 8 )
	; MessageBox "state 8"
	if ( pvf_bloodrage > 0 )
		if ( Player->GetSpell "vn_pv_bloodrage" == 0 )
			Player->AddSpell "vn_pv_bloodrage"
		endif
	endif
	if ( pvf_stealskills > 0 )
		if ( Player->GetSpell "vn_pv_stealskills" == 0 )
			Player->AddSpell "vn_pv_stealskills"
		endif
	endif
	if ( pvf_superspeed > 0 )
		if ( Player->GetSpell "vn_pv_superspeed_ON" == 0 )
			Player->AddSpell "vn_pv_superspeed_ON"
		endif
		if ( Player->GetSpell "vn_pv_superspeed_OFF" == 0 )
			Player->AddSpell "vn_pv_superspeed_OFF"
		endif
	endif
	if ( pvf_frenzy > 0 )
		if ( Player->GetSpell "vn_pv_frenzy" == 0 )
			Player->AddSpell "vn_pv_frenzy"
		endif
	endif
	if ( pvf_brainwash > 0 )
		if ( Player->GetSpell "vn_pv_brainwash" == 0 )
			Player->AddSpell "vn_pv_brainwash"
		endif
	endif
	if ( pvf_vampbite > 0 )
		if ( Player->GetSpell "vn_pv_vampbite" == 0 )
			Player->AddSpell "vn_pv_vampbite"
		endif
	endif
	if ( pvf_absorbmagicka > 0 )
		if ( Player->GetSpell "vn_pv_absorbmagicka" == 0 )
			Player->AddSpell "vn_pv_absorbmagicka"
		endif
	endif
	if ( pvf_consume > 0 )
		if ( Player->GetSpell "vn_pv_consume" == 0 )
			Player->AddSpell "vn_pv_consume"
		endif
	endif

	; MessageBox "End state 8"
	set state to 9
endif

if ( state == 9 )
	; MessageBox, "all spells added in spellAdd script"
	set active to 0
	set state to 0
endif

End

# vn_lichspellmakingscript ====================================================
Begin vn_lichspellmakingscript

short noattack
short nohit

long StartGold
long CurrentGold
long AfterGold1
short GoodbyeOnce

StopCombat

; MessageBox "Testing That this even executes"
; if ( MenuMode == 0 )
;	MessageBox "MenuMode off"
; else
;	MessageBox "MenuMode on"
; endif

if ( vn_spellmakestate == 0 )
;	MessageBox "state 0"
	set StartGold to ( Player->GetItemCount "Gold_001" )
	set AfterGold1 to ( StartGold + 30000 )
	Player->AddItem "Gold_001" 30000
	set vn_spellmakestate to 1
	return
endif

if ( vn_spellmakestate == 1 )
;	MessageBox "state 1"
	ForceGreeting
	set vn_spellmakestate to 2
	return
endif

if ( vn_spellmakestate == 2 )
; End if ( gold changed OR talked & no menu )
;	MessageBox "state 2"
	if ( GoodbyeOnce == 0 )
		set CurrentGold to ( Player->GetItemCount "Gold_001" )
		if ( currentgold != AfterGold1 )
			Goodbye
			set GoodbyeOnce to 1
			set vn_spellmakestate to 3
			return
		endif
	endif
	if ( vn_spelltalked == 1 )
		if ( MenuMode == 0 )
;			MessageBox "Player said Goodbye without crating spell"
			set goodbyeonce to 1
			set vn_spellmakestate to 3
			set vn_spelltalked to 0
			return
		endif
	endif
endif

if ( vn_spellmakestate == 3 )
	if ( MenuMode == 0 )
;		MessageBox "Resetting gold to %.2f...please wait", startgold
		set CurrentGold to ( Player->GetItemCount "Gold_001" )
		if ( CurrentGold > ( StartGold + 2047 ) )
			Player->RemoveItem "Gold_001", 2048
		elseif ( CurrentGold > ( StartGold + 1023 ) )
			Player->RemoveItem "Gold_001" 1024
		elseif ( CurrentGold > ( StartGold + 511 ) )
			Player->RemoveItem "Gold_001" 512
		elseif ( CurrentGold > ( StartGold + 255 ) )
			Player->RemoveItem "Gold_001" 256 
		elseif ( CurrentGold > ( StartGold + 127 ) )
			Player->RemoveItem "Gold_001" 128
		elseif ( CurrentGold > ( StartGold + 63 ) )
			Player->RemoveItem "Gold_001" 64
		elseif ( CurrentGold > ( StartGold + 31 ) )
			Player->RemoveItem "Gold_001" 32
		elseif ( CurrentGold > ( StartGold + 15 ) )
			Player->RemoveItem "Gold_001" 16
		elseif ( CurrentGold > ( StartGold + 7 ) )
			Player->RemoveItem "Gold_001" 8
		elseif ( CurrentGold > ( StartGold + 3 ) )
			Player->RemoveItem "Gold_001" 4
		elseif ( CurrentGold > ( StartGold + 1 ) )
			Player->RemoveItem "Gold_001" 2
		elseif ( CurrentGold > StartGold )
			Player->RemoveItem "Gold_001" 1
		elseif ( CurrentGold < ( StartGold - 2047 ) )
			Player->AddItem "Gold_001" 2048
		elseif ( CurrentGold < ( StartGold - 1023 ) )
			Player->AddItem "Gold_001" 1024
		elseif ( CurrentGold < ( StartGold - 511 ) )
			Player->AddItem "Gold_001" 512
		elseif ( CurrentGold < ( StartGold - 255 ) )
			Player->AddItem "Gold_001" 256
		elseif ( CurrentGold < ( StartGold - 127 ) )
			Player->AddItem "Gold_001" 128
		elseif ( CurrentGold < ( StartGold - 63 ) )
			Player->AddItem "Gold_001" 64
		elseif ( CurrentGold < ( StartGold - 31 ) )
			Player->AddItem "Gold_001" 32
		elseif ( CurrentGold < ( StartGold - 15 ) )
			Player->AddItem "Gold_001" 16
		elseif ( CurrentGold < ( StartGold - 7 ) )
			Player->AddItem "Gold_001" 8
		elseif ( CurrentGold < ( StartGold - 3 ) )
			Player->AddItem "Gold_001" 4
		elseif ( CurrentGold < ( StartGold - 2 ) )
			Player->AddItem "Gold_001" 3
		elseif ( CurrentGold < ( StartGold - 1 ) )
			Player->AddItem "Gold_001" 2
		elseif ( CurrentGold < StartGold )
			Player->AddItem "Gold_001" 1
		elseif ( CurrentGold == StartGold )
;			MessageBox "Gold from spellcrafting has been reset"
			set vn_spelltalked to 0
			set vn_spellmakestate to -1
			Disable
			SetDelete 1
		endif
	endif
endif

End vn_spellmakingscript

# vn_lichspellremove ==========================================================
Begin vn_lichspellremove

; when is this used???
; --used by levelup script, since lichgood must be re-applied then. Must be used elsewhere though??
; or else I'd have removed skills here, surely?
; Well, since it's not broke I won't fix it. This is what happens when you don't touch a mod for 6 months...

; does NOT remove skills???

; removes abilities
; removes attributes
; removes bonuses
; removes lich powers
; removes avenue powers
; MIGHT remove skills - only if mad leveller used

short state
short removelevel
short temp
short temp2
short temp3

if ( state == 0 )
	
	; check if mad leveller needs skills removed
	if ( mlRemoved == 1 )
		StartScript "vn_lichskillremove"
	endif

	Player->RemoveSpell "vn_lichgood0"
	Player->RemoveSpell "vn_lichgood1"
	Player->RemoveSpell "vn_lichgood2"
	Player->RemoveSpell "vn_lichgood3"
	Player->RemoveSpell "vn_lichgood4"
	Player->RemoveSpell "vn_lichgood5"
	Player->RemoveSpell "vn_lichgood6"
	Player->RemoveSpell "vn_lichgood7"
	Player->RemoveSpell "vn_lichgood8"
	Player->RemoveSpell "vn_lichgood9"
	Player->RemoveSpell "vn_lichgood10"
	Player->RemoveSpell "vn_lichgood11"
	Player->RemoveSpell "vn_lichgood12"

	set state to 1
endif

if ( state == 1 )

if ( Player->GetSpell "vn_bodysteal" == 1 )
	Player->RemoveSpell "vn_bodysteal"
endif

if ( Player->GetSpell "vn_power_ritual_spell" == 1 )
	Player->RemoveSpell "vn_power_ritual_spell"
endif

if ( Player->GetSpell "vn_raise_dead" == 1 )
	Player->RemoveSpell "vn_raise_dead"
endif

if ( Player->GetSpell "vn_follower_teleport" == 1 )
	Player->RemoveSpell "vn_follower_teleport"
endif

if ( Player->GetSpell "vn_lich_spellmaking" == 1 )
	Player->RemoveSpell "vn_lich_spellmaking"
endif

if ( Player->GetSpell "vn_lich_enchanting" == 1 )
	Player->RemoveSpell "vn_lich_enchanting"
endif

if ( Player->GetSpell "vn_set_waypoint" == 1 )
	Player->RemoveSpell "vn_set_waypoint"
endif

Player->RemoveSpell "vn_lich_transform"
Player->RemoveSpell "vn_lich_transform_back"
Player->RemoveSpell "vn_lichcurse"

set state to 2 
endif

if ( state == 2 )

	if ( Player->GetSpell "vn_lichattrlev1" == 1 )
		Player->RemoveSpell "vn_lichattrlev1"
		set removelevel to 1
	endif

	if ( Player->GetSpell "vn_lichattrlev5" == 1 )
		Player->RemoveSpell "vn_lichattrlev5"
		set removelevel to 2
	endif

	if ( Player->GetSpell "vn_lichattrlev10" == 1 )
		Player->RemoveSpell "vn_lichattrlev10"
		set removelevel to 3
	endif

	if ( Player->GetSpell "vn_lichattrlev15" == 1 )
		Player->RemoveSpell "vn_lichattrlev15"
		set removelevel to 4
	endif

	if ( Player->GetSpell "vn_lichattrlev20" == 1 )
		Player->RemoveSpell "vn_lichattrlev20"
		set removelevel to 5
	endif

	if ( Player->GetSpell "vn_lichattrlev25" == 1 )
		Player->RemoveSpell "vn_lichattrlev25"
		set removelevel to 6
	endif

	if ( Player->GetSpell "vn_lichattrlev30" == 1 )
		Player->RemoveSpell "vn_lichattrlev30"
		set removelevel to 7
	endif

	if ( Player->GetSpell "vn_lichattrlev35" == 1 )
		Player->RemoveSpell "vn_lichattrlev35"
		set removelevel to 8
	endif

	if ( Player->GetSpell "vn_lichattrlev40" == 1 )
		Player->RemoveSpell "vn_lichattrlev40"
		set removelevel to 9
	endif

	if ( Player->GetSpell "vn_lichattrlev45" == 1 )
		Player->RemoveSpell "vn_lichattrlev45"
		set removelevel to 10
	endif

	if ( Player->GetSpell "vn_lichattrlev50" == 1 )
		Player->RemoveSpell "vn_lichattrlev50"
		set removelevel to 11
	endif

	if ( Player->GetSpell "vn_lichattrlev55" == 1 )
		Player->RemoveSpell "vn_lichattrlev55"
		set removelevel to 12
	endif

	if ( Player->GetSpell "vn_lichattrlev60" == 1 )
		Player->RemoveSpell "vn_lichattrlev60"
		set removelevel to 13
	endif

	if ( Player->GetSpell "vn_lichattrlev65" == 1 )
		Player->RemoveSpell "vn_lichattrlev65"
		set removelevel to 14
	endif

	if ( Player->GetSpell "vn_lichattrlev70" == 1 )
		Player->RemoveSpell "vn_lichattrlev70"
		set removelevel to 15
	endif

	if ( Player->GetSpell "vn_lichattrlev75" == 1 )
		Player->RemoveSpell "vn_lichattrlev75"
		set removelevel to 16
	endif

	set state to 3

endif

if ( state == 3 )

	Player->RemoveSpell "vn_Lichbonuslev1"
	Player->RemoveSpell "vn_Lichbonuslev5"
	Player->RemoveSpell "vn_Lichbonuslev10"
	Player->RemoveSpell "vn_Lichbonuslev15"
	Player->RemoveSpell "vn_Lichbonuslev20"
	Player->RemoveSpell "vn_Lichbonuslev25"
	Player->RemoveSpell "vn_Lichbonuslev30"
	Player->RemoveSpell "vn_Lichbonuslev35"
	Player->RemoveSpell "vn_Lichbonuslev40"
	Player->RemoveSpell "vn_Lichbonuslev45"
	Player->RemoveSpell "vn_Lichbonuslev50"
	Player->RemoveSpell "vn_Lichbonuslev55"
	Player->RemoveSpell "vn_Lichbonuslev60"
	Player->RemoveSpell "vn_Lichbonuslev65"
	Player->RemoveSpell "vn_Lichbonuslev70"
	Player->RemoveSpell "vn_Lichbonuslev75"

	set state to 4

endif

if ( state == 4 )

	if ( Player->GetSpell "vn_pn_fake_death" == 1 )
		Player->RemoveSpell "vn_pn_fake_death"
	endif

	if ( Player->GetSpell "vn_pn_heal_undead_horde" == 1 )
		Player->RemoveSpell "vn_pn_heal_undead_horde"
	endif

	if ( Player->GetSpell "vn_pn_turn_undead" == 1 )
		Player->RemoveSpell "vn_pn_turn_undead"
	endif

	if ( Player->GetSpell "vn_pn_reanimate" == 1 )
		Player->RemoveSpell "vn_pn_reanimate"
	endif

	if ( Player->GetSpell "vn_pn_dissolve_flesh" == 1 )
		Player->RemoveSpell "vn_pn_dissolve_flesh"
	endif

	if ( Player->GetSpell "vn_pn_raise_dead" == 1 )
		Player->RemoveSpell "vn_pn_raise_dead"
	endif

	if ( Player->GetSpell "vn_pn_regeneration" == 1 )
		Player->RemoveSpell "vn_pn_regeneration"
	endif

	if ( Player->GetSpell "vn_pn_undead_legion" == 1 )
		Player->RemoveSpell "vn_pn_undead_legion"
	endif

	if ( Player->GetSpell "vn_pn_unholy_animation" == 1 )
		Player->RemoveSpell "vn_pn_unholy_animation"
	endif

	set state to 5

endif

if ( state == 5 )

	if ( Player->GetSpell "vn_ps_explosive_rat" == 1 )
		Player->RemoveSpell "vn_ps_explosive_rat"
	endif

	if ( Player->GetSpell "vn_ps_detect" == 1 )
		Player->RemoveSpell "vn_ps_detect"
	endif

	if ( Player->GetSpell "vn_ps_resist_weapons" == 1 )
		Player->RemoveSpell "vn_ps_resist_weapons"
	endif

	if ( Player->GetSpell "vn_ps_magicka_boon" == 1 )
		Player->RemoveSpell "vn_ps_magicka_boon"
	endif

	if ( Player->GetSpell "vn_ps_consume_soul" == 1 )
		Player->RemoveSpell "vn_ps_consume_soul"
	endif

	if ( Player->GetSpell "vn_ps_godmode" == 1 )
		Player->RemoveSpell "vn_ps_godmode"
	endif

	if ( Player->GetSpell "vn_ps_petrify" == 1 )
		Player->RemoveSpell "vn_ps_petrify"
	endif

	if ( Player->GetSpell "vn_ps_chicken" == 1 )
		Player->RemoveSpell "vn_ps_chicken"
	endif

	set state to 6

endif

if ( state == 6 )

	if ( Player->GetSpell "vn_pp_peace" == 1 )
		Player->RemoveSpell "vn_pp_peace"
	endif

	if ( Player->GetSpell "vn_pp_beast_detect" == 1 )
		Player->RemoveSpell "vn_pp_beast_detect"
	endif

	if ( Player->GetSpell "vn_pp_reduce_notoriety" == 1 )
		Player->RemoveSpell "vn_pp_reduce_notoriety"
	endif

	if ( Player->GetSpell "vn_pp_packrat" == 1 )
		Player->RemoveSpell "vn_pp_packrat"
	endif

	if ( Player->GetSpell "vn_pp_beast_mastery" == 1 )
		Player->RemoveSpell "vn_pp_beast_mastery"
	endif

	if ( Player->GetSpell "vn_pp_voice" == 1 )
		Player->RemoveSpell "vn_pp_voice"
	endif

	if ( Player->GetSpell "vn_pp_terror" == 1 )
		Player->RemoveSpell "vn_pp_terror"
	endif

	if ( Player->GetSpell "vn_pp_fame" == 1 )
		Player->RemoveSpell "vn_pp_fame"
	endif

	if ( Player->GetSpell "vn_pp_command" == 1 )
		Player->RemoveSpell "vn_pp_command"
	endif

	set state to 7

endif

if ( state == 7 )

	if ( Player->GetSpell "vn_pv_bloodrage" == 1 )
		Player->RemoveSpell "vn_pv_bloodrage"
	endif

	if ( Player->GetSpell "vn_pv_absorbmagicka" == 1 )
		Player->RemoveSpell "vn_pv_absorbmagicka"
	endif

	if ( Player->GetSpell "vn_pv_vampbite" == 1 )
		Player->RemoveSpell "vn_pv_vampbite"
	endif

	if ( Player->GetSpell "vn_pv_consume" == 1 )
		Player->RemoveSpell "vn_pv_consume"
	endif

	if ( Player->GetSpell "vn_pv_brainwash" == 1 )
		Player->RemoveSpell "vn_pv_brainwash"
	endif

	if ( Player->GetSpell "vn_pv_frenzy" == 1 )
		Player->RemoveSpell "vn_pv_frenzy"
	endif

	if ( Player->GetSpell "vn_pv_stealskills" == 1 )
		Player->RemoveSpell "vn_pv_stealskills"
	endif

	if ( Player->GetSpell "vn_pv_superspeed_ON" == 1 )
		Player->RemoveSpell "vn_pv_superspeed_ON"
	endif

	if ( Player->GetSpell "vn_pv_superspeed_OFF" == 1 )
		Player->RemoveSpell "vn_pv_superspeed_OFF"
	endif

	set state to 8

endif

if ( state == 8 )

	if ( removelevel == 1 )
		set temp to 1
		set temp2 to 1
		set temp3 to 1
	else
		set removelevel to ( removelevel - 1 )
		set temp to ( removelevel * 4 )
		set temp2 to ( removelevel * 5 )
		set temp3 to ( removelevel * 6 )
	endif

	if ( removelevel > 0 )
		set Gals_Natural_Willpower to ( Gals_Natural_Willpower - temp2 )
		set Gals_Natural_Intelligence to ( Gals_Natural_Intelligence - temp2 )
	endif

	set state to 9

endif

if ( state == 9 )
	set vn_spellremove_done to 1
	set state to 0
	StopScript "vn_lichspellremove"
endif

End

# vn_lichspellremove_partial ==================================================
Begin vn_lichspellremove_partial

; called when you disguise yourself. Therefore...
; does NOT remove abilities (night vision, breathe underwater, magicka bonus etc)
; does NOT remove skills

; removes lich powers
; removes attributes
; removes bonuses
; removes avenue powers

short state
short removelevel
short temp
short temp2
short temp3

if ( state == 0 )
	; check if mad leveller needs skills removed -- no idea if i really need that here.
	if ( mlRemoved == 1 )
		StartScript "vn_lichskillremove"
	endif

	; lichgood not removed.

	set state to 1
endif

if ( state == 1 )

if ( Player->GetSpell "vn_bodysteal" == 1 )
	Player->RemoveSpell "vn_bodysteal"
endif
if ( Player->GetSpell "vn_power_ritual_spell" == 1 )
	Player->RemoveSpell "vn_power_ritual_spell"
endif
if ( Player->GetSpell "vn_raise_dead" == 1 )
	Player->RemoveSpell "vn_raise_dead"
endif
if ( Player->GetSpell "vn_follower_teleport" == 1 )
	Player->RemoveSpell "vn_follower_teleport"
endif
if ( Player->GetSpell "vn_lich_spellmaking" == 1 )
	Player->RemoveSpell "vn_lich_spellmaking"
endif
if ( Player->GetSpell "vn_lich_enchanting" == 1 )
	Player->RemoveSpell "vn_lich_enchanting"
endif
if ( Player->GetSpell "vn_set_waypoint" == 1 )
	Player->RemoveSpell "vn_set_waypoint"
endif
if ( vn_wearinglich == 0 ) ; expected
	Player->RemoveSpell "vn_lich_transform"
	if ( Player->GetSpell "vn_lich_transform_back" == 0 )
		Player->AddSpell "vn_lich_transform_back"
	endif
	if ( Player->GetSpell "vn_lichcurse" == 0 )
		Player->AddSpell "vn_lichcurse"	
	endif
endif
if ( vn_wearinglich == 1 ) ; shouldn't happen - should notbe in lich form if ( this script called. )
	if ( Player->GetSpell "vn_lich_transform" == 0 )
		Player->AddSpell "vn_lich_transform"
	endif
	Player->RemoveSpell "vn_lich_transform_back"
	Player->RemoveSpell "vn_lichcurse"
endif

set state to 2 
endif

if ( state == 2 )
	; if ( Player->GetSpell, "vn_lichbad" == 1 )
	;	Player->RemoveSpell, "vn_lichbad"
	;	set Gals_Natural_Strength to ( Gals_Natural_Strength + 15 )
	;	set Gals_Natural_Agility to ( Gals_Natural_Agility + 25 )
	;	set Gals_Natural_Personality to ( Gals_Natural_Personality + 100 )
	; endif
	if ( Player->GetSpell "vn_lichattrlev1" == 1 )
		Player->RemoveSpell "vn_lichattrlev1"
		set removelevel to 1
	endif
	if ( Player->GetSpell "vn_lichattrlev5" == 1 )
		Player->RemoveSpell "vn_lichattrlev5"
		set removelevel to 2
	endif
	if ( Player->GetSpell "vn_lichattrlev10" == 1 )
		Player->RemoveSpell "vn_lichattrlev10"
		set removelevel to 3
	endif
	if ( Player->GetSpell "vn_lichattrlev15" == 1 )
		Player->RemoveSpell "vn_lichattrlev15"
		set removelevel to 4
	endif
	if ( Player->GetSpell "vn_lichattrlev20" == 1 )
		Player->RemoveSpell "vn_lichattrlev20"
		set removelevel to 5
	endif
	if ( Player->GetSpell "vn_lichattrlev25" == 1 )
		Player->RemoveSpell "vn_lichattrlev25"
		set removelevel to 6
	endif
	if ( Player->GetSpell "vn_lichattrlev30" == 1 )
		Player->RemoveSpell "vn_lichattrlev30"
		set removelevel to 7
	endif
	if ( Player->GetSpell "vn_lichattrlev35" == 1 )
		Player->RemoveSpell "vn_lichattrlev35"
		set removelevel to 8
	endif
	if ( Player->GetSpell "vn_lichattrlev40" == 1 )
		Player->RemoveSpell "vn_lichattrlev40"
		set removelevel to 9
	endif
	if ( Player->GetSpell "vn_lichattrlev45" == 1 )
		Player->RemoveSpell "vn_lichattrlev45"
		set removelevel to 10
	endif
	if ( Player->GetSpell "vn_lichattrlev50" == 1 )
		Player->RemoveSpell "vn_lichattrlev50"
		set removelevel to 11
	endif
	if ( Player->GetSpell "vn_lichattrlev55" == 1 )
		Player->RemoveSpell "vn_lichattrlev55"
		set removelevel to 12
	endif
	if ( Player->GetSpell "vn_lichattrlev60" == 1 )
		Player->RemoveSpell "vn_lichattrlev60"
		set removelevel to 13
	endif
	if ( Player->GetSpell "vn_lichattrlev65" == 1 )
		Player->RemoveSpell "vn_lichattrlev65"
		set removelevel to 14
	endif
	if ( Player->GetSpell "vn_lichattrlev70" == 1 )
		Player->RemoveSpell "vn_lichattrlev70"
		set removelevel to 15
	endif
	if ( Player->GetSpell "vn_lichattrlev75" == 1 )
		Player->RemoveSpell "vn_lichattrlev75"
		set removelevel to 16
	endif
	set state to 3
endif

if ( state == 3 )
	Player->RemoveSpell "vn_Lichbonuslev1"
	Player->RemoveSpell "vn_Lichbonuslev5"
	Player->RemoveSpell "vn_Lichbonuslev10"
	Player->RemoveSpell "vn_Lichbonuslev15"
	Player->RemoveSpell "vn_Lichbonuslev20"
	Player->RemoveSpell "vn_Lichbonuslev25"
	Player->RemoveSpell "vn_Lichbonuslev30"
	Player->RemoveSpell "vn_Lichbonuslev35"
	Player->RemoveSpell "vn_Lichbonuslev40"
	Player->RemoveSpell "vn_Lichbonuslev45"
	Player->RemoveSpell "vn_Lichbonuslev50"
	Player->RemoveSpell "vn_Lichbonuslev55"
	Player->RemoveSpell "vn_Lichbonuslev60"
	Player->RemoveSpell "vn_Lichbonuslev65"
	Player->RemoveSpell "vn_Lichbonuslev70"
	Player->RemoveSpell "vn_Lichbonuslev75"

set state to 4
endif

if ( state == 4 )
	if ( Player->GetSpell "vn_pn_fake_death" == 1 )
		Player->RemoveSpell "vn_pn_fake_death"
	endif
	if ( Player->GetSpell "vn_pn_heal_undead_horde" == 1 )
		Player->RemoveSpell "vn_pn_heal_undead_horde"
	endif
	if ( Player->GetSpell "vn_pn_turn_undead" == 1 )
		Player->RemoveSpell "vn_pn_turn_undead"
	endif
	if ( Player->GetSpell "vn_pn_reanimate" == 1 )
		Player->RemoveSpell "vn_pn_reanimate"
	endif
	if ( Player->GetSpell "vn_pn_dissolve_flesh" == 1 )
		Player->RemoveSpell "vn_pn_dissolve_flesh"
	endif
	if ( Player->GetSpell "vn_pn_raise_dead" == 1 )
		Player->RemoveSpell "vn_pn_raise_dead"
	endif
	if ( Player->GetSpell "vn_pn_regeneration" == 1 )
		Player->RemoveSpell "vn_pn_regeneration"
	endif
	if ( Player->GetSpell "vn_pn_undead_legion" == 1 )
		Player->RemoveSpell "vn_pn_undead_legion"
	endif
	if ( Player->GetSpell "vn_pn_unholy_animation" == 1 )
		Player->RemoveSpell "vn_pn_unholy_animation"
	endif
	set state to 5
endif

if ( state == 5 )
	if ( Player->GetSpell "vn_ps_explosive_rat" == 1 )
		Player->RemoveSpell "vn_ps_explosive_rat"
	endif
	if ( Player->GetSpell "vn_ps_detect" == 1 )
		Player->RemoveSpell "vn_ps_detect"
	endif
	if ( Player->GetSpell "vn_ps_resist_weapons" == 1 )
		Player->RemoveSpell "vn_ps_resist_weapons"
	endif
	if ( Player->GetSpell "vn_ps_magicka_boon" == 1 )
		Player->RemoveSpell "vn_ps_magicka_boon"
	endif
	if ( Player->GetSpell "vn_ps_consume_soul" == 1 )
		Player->RemoveSpell "vn_ps_consume_soul"
	endif
	if ( Player->GetSpell "vn_ps_godmode" == 1 )
		Player->RemoveSpell "vn_ps_godmode"
	endif
	if ( Player->GetSpell "vn_ps_petrify" == 1 )
		Player->RemoveSpell "vn_ps_petrify"
	endif
	if ( Player->GetSpell "vn_ps_chicken" == 1 )
		Player->RemoveSpell "vn_ps_chicken"
	endif
	set state to 6
endif

if ( state == 6 )
	if ( Player->GetSpell "vn_pp_peace" == 1 )
		Player->RemoveSpell "vn_pp_peace"
	endif
	if ( Player->GetSpell "vn_pp_beast_detect" == 1 )
		Player->RemoveSpell "vn_pp_beast_detect"
	endif
	if ( Player->GetSpell "vn_pp_reduce_notoriety" == 1 )
		Player->RemoveSpell "vn_pp_reduce_notoriety"
	endif
	if ( Player->GetSpell "vn_pp_packrat" == 1 )
		Player->RemoveSpell "vn_pp_packrat"
	endif
	if ( Player->GetSpell "vn_pp_beast_mastery" == 1 )
		Player->RemoveSpell "vn_pp_beast_mastery"
	endif
	if ( Player->GetSpell "vn_pp_voice" == 1 )
		Player->RemoveSpell "vn_pp_voice"
	endif
	if ( Player->GetSpell "vn_pp_terror" == 1 )
		Player->RemoveSpell "vn_pp_terror"
	endif
	if ( Player->GetSpell "vn_pp_fame" == 1 )
		Player->RemoveSpell "vn_pp_fame"
	endif
	if ( Player->GetSpell "vn_pp_command" == 1 )
		Player->RemoveSpell "vn_pp_command"
	endif
	set state to 7
endif

if ( state == 7 )
	; MessageBox "state 7"

	if ( Player->GetSpell "vn_pv_bloodrage" == 1 )
		Player->RemoveSpell "vn_pv_bloodrage"
	endif
	if ( Player->GetSpell "vn_pv_absorbmagicka" == 1 )
		Player->RemoveSpell "vn_pv_absorbmagicka"
	endif
	if ( Player->GetSpell "vn_pv_vampbite" == 1 )
		Player->RemoveSpell "vn_pv_vampbite"
	endif
	if ( Player->GetSpell "vn_pv_consume" == 1 )
		Player->RemoveSpell "vn_pv_consume"
	endif
	if ( Player->GetSpell "vn_pv_brainwash" == 1 )
		Player->RemoveSpell "vn_pv_brainwash"
	endif
	if ( Player->GetSpell "vn_pv_frenzy" == 1 )
		Player->RemoveSpell "vn_pv_frenzy"
	endif
	if ( Player->GetSpell "vn_pv_stealskills" == 1 )
		Player->RemoveSpell "vn_pv_stealskills"
	endif
	if ( Player->GetSpell "vn_pv_superspeed_ON" == 1 )
		Player->RemoveSpell "vn_pv_superspeed_ON"
	endif
	if ( Player->GetSpell "vn_pv_superspeed_OFF" == 1 )
		Player->RemoveSpell "vn_pv_superspeed_OFF"
	endif

	; MessageBox "End state 7"
	set state to 8
endif

if ( state == 8 )
	if ( removelevel == 1 )
		set temp to 1
		set temp2 to 1
		set temp3 to 1
	else
		set removelevel to ( removelevel - 1 )
		set temp to ( removelevel * 4 )
		set temp2 to ( removelevel * 5 )
		set temp3 to ( removelevel * 6 )
	endif
	if ( removelevel > 0 )
		set Gals_Natural_Willpower to ( Gals_Natural_Willpower - temp2 )
		set Gals_Natural_Intelligence to ( Gals_Natural_Intelligence - temp2 )
	endif
	set state to 9
endif

if ( state == 9 )
	; MessageBox "Partial spells removed"
	set state to 0
	StopScript "vn_lichspellremove_partial"
endif

End

# vn_moonphase_script =========================================================
Begin vn_moonphase_script

; GetSecundaPhase
; moon phases:
; 0 - new
; 1 - waxing/waning crescent 
; 2 - waxing/waning half moon
; 3 - waxing/waning gibbous
; 4 - waxing/waning full moon

short waxing ; 1 if ( moon is new->full rather than full->new )
short phasenoted
short currentphase
short lastphase
short lastphase2
short lastphase3
short lastphase4
short consecutive
float timer;

long numdayspassed
long nextfull
long nextfull2
long endfull
short oktorecord
short OnPCEquip
short soundflag

short doonce

if ( doonce == 0 )
	set lastphase to -2
	set lastphase2 to -3
	set lastphase3 to -4 
	set doonce to 1
endif

if ( OnPCEquip == 1 )

	if ( GetSecundaPhase == 4 )
		MessageBox "Tonight is a full moon"
	elseif ( GetSecundaPhase == 3 )
		MessageBox "Tonight is a gibbous moon"
	elseif ( GetSecundaPhase == 2 )
		MessageBox "Tonight is a half moon"
	elseif ( GetSecundaPhase == 1 )
		MessageBox "Tonight is a crescent moon"
	else
		MessageBox "Tonight is a new moon"
	endif

	if ( nextfull == 0 )
		MessageBox "The Lunar is unable to predict the next full moon... you should take it outside at night more often"
	else
		MessageBox "Studying carefully the intricate runes and mechanisms on the Lunar, you see it indicates the next full moon will run from Day %.2f until Day %.2f" nextfull endfull
	endif

	set OnPCEquip to 0

endif

if ( DaysPassed != numdayspassed )
	set lastphase4 to lastphase3
	set lastphase3 to lastphase2
	set lastphase2 to lastphase
	if ( phasenoted == 0 )
		set lastphase to -1
	else
		set lastphase to currentphase
	endif
	; MessageBox "now attempting to detect new phase (last one was %.2f)", lastphase
	set phasenoted to 0
	set numdayspassed to DaysPassed
	set timer to 0
endif

if ( GameHour > 18 )
	set oktorecord to 1
elseif ( GameHour < 6 )
	set oktorecord to 1
else
	set oktorecord to 0
endif

; remember that phase info not accurate if we're not outside
if ( phasenoted == 0 )
	if ( GetInterior == 0 )
		if ( oktorecord == 1 )
			set timer to ( timer + ( GetSecondsPassed ) )
			if ( timer < 10 )
				return
			endif

			MessageBox "The Lunar hums and glows with energy as it reads the path of the moon"
			PlaySound "vn_rise"
			PlaySound "vn_thunder"
			set currentphase to GetSecundaPhase
			set phasenoted to 1
			set timer to 0

			if ( lastphase > -1 ) ; if ( we got the last phase too try to make a prediction )
				if ( lastphase < currentphase )
					set waxing to 1
					set consecutive to 0
				elseif ( lastphase > currentphase )
					set consecutive to 0
					set waxing to -1
				else  ; lastphase == currentphase so that's two consecutive ( stored as +1 ) phase
					; set waxing to 0
					set consecutive to 1
					if ( lastphase == lastphase2 ) ; that's three the maximum
						set consecutive to 2
						; if ( lastphase2 == lastphase3 ) ; so this can't happen
						;	if ( DaysPassed > 6 )
						;		MessageBox "Shouldn't ever see this. Report as a bug! Error in moon phase predictor %.2f, %.2f, %.2f", currentphase, lastphase, lastphase2
						;	endif
						; endif
					endif
				endif

				; now we know how many consecutive phases we've had, and what they were.

				if ( waxing == 1 )
					if ( currentphase == 3 )
						set nextfull to ( DaysPassed + 3 - consecutive )
					elseif ( currentphase == 2 )	
						set nextfull to ( DaysPassed + 6 - consecutive )
					elseif ( currentphase == 1 )
						set nextfull to ( DaysPassed + 9 - consecutive )
					elseif ( currentphase == 4 )
						set nextfull to ( DaysPassed - consecutive )
					endif
				elseif ( waxing == -1 )
					if ( currentphase == 0 ) 
						set nextfull to ( DaysPassed + 12 - consecutive )
					elseif ( currentphase == 1 )
						set nextfull to ( DaysPassed + 15 - consecutive )
					elseif ( currentphase == 2 )
						set nextfull to ( DaysPassed + 18 - consecutive )
					elseif ( currentphase == 3 )
						set nextfull to ( DaysPassed + 21 - consecutive )
					endif
				endif
				set endfull to ( nextfull + 2 )
				set nextfull2 to ( nextfull + 24 )	

			; if the phase changed, we know what from and to, therefore we can make a prediction.
			; probably makes my consecutive stuff redundant.... whoops
			endif ; End game hour check
		endif ; End if ( lastphase wasn't -1 )
	endif ; End exterior
endif ; End not recorded phase

End

# vn_necromancy_book ==========================================================
Begin vn_necromancy_book

short doOnce
short state
short myst

; bodge tests for mysticism increase to see if you've read the book
; I can't use the OnActivate command on the book scrip because it's broken, preventing the book being picked up.

if ( GetDistance Player < 200 )
	
	if ( doOnce == 0 )
		set myst to ( Player->GetMysticism )
		set doOnce to 1
	endif

	if ( doOnce == 1 )
		if ( Player->GetMysticism > myst )
			if ( MenuMode == 1 )
				AddTopic "incredibly strong amulet"
				AddTopic "powerful enchant spell"
				Journal "vn_lich_becoming" 10
				set doonce to 2
				StopScript "vn_necromancy_book"
			else
				set myst to ( Player->GetMysticism )
			endif
		endif
	endif
endif

End

# vn_npcLichResponseScript ====================================================
Begin vn_npcLichResponseScript

if ( GetItemCount vn_lichidentity > 0 ) ; if ( they have had the Player reveal to them )
	StopScript "vn_npcLichResponseScript"
endif

if ( vn_pp_fear_aura != 0 )
	MessageBox "Your evil aura strikes fear into the hearts of those nearby..." 
	ModFlee 100
	StopCombat
	StartCombat Player
	StopScript "vn_npclichresponsescript"
endif

if ( Random100 >= 30 )
	ForceGreeting
	StopScript "vn_npcLichResponseScript"
	return
else
	if ( GetFlee > 30 )
		ModFlee 30
		StopCombat
		StartCombat Player
		StopScript "vn_npcLichResponseScript"
	elseif ( GetFight > 45 )
		ModFlee 15
		StopCombat
		StartCombat Player
		StopScript "vn_npcLichResponseScript"
	elseif ( GetDisposition < 10 )
		ModFight 50
		ModFlee 25
		StopScript "vn_npcLichResponseScript"
	else
		ModDisposition -20
		ModFight 30
		ModFlee 20
		StopScript "vn_npcLichResponseScript"
	endif
	StopScript "vn_npcLichResponseScript"
endif

End

# vn_ordercheck ===============================================================
Begin vn_ordercheck

; this script triggers & runs once as soon as the PC becomes a lich via illuminated order OR my mod
; my mod sets vn_Lich to 1
; IO sets pcordlich to 1
; I ought to make this a StartScript

; stop all lich related scripts, just in case. Probably only need to stop order_lichscript though.
if ( pcordlich == 1 )
	if ( vn_lich == 0 ) ; if ( triggered by immuinated order and not my mod )
		; StopScript, order_npclichresponsescript1
		; StopScript, order_lichunarmoredscript
		; StopScript, order_lichspellmakingscript
		StopScript "order_lichscript"
		; StopScript, order_lichracecheckscript
		; StopScript, order_lichquickinit
		; StopScript, order_lichitemremovecheck
		; StopScript, order_lichhiddenarmorscript
		; StopScript, order_lichguardresponsescript
		Player->RemoveSpell "order_lichgood4"
		Player->RemoveSpell "order_lichgood3"
		Player->RemoveSpell "order_lichgood2"
		Player->RemoveSpell "order_lichgood"
		Player->RemoveSpell "order_lichbad"
		Player->RemoveSpell "order_lichcurse"
		Player->RemoveSpell "order_lich_spellmaking"
		Player->RemoveSpell "order_lich_transform"
		Player->RemoveSpell "order_lich_transform_back"
		Player->RemoveItem "_order_lich_boots" 1
		Player->RemoveItem "_order_lich_glove_left" 1
		Player->RemoveItem "_order_lich_glove_right" 1
		Player->RemoveItem "_order_lich_pants" 1
		Player->RemoveItem "_order_lich_shirt" 1
		Player->AddItem "vn_phylactery1" 1
		StartScript "vn_lichquickinit"
		; should I reset the order's variable? maybe best not to.
		; in fact, for full compatibility I shoudl really change them as mine too...
		; pcOrdlich and pcwearing lich are likely to be used by IO.
		; for the moment, I will leave as is.
		; NOTE order globals will not be correct from here on.
	endif
	StopScript "vn_ordercheck" ; either way this script no longer necessary.
endif

End

# vn_packrat_script ===========================================================
Begin vn_packrat_script

short Companion
short doonce
short shown

if ( doonce == 0 )
	set Companion to 1
	set doonce to 1
endif

if ( shown == 0 )
	if ( GetSpellEffects "vn_follower_teleport" )
		; MessageBox "Teleport effects not yet implemented on packrat"
		set shown to 1
	endif
endif

End

# vn_phylactery_build =========================================================
Begin vn_phylactery_build

; add a number of counters to the NPC's inventory to mark the number of days
; passed when the work will be complete

short state
long temp1
long temp2
long counters

if ( state == 0 )
	set temp1 to DaysPassed
	set state to 1
	return
endif

if ( state == 1 )
	set temp2 to ( temp1 + 7 )
	set state to 2
	return
endif

if ( state == 2 )
	; MessageBox, "Adding %.2f counters", temp2
	; AddItem, vn_counter, temp2
	set counters to ( GetItemCount vn_counter )
	if ( ( counters + 8 ) <= temp2 )
		AddItem "vn_counter" 8
	elseif ( ( counters + 4 ) <= temp2 )
		AddItem "vn_counter" 4
	elseif ( ( counters + 2 ) <= temp2 )
		AddItem "vn_counter" 2
	elseif ( ( counters + 1 ) <= temp2 )
		AddItem "vn_counter" 1
	else
		set state to 3
	endif
endif

if ( state == 3 )
	set state to 0
	StopScript "vn_phylactery_build"
endif

End

# vn_phylactery_e_script ======================================================
Begin vn_phylactery_e_script

short button
short state
short doonce
short OnPCAdd
short OnPCEquip

if ( doonce == 0 )
	; only display this message the first time it is equipped
	if ( OnPCAdd == 1 )
		MessageBox "Equip the Phylactery when you're ready to start the ritual of becoming"
	endif
	set doonce to 1
endif

if ( state == 0 )
	if ( OnPCEquip == 1 )
		MessageBox "Start the ritual of becoming?" "Yes, I am ready and the time is right" "Not yet"
		set state to 1
		set OnPCEquip to 0
	endif
elseif ( state == 2 ) ; Chose 'No' 
	set state to 0
	set button to -1
endif

if ( state == 1 )
	; MessageBox, "waiting for button info...."
	set button to GetButtonPressed
	if ( button == -1 )
		return
	endif
	if ( button == 0 )
		StartScript "vn_lichritual"
		set state to 3
	endif
	if ( button == 1 )
		set state to 2
	endif
endif

if ( state == 3 )
	if ( Player->HasItemEquipped vn_phylactery1_e == 0 )
		MessageBox "Ritual of becoming cancelled"
		StopScript "vn_lichritual"
		set state to 0
		set button to -1
	endif
endif

End

# vn_phylactery_entrance ======================================================
Begin vn_phylactery_entrance

long temp
short returnedonce

if ( OnActivate == 1 )
	EnableTeleporting
	set vn_brotherhoodswitch to 1
	MessageBox "You return to the realm of the mortals"
	set vn_globe_used to 0

	if ( returnedonce == 0 )
		set vn_lichscript2.set_phylactery to 2 ; get current globals
		set vn_lichscript2.returnto_phylactery to 2 ; skips getting of vars script ( not needed but safer )
		set returnedonce to 1
	else
		set vn_lichscript2.returnto_phylactery to 1
	endif
endif

End

# vn_phylactery_ingred_supply =================================================
Begin vn_phylactery_ingred_supply

if ( OnActivate == 1 )
	Player->AddItem "ingred_adamantium_ore_01" 2
	Player->AddItem "ingred_scrap_metal_01" 2
	Player->AddItem "ingred_diamond_01" 4
	Player->AddItem "ingred_pearl_01" 3
	Player->AddItem "ingred_ruby_01" 3
	Player->AddItem "ingred_raw_ebony_01" 2
	Player->AddItem "ingred_raw_glass_01" 2
	Player->AddItem "gold_001" 5000
endif

End

# vn_phylactery_u2_script =====================================================
Begin vn_phylactery_u2_script

; if ( Player->GetSpellEffects, "vn_enchant" == 1 )
;	if ( Player->GetItemCount, vn_phylactery1_u, 1 > 0 )
;		MessageBox "Phylactery has been enchanted"
;		Player->AddItem, vn_phylactery1_e, 1
;		StartScript, vn_remove_pu
;	endif
; endif

End

# vn_phylacteryscript =========================================================
Begin vn_phylacteryscript

short OnPCAdd
short OnPCDrop
short doOnce
short held

if ( OnPCAdd == 1 ) ; set a flag to Disable teleporting on death.
	if ( held == 0 )
		set vn_phylacteryset to 0
		MessageBox "Phylactery added to inventory"
		set held to 1
		set OnPCAdd to 0
	endif
endif

if ( OnPCDrop == 1 )
	if ( held == 1 )
		MessageBox "Phylactery dropped."
		set vn_phylacteryset to 1
		if ( ScriptRunning "vn_lichscript2" == 1 )
			set vn_lichscript2.set_phylactery to 1
		else
			StartScript "vn_getposition"
		endif
		; start my copy of multimark script to mark the location
		; that you need to teleport to on death
		; vars will be stored as globals
		set held to 0
		set OnPCDrop to 0
	endif
endif

if ( vn_phylacteryset == 0 )
	if ( doOnce == 0 )
		; MessageBox, "phylactery started"
		set vn_phylacteryset to 1
		; StartScript, vn_getposition  - SHOULD BE DONE ALREADY
		; same stuff as on Drop
		; because pylactery will NOT be in inventory first time you see it
		; may change this at some point
		set held to 0
		set doonce to 1
	endif
endif

End

# vn_possession ===============================================================
Begin vn_possession

float timer
short doonce
short faded
short moved
short thunder
short state
long temp

if ( state == 0 )

	if ( ( Player->GetEffect sEffectFortifyAttribute ) == 1 ) ; If they have a fortify attribute we remove all the Lich abilities and check again
		set vn_spellremove_done to 0

		if ( ScriptRunning "vn_lichspellremove" == 0 ) ; in case it's already active. unlikely but feasable
			StartScript "vn_lichspellremove"
		endif
		set state to 1
	else
		set state to 2
	endif

endif

if ( state == 1 )
	if ( vn_spellremove_done == 1 )
		if ( ( Player->GetEffect sEffectFortifyAttribute ) == 1 ) ; If they still have a fortify attribute without the skills shut it down and readd them
			if ( ScriptRunning "vn_lichspelladd" == 0 ) ; in case it's already active. unlikely but feasable
				StartScript "vn_lichspelladd"
				return ; give it a frame to start running
			else 
				MessageBox "You cannot perform possession whilst you have attributes fortified"
				set vn_lichspelladd.active to 1
				StopScript "vn_possession"
				set state to 3
			endif
		else 
			set state to 2
		endif
	endif
endif

if ( state == 2 )

	if ( thunder == 0 )
		if ( vn_crimeflag == 0 )
			set vn_crimeflag to 1 ; removes bounty don't want guards forcgreeting while ( this is in progress )
			; MessageBox "Removing crime level to prevent guard greet"
		endif
		PlaySound "vn_thunder"
		TGM ; can't be killed while ( this is going )
		set thunder to 1
	endif

	if ( MenuMode == 0 )
		set timer to ( timer + ( GetSecondsPassed ) )
		if ( timer < 8 )
			if ( timer > 6 )
				Player->RotateWorld x 2000
				Player->RotateWorld y -2000
			elseif ( timer > 5 )
				Player->RotateWorld x 800
				Player->RotateWorld z 800
			elseif ( timer > 4 )
				Player->RotateWorld x 500
				Player->RotateWorld y 500
			elseif ( timer > 3 )
				Player->RotateWorld x 300
				Player->RotateWorld z -300
			elseif ( timer > 2 )
				Player->RotateWorld x 200
				Player->RotateWorld y -200
			elseif ( timer > 1 )
				Player->RotateWorld x 100
				Player->RotateWorld z 100
			else
				Player->RotateWorld x 50
				Player->RotateWorld y 50
			endif
		endif
		if ( timer > 3 )
			if ( faded == 0 )
				FadeOut 5
				set faded to 1
			endif
		endif
		if ( timer > 4 )
			if ( doOnce == 0 )
				PlaySound "vn_sacrifice"
				set doonce to 1
			endif
		endif
		if ( timer > 11 )
			if ( moved == 0 )
				Player->PositionCell 0 0 100 0 "Phylactery - Inner Chamber"
				set vn_brotherhoodswitch to 1
				FadeIn 4
				set moved to 1
				TGM ; turn if ( off now we're safe )
				set state to 3
			endif
		endif
	endif

endif

if ( state == 3 )
	set vn_attributeswitch to 1
	; MessageBox "stopping possession script"
	set timer to 0
	set thunder to 0
	set moved to 0
	set faded to 0
	set doonce to 0
	set state to 0
	StopScript "vn_possession"
endif
	
End

# vn_power_ritual_success =====================================================
Begin vn_power_ritual_success

short state
short button
short count
short accum_limit
float power

if ( state == 0 )

	if ( vn_lich_vamp == 1 ) ; if ( you're a vampire lich you get to choose vamprism )
		MessageBox "Which avenue will you seek power in?" "Psionics" "Necromancy" "Sorcery" "Vampirism"
		set accum_limit to 3
	else
		MessageBox "Which avenue will you seek power in?" "Psionics" "Necromancy" "Sorcery"
		set accum_limit to 2
	endif

	set state to 1

endif

if ( state == 1 )

	set button to GetButtonPressed

	if ( button == -1 )
		return
	elseif ( button == 0 )
		; MessageBox "You chose Psionics"
		set vn_avenue_psionics to ( vn_avenue_psionics + 1 )
		set vn_av_psi_accum to ( vn_av_psi_accum + 1 )
		if ( vn_av_psi_accum == accum_limit )
			; MessageBox "decreasing other skills to compensate"
			set vn_avenue_necromancy to ( vn_avenue_necromancy - 1 )
			set vn_avenue_sorcery to ( vn_avenue_sorcery - 1 )
			if ( vn_avenue_vampirism > 0 )
				set vn_avenue_vampirism to ( vn_avenue_vampirism - 1 )
			endif
			set vn_av_psi_accum to 0
		endif
		set state to 3
	elseif ( button == 1 )
		; MessageBox "You chose Necromancy"
		set vn_avenue_necromancy to ( vn_avenue_necromancy + 1 )
		set vn_av_nec_accum to ( vn_av_nec_accum + 1 )
		if ( vn_av_nec_accum == accum_limit )
			; MessageBox "decreasing other skills to compensate"
			set vn_avenue_psionics to ( vn_avenue_psionics - 1 )
			set vn_avenue_sorcery to ( vn_avenue_sorcery - 1 )
			if ( vn_avenue_vampirism > 0 )
				set vn_avenue_vampirism to ( vn_avenue_vampirism - 1 )
			endif
			set vn_av_nec_accum to 0
		endif
		set state to 6
	elseif ( button == 2 )
		; MessageBox "You chose Sorcery"
		set vn_avenue_sorcery to ( vn_avenue_sorcery + 1 )
		set vn_av_sor_accum to ( vn_av_sor_accum + 1 )
		if ( vn_av_sor_accum == accum_limit )
			; MessageBox "decreasing other skills to compensate"
			set vn_avenue_necromancy to ( vn_avenue_necromancy - 1 )
			set vn_avenue_psionics to ( vn_avenue_psionics - 1 )
			if ( vn_avenue_vampirism > 0 )
				set vn_avenue_vampirism to ( vn_avenue_vampirism - 1 )
			endif
			set vn_av_sor_accum to 0
		endif
		set state to 9
	elseif ( button == 3 )
		; MessageBox "You chose Vampirism"
		set vn_avenue_vampirism to ( vn_avenue_vampirism + 1 )
		set vn_av_vmp_accum to ( vn_av_vmp_accum + 1 )
		if ( vn_av_vmp_accum == accum_limit )
			; MessageBox "decreasing other skills to compensate"
			set vn_avenue_necromancy to ( vn_avenue_necromancy - 1 )
			set vn_avenue_psionics to ( vn_avenue_psionics - 1 )
			set vn_avenue_sorcery to ( vn_avenue_sorcery - 1 )
			set vn_av_vmp_accum to 0
		endif
		set state to 12
	endif	
	set button to -1
	MessageBox "Your skills are now P %.2f N %.2f S %.2f" vn_avenue_psionics vn_avenue_necromancy vn_avenue_sorcery
	MessageBox "Next power ritual at level %.2f" vn_next_power_level
endif

if ( state == 3 )
	; MessageBox "state 3 - Now assigning Random number"
	set power to ( random100 / 8.0 )
	set count to ( count + 1 )
	if ( count > 30 )
		MessageBox "You are granted no power this time. Perhaps your dedication hasn't been great enough." "Ok"
		set state to 20
		return
	endif
	set state to 4
endif

if ( state == 4 )
	if ( vn_avenue_psionics < 7 )
		if ( power >= 4 )
			set state to 3
			return
		endif
	elseif ( vn_avenue_psionics < 9 )
		if ( power >= 7 )
			set state to 3
			return
		endif
	elseif ( vn_avenue_psionics < 11 )
		if ( power >= 9 )
			set state to 3
			return
		endif
	endif
	set state to 5
endif

if ( state == 5 )

	if ( power < 1 )
		if ( Player->GetSpell "vn_pp_peace" == 0 ) 
			MessageBox "You have been granted the first order psionic power of 'Pacify'" "Ok"
			AddTopic "Psionic 1 - Pacify"
			set vn_lichspelladd.ppf_pacify to 1
			set state to 20
			return
		else
			set state to 3
			return
		endif
	endif

	if ( power < 2 )
		if ( Player->GetSpell "vn_pp_beast_detect" == 0 ) 
			MessageBox "You have been granted the first order psionic power of 'Beast Detection'" "Ok"
			AddTopic "Psionic 2 - Beast Detection"
			set vn_lichspelladd.ppf_beast_detect to 1
			set state to 20
			return
		else
			set state to 3
			return
		endif
	endif

	if ( power < 3 )
		if ( Player->GetSpell "vn_pp_reduce_notoriety" == 0 ) 
			MessageBox "You have been granted the first order psionic power of 'Reduce Notoriety'" "Ok"
			AddTopic "Psionic 3 - Reduce Notoriety"
			set vn_lichspelladd.ppf_reduce_bounty to 1
			set state to 20
			return
		else
			set state to 3
			return
		endif
	endif

	if ( power < 4 )
		if ( Player->GetSpell "vn_pp_packrat" == 0 ) 
			MessageBox "You have been granted the first order psionic power of 'Summon Packrat'" "Ok"
			AddTopic "Psionic 4 - Summon Packrat"
			set vn_lichspelladd.ppf_packrat to 1
			set state to 20
			return
		else
			set state to 3
			return
		endif
	endif

	if ( power < 5 )
		if ( vn_pp_fear_aura == 0 ) 
			MessageBox "You have been granted the second order psionic power of 'Fearful Aura'" "Ok"
			AddTopic "Psionic 5 - Fearful Aura"
			set vn_pp_fear_aura to 1
			set state to 20
			return
		else
			set state to 3
			return
		endif
	endif

	if ( power < 6 )
		if ( Player->GetSpell "vn_pp_beast_mastery" == 0 ) 
			MessageBox "You have been granted the second order psionic power of 'Beast Mastery'" "Ok"
			AddTopic "Psionic 6 - Beast Mastery"
			set vn_lichspelladd.ppf_beast_mastery to 1
			set state to 20
			return
		else
			set state to 3
			return
		endif
	endif

	if ( power < 7 )
		if ( Player->GetSpell "vn_pp_voice" == 0 ) 
			MessageBox "You have been granted the second order psionic power of 'Voice Of The Lich'" "Ok"
			AddTopic "Psionic 7 - Voice Of The Lich"
			set vn_lichspelladd.ppf_voice_of_the_lich to 1
			set state to 20
			return
		else
			set state to 3
			return
		endif
	endif

	if ( power < 8 )
		if ( Player->GetSpell "vn_pp_terror" == 0 ) 
			MessageBox "You have been granted the third order psionic power of 'Terror'" "Ok"
			AddTopic "Psionic 8 - Terror"
			set vn_lichspelladd.ppf_terror to 1
			set state to 20
			return
		else
			set state to 3
			return
		endif
	endif

	if ( power < 9 )
		if ( Player->GetSpell "vn_pp_fame" == 0 ) 
			MessageBox "You have been granted the third order psionic power of 'Fame'" "Ok"
			AddTopic "Psionic 9 - Fame"
			set vn_lichspelladd.ppf_fame to 1
			set state to 20
			return
		else
			set state to 3
			return
		endif
	endif

	if ( power < 10 )
		if ( Player->GetSpell "vn_pp_command" == 0 ) 
			MessageBox "You have been granted the fourth order psionic power of 'Commanding Touch'" "Ok"
			AddTopic "Psionic 10 - Commanding Touch"
			set vn_lichspelladd.ppf_command to 1
			set state to 20
			return
		else
			set state to 3
			return
		endif
	else
		set state to 3
		return
	endif
	
endif

if ( state == 6 )
	; MessageBox "state 6 - Now assigning Random number"
	set power to ( random100 / 8.0 )
	set count to ( count + 1 )
	if ( count > 30 )
		MessageBox "You are granted no power this time. Perhaps your dedication hasn't been great enough." "Ok"
		set state to 20
		return
	endif
	set state to 7
endif

if ( state == 7 )
	if ( vn_avenue_necromancy < 7 )
		if ( power >= 4 )
			set state to 6
			return
		endif
	elseif ( vn_avenue_necromancy < 9 )
		if ( power >= 7 )
			set state to 6
			return
		endif
	elseif ( vn_avenue_necromancy < 11 )
		if ( power >= 9 )
			set state to 6
			return
		endif
	endif
	set state to 8
endif

if ( state == 8 )

	if ( power < 1 )
		if ( Player->GetSpell "vn_pn_fake_death" == 0 ) 
			MessageBox "You have been granted the first order necromancy power of 'Fake Death'" "Ok"
			AddTopic "Necromancy 1 - Fake Death"
			set vn_lichspelladd.pnf_fake_death to 1
			set state to 20
			return
		else
			set state to 6
			return
		endif
	endif

	if ( power < 2 )
		if ( Player->GetSpell "vn_pn_heal_undead_horde" == 0 ) 
			MessageBox "You have been granted the first order necromancy power of 'Heal Undead Horde'" "Ok"
			AddTopic "Necromancy 2 - Heal Undead Horde"
			set vn_lichspelladd.pnf_heal_undead to 1
			set state to 20
			return
		else
			set state to 6
			return
		endif
	endif

	if ( power < 3 )
		if ( vn_pn_reduce_decay == 0 ) 
			MessageBox "You have been granted the first order necromancy power of 'Reduce Decay'" "Ok"
			AddTopic "Necromancy 3 - Reduce Decay"
			set vn_pn_reduce_decay to 1
			set state to 20
			return
		else
			set state to 6
			return
		endif
	endif

	if ( power < 4 )
		if ( Player->GetSpell "vn_pn_turn_undead" == 0 ) 
			MessageBox "You have been granted the first order necromancy power of 'Turn Undead'" "Ok"
			AddTopic "Necromancy 4 - Turn Undead"
			set vn_lichspelladd.pnf_turn_undead to 1
			set state to 20
			return
		else
			set state to 6
			return
		endif
	endif

	if ( power < 5 )
		if ( Player->GetSpell "vn_pn_reanimate" == 0 ) 
			MessageBox "You have been granted the second order necromancy power of 'Reanimate Dead'" "Ok"
			AddTopic "Necromancy 5 - Reanimate Dead"
			set vn_lichspelladd.pnf_reanimate to 1
			set state to 20
			return
		else
			set state to 6
			return
		endif
	endif

	if ( power < 6 )
		if ( Player->GetSpell "vn_pn_dissolve_flesh" == 0 ) 
			MessageBox "You have been granted the second order necromancy power of 'Dissolve Flesh'" "Ok"
			AddTopic "Necromancy 6 - Dissolve Flesh"
			set vn_lichspelladd.pnf_dissolve_flesh to 1
			set state to 20
			return
		else
			set state to 6
			return
		endif
	endif

	if ( power < 7 )
		if ( Player->GetSpell "vn_pn_raise_dead" == 0 ) 
			MessageBox "You have been granted the second order necromancy power of 'Raise Dead II'" "Ok"
			AddTopic "Necromancy 7 - Raise Dead II"
			set vn_lichspelladd.pnf_raise_dead2 to 1
			set state to 20
			return
		else
			set state to 6
			return
		endif
	endif

	if ( power < 8 )
		if ( Player->GetSpell "vn_pn_regeneration" == 0 ) 
			MessageBox "You have been granted the third order necromancy power of 'Regeneration'" "Ok"
			AddTopic "Necromancy 8 - Regeneration"
			set vn_lichspelladd.pnf_regeneration to 1
			set state to 20
			return
		else
			set state to 6
			return
		endif
	endif

	if ( power < 9 )
		if ( Player->GetSpell "vn_pn_undead_legion" == 0 ) 
			MessageBox "You have been granted the third order necromancy power of 'Summon Undead Legion'" "Ok"
			AddTopic "Necromancy 9 - Summon Undead Legion"
			set vn_lichspelladd.pnf_undead_legion to 1
			set state to 20
			return
		else
			set state to 6
			return
		endif
	endif

	if ( power < 10 )
		if ( Player->GetSpell "vn_pn_unholy_animation" == 0 ) 
			MessageBox "You have been granted the fourth order necromancy power of 'Unholy Animation'" "Ok"
			AddTopic "Necromancy 10 - Unholy Animation"
			set vn_lichspelladd.pnf_unholy_animation to 1
			set state to 20
			return
		else
			set state to 6
			return
		endif
	else
		set state to 6
		return
	endif

endif

if ( state == 9 )
	; MessageBox "state 9 - Now assigning Random number"
	set power to ( random100 / 8.0 )
	set count to ( count + 1 )
	if ( count > 30 )
		MessageBox "You are granted no power this time. Perhaps your dedication hasn't been great enough." "Ok"
		set state to 20
		return
	endif
	set state to 10
endif

if ( state == 10 )
	if ( vn_avenue_sorcery < 7 )
		if ( power >= 4 )
			set state to 9
			return
		endif
	elseif ( vn_avenue_sorcery < 9 )
		if ( power >= 7 )
			set state to 9
			return
		endif
	elseif ( vn_avenue_sorcery < 11 )
		if ( power >= 9 )
			set state to 9
			return
		endif
	endif
	set state to 11
endif

if ( state == 11 )

	if ( power < 1 )
		if ( vn_ps_lunar_magicka == 0 ) 
			MessageBox "You have been granted the first order sorcery power of 'Lunar Magicka'" "Ok"
			AddTopic "Sorcery 1 - Lunar Magicka"
			set vn_ps_lunar_magicka to 1
			set state to 20
			return
		else
			set state to 9
			return
		endif
	endif

	if ( power < 2 )
		if ( Player->GetSpell "vn_ps_explosive_rat" == 0 ) 
			MessageBox "You have been granted the first order sorcery power of 'Explosive Rat'" "Ok"
			AddTopic "Sorcery 2 - Explosive Rat"
			set vn_lichspelladd.psf_explosive_rat to 1
			set state to 20
			return
		else
			set state to 9
			return
		endif
	endif

	if ( power < 3 )
		if ( vn_ps_enchant_mastery == 0 ) 
			MessageBox "You have been granted the first order sorcery power of 'Enchant Mastery'" "Ok"
			AddTopic "Sorcery 3 - Enchant Mastery"
			set vn_ps_enchant_mastery to 1
			set state to 20
			return
		else
			set state to 9
			return
		endif
	endif

	if ( power < 4 )
		if ( Player->GetSpell "vn_ps_detect" == 0 ) 
			MessageBox "You have been granted the first order sorcery power of 'Enchantment Detection'" "Ok"
			AddTopic "Sorcery 4 - Enchantment Detection"
			set vn_lichspelladd.psf_detection to 1
			set state to 20
			return
		else
			set state to 9
			return
		endif
	endif

	if ( power < 5 )
		if ( Player->GetSpell "vn_ps_resist_weapons" == 0 ) 
			MessageBox "You have been granted the second order sorcery power of 'Resist Normal Weapons'" "Ok"
			AddTopic "Sorcery 5 - Resist Normal Weapons"
			set vn_lichspelladd.psf_resist_weapons to 1
			set state to 20
			return
		else
			set state to 9
			return
		endif
	endif

	if ( power < 6 )
		if ( Player->GetSpell "vn_ps_magicka_boon" == 0 ) 
			MessageBox "You have been granted the second order sorcery power of 'Magicka Boon'" "Ok"
			AddTopic "Sorcery 6 - Magicka Boon"
			set vn_lichspelladd.psf_magicka_boon to 1
			set state to 20
			return
		else
			set state to 9
			return
		endif
	endif

	if ( power < 7 )
		if ( Player->GetSpell "vn_ps_consume_soul" == 0 ) 
			MessageBox "You have been granted the second order sorcery power of 'Consume Soul'" "Ok"
			AddTopic "Sorcery 7 - Consume Soul"
			set vn_lichspelladd.psf_consume_soul to 1
			set state to 20
			return
		else
			set state to 9
			return
		endif
	endif

	if ( power < 8 )
		if ( Player->GetSpell "vn_ps_godmode" == 0 ) 
			MessageBox "You have been granted the third order sorcery power of 'Invulnerability'" "Ok"
			AddTopic "Sorcery 8 - Invulnerability"
			set vn_lichspelladd.psf_godmode to 1
			set state to 20
			return
		else
			set state to 9
			return
		endif
	endif

	if ( power < 9 )
		if ( Player->GetSpell "vn_ps_petrify" == 0 ) 
			MessageBox "You have been granted the third order sorcery power of 'Petrify'" "Ok"
			AddTopic "Sorcery 9 - Petrify"
			set vn_lichspelladd.psf_petrify to 1
			set state to 20
			return
		else
			set state to 9
			return
		endif
	endif

	if ( power < 10 )
		if ( Player->GetSpell "vn_ps_chicken" == 0 ) 
			MessageBox "You have been granted the fourth order sorcery power of 'Turn to Chicken'" "Ok"
			AddTopic "Sorcery 10 - Turn to Chicken"
			set vn_lichspelladd.psf_chicken to 1
			set state to 20
			return
		else
			set state to 9
			return
		endif
	else
		set state to 9
		return
	endif

endif

if ( state == 12 )
	; MessageBox "state 12 - Now assigning Random number"
	set power to ( random100 / 8.0 )
	set count to ( count + 1 )
	if ( count > 30 )
		; this means that after 30 randomisations, it couldn't find a power to give you.
		MessageBox "You are granted no power this time. Perhaps your dedication hasn't been great enough." "Ok"
		set state to 20
		return
	endif
	set state to 13
endif

if ( state == 13 )
	if ( vn_avenue_vampirism < 7 )
		if ( power >= 4 )
			set state to 12
			return
		endif
	elseif ( vn_avenue_vampirism < 9 )
		if ( power >= 7 )
			set state to 12
			return
		endif
	elseif ( vn_avenue_vampirism < 11 )
		if ( power >= 9 )
			set state to 12
			return
		endif
	endif
	set state to 14
endif

if ( state == 14 )

	if ( power < 1 )
		if ( Player->GetSpell "vn_pv_vampbite" == 0 ) 
			MessageBox "You have been granted the first order vampirism power of 'Improved Vampire Bite'" "Ok"
			AddTopic "Vampirism 1 - Improved Vampire Bite"
			set vn_lichspelladd.pvf_vampbite to 1
			set state to 20
			return
		else
			set state to 12
			return
		endif
	endif

	if ( power < 2 )
		if ( vn_pv_blood_conv_bonus == 0 ) 
			MessageBox "You have been granted the first order vampirism power of 'Enhanced Blood Conversion'" "Ok"
			AddTopic "Vampirism 2 - Enhanced Blood Conversion"
			set vn_pv_blood_conv_bonus to 1
			set state to 20
			return
		else
			set state to 12
			return
		endif
	endif

	if ( power < 3 )
		if ( Player->GetSpell "vn_pv_consume" == 0 ) 
			MessageBox "You have been granted the first order vampirism power of 'Consume Soul'" "Ok"
			AddTopic "Vampirism 3 - Consume Soul"
			set vn_lichspelladd.pvf_consume to 1
			set state to 20
			return
		else
			set state to 12
			return
		endif
	endif

	if ( power < 4 )
		if ( Player->GetSpell "vn_pv_absorbmagicka" == 0 ) 
			MessageBox "You have been granted the first order vampirism power of 'Absorb Magicka'" "Ok"
			AddTopic "Vampirism 4 - Absorb Magicka"
			set vn_lichspelladd.pvf_absorbmagicka to 1
			set state to 20
			return
		else
			set state to 12
			return
		endif
	endif

	if ( power < 5 )
		if ( Player->GetSpell "vn_pv_brainwash" == 0 ) 
			MessageBox "You have been granted the second order vampirism power of 'Brainwash'" "Ok"
			AddTopic "Vampirism 5 - Brainwash"
			set vn_lichspelladd.pvf_brainwash to 1
			set state to 20
			return
		else
			set state to 12
			return
		endif
	endif

	if ( power < 6 )
		if ( Player->GetSpell "vn_pv_frenzy" == 0 ) 
			MessageBox "You have been granted the second order sorcery power of 'Feeding Frenzy'" "Ok"
			AddTopic "Vampirism 6 - Feeding Frenzy"
			set vn_lichspelladd.pvf_frenzy to 1
			set state to 20
			return
		else
			set state to 12
			return
		endif
	endif

	if ( power < 7 )
		if ( vn_pv_daywalker == 0 ) 
			MessageBox "You have been granted the second order sorcery power of 'Daywalker'" "Ok"
			AddTopic "Vampirism 7 - Daywalker"
			set vn_pv_daywalker to 1
			set state to 20
			return
		else
			set state to 12
			return
		endif
	endif

	if ( power < 8 )
		if ( Player->GetSpell "vn_pv_stealskills" == 0 ) 
			MessageBox "You have been granted the third order vampirism power of 'Steal Skills'" "Ok"
			AddTopic "Vampirism 8 - Steal Skills"
			set vn_lichspelladd.pvf_stealskills to 1
			set state to 20
			return
		else
			set state to 12
			return
		endif
	endif

	if ( power < 9 )
		if ( Player->GetSpell "vn_pv_superspeed_ON" == 0 ) 
			MessageBox "You have been granted the third order vampirism power of 'Super Speed'" "Ok"
			AddTopic "Vampirism 9 - Super Speed"
			set vn_lichspelladd.pvf_superspeed to 1
			set state to 20
			return
		else
			set state to 12
			return
		endif
	endif

	if ( power < 10 )
		if ( Player->GetSpell "vn_pv_bloodrage" == 0 ) 
			MessageBox "You have been granted the fourth order vampirism power of 'Blood Rage'" "Ok"
			AddTopic "Vampirism 10 - Blood Rage"
			set vn_lichspelladd.pvf_bloodrage to 1
			set state to 20
			return
		else
			set state to 12
			return
		endif
	else
		set state to 12
		return
	endif

endif

if ( state == 20 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	endif
	StartScript "vn_lichlevelup"
	set count to 0
	set power to 0
;	set timer to 0
	set state to 21
endif

if ( state == 21 )
	set vn_power_ritual_available to 0
	set state to 0
	StopScript "vn_power_ritual_success"
endif

End

# vn_power_skull_script =======================================================
Begin vn_power_skull_script

short held
short OnPCDrop
short mooncheck
long days

if ( OnPCDrop == 1 )
	set held to 0
	set vn_x to GetPos x
	set vn_y to GetPos y
	set vn_z to GetPos z
endif

if ( OnActivate == 1 )
	set held to 1
	Activate
endif

End

# vn_power_skull_script2 ======================================================
Begin vn_power_skull_script2

short held
short OnPCDrop

if ( OnPCDrop == 1 )
	set held to 0
	set vn_x2 to GetPos x
	set vn_y2 to GetPos y
	set vn_z2 to GetPos z
endif

if ( OnActivate == 1 )
	set held to 1
	Activate
endif

End

# vn_power_tutor_script =======================================================
Begin vn_power_tutor_script

short state
float timer

StopCombat

if ( state == 0 )
	ForceGreeting
	set state to 1
	return
endif

if ( state == 1 )
	if ( MenuMode == 0 )
		set timer to ( timer + ( GetSecondsPassed ) )
		if ( timer > 3 )
			set timer to 0
			Disable
			SetDelete 1	
		endif
	endif
endif

End

# vn_powerritual ==============================================================
Begin vn_powerritual

; must be done thrice successfully, consecutively
; one attempt per Day, midnight at a full moon only
; but how to detect failed attempts?
; must be done by skulls I guess? - auto running when in range.
; could even have skulls store the necessary variables.

float x1
float y1
float z1
float x2
float y2
float z2
float x3
float y3
float z3
float timer
short pos
short time
short phase
short temp

if ( MenuMode == 1 )
	return
endif

if ( Player->GetItemCount vn_power_skull > 0 )
	MessageBox "Cannot start ritual unless both skulls are in Position"
	set vn_power_ritual_state to 10
endif

if ( Player->GetItemCount vn_power_skull2 > 0 )
	MessageBox "Cannot start ritual unless both skulls are in Position"
	set vn_power_ritual_state to 10
endif

if ( vn_power_ritual_available == 0 )
	MessageBox "No Power Ritual is available to you at this time"
	set vn_power_ritual_state to 10
endif

if ( vn_power_ritual_state == 0 )
	if ( GetInterior == 1 )
		MessageBox "Power rituals must be performed outside!"
		set vn_power_ritual_state to 10
	endif
endif

if ( vn_power_ritual_state == 0 )
	if ( vn_ritualAttemptedToday == 1 )
		MessageBox "You have already attempted the ritual today"
		set vn_power_ritual_state to 10
	endif
endif

; this script is called when spell is successfully Cast.
; 1check skulls are in Position
if ( vn_power_ritual_state == 0 )
	set x1 to ( vn_x )
	set y1 to ( vn_y )
	set z1 to ( vn_z )
	set x2 to ( vn_x2 )
	set y2 to ( vn_y2 )
	set z2 to ( vn_z2 )
	set x3 to ( Player->GetPos x )
	set y3 to ( Player->GetPos y )
	set z3 to ( Player->GetPos z )
	set vn_power_ritual_state to 1
endif

if ( vn_power_ritual_state == 1 )
	; MessageBox, "Position check"
	set pos to 1
	; check for anything which would mess Position up
	; don't be too harsh -- allow 15 either side

     if ( x3 > x1 ) ; if ( Player x pos higher than skull1 )
		if ( x3 > x2 )
			set pos to 0
		endif
	elseif ( x3 < x1 ) ; if ( playes x pos lower than skull1 )
		if ( x3 < x2 ) 
			set pos to 0
		endif
	endif

    if ( y3 > y1 )
		if ( y3 > y2 )
			set pos to 0
		endif
	elseif ( y3 < y1 )
		if ( y3 < y2 )
			set pos to 0
		endif
	endif

	; if the difference is less than 60, allow it anyway
	set temp to ( x2 - x3 )
	if ( temp < 0 )
		if ( temp > -60 )
			set pos to 1
		endif
	else
		if ( temp < 60 )
			set pos to 1
		endif
	endif

	set temp to ( y2 - y3 )
	if ( temp < 0 )
		if ( temp > -60 )
			set pos to 1
		endif
	else
		if ( temp < 60 )
			set pos to 1
		endif
	endif
	set vn_power_ritual_state to 2
endif

if ( vn_power_ritual_state == 2 )
	set time to 0
	if ( GameHour > 22 ) ; 10pm to midnight only
		set time to 1
	endif
	set vn_power_ritual_state to 3
endif

if ( vn_power_ritual_state == 3 )
	if ( GetSecundaPhase == 4 )
		set phase to 1
	else
		set phase to 0
	endif
	set vn_power_ritual_state to 4
endif

if ( vn_power_ritual_state == 4 )
	set vn_ritualAttemptedToday to 1
	if ( pos == 0 )
		MessageBox "You were out of Position when you Cast the spell"
		set vn_power_ritual_consec to 0
		set vn_power_ritual_state to 10
	elseif ( time == 0 )
		MessageBox "You did not Cast the spell before midnight"
		set vn_power_ritual_consec to 0
		set vn_power_ritual_state to 10
	elseif ( phase == 0 )
		MessageBox "You did not Cast during a full moon"
		set vn_power_ritual_consec to 0
		set vn_power_ritual_state to 10
	else
		MessageBox "Ritual successful"
		set vn_power_ritual_state to 5
	endif
endif

if ( vn_power_ritual_state == 5 )
	set temp to ( vn_power_ritual_consec + 1 )
	if ( temp == 1 )
		set vn_power_ritual_consec to 1
		MessageBox "You have now performed the ritual successfully once. Repeat it again the next two nights to be granted your power"
	elseif ( temp == 2 )
		set vn_power_ritual_consec to 2
		MessageBox "You have now performed the ritual successfully twice. Once more will complete the ritual"
	elseif ( temp == 3 )
		set vn_power_ritual_consec to 0
		StartScript "vn_power_ritual_success"
	endif
	set vn_power_ritual_state to 10
endif

if ( vn_power_ritual_state == 10 )
	; MessageBox "State 10"
;	set timer to ( timer + ( GetSecondsPassed ) )
;	if ( timer > 5 )
;		set timer to 0
;		set vn_power_ritual_state to -1
		StopScript "vn_powerritual"
;	endif
endif

End

# vn_raise_dead_script ========================================================
Begin vn_raise_dead_script

; first, check ingredients
; then check Player skill
; only show creatures with chance > 0
; bonemeal, corprus weepings?, ectoplasm

; 17/10/05 -- FUCK IT. I'm going to have to rewrite this bloody script from scratch.

short button

short bonemeal
short pearls
short gravedust

short ectoplasm
short emeralds

short weepings
short preparedmeat

long skill
long raise_dead_bonus
long exp_bonus

float chance
float rand
float skel1
float zomb1
float ghost1

long intskill2
long intskill

float temp
float temp2

if ( vn_raise_dead_state == 0 )
	; MessageBox "init state 0"

	set rand to Random100
	
	; base exp and chance bonus
	set exp_bonus to 1
	set raise_dead_bonus to 0

	; midnight bonus
	if ( GameHour > 23 )
			set raise_dead_bonus to ( raise_dead_bonus + 5 )
			set exp_bonus to ( exp_bonus * 5 )
	elseif ( GameHour < 1 )
			set raise_dead_bonus to ( raise_dead_bonus + 5 )
			set exp_bonus to ( exp_bonus * 5 )
	endif

	; nighttime full moon bonus
	if ( GameHour > 18 )
		if ( GetMasserPhase == 4 )
			set raise_dead_bonus to ( raise_dead_bonus + 10 )
			set exp_bonus to ( exp_bonus * 2 )
		else
			set raise_dead_bonus to ( raise_dead_bonus + 5 )
		endif
	elseif ( GameHour < 6 )
		if ( GetMasserPhase == 4 )
			set raise_dead_bonus to ( raise_dead_bonus + 10 )
			set exp_bonus to ( exp_bonus * 2 )
		else
			set raise_dead_bonus to ( raise_dead_bonus + 5 )
		endif
	endif
	if ( raise_dead_bonus == 5 ) ; night only
		MessageBox "In the black of night the dead rise more easily from the grave..."
	elseif ( raise_dead_bonus == 10 ) ; must be midnight
		MessageBox "At the heart of midnight the necromancer's power is made clear..."
	elseif ( raise_dead_bonus == 15 ) ; full moon
		MessageBox "Under the light of the full moon, graves are restless..."
	elseif ( raise_dead_bonus == 20 ) ; full moon at midnight
		MessageBox "In the midnight glow of a full moon, the dark powers are yours to control..."
	else
		MessageBox "You call on restless spirits to rise again..."
	endif
	; MessageBox "bonuses are %.2f and %.2f at %.2f", raise_dead_bonus, exp_bonus, GameHour 

	; effects of necromancy skill
	set temp to ( 2 * vn_avenue_necromancy )
	set raise_dead_bonus to ( raise_dead_bonus + temp )
	set temp to ( vn_avenue_necromancy / 5 )
	set exp_bonus to ( exp_bonus * temp )

	set vn_raise_dead_skill to ( vn_raise_dead_skill + raise_dead_bonus )

	MessageBox "Reading ingredients"

	set bonemeal to ( Player->GetItemCount ingred_bonemeal_01 )
	set ectoplasm to ( Player->GetItemCount ingred_ectoplasm_01 )
	set gravedust to ( Player->GetItemCount ingred_gravedust_01 )
	set preparedmeat to ( Player->GetItemCount vn_preparedmeat ) 
	set weepings to ( Player->GetItemCount ingred_corprus_weepings_01 )
	set pearls to ( Player->GetItemCount ingred_pearl_01 )
	set emeralds to ( Player->GetItemCount ingred_emerald_01 )

	MessageBox "Ingredients read"

	; this causes skill effects to 'tail off'
	if ( vn_raise_dead_skill < 26 )
		set skill to ( vn_raise_dead_skill * 10 )
	elseif ( vn_raise_dead_skill < 51 )
		set temp to ( vn_raise_dead_skill - 25 )
		set skill to ( 250 + ( temp * 8 ) )
	elseif ( vn_raise_dead_skill < 76 )
		set temp to ( vn_raise_dead_skill - 55 )
		set skill to ( 450 + ( temp * 6 ) )
	else
		set temp to ( vn_raise_dead_skill - 75 )
		set skill to ( 600 + ( temp * 4 ) )
	endif

	if ( ectoplasm < 1 )
		set ghost1 to -1
	else
		set ghost1 to ( skill - 20 )
	endif
	if ( bonemeal < 3 )
		set skel1 to -1
	else
		set skel1 to ( skill - 60 )
	endif
	if ( preparedmeat < 2 )
		set zomb1 to -1
	else
		set zomb1 to ( skill - 40 )
	endif

	set vn_raise_dead_state to 1
endif

if ( vn_raise_dead_state == 1 )
	; MessageBox "init state 1"
	if ( skel1 < 0 )	
		if ( zomb1 < 0 )
			if ( ghost1 < 0 )
				MessageBox "You lack either the ingredients or the skill to raise any undead"
				set vn_raise_dead_state to 21
				return
			endif
		endif
	endif
	MessageBox "Which type of creature do you wish to raise?" "Skeleton" "Bonewalker" "Ghost" "Cancel"
	set vn_raise_dead_state to 2
endif

if ( vn_raise_dead_state == 2 )
	set button to GetButtonPressed
	; MessageBox "init state 2 - %.2f", button
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set vn_raise_dead_state to 4
	elseif ( button == 1 )
		set vn_raise_dead_state to 5
	elseif ( button == 2 )
		set vn_raise_dead_state to 6
	elseif ( button == 3 )
		MessageBox "Raise dead cancelled"
		set vn_raise_dead_state to 21
		return
	endif
	set button to -1
endif

if ( vn_raise_dead_state == 4 )
	; start skeleton script, send it necessary variables
	if ( ScriptRunning "vn_raise_dead_script_skel" == 0 )
		StartScript "vn_raise_dead_script_skel"
	else
		set vn_raise_dead_script_skel.rand to rand
		set vn_raise_dead_script_skel.skill to skill 
		set vn_raise_dead_script_skel.pearls to pearls
		set vn_raise_dead_script_skel.bonemeal to bonemeal
		set vn_raise_dead_script_skel.gravedust to gravedust
		set vn_raise_dead_script_skel.state to 1 ; GO!
		set vn_raise_dead_state to 10 ; the holding state
	endif
endif

if ( vn_raise_dead_state == 5 )
	; start bonewalker script, send it necessary variables
	if ( ScriptRunning "vn_raise_dead_script_zombie" == 0 )
		StartScript "vn_raise_dead_script_zombie"
	else
		set vn_raise_dead_script_zombie.rand to rand
		set vn_raise_dead_script_zombie.skill to skill 
		set vn_raise_dead_script_zombie.preparedmeat to preparedmeat
		set vn_raise_dead_script_zombie.weepings to weepings
		set vn_raise_dead_script_zombie.state to 1 ; GO!
		set vn_raise_dead_state to 10 ; the holding state
	endif
endif

if ( vn_raise_dead_state == 6 )
	; start ghost script, send it necessary variables
	if ( ScriptRunning "vn_raise_dead_script_ghost" == 0 )
		StartScript "vn_raise_dead_script_ghost"
	else
		set vn_raise_dead_script_ghost.rand to rand
		set vn_raise_dead_script_ghost.skill to skill 
		set vn_raise_dead_script_ghost.ectoplasm to ectoplasm
		set vn_raise_dead_script_ghost.emeralds to emeralds
		set vn_raise_dead_script_ghost.state to 1 ; GO!
		set vn_raise_dead_state to 10 ; the holding state
	endif
endif

; if ( vn_raise_dead_state == 10 )
	; wait for response
; endif

if ( vn_raise_dead_state == 15 )
	; MessageBox "returned, get skill gain -- chance was %.2f, Random was %.2f", chance, Random
	; script done, give skill gain
	; gain no experience if chance was 200% or higher, otherwise gain twice as much from success as failure.
	if ( chance >= 200 )
		MessageBox "That summoning was trivial for a lich of your ability. You gain no experience from it"
		if ( raise_dead_bonus > 0 )
			set vn_raise_dead_skill to ( vn_raise_dead_skill - raise_dead_bonus )
		endif
		set vn_raise_dead_state to 21
		set temp to 0
		return
	endif
	set temp to ( 100 - vn_raise_dead_skill )
	set temp2 to ( temp / 100 )
	if ( rand > chance ) ; if ( it was not successful )
		set temp to temp2
		set temp2 to ( temp / 2 ) ; only gain half experience
	endif
	if ( raise_dead_bonus > 0 )
		set vn_raise_dead_skill to ( vn_raise_dead_skill - raise_dead_bonus )
	endif
	set temp to ( temp2 * exp_bonus )
	set intskill to vn_raise_dead_skill
	set vn_raise_dead_skill to ( vn_raise_dead_skill + temp )
	set intskill2 to vn_raise_dead_skill
	if ( intskill2 > intskill )
		MessageBox "Your Raising The Dead skill increased to %.2f" intskill2
		PlaySound "skillraise"
	endif
	; MessageBox, "Raise dead skill now %.2f - increase of %.2f", vn_raise_dead_skill, temp
	set vn_raise_dead_state to 21
endif

if ( vn_raise_dead_state == 21 )
	StopScript "vn_raise_dead_script" ; leave state on 21 so main script can detect when it's finished.
endif

End

# vn_raise_dead_script_ghost ==================================================
Begin vn_raise_dead_script_ghost

; REQUIREMENTS
; 1ancestor ghost  (1)				1ec
; 2ancestor guardian (4)			2ec
; 3Unholy Phantom (6)				2ec
; 4greater ancestor ghost (10)	3ec + 1em 
; 5primeval spirit (15)				5ec + 2em
; 6avenging phantasm (20)		8ec + 3em

short state 		; 0 by default set to '1' when this script is triggered.
short button
long skill

float ghost1
float ghost2
float ghost3
float ghost4
float ghost5
float ghost6

float chance
float rand

short ectoplasm
short emeralds

if ( state == 1 )
	if ( ectoplasm < 1 )
		set ghost1 to -1
	else
		set ghost1 to ( skill - 20 )
	endif
	if ( ectoplasm < 2 )
		set ghost2 to -1
	else
		set ghost2 to ( skill - 80 )
	endif
	if ( ectoplasm < 2 )
		set ghost3 to -1
	else
		set ghost3 to ( skill - 120 )
	endif
	if ( ectoplasm < 3 )
		set ghost4 to -1
	elseif ( emeralds < 1 )
		set ghost4 to -1 
	else
		set ghost4 to ( skill - 180 )
	endif
	if ( ectoplasm < 5 )
		set ghost5 to -1
	elseif ( emeralds < 2 )
		set ghost5 to -1
	else
		set ghost5 to ( skill - 260 )
	endif
	if ( ectoplasm < 8 )
		set ghost6 to -1
	elseif ( emeralds < 3 )
		set ghost6 to -1
	else
		set ghost6 to ( skill - 400 )
	endif
	set state to 2
endif

if ( state == 2 )
	; MessageBox "sub state 2"
	if ( ghost1 < 0 )
		MessageBox "You lack either the ingredients or the skills to raise any ghosts" "Back"
	elseif ( ghost2 < 0 )
		MessageBox "Which type of ghost do you wish to raise?" "None" "Ancestor Ghost"
	elseif ( ghost3 < 0 )
		MessageBox "Which type of ghost do you wish to raise?" "None" "Ancestor Ghost" "Ancestor Guardian" 
	elseif ( ghost4 < 0 )
		MessageBox "Which type of ghost do you wish to raise?" "None" "Ancestor Ghost" "Ancestor Guardian" "Unholy Phantom"
	elseif ( ghost5 < 0 )
		MessageBox "Which type of ghost do you wish to raise?" "None" "Ancestor Ghost" "Ancestor Guardian" "Unholy Phantom" "Greater Ancestor Ghost"
	elseif ( ghost6 < 0 )
		MessageBox "Which type of ghost do you wish to raise?" "None" "Ancestor Ghost" "Ancestor Guardian" "Unholy Phantom" "Greater Ancestor Ghost" "Primeval Spirit"
	else
		MessageBox "Which type of ghost do you wish to raise?" "None" "Ancestor Ghost" "Ancestor Guardian" "Unholy Phantom" "Greater Ancestor Ghost" "Primeval Spirit" "Avenging Phantasm"
	endif
	set state to 3
endif

if ( state == 3  ) ; raise skel
	; MessageBox "sub state 3"
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 ) ; cancel
		MessageBox "Cancel option chosen" "Ok"
		set state to 10
	elseif ( button == 1 )
		set chance to ghost1
		if ( rand < chance )
			MessageBox "You successfully raised an ancestor ghost"
			PlaceAtPC "vn_ancestor_ghost"  1 200 0
		else
			MessageBox "You failed to raise an ancestor ghost"
		endif
		Player->RemoveItem "ingred_ectoplasm_01" 1
		set state to 20
	elseif ( button == 2 )
		set chance to ghost2
		if ( rand < chance )
			MessageBox "You successfully raised an ancestor guardian"
			PlaceAtPC "vn_ancestor_guardian"  1 200 0
		else
			MessageBox "You failed to raise an ancestor guardian"
		endif
		Player->RemoveItem "ingred_ectoplasm_01" 2
		set state to 20
	elseif ( button == 3 )
		set chance to ghost3
		if ( rand < chance )
			MessageBox "You successfully raised an unholy phantom"
			PlaceAtPC "vn_ghost_phantom"  1 200 0
		else
			MessageBox "You failed to raise an unholy phantom"
		endif
		Player->RemoveItem "ingred_ectoplasm_01" 2
		set state to 20
	elseif ( button == 4 )
		set chance to ghost4
		if ( rand < chance )
			MessageBox "You successfully raised a greater ancestor ghost"
			PlaceAtPC "vn_g_ancestor_ghost"  1 200 0
		else
			MessageBox "You failed to raise a greater ancestor ghost"
		endif
		Player->RemoveItem "ingred_ectoplasm_01" 3
		Player->RemoveItem "ingred_emerald_01" 1
		set state to 20
	elseif ( button == 5 )
		set chance to ghost5
		if ( rand < chance )
			MessageBox "You successfully raised a primeval spirit"
			PlaceAtPC "vn_spectre"  1 200 0
		else
			MessageBox "You successfully raised a primeval spirit"
		endif
		Player->RemoveItem "ingred_ectoplasm_01" 5
		Player->RemoveItem "ingred_emerald_01" 2
		set state to 20
	elseif ( button == 6 )
		set chance to ghost6
		if ( rand < chance )
			MessageBox "You successfully raised an avenging phantasm"
			PlaceAtPC "vn_avenging_phantasm"  1 200 0
		else
			MessageBox "You failed to raise an avenging phantasm"
		endif
		Player->RemoveItem "ingred_ectoplasm_01" 8
		Player->RemoveItem "ingred_emerald_01" 3
		set state to 20
	else
		MessageBox "Some other option chosen %.2f" button "Ok"
	endif
	set button to -1
endif

if ( state == 10 ) ; cancel
	set vn_raise_dead_state to 1
	set state to 25
endif

if ( state == 20 ) ; done
	set vn_raise_dead_script.chance to chance
	set vn_raise_dead_state to 15
	set state to 25	
endif

if ( state == 25 ) ; terminatum
	set state to 0
	StopScript "vn_raise_dead_script_ghost"
endif

End

# vn_raise_dead_script_skel ===================================================
Begin vn_raise_dead_script_skel

; REQUIREMENTS
; 1skeleton 		3b
; 2skel archer	3b
; 3reaper	7b
; 4bonelord		8b + 2gd
; 5knight	10b + 3gd
; 6mage	10b + 3gd
; 8beserker	20b + 4gd + 1p
; 9sorcerer	20b + 4gd + 1p
; 10soul harvester	25b + 5gd + 2p
; 11lord of the undead		30b + 6gd + 3p

short state 		; 0 by default set to '1' when this script is triggered.
short button
long skill

float skel1
float skel2
float skel3
float skel4
float skel5
float skel6
float skel7
float skel8
float skel9
float skel10
float chance
float rand

short bonemeal
short pearls
short gravedust

if ( state == 1 )
	if ( bonemeal < 3 )
		set skel1 to -1
	else
		set skel1 to ( skill - 60 )
	endif
	if ( bonemeal < 3 )
		set skel2 to -1
	else
		set skel2 to ( skill - 60 )
	endif
	if ( bonemeal < 7 )
		set skel3 to -1
	else
		set skel3 to ( skill - 140 )
	endif
	if ( bonemeal < 8 )
		set skel4 to -1
	elseif ( gravedust < 2 )
		set skel4 to -1
	else
		set skel4 to ( skill - 160 )
	endif
	if ( bonemeal < 10 )
		set skel5 to -1
	elseif ( gravedust < 3 )
		set skel5 to -1
	else
		set skel5 to ( skill - 200 )
	endif
	if ( bonemeal < 10 )
		set skel6 to -1
	elseif ( gravedust < 3 )
		set skel6 to -1
	else
		set skel6 to ( skill - 200 )
	endif
	if ( bonemeal < 20 )
		set skel7 to -1
	elseif ( gravedust < 4 )
		set skel7 to -1
	elseif ( pearls < 1 )
		set skel7 to -1
	else
		set skel7 to ( skill - 400 )
	endif
	if ( bonemeal < 20 )
		set skel8 to -1
	elseif ( gravedust < 4 )
		set skel8 to -1
	elseif ( pearls < 1 )
		set skel8 to -1
	else
		set skel8 to ( skill - 400 )
	endif
	if ( bonemeal < 25 )
		set skel9 to -1
	elseif ( gravedust < 5 )
		set skel9 to -1
	elseif ( pearls < 2 )
		set skel9 to -1
	else
		set skel9 to ( skill - 500 )
	endif
	if ( bonemeal < 30 )
		set skel10 to -1
	elseif ( gravedust < 6 )
		set skel10 to -1
	elseif ( pearls < 3 )
		set skel10 to -1
	else
		set skel10 to ( skill - 600 )
	endif
	set state to 2
endif

if ( state == 2 )
	; MessageBox "sub state 2"
	if ( skel1 < 0 )
		MessageBox "You lack either the ingredients or the skills to raise any skeletons" "Back"
	elseif ( skel2 < 0 )
		MessageBox "Which type of skeleton do you wish to raise?" "None" "Skeleton"
	elseif ( skel3 < 0 )
		MessageBox "Which type of skeleton do you wish to raise?" "None" "Skeleton" "Skeleton Archer"
	elseif ( skel4 < 0 )
		MessageBox "Which type of skeleton do you wish to raise?" "None" "Skeleton" "Skeleton Archer" "Reaper"
	elseif ( skel5 < 0 )
		MessageBox "Which type of skeleton do you wish to raise?" "None" "Skeleton" "Skeleton Archer" "Reaper" "Bonelord"
	elseif ( skel6 < 0 )
		MessageBox "Which type of skeleton do you wish to raise?" "None" "Skeleton" "Skeleton Archer" "Reaper" "Bonelord" "Black Knight"
	else
		MessageBox "Which type of skeleton do you wish to raise?" "None" "Skeleton" "Skeleton Archer" "Reaper" "Bonelord" "Black Knight" "More"
	endif
	set state to 3
endif

if ( state == 3  ) ; raise skel
	; MessageBox "sub state 3"
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 ) ; cancel
		set state to 10
	elseif ( button == 1 )
		set chance to skel1
		if ( rand < chance )
			MessageBox "You successfully raised a skeleton"
			PlaceAtPC "vn_skeleton" 1 200 0
		else
			MessageBox "You failed to raise a skeleton"
		endif
		Player->RemoveItem "ingred_bonemeal_01" 3
		set state to 20
	elseif ( button == 2 )
		set chance to skel2
		if ( rand < chance )
			MessageBox "You successfully raised a skeleton archer"
			PlaceAtPC "vn_skeleton_archer"  1 200 0
		else
			MessageBox "You failed to raise a skeleton archer"
		endif
		Player->RemoveItem "ingred_bonemeal_01" 3
		set state to 20
	elseif ( button == 3 )
		set chance to skel3
		if ( rand < chance )
			MessageBox "You successfully raised a reaper"
			PlaceAtPC "vn_skeleton_reaper"  1 200 0
		else
			MessageBox "You failed to raise a reaper"
		endif
		Player->RemoveItem "ingred_bonemeal_01" 7
		set state to 20
	elseif ( button == 4 )
		set chance to skel4
		if ( rand < chance )
			MessageBox "You successfully raised a bonelord"
			PlaceAtPC "vn_skeleton_bonelord"  1 200 0
		else
			MessageBox "You failed to raise a bonelord"
		endif
		Player->RemoveItem "ingred_bonemeal_01" 8
		Player->RemoveItem "ingred_gravedust_01" 2
		set state to 20
	elseif ( button == 5 )
		set chance to skel5
		if ( rand < chance )
			MessageBox "You successfully raised a black knight"
			PlaceAtPC "vn_skeleton_knight"  1 200 0
		else
			MessageBox "You failed to raise a black knight"
		endif
		Player->RemoveItem "ingred_bonemeal_01" 10
		Player->RemoveItem "ingred_gravedust_01" 3
		set state to 20
	elseif ( button == 6 ) ; more
		set state to 4
	endif
	set button to -1
endif

if ( state == 4 ) ; raise skel menu 2
	; MessageBox "init state 8"
	if ( skel7 < 0 )
		MessageBox "Which type of skeleton do you wish to raise?" "Back" "Skeleton Mage"
	elseif ( skel8 < 0 )
		MessageBox "Which type of skeleton do you wish to raise?" "Back" "Skeleton Mage" "Crypt Guardian"
	elseif ( skel9 < 0 )
		MessageBox "Which type of skeleton do you wish to raise?" "Back" "Skeleton Mage" "Crypt Guardian" "Undead Sorcerer"
	elseif ( skel10 < 0 )
		MessageBox "Which type of skeleton do you wish to raise?" "Back" "Skeleton Mage" "Crypt Guardian" "Undead Sorcerer" "Soul Hervester"
	else
		MessageBox "Which type of skeleton do you wish to raise?" "Back" "Skeleton Mage" "Crypt Guardian" "Undead Sorcerer" "Soul Harvester" "Lord Of The Undead"
	endif
	set state to 5
endif

if ( state == 5 ) ; raise skel
	; MessageBox "init state 9"
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		set state to 2
	elseif ( button == 1 )
		set chance to skel6
		if ( rand < chance )
			MessageBox "You successfully raised a skeleton mage"
			PlaceAtPC "vn_skeleton_mage"  1 200 0
		else
			MessageBox "You failed to raise a skeleton mage"
		endif
		Player->RemoveItem "ingred_bonemeal_01" 10
		Player->RemoveItem "ingred_gravedust_01" 3
		set state to 20
	elseif ( button == 2 )
		set chance to skel7
		if ( rand < chance )
			MessageBox "You successfully raised a crypt guardian"
			PlaceAtPC "vn_skeleton_guardian"  1 200 0
		else
			MessageBox "You failed to raise a crypt guardian"
		endif
		Player->RemoveItem "ingred_bonemeal_01" 20
		Player->RemoveItem "ingred_gravedust_01" 4
		Player->RemoveItem "ingred_pearl_01" 1
		set state to 20
	elseif ( button == 3 )
		set chance to skel8
		if ( rand < chance )
			MessageBox "You successfully raised an undead sorcerer"
			PlaceAtPC "vn_skeleton_war_wizard"  1 200 0
		else
			MessageBox "You failed to raise an undead sorcerer"
		endif
		Player->RemoveItem "ingred_bonemeal_01" 20
		Player->RemoveItem "ingred_gravedust_01" 4
		Player->RemoveItem "ingred_pearl_01" 1
		set state to 20
	elseif ( button == 4 )
		set chance to skel9
		if ( rand < chance )
			MessageBox "You successfully raised a soul harvester"
			PlaceAtPC "vn_skeleton_harvester"  1 200 0
		else
			MessageBox "You failed to raise a soul harvester"
		endif
		Player->RemoveItem "ingred_bonemeal_01" 25
		Player->RemoveItem "ingred_gravedust_01" 5
		Player->RemoveItem "ingred_pearl_01" 2
		set state to 20
	elseif ( button == 5 )
		set chance to skel10
		if ( rand < chance )
			MessageBox "You successfully raised a Lord Of The Undead"
			PlaceAtPC "vn_skeleton_lord"  1 200 0
		else
			MessageBox "You failed to raise a Lord Of The Undead"
		endif
		Player->RemoveItem "ingred_bonemeal_01" 30
		Player->RemoveItem "ingred_gravedust_01" 6
		Player->RemoveItem "ingred_pearl_01" 3
		set state to 20
	endif
	set button to -1
endif

if ( state == 10 ) ; cancel
	set vn_raise_dead_state to 1
	set state to 25
endif

if ( state == 20 ) ; done
	set vn_raise_dead_script.chance to chance
	set vn_raise_dead_state to 15
	set state to 25	
endif

if ( state == 25 ) ; terminatum
	set state to 0
	StopScript "vn_raise_dead_script_skel"
endif

End

# vn_raise_dead_script_zombie =================================================
Begin vn_raise_dead_script_zombie

; REQUIREMENTS
; 1festering corpse		2lb/c
; 2bonewalker				4lb/c	
; 3greater bonewalker	7lb/c + 1cp
; 4bonewolf	10lb + 1 cp
; 5demontie 15lb/c + 2cp
; 6carrion overlord		20lb/c + 3cp

short state 		; 0 by default set to '1' when this script is triggered.
short button
long skill

float zomb1
float zomb2
float zomb3
float zomb4
float zomb5
float zomb6

float chance
float rand

short preparedmeat
short weepings

if ( state == 1 )
	if ( preparedmeat < 2 )
		set zomb1 to -1
	else
		set zomb1 to ( skill - 40 )
	endif
	if ( preparedmeat < 4 )
		set zomb2 to -1
	else
		set zomb2 to ( skill - 80 )
	endif
	if ( preparedmeat < 7 )
		set zomb3 to -1
	elseif ( weepings < 1 )
		set zomb3 to -1
	else
		set zomb3 to ( skill - 140 )
	endif
	if ( preparedmeat < 10 )
		set zomb4 to -1
	elseif ( weepings < 1 )
		set zomb4 to -1
	else
		set zomb4 to ( skill - 200 )
	endif
	if ( preparedmeat < 15 )
		set zomb5 to -1
	elseif ( weepings < 2 )
		set zomb5 to -1
	else
		set zomb5 to ( skill - 300 )
	endif
	if ( preparedmeat < 20 )
		set zomb6 to -1
	elseif ( weepings < 3 )
		set zomb6 to -1
	else
		set zomb6 to ( skill - 400 )
	endif
	set state to 2
endif

if ( state == 2 )
	; MessageBox "sub state 2"
	if ( zomb1 < 0 )
		MessageBox "You lack either the ingredients or the skills to raise any bonewalkers" "Back"
	elseif ( zomb2 < 0 )
		MessageBox "Which type of bonewalker do you wish to raise?" "None" "Festering Corpse"
	elseif ( zomb3 < 0 )
		MessageBox "Which type of bonewalker do you wish to raise?" "None" "Festering Corpse" "Bonewalker"
	elseif ( zomb4 < 0 )
		MessageBox "Which type of bonewalker do you wish to raise?" "None" "Festering Corpse" "Bonewalker" "Greater Bonewalker"
	elseif ( zomb5 < 0 )
		MessageBox "Which type of bonewalker do you wish to raise?" "None" "Festering Corpse" "Bonewalker" "Greater Bonewalker" "Bonewolf"
	elseif ( zomb6 < 0 )
		MessageBox "Which type of bonewalker do you wish to raise?" "None" "Festering Corpse" "Bonewalker" "Greater Bonewalker" "Bonewolf" "Demonite"
	else
		MessageBox "Which type of bonewalker do you wish to raise?" "None" "Festering Corpse" "Bonewalker" "Greater Bonewalker" "Bonewolf" "Demonite" "Carrion Overlord"
	endif
	set state to 3
endif

if ( state == 3  ) 
	; MessageBox "sub state 3"
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 ) ; cancel
		set state to 10
	elseif ( button == 1 )
		set chance to zomb1
		if ( rand < chance )
			MessageBox "You successfully raised a Festering Corpse"
			PlaceAtPC "vn_bonewalker_corpse"  1 200 0
		else
			MessageBox "You failed to raise Festering Corpse"
		endif
		Player->RemoveItem "vn_preparedmeat" 2
		set state to 20
	elseif ( button == 2 )
		set chance to zomb2
		if ( rand < chance )
			MessageBox "You successfully raised a bonewalker"
			PlaceAtPC "vn_bonewalker"  1 200 0
		else
			MessageBox "You failed to raise a bonewalker"
		endif
		Player->RemoveItem "vn_preparedmeat" 4
		set state to 20
	elseif ( button == 3 )
		set chance to zomb3
		if ( rand < chance )
			MessageBox "You successfully raised a greater bonewalker"
			PlaceAtPC "vn_greater_bonewalker" 1 200 0
		else
			MessageBox "You failed to raise a greater bonewalker"
		endif
		Player->RemoveItem "vn_preparedmeat" 7
		Player->RemoveItem "ingred_corprus_weepings_01" 1
		set state to 20
	elseif ( button == 4 )
		set chance to zomb4
		if ( rand < chance )
			MessageBox "You successfully raised a bonewolf"
			PlaceAtPC "vn_bonewolf" 1 200 0
		else
			MessageBox "You failed to raise a bonewolf"
		endif
		Player->RemoveItem "vn_preparedmeat" 10
		Player->RemoveItem "ingred_corprus_weepings_01" 1
		set state to 20
	elseif ( button == 5 )
		set chance to zomb5
		if ( rand < chance )
			MessageBox "You successfully raised a Demonite"
			PlaceAtPC "vn_demonite"  1 200 0
		else
			MessageBox "You failed to raise a Demonite"
		endif
		Player->RemoveItem "vn_preparedmeat" 15
		Player->RemoveItem "ingred_corprus_weepings_01" 2
		set state to 20
	elseif ( button == 6 )
		set chance to zomb6
		if ( rand < chance )
			MessageBox "You successfully raised a carrion overlord"
			PlaceAtPC "vn_monstrous_bonewalker"  1 200 0
		else
			MessageBox "You failed to raise a carrion overlord"
		endif
		Player->RemoveItem "vn_preparedmeat" 20
		Player->RemoveItem "ingred_corprus_weepings_01" 3
		set state to 20
	endif
	set button to -1
endif

if ( state == 10 ) ; cancel
	set vn_raise_dead_state to 1
	set state to 25
endif

if ( state == 20 ) ; done
	set vn_raise_dead_script.chance to chance
	set vn_raise_dead_state to 15
	set state to 25	
endif

if ( state == 25 ) ; terminatum
	set state to 0
	StopScript "vn_raise_dead_script_zombie"
endif

End

# vn_rand_test ================================================================
Begin vn_rand_test

short number_vn
short doonce

if ( doonce == 0 )
	set number_vn to Random 10
	set doonce to 1
endif

End

# vn_recruitment ==============================================================
Begin vn_recruitment

short temp
short state

if ( state == 0 )
	; MessageBox "Recruit script starting"
	set temp to ( DaysPassed + 2 )
	set state to 1
endif

if ( state == 1 )
	; MessageBox "temp %.2f", temp
	if ( GetItemCount vn_daytags < ( temp - 8 ) )
		AddItem "vn_daytags" 8
	elseif ( GetItemCount vn_daytags < temp )
		AddItem "vn_daytags" 1
	else
		AddItem "vn_daytags" 1 ; 1 extra
		set state to 2
	endif
endif

if ( state == 2 )
	set temp to Random100
	set temp to ( temp - ( Player->GetReputation ) )
	if ( GetSpellEffects "vn_pp_Voice" == 1 )
		set temp to ( temp - 15 )
		; MessageBox "Voice of the Lich Active -- 15 percent bonus"
	endif
	; MessageBox "Random was %.2f", Random100
	if ( temp < vn_avenue_psionics )
		AddItem "vn_recruittoken" 1
		; MessageBox "suceed"
	else
		; MessageBox "fail"
	endif
	set state to 3
endif

if ( state == 3 )
	; MessageBox "Recruit script finishing"
	set state to 0
	StopScript "vn_recruitment"
endif

End

# vn_relvelscript =============================================================
Begin vn_relvelscript

short speak
short disabled

if ( speak == 0 )
	ForceGreeting
	set speak to 1
	return
endif

if ( GetHealth < 1 )
	if ( disabled == 0 )
		PlaySound "conjuration hit"
		Disable
		set disabled to 1
	endif
endif

End

# vn_remove_pu ================================================================
Begin vn_remove_pu

Player->RemoveItem "vn_phylactery1_u" 1
StopScript "vn_remove_pu"

End

# vn_removeCounters ===========================================================
Begin vn_removeCounters

if ( GetItemCount vn_counter > 0 )
  RemoveItem "vn_counter" 1
else
  StopScript "vn_removeCounters"
endif

End

# vn_removefailedlichpotion ===================================================
Begin vn_removefailedlichpotion

short doonce

if ( doOnce == 0 )
	if ( Player->GetItemCount vn_lichpotion_failed > 0 )
		; MessageBox "failed potion removed from inventory"
		Player->RemoveItem "vn_lichpotion_failed" 1
		set doOnce to 1
	endif
else
	StopScript "vn_removefailedlichpotion"
endif

End

# vn_removelichpotion =========================================================
Begin vn_removelichpotion

short doonce

if ( doOnce == 0 )
	if ( vn_lich_potion_consumed == 1 ) ; normal
		if ( Player->GetItemCount vn_lichpotion > 0 )
			; MessageBox, "removed lich potion"
			Player->RemoveItem "vn_lichpotion" 1
			set doOnce to 1
		endif
	endif
	if ( vn_lich_potion_consumed == 1 ) ; vamp
		if ( Player->GetItemCount vn_lichpotion > 0 )
			; MessageBox, "removed lich potion"
			Player->RemoveItem "vn_lichpotion" 1
			set doOnce to 1
		endif
	endif
else
	StopScript "vn_removelichpotion"
endif

End

# vn_set_host_attributes ======================================================
Begin vn_set_host_attributes

; this mod needs to read the four globals with the new stats, and set the players stats accordingly
; but without ballsing up if stuff is fortified.

float strength
float agility
float speed
float endurance
short state

if ( vn_attributeswitch == 1 )
	; MessageBox, "Starting attrib set script"
	set state to 0
endif

if ( state == 0 )
	set vn_attributeswitch to 0
	; 79 fortify attrib
	; 17 drain attrib
	; 22damage attrib
	; 85 absorb attrib
	if ( Player->GetSpell "vn_lichbad" == 1 )
		Player->RemoveSpell "vn_lichbad"
		set Gals_Natural_Strength to ( Gals_Natural_Strength + 15 )
		set Gals_Natural_Agility to ( Gals_Natural_Agility + 25 )
		set Gals_Natural_Personality to ( Gals_Natural_Personality + 100 )
		return
	endif
	if ( Player->GetEffect sEffectFortifyAttribute == 1 )
		Player->RemoveEffects 79
		return
	elseif ( Player->GetEffect sEffectDrainAttribute == 1 )
		Player->RemoveEffects 17
		return
	elseif ( Player->GetEffect sEffectDamageAttribute == 1 )
		Player->RemoveEffects 22
		return
	elseif ( Player->GetEffect sEffectAbsorbAttribute == 1 )
		Player->RemoveEffects 85
		return
	else ; no effects are in place
		if ( mlRunOnce != 0 ) ; maybe check for = 1?
			MessageBox "Mad leveller in use, using alternative stat set routine"
			set strength to ( Player->GetStrength )
			set agility to ( Player->GetAgility )
			set speed to ( Player->GetSpeed )
			set endurance to ( Player->GetEndurance ) 
			set state to 2
		else
			set strength to vn_host_str
			set agility to vn_host_agl
			set endurance to vn_host_end
			set speed to vn_host_spd
	;		StopScript, vn_set_host_attributes
			MessageBox "all attribs set"
			set state to 2
		endif
	endif
endif

if ( state == 2 )
	set Gals_Natural_Strength to vn_host_str
	set Gals_Natural_Agility to vn_host_agl
	set Gals_Natural_Endurance to vn_host_end
	set Gals_Natural_Speed to vn_host_spd

	if ( mlRunOnce != 0 )
		set Adj_Strength to ( vn_host_str - strength ) 
		set Adj_Agility to ( vn_host_agl - agility )
		set Adj_Endurance to ( vn_host_end - endurance )
		set Adj_Speed to ( vn_host_spd - speed )
		StartScript "mlAdjust"
		set state to 1
	else
		Player->SetStrength strength
		Player->SetAgility agility
		Player->SetEndurance endurance
		Player->SetSpeed speed
		set state to 1
	endif
endif

		

if ( state == 1 )
	if ( ScriptRunning "mlAdjust" == 1 )
		return
	elseif ( Player->GetSpell "vn_lichbad" == 0 )
		Player->AddSpell "vn_lichbad"
		set Gals_Natural_Strength to ( Gals_Natural_Strength - 15 )
		set Gals_Natural_Agility to ( Gals_Natural_Agility - 25 )
		set Gals_Natural_Personality to ( Gals_Natural_Personality - 100 )
		return
	else
		MessageBox "You have taken the physical attributes of  your chosen host"
		set state to 0
		StopScript "vn_set_host_attributes"
	endif
	StartScript "vn_lichlevelup"
endif

End

# vn_setPosition ==============================================================
Begin vn_setPosition
; this script gets sets the Position of the Player to the 
; Position given in the global vn_TeleportCell, vn_PosX, vn_PosY, vn_PosZ and vn_Angle variables 

short ScriptState
short doOnce
float timer

if ( ScriptState ==  0 )
	if ( vn_TeleportCell < 0 ) 
		if ( vn_TeleportCell != -3 )
			MessageBox "No teleport target set"
			StopScript "vn_setPosition"
			return
		endif
	endif

	FadeOut 0.25
	set timer to 0
	set ScriptState to 1
endif

if ( ScriptState == 1 )
	; MessageBox, "Attempting to return to %.2f, %.2f, %.2f, %.2f", vn_TeleportCell, vn_PosX, vn_PosY, vn_PosZ
	set timer to ( timer + ( GetSecondsPassed ) )
	if ( timer < 0.3 )
		return
	endif
	if ( vn_TeleportCell == -3 )
		; original recall
		Player->EnableTeleporting
		; Player->AddSpell "Teleport_Recall_Effect"
		; Player->RemoveSpell "Teleport_Recall_Effect"
	elseif ( vn_TeleportCell < 128 )
		StartScript "vn_Teleport_setCell_Sub1"
	elseif ( vn_TeleportCell < 256 )
		StartScript "vn_Teleport_setCell_Sub2"
	elseif ( vn_TeleportCell < 384 )
		StartScript "vn_Teleport_setCell_Sub3"
	elseif ( vn_TeleportCell < 512 )
		StartScript "vn_Teleport_setCell_Sub4"
	elseif ( vn_TeleportCell < 640 )
		StartScript "vn_Teleport_setCell_Sub5"
	elseif ( vn_TeleportCell < 768 )
		StartScript "vn_Teleport_setCell_Sub6"
	elseif ( vn_TeleportCell < 896 )
		StartScript "vn_Teleport_setCell_Sub7"
	elseif ( vn_TeleportCell < 1024 )
		StartScript "vn_Teleport_setCell_Sub8"
	elseif ( vn_TeleportCell < 1152 )
		StartScript "vn_Teleport_setCell_Sub9"
	elseif ( vn_TeleportCell < 1300 )
		StartScript "vn_Teleport_setCell_SubA"
	elseif ( vn_TeleportCell < 1500 )
		if ( vn_PosX < -237568 )
			set vn_TeleportPluginAction to 3
		elseif ( vn_PosX >= 196608 )
			set vn_TeleportPluginAction to 3
		elseif ( vn_PosY < -155648 )
			set vn_TeleportPluginAction to 3
		elseif ( vn_PosY < -114688 )
			StartScript "vn_Teleport_setGrid_Sub1"
		elseif ( vn_PosY < -73728 )
			StartScript "vn_Teleport_setGrid_Sub2"
		elseif ( vn_PosY < -32768 )
			StartScript "vn_Teleport_setGrid_Sub3"
		elseif ( vn_PosY < 8192 )
			StartScript "vn_Teleport_setGrid_Sub4"
		elseif ( vn_PosY < 49152 )
			StartScript "vn_Teleport_setGrid_Sub5"
		elseif ( vn_PosY < 90112 )
			StartScript "vn_Teleport_setGrid_Sub6"
		elseif ( vn_PosY < 131072 )
			StartScript "vn_Teleport_setGrid_Sub7"
		elseif ( vn_PosY < 172032 )
			StartScript "vn_Teleport_setGrid_Sub8"
		elseif ( vn_PosY < 212992 )
			StartScript "vn_Teleport_setGrid_Sub9"
		elseif ( vn_PosY < 237568 )
			StartScript "vn_Teleport_setGrid_SubA"
		else
			set vn_TeleportPluginAction to 3
		endif
	elseif ( vn_TeleportCell < 1900 )
		set vn_TeleportPluginAction to 3
	elseif ( vn_TeleportCell < 2000 )
		StartScript "vn_Teleport_setCell_BloodMoon"
	else
		set vn_TeleportPluginAction to 3
	endif
	set ScriptState to 2
	return
endif

if ( ScriptState == 2 )
	if ( ScriptRunning "vn_Teleport_setCell_Sub1" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setCell_Sub2" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setCell_Sub3" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setCell_Sub4" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setCell_Sub5" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setCell_Sub6" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setCell_Sub7" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setCell_Sub8" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setCell_Sub9" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setCell_SubA" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setCell_BloodMoon" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setGrid_Sub1" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setGrid_Sub2" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setGrid_Sub3" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setGrid_Sub4" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setGrid_Sub5" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setGrid_Sub6" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setGrid_Sub7" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setGrid_Sub8" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setGrid_Sub9" == 1 )
		return
	elseif ( ScriptRunning "vn_Teleport_setGrid_SubA" == 1 )
		return
	endif

	if ( vn_TeleportPluginAction > 0 )
		if ( vn_TeleportPluginAction == 4 )
			; MessageBox, "setting Player co-ordinates"
			set timer to vn_PosX
			Player->SetPos x timer
			set timer to vn_PosY
			Player->SetPos y timer
			set timer to vn_PosZ
			Player->SetPos z timer
			set timer to vn_Angle
			Player->SetAngle z timer
		endif
		set vn_TeleportPluginAction to 0
	endif

	FadeIn 0.25

	set ScriptState to 0
	; MessageBox, "ending teleport script"
	StopScript "vn_setPosition"
	return
endif

End

# vn_spirit_stone_script ======================================================
Begin vn_spirit_stone_script

; stores an ancestor ghost. Only need to know what type

; 1 = ancestor ghost
; 2 = ancestor guardian
; 3 = greater ancestor ghost
; 4 = primeval spirit
; 5 = avenging phantasm

short state
long temp
long type1
long type2
long type3
long type4
long type5
short button
short OnPCEquip

if ( vn_ghost != 0 )
	if ( vn_ghost == 1 )
		set temp to ( type1 + 1 )
		set type1 to temp
		set vn_ghost to 0
		MessageBox "Ancestor ghost added to spirit stone"
	elseif ( vn_ghost == 2 )
		set temp to ( type2 + 1 )
		set type2 to temp
		set vn_ghost to 0
		MessageBox "Ancestor guardian added to spirit stone"
	elseif ( vn_ghost == 3 )
		set temp to ( type3 + 1 )
		set type3 to temp
		set vn_ghost to 0
		MessageBox "Greater ancestor ghost added to spirit stone"
	elseif ( vn_ghost == 4 )
		set temp to ( type4 + 1 )
		set type4 to temp
		set vn_ghost to 0
		MessageBox "Primeval spirit added to spirit stone"
	elseif ( vn_ghost == 5 )
		set temp to ( type5 + 1 )
		set type5 to temp
		set vn_ghost to 0
		MessageBox "Avenging Phantasm added to spirit stone"
	endif
endif

if ( state == 0 )
	if ( OnPCEquip == 1 )
		MessageBox "Activate which type of ghost? ( %G, %G, %G, %G, %G ) " type1 type2 type3 type4 type5 "Ancestor Ghost" "Ancestor Guardian" "Greater Ancestor Ghost" "Primeval Spirit" "Avenging Phantasm" "Cancel"
		set OnPCEquip to 0
		set state to 1
	endif
endif

if ( state == 1 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		if ( type1 > 0 )
			MessageBox "You summoned an Ancestor Ghost from the spirit stone"
			PlaceAtPC "vn_ancestor_ghost" 1 200 0
			set type1 to ( type1 - 1 )
		else
			MessageBox "You have no Ancestor Ghosts to summon"
		endif
	elseif ( button == 1 )
		if ( type2 > 0 )
			MessageBox "You summoned an Ancestor Guardian from the spirit stone"
			PlaceAtPC "vn_ancestor_guardian" 1 200 0
			set type2 to ( type2 - 1 )
		else
			MessageBox "You have no Ancestor Guardians to summon"
		endif
	elseif ( button == 2 )
		if ( type3 > 0 )
			MessageBox "You summoned a Greater Ancestor Ghost from the spirit stone"
			PlaceAtPC "vn_g_ancestor_ghost" 1 200 0
			set type3 to ( type3 - 1 )
		else
			MessageBox "You have no Greater Ancestor Ghosts to summon"
		endif
	elseif ( button == 3 )
		if ( type4 > 0 )
			MessageBox "You summoned a Primeval Spirit from the spirit stone"
			PlaceAtPC "vn_spectre" 1 200 0
			set type4 to ( type4 - 1 )
		else
			MessageBox "You have no Primeval Spirits to summon"
		endif
	elseif ( button == 4 )
		if ( type5 > 0 )
			MessageBox "You summoned an Avenging Phantasm from the spirit stone"
			PlaceAtPC "vn_avenging_phantasm" 1 200 0
			set type5 to ( type5 - 1 )
		else
			MessageBox "You have no Avening Phantasms to summon"
		endif
	endif
	set state to 0
endif

End

# vn_spoiler_skull_script =====================================================
Begin vn_spoiler_skull_script

short state
short button

if ( state == 0 )
	if ( OnActivate == 1 )
		MessageBox "Oh, fine. Go on then. At the End of the Day, you're only cheating yourself. I hope your conscience can live with that. What's your question?" "Where is the secret library?"  "Who do I talk to about the phylactery?"  "Who do I talk to about the enchant spell?" "Where can I find an empty potion bottle?" "Where can I find the ingredients for the phylactery?" "Where can I find the ingredients for the potion?"  "I keep failing the ritual. Why?" "More Questions...." "Cancel"
		set state to 1
	endif
endif

if ( state == 1 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		MessageBox "There are trapdoors in the Justice Offices & Hall of Justice in Vivec. These lead to a secret room. There you'll find the secret library" "Ok"
	elseif ( button == 1 )
		MessageBox "Talk to any high level smith. You might try the craftsman's guild in Mournhold" "Ok"
	elseif ( button == 2 )
		MessageBox "Various high level mages/sorcerers will teach you this spell. Asciene Rane for one." "Ok"
	elseif ( button == 3 )
		MessageBox "Silronwe of Vivec Mages Guild has three in her cupboard. Verick Germain in Caldera also has two." "Ok"
	elseif ( button == 4 )
		MessageBox "Phylactery Ingredients list has been added to your inventory"
		Player->AddItem "vn_spoiler_phylactery_ingred" 1
	elseif ( button == 5 )
		MessageBox "Lich potion ingredients list has been added to your inventory"
		Player->AddItem "vn_spoiler_potion_ingred" 1
	elseif ( button == 6 )
		MessageBox "Either your potion failed, or you didn't drink it at 12am ( midnight ) . Check you put the right ingredients in the potion, and maybe you'll be luckier next time." "Ok"
	elseif ( button == 7 )
		set state to 2
		set button to -1
		return
	elseif ( button == 8 )
		set state to 0
	endif
	set state to 0
	set button to -1
endif

if ( state == 2 )
	MessageBox "What is your question?" "What's so special about the Lich Crown?" "Where is the Spirit Stone?" "Where is the Lich's Mortar and Pestle?" "Where are the Power Skulls?" "Cancel"
	set state to 3
endif

if ( state == 3 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	elseif ( button == 0 )
		MessageBox "Some things I'm going to keep secret. That's one of them. Sorry!" "Ok"
	elseif ( button == 1 )
		MessageBox "In the corprasium, take a right after you enter and followe the passage to the final submerged chamber. Look amongst the rocks at the back." "Ok"
	elseif ( button == 2 )
		MessageBox "In Gedna Relvel's Tomb. Go to the Mournhold Temple, take the basement trapdoor into the sewers, and stay to the right when you reach the junction." "Ok"
	elseif ( button == 3 )
		MessageBox "Arethan Ancestral Tomb, southwest of Erabenimsum, north-northwest of Molag Mar" "Ok"
	elseif ( button == 4 )
		set state to 0
		set button to -1
		return
	endif
	set state to 0
	set button to -1
endif

End

# vn_spoonscript ==============================================================
Begin vn_spoonscript

short doOnce

if ( OnActivate == 1 )
	MessageBox "There is no spoon" ; this script is attacked to a spoon after all : )
endif

if ( doOnce == 0 )
	if ( ScriptRunning "vn_ordercheck" == 0 )
		StartScript "vn_ordercheck"
	endif
	set doOnce to 1
endif

End

# vn_Teleport_getCell_Sub1 ====================================================
Begin vn_Teleport_getCell_Sub1

short cell
set cell to -1

if ( GetPCCell "Buckmoth Legion Fort, Towers" == 1 )
set cell to 251
elseif ( GetPCCell "Buckmoth Legion Fort, Prison" == 1 )
set cell to 250
elseif ( GetPCCell "Buckmoth Legion Fort, Interior" == 1 )
set cell to 249
elseif ( GetPCCell "Bthungthumz" == 1 )
set cell to 248
elseif ( GetPCCell "Bthuand" == 1 )
set cell to 247
elseif ( GetPCCell "Bthanchend" == 1 )
set cell to 246
elseif ( GetPCCell "Big Head's Shack" == 1 )
set cell to 245
elseif ( GetPCCell "Beshara" == 1 )
set cell to 244
elseif ( GetPCCell "Berandas, Underground" == 1 )
set cell to 243
elseif ( GetPCCell "Berandas, Propylon Chamber" == 1 )
set cell to 242
elseif ( GetPCCell "Berandas, Keep, Top Level" == 1 )
set cell to 241
elseif ( GetPCCell "Berandas, Keep, Bottom Level" == 1 )
set cell to 240
elseif ( GetPCCell "Beran Ancestral Tomb" == 1 )
set cell to 239
elseif ( GetPCCell "Bensiberib Camp, Odaishah's Yurt" == 1 )
set cell to 238
elseif ( GetPCCell "Bensamsi" == 1 )
set cell to 237
elseif ( GetPCCell "Baram Ancestral Tomb" == 1 )
set cell to 236
elseif ( GetPCCell "Band Egg Mine" == 1 )
set cell to 235
elseif ( GetPCCell "Balur's Farmhouse" == 1 )
set cell to 226
elseif ( GetPCCell "Balmora, Western Guard Tower South" == 1 )
set cell to 225
elseif ( GetPCCell "Balmora, Western Guard Tower North" == 1 )
set cell to 224
elseif ( GetPCCell "Balmora, Vori's House" == 1 )
set cell to 223
elseif ( GetPCCell "Balmora, Vorar Helas' House" == 1 )
set cell to 222
elseif ( GetPCCell "Balmora, Tyravel Manor" == 1 )
set cell to 221
elseif ( GetPCCell "Balmora, Tyermaillin's House" == 1 )
set cell to 220
elseif ( GetPCCell "Balmora, Tsiya's House" == 1 )
set cell to 219
elseif ( GetPCCell "Balmora, The Razor Hole" == 1 )
set cell to 218
elseif ( GetPCCell "Balmora, Temple" == 1 )
set cell to 217
elseif ( GetPCCell "Balmora, South Wall Cornerclub" == 1 )
set cell to 216
elseif ( GetPCCell "Balmora, Rithleen's House" == 1 )
set cell to 215
elseif ( GetPCCell "Balmora, Rarayn Radarys' House" == 1 )
set cell to 214
elseif ( GetPCCell "Balmora, Ra'Virr: Trader" == 1 )
set cell to 213
elseif ( GetPCCell "Balmora, Nine Toes' House" == 1 )
set cell to 212
elseif ( GetPCCell "Balmora, Nerano Manor" == 1 )
set cell to 211
elseif ( GetPCCell "Balmora, Nalcarya of White Haven: Fine Alchemist" == 1 )
set cell to 210
elseif ( GetPCCell "Balmora, Morag Tong Guild" == 1 )
set cell to 209
elseif ( GetPCCell "Balmora, Milie Hastien: Fine Clothier" == 1 )
set cell to 208
elseif ( GetPCCell "Balmora, Meldor: Armorer" == 1 )
set cell to 207
elseif ( GetPCCell "Balmora, Lucky Lockup" == 1 )
set cell to 206
elseif ( GetPCCell "Balmora, Karlirah's House" == 1 )
set cell to 205
elseif ( GetPCCell "Balmora, Itan's House" == 1 )
set cell to 204
elseif ( GetPCCell "Balmora, Hlaalu Council Manor" == 1 )
set cell to 203
elseif ( GetPCCell "Balmora, Hlaalo Manor" == 1 )
set cell to 202
elseif ( GetPCCell "Balmora, Hecerinde's House" == 1 )
set cell to 201
elseif ( GetPCCell "Balmora, Guild of Mages" == 1 )
set cell to 200
elseif ( GetPCCell "Balmora, Guild of Fighters" == 1 )
set cell to 199
elseif ( GetPCCell "Balmora, Fast Eddie's House" == 1 )
set cell to 198
elseif ( GetPCCell "Balmora, Eight Plates" == 1 )
set cell to 197
elseif ( GetPCCell "Balmora, Eastern Guard Tower" == 1 )
set cell to 196
elseif ( GetPCCell "Balmora, Dura gra-Bol's House" == 1 )
set cell to 195
elseif ( GetPCCell "Balmora, Drarayne Thelas' Storage" == 1 )
set cell to 194
elseif ( GetPCCell "Balmora, Drarayne Thelas' House" == 1 )
set cell to 193
elseif ( GetPCCell "Balmora, Dralosa Athren's House" == 1 )
set cell to 192
elseif ( GetPCCell "Balmora, Dralcea Arethi's House" == 1 )
set cell to 191
elseif ( GetPCCell "Balmora, Dralasa Nithryon: Pawnbroker" == 1 )
set cell to 190
elseif ( GetPCCell "Balmora, Dorisa Darvel: Bookseller" == 1 )
set cell to 189
elseif ( GetPCCell "Balmora, Council Club" == 1 )
set cell to 188
elseif ( GetPCCell "Balmora, Clagius Clanler: Outfitter" == 1 )
set cell to 187
elseif ( GetPCCell "Balmora, Caius Cosades' House" == 1 )
set cell to 186
elseif ( GetPCCell "Balmora, Balyn Omarel's House" == 1 )
set cell to 185
elseif ( GetPCCell "Balmora, Astius Hanotepelus' House" == 1 )
set cell to 184
elseif ( GetPCCell "Bal Ur, Underground" == 1 )
set cell to 183
elseif ( GetPCCell "Bal Ur, Shrine" == 1 )
set cell to 182
elseif ( GetPCCell "Bal Fell, West Wing" == 1 )
set cell to 181
elseif ( GetPCCell "Bal Fell, Outer Shrine" == 1 )
set cell to 180
elseif ( GetPCCell "Bal Fell, Inner Shrine" == 1 )
set cell to 179
elseif ( GetPCCell "Bal Fell, East Wing" == 1 )
set cell to 178
elseif ( GetPCCell "Assurnabitashpi, Shrine" == 1 )
set cell to 177
elseif ( GetPCCell "Assurnabitashpi" == 1 )
set cell to 176
elseif ( GetPCCell "Assurdirapal, Shrine" == 1 )
set cell to 175
elseif ( GetPCCell "Assurdirapal, Inner Shrine" == 1 )
set cell to 174
elseif ( GetPCCell "Assumanu" == 1 )
set cell to 173
elseif ( GetPCCell "Assu" == 1 )
set cell to 172
elseif ( GetPCCell "Assernerairan, Shrine" == 1 )
set cell to 171
elseif ( GetPCCell "Assemanu, Shrine" == 1 )
set cell to 170
elseif ( GetPCCell "Assemanu" == 1 )
set cell to 169
elseif ( GetPCCell "Assarnud" == 1 )
set cell to 168
elseif ( GetPCCell "Assarnatamat, Shrine" == 1 )
set cell to 167
elseif ( GetPCCell "Assalkushalit, Shrine" == 1 )
set cell to 166
elseif ( GetPCCell "Ashurnibibi, Shrine" == 1 )
set cell to 165
elseif ( GetPCCell "Ashunartes, Shrine" == 1 )
set cell to 164
elseif ( GetPCCell "Ashmelech" == 1 )
set cell to 163
elseif ( GetPCCell "Ashirbadon" == 1 )
set cell to 162
elseif ( GetPCCell "Ashir-Dan" == 1 )
set cell to 161
elseif ( GetPCCell "Ashinabi, Smuggler Den" == 1 )
set cell to 160
elseif ( GetPCCell "Ashinabi" == 1 )
set cell to 159
elseif ( GetPCCell "Ashimanu Egg Mine, Queen's Lair" == 1 )
set cell to 158
elseif ( GetPCCell "Ashimanu Egg Mine" == 1 )
set cell to 157
elseif ( GetPCCell "Ashanammu" == 1 )
set cell to 156
elseif ( GetPCCell "Ashamanu Camp, Kausha's Yurt" == 1 )
set cell to 155
elseif ( GetPCCell "Ashalmimilkala, Shrine" == 1 )
set cell to 154
elseif ( GetPCCell "Ashalmawia, Shrine, Sunken Vaults" == 1 )
set cell to 153
elseif ( GetPCCell "Ashalmawia, Shrine" == 1 )
set cell to 152
elseif ( GetPCCell "Asha-Ahhe Egg Mine" == 1 )
set cell to 151
elseif ( GetPCCell "Arys Ancestral Tomb" == 1 )
set cell to 150
elseif ( GetPCCell "Aryon Ancestral Tomb" == 1 )
set cell to 149
elseif ( GetPCCell "Arvel Manor, Storage Shack" == 1 )
set cell to 148
elseif ( GetPCCell "Arvel Manor, Slavemaster's Shack" == 1 )
set cell to 147
elseif ( GetPCCell "Arvel Manor, Slave Shack" == 1 )
set cell to 146
elseif ( GetPCCell "Arvel Manor" == 1 )
set cell to 145
elseif ( GetPCCell "Arrow, Upper Level" == 1 )
set cell to 144
elseif ( GetPCCell "Arrow, Lower Level" == 1 )
set cell to 143
elseif ( GetPCCell "Arrow, Cabin" == 1 )
set cell to 142
elseif ( GetPCCell "Arkngthunch-Sturdumz" == 1 )
set cell to 141
elseif ( GetPCCell "Arkngthand, Weepingbell Hall" == 1 )
set cell to 140
elseif ( GetPCCell "Arkngthand, Land's Blood Gallery" == 1 )
set cell to 139
elseif ( GetPCCell "Arkngthand, Heaven's Gallery" == 1 )
set cell to 138
elseif ( GetPCCell "Arkngthand, Hall of Centrifuge" == 1 )
set cell to 137
elseif ( GetPCCell "Arkngthand, Deep Ore Passage" == 1 )
set cell to 136
elseif ( GetPCCell "Arkngthand, Cells of Hollow Hand" == 1 )
set cell to 135
elseif ( GetPCCell "Arethan Ancestral Tomb" == 1 )
set cell to 134
elseif ( GetPCCell "Arenim Ancestral Tomb" == 1 )
set cell to 133
elseif ( GetPCCell "Arano Plantation" == 1 )
set cell to 132
elseif ( GetPCCell "Arano Ancestral Tomb" == 1 )
set cell to 131
elseif ( GetPCCell "Aran Ancestral Tomb" == 1 )
set cell to 130
elseif ( GetPCCell "Aralen Ancestral Tomb" == 1 )
set cell to 129
elseif ( GetPCCell "Ansi" == 1 )
set cell to 128
elseif ( GetPCCell "Andules Ancestral Tomb" == 1 )
set cell to 127
elseif ( GetPCCell "Andrethi Ancestral Tomb" == 1 )
set cell to 126
elseif ( GetPCCell "Andrano Ancestral Tomb" == 1 )
set cell to 125
elseif ( GetPCCell "Andavel Ancestral Tomb" == 1 )
set cell to 124
elseif ( GetPCCell "Andasreth, Upper Level" == 1 )
set cell to 123
elseif ( GetPCCell "Andasreth, Propylon Chamber" == 1 )
set cell to 122
elseif ( GetPCCell "Andasreth, Lower Level" == 1 )
set cell to 121
elseif ( GetPCCell "Andas Ancestral Tomb" == 1 )
set cell to 120
elseif ( GetPCCell "Andalor Ancestral Tomb" == 1 )
set cell to 119
elseif ( GetPCCell "Andalen Ancestral Tomb" == 1 )
set cell to 118
elseif ( GetPCCell "Ancient Shipwreck, Upper Level" == 1 )
set cell to 117
elseif ( GetPCCell "Ancient Shipwreck, Lower Level" == 1 )
set cell to 116
elseif ( GetPCCell "Ancient Shipwreck, Cabin" == 1 )
set cell to 115
elseif ( GetPCCell "An Abandoned Shack" == 1 )
set cell to 114
elseif ( GetPCCell "Alof's Farmhouse" == 1 )
set cell to 113
elseif ( GetPCCell "Almurbalarammi, Shrine" == 1 )
set cell to 112
elseif ( GetPCCell "Alen Ancestral Tomb" == 1 )
set cell to 111
elseif ( GetPCCell "Aleft" == 1 )
set cell to 110
elseif ( GetPCCell "Ald-ruhn, Venim Manor Right Wing" == 1 )
set cell to 109
elseif ( GetPCCell "Ald-ruhn, Venim Manor Private Quarters" == 1 )
set cell to 108
elseif ( GetPCCell "Ald-ruhn, Venim Manor Guard Quarters" == 1 )
set cell to 107
elseif ( GetPCCell "Ald-ruhn, Venim Manor Entrance" == 1 )
set cell to 106
elseif ( GetPCCell "Ald-ruhn, Venim Manor Bedrooms" == 1 )
set cell to 105
elseif ( GetPCCell "Ald-ruhn, Tuveso Beleth: Smith" == 1 )
set cell to 104
elseif ( GetPCCell "Ald-ruhn, Tiras Sadus: General Merchandise" == 1 )
set cell to 103
elseif ( GetPCCell "Ald-ruhn, The Rat In The Pot" == 1 )
set cell to 102
elseif ( GetPCCell "Ald-ruhn, Temple" == 1 )
set cell to 101
elseif ( GetPCCell "Ald-ruhn, Tauryon's House" == 1 )
set cell to 100
elseif ( GetPCCell "Ald-ruhn, Sarethi Manor" == 1 )
set cell to 99
elseif ( GetPCCell "Ald-ruhn, Sarethi Guard Quarters" == 1 )
set cell to 98
elseif ( GetPCCell "Ald-ruhn, Redoran Council Hall" == 1 )
set cell to 97
elseif ( GetPCCell "Ald-ruhn, Redoran Council Entrance" == 1 )
set cell to 96
elseif ( GetPCCell "Ald-ruhn, Ramoran Private Quarters" == 1 )
set cell to 95
elseif ( GetPCCell "Ald-ruhn, Ramoran Manor" == 1 )
set cell to 94
elseif ( GetPCCell "Ald-ruhn, Practice Room" == 1 )
set cell to 93
elseif ( GetPCCell "Ald-ruhn, Pellecia Aurrus's House" == 1 )
set cell to 92
elseif ( GetPCCell "Ald-ruhn, Morvayn Quarters" == 1 )
set cell to 91
elseif ( GetPCCell "Ald-ruhn, Morag Tong Guildhall" == 1 )
set cell to 90
elseif ( GetPCCell "Ald-ruhn, Manor District" == 1 )
set cell to 89
elseif ( GetPCCell "Ald-ruhn, Malpenix Blonia: Trader" == 1 )
set cell to 88
elseif ( GetPCCell "Ald-ruhn, Llethri Private Quarters" == 1 )
set cell to 87
elseif ( GetPCCell "Ald-ruhn, Llethri Manor Entrance" == 1 )
set cell to 86
elseif ( GetPCCell "Ald-ruhn, Llethri Manor Bedrooms" == 1 )
set cell to 85
elseif ( GetPCCell "Ald-ruhn, Llethri Guard Quarters" == 1 )
set cell to 84
elseif ( GetPCCell "Ald-ruhn, Llether Vari: Enchanter" == 1 )
set cell to 83
elseif ( GetPCCell "Ald-ruhn, Ilmiril's House" == 1 )
set cell to 82
elseif ( GetPCCell "Ald-ruhn, Ienas Sarandas's House" == 1 )
set cell to 81
elseif ( GetPCCell "Ald-ruhn, Hanarai Assutlanipal's House" == 1 )
set cell to 80
elseif ( GetPCCell "Ald-ruhn, Guls Llervu's House" == 1 )
set cell to 79
elseif ( GetPCCell "Ald-ruhn, Guild of Mages" == 1 )
set cell to 78
elseif ( GetPCCell "Ald-ruhn, Guild of Fighters" == 1 )
set cell to 77
elseif ( GetPCCell "Ald-ruhn, Guard Tower 2" == 1 )
set cell to 76
elseif ( GetPCCell "Ald-ruhn, Guard Tower 1" == 1 )
set cell to 75
elseif ( GetPCCell "Ald-ruhn, Goras Andrelo's House" == 1 )
set cell to 74
elseif ( GetPCCell "Ald-ruhn, Gindrala Hleran's House" == 1 )
set cell to 73
elseif ( GetPCCell "Ald-ruhn, Gildan's House" == 1 )
set cell to 72
elseif ( GetPCCell "Ald-ruhn, Galthragoth's House" == 1 )
set cell to 71
elseif ( GetPCCell "Ald-ruhn, Galsa Gindu's House" == 1 )
set cell to 70
elseif ( GetPCCell "Ald-ruhn, Drinar Varyon's House" == 1 )
set cell to 69
elseif ( GetPCCell "Ald-ruhn, Dravasa Andrethi's House" == 1 )
set cell to 68
elseif ( GetPCCell "Ald-ruhn, Daynes Redothril: Pawnbroker" == 1 )
set cell to 67
elseif ( GetPCCell "Ald-ruhn, Dandera Selaro: Smith" == 1 )
set cell to 66
elseif ( GetPCCell "Ald-ruhn, Council Hostel" == 1 )
set cell to 65
elseif ( GetPCCell "Ald-ruhn, Council Club" == 1 )
set cell to 64
elseif ( GetPCCell "Ald-ruhn, Codus Callonus: Bookseller" == 1 )
set cell to 63
elseif ( GetPCCell "Ald-ruhn, Cienne Sintieve: Alchemist" == 1 )
set cell to 62
elseif ( GetPCCell "Ald-ruhn, Braynas Hlervu's House" == 1 )
set cell to 61
elseif ( GetPCCell "Ald-ruhn, Boldrisa Andrano's House" == 1 )
set cell to 60
elseif ( GetPCCell "Ald-ruhn, Bivale Teneran: Clothier" == 1 )
set cell to 59
elseif ( GetPCCell "Ald-ruhn, Bevene Releth: Clothier" == 1 )
set cell to 58
elseif ( GetPCCell "Ald-ruhn, Aryni Orethi's House" == 1 )
set cell to 57
elseif ( GetPCCell "Ald-ruhn, Arobar Private Quarters" == 1 )
set cell to 56
elseif ( GetPCCell "Ald-ruhn, Arobar Manor Entrance" == 1 )
set cell to 55
elseif ( GetPCCell "Ald-ruhn, Arobar Manor Bedrooms" == 1 )
set cell to 54
elseif ( GetPCCell "Ald-ruhn, Arobar Guard Quarters" == 1 )
set cell to 53
elseif ( GetPCCell "Ald-ruhn, Ald Skar Inn" == 1 )
set cell to 52
elseif ( GetPCCell "Ald Velothi, Vireveri Darethran's Shack" == 1 )
set cell to 51
elseif ( GetPCCell "Ald Velothi, Sathas Rivul's Shack" == 1 )
set cell to 50
elseif ( GetPCCell "Ald Velothi, Outpost" == 1 )
set cell to 49
elseif ( GetPCCell "Ald Velothi, Llerar Vinden's Shack" == 1 )
set cell to 48
elseif ( GetPCCell "Ald Velothi, Lledsea Relas's Shack" == 1 )
set cell to 47
elseif ( GetPCCell "Ald Velothi, Ienas Arvel's Shack" == 1 )
set cell to 46
elseif ( GetPCCell "Ald Velothi, Ganus Lloryn's Shack" == 1 )
set cell to 45
elseif ( GetPCCell "Ald Velothi, Fevila Bethrano's Shack" == 1 )
set cell to 44
elseif ( GetPCCell "Ald Sotha, Upper Level" == 1 )
set cell to 43
elseif ( GetPCCell "Ald Sotha, Shrine" == 1 )
set cell to 42
elseif ( GetPCCell "Ald Sotha, Lower Level" == 1 )
set cell to 41
elseif ( GetPCCell "Ald Redaynia, Tower" == 1 )
set cell to 40
elseif ( GetPCCell "Ald Daedroth, Right Wing" == 1 )
set cell to 39
elseif ( GetPCCell "Ald Daedroth, Outer Shrine" == 1 )
set cell to 38
elseif ( GetPCCell "Ald Daedroth, Left Wing" == 1 )
set cell to 37
elseif ( GetPCCell "Ald Daedroth, Inner Shrine" == 1 )
set cell to 36
elseif ( GetPCCell "Ald Daedroth, Antechamber" == 1 )
set cell to 35
elseif ( GetPCCell "Alas Ancestral Tomb" == 1 )
set cell to 34
elseif ( GetPCCell "Akulakhan's Chamber" == 1 )
set cell to 33
elseif ( GetPCCell "Akimaes-Ilanipu Egg Mine" == 1 )
set cell to 32
elseif ( GetPCCell "Akimaes Grotto" == 1 )
set cell to 31
elseif ( GetPCCell "Ainat" == 1 )
set cell to 30
elseif ( GetPCCell "Ainab, Shrine" == 1 )
set cell to 29
elseif ( GetPCCell "Ainab" == 1 )
set cell to 28
elseif ( GetPCCell "Aidanat Camp, Abassel's Yurt" == 1 )
set cell to 27
elseif ( GetPCCell "Ahinipalit" == 1 )
set cell to 26
elseif ( GetPCCell "Ahemmusa Camp, Wise Woman's Yurt" == 1 )
set cell to 25
elseif ( GetPCCell "Ahemmusa Camp, Nummu's Yurt" == 1 )
set cell to 24
elseif ( GetPCCell "Ahemmusa Camp, Mamaea's Yurt" == 1 )
set cell to 23
elseif ( GetPCCell "Ahemmusa Camp, Lanabi's Yurt" == 1 )
set cell to 22
elseif ( GetPCCell "Ahemmusa Camp, Kausi's Yurt" == 1 )
set cell to 21
elseif ( GetPCCell "Ahemmusa Camp, Dutadalk's Yurt" == 1 )
set cell to 20
elseif ( GetPCCell "Ahemmusa Camp, Assamma-Idan's Yurt" == 1 )
set cell to 19
elseif ( GetPCCell "Ahemmusa Camp, Ashkhan's Yurt" == 1 )
set cell to 18
elseif ( GetPCCell "Ahemmusa Camp, Addammus's Yurt" == 1 )
set cell to 17
elseif ( GetPCCell "Aharunartus" == 1 )
set cell to 16
elseif ( GetPCCell "Aharnabi" == 1 )
set cell to 15
elseif ( GetPCCell "Aharasaplit Camp, Zallay's Yurt" == 1 )
set cell to 14
elseif ( GetPCCell "Ahanibi-Malmus Egg Mine" == 1 )
set cell to 13
elseif ( GetPCCell "Ahallaraddon Egg Mine" == 1 )
set cell to 12
elseif ( GetPCCell "Addamasartus" == 1 )
set cell to 11
elseif ( GetPCCell "Addadshashanammu, Shrine" == 1 )
set cell to 10
elseif ( GetPCCell "Adanumuran" == 1 )
set cell to 9
elseif ( GetPCCell "Abinabi" == 1 )
set cell to 8
elseif ( GetPCCell "Abernanit" == 1 )
set cell to 7
elseif ( GetPCCell "Abebaal Egg Mine" == 1 )
set cell to 6
elseif ( GetPCCell "Abandoned Shipwreck, Upper Level" == 1 )
set cell to 5
elseif ( GetPCCell "Abandoned Shipwreck, Lower Level" == 1 )
set cell to 4
elseif ( GetPCCell "Abandoned Shipwreck, Cabin" == 1 )
set cell to 3
elseif ( GetPCCell "Abanabi" == 1 )
set cell to 2
elseif ( GetPCCell "Abaesen-Pulu Egg Mine" == 1 )
set cell to 1
elseif ( GetPCCell "Abaelun Mine" == 1 )
set cell to 0
endif

if ( cell != -1 )
	set vn_TeleportCell to cell
endif

StopScript "vn_Teleport_getCell_Sub1"

End

# vn_Teleport_getCell_Sub2 ====================================================
Begin vn_Teleport_getCell_Sub2

short cell
set cell to -1

if ( GetPCCell "Kora-Dur" == 1 )
set cell to 511
elseif ( GetPCCell "Kogoruhn, Vault of Aerode" == 1 )
set cell to 510
elseif ( GetPCCell "Kogoruhn, Temple of Fey" == 1 )
set cell to 509
elseif ( GetPCCell "Kogoruhn, Nabith Waterway" == 1 )
set cell to 508
elseif ( GetPCCell "Kogoruhn, Hall of the Watchful Touch" == 1 )
set cell to 507
elseif ( GetPCCell "Kogoruhn, Hall of Phisto" == 1 )
set cell to 506
elseif ( GetPCCell "Kogoruhn, Hall of Maki" == 1 )
set cell to 505
elseif ( GetPCCell "Kogoruhn, Dome of Urso" == 1 )
set cell to 504
elseif ( GetPCCell "Kogoruhn, Dome of Pollock's Eve" == 1 )
set cell to 503
elseif ( GetPCCell "Kogoruhn, Charma's Breath" == 1 )
set cell to 502
elseif ( GetPCCell "Kogoruhn, Bleeding Heart" == 1 )
set cell to 501
elseif ( GetPCCell "Koal Cave" == 1 )
set cell to 500
elseif ( GetPCCell "Khuul, Thongar's Tradehouse" == 1 )
set cell to 499
elseif ( GetPCCell "Khuul, Svadstar's Shack" == 1 )
set cell to 498
elseif ( GetPCCell "Khuul, Rivame Samandas's Shack" == 1 )
set cell to 497
elseif ( GetPCCell "Khuul, Nelmyne Andules's Shack" == 1 )
set cell to 496
elseif ( GetPCCell "Khuul, Miron Garer's Shack" == 1 )
set cell to 495
elseif ( GetPCCell "Khuul, Helga's Shack" == 1 )
set cell to 494
elseif ( GetPCCell "Khuul, Endris Dilmyn's Shack" == 1 )
set cell to 493
elseif ( GetPCCell "Khuul, Brurid's Shack" == 1 )
set cell to 492
elseif ( GetPCCell "Khuul, Aldi's Shack" == 1 )
set cell to 491
elseif ( GetPCCell "ken's test hole" == 1 )
set cell to 490
elseif ( GetPCCell "Kaushtarari, Shrine" == 1 )
set cell to 489
elseif ( GetPCCell "Kaushtababi Camp, Adibael's Yurt" == 1 )
set cell to 488
elseif ( GetPCCell "Indoranyon, Propylon Chamber" == 1 )
set cell to 487
elseif ( GetPCCell "Indoranyon" == 1 )
set cell to 486
elseif ( GetPCCell "Indarys Manor, Raram's House" == 1 )
set cell to 485
elseif ( GetPCCell "Indarys Manor, Manor Services" == 1 )
set cell to 484
elseif ( GetPCCell "Indarys Manor, Berendas' House" == 1 )
set cell to 483
elseif ( GetPCCell "Indarys Manor" == 1 )
set cell to 482
elseif ( GetPCCell "Indaren Ancestral Tomb" == 1 )
set cell to 481
elseif ( GetPCCell "Indalen Ancestral Tomb" == 1 )
set cell to 480
elseif ( GetPCCell "Inanius Egg Mine" == 1 )
set cell to 479
elseif ( GetPCCell "Imperial Prison Ship" == 1 )
set cell to 478
elseif ( GetPCCell "Ilunibi, Tainted Marrow" == 1 )
set cell to 477
elseif ( GetPCCell "Ilunibi, Soul's Rattle" == 1 )
set cell to 476
elseif ( GetPCCell "Ilunibi, Marowak's Spine" == 1 )
set cell to 475
elseif ( GetPCCell "Ilunibi, Carcass of the Saint" == 1 )
set cell to 474
elseif ( GetPCCell "Ilunibi, Blackened Heart" == 1 )
set cell to 473
elseif ( GetPCCell "Ilanipu Grotto" == 1 )
set cell to 472
elseif ( GetPCCell "Ihinipalit, Shrine" == 1 )
set cell to 471
elseif ( GetPCCell "Ienith Ancestral Tomb" == 1 )
set cell to 470
elseif ( GetPCCell "Ibishammus, Shrine" == 1 )
set cell to 469
elseif ( GetPCCell "Ibar-Dad" == 1 )
set cell to 468
elseif ( GetPCCell "Holamayan Monastery" == 1 )
set cell to 467
elseif ( GetPCCell "Hlormaren, Underground" == 1 )
set cell to 466
elseif ( GetPCCell "Hlormaren, Sewers" == 1 )
set cell to 465
elseif ( GetPCCell "Hlormaren, Propylon Chamber" == 1 )
set cell to 464
elseif ( GetPCCell "Hlormaren, Keep, Top Level" == 1 )
set cell to 463
elseif ( GetPCCell "Hlormaren, Keep, Bottom Level" == 1 )
set cell to 462
elseif ( GetPCCell "Hlormaren, Dome" == 1 )
set cell to 461
elseif ( GetPCCell "Hlervu Ancestral Tomb" == 1 )
set cell to 460
elseif ( GetPCCell "Hlervi Ancestral Tomb" == 1 )
set cell to 459
elseif ( GetPCCell "Hleran Ancestral Tomb" == 1 )
set cell to 458
elseif ( GetPCCell "Hlaalu Ancestral Tomb" == 1 )
set cell to 457
elseif ( GetPCCell "Hla Oad, Shurkul gro-Sharga's House" == 1 )
set cell to 456
elseif ( GetPCCell "Hla Oad, Relien Rirne's House" == 1 )
set cell to 455
elseif ( GetPCCell "Hla Oad, Okur's House" == 1 )
set cell to 454
elseif ( GetPCCell "Hla Oad, Murudius Flaeus's House" == 1 )
set cell to 453
elseif ( GetPCCell "Hla Oad, Fatleg's Drop Off" == 1 )
set cell to 452
elseif ( GetPCCell "Hla Oad, Fadila Balvel's House" == 1 )
set cell to 451
elseif ( GetPCCell "Hinnabi" == 1 )
set cell to 450
elseif ( GetPCCell "Heran Ancestral Tomb" == 1 )
set cell to 449
elseif ( GetPCCell "Heleran Ancestral Tomb" == 1 )
set cell to 448
elseif ( GetPCCell "Helas Ancestral Tomb" == 1 )
set cell to 447
elseif ( GetPCCell "Helan Ancestral Tomb" == 1 )
set cell to 446
elseif ( GetPCCell "Hawia Egg Mine" == 1 )
set cell to 445
elseif ( GetPCCell "Hassour, Shrine" == 1 )
set cell to 444
elseif ( GetPCCell "Hassour" == 1 )
set cell to 443
elseif ( GetPCCell "Hanud, Tower" == 1 )
set cell to 442
elseif ( GetPCCell "Hanud" == 1 )
set cell to 441
elseif ( GetPCCell "Halit Mine" == 1 )
set cell to 440
elseif ( GetPCCell "Hairat-Vassamsi Egg Mine, Queen's Lair" == 1 )
set cell to 439
elseif ( GetPCCell "Hairat-Vassamsi Egg Mine" == 1 )
set cell to 438
elseif ( GetPCCell "Habinbaes" == 1 )
set cell to 437
elseif ( GetPCCell "Grytewake, Upper Level" == 1 )
set cell to 436
elseif ( GetPCCell "Grytewake, Lower Level" == 1 )
set cell to 435
elseif ( GetPCCell "Grytewake, Cabin" == 1 )
set cell to 434
elseif ( GetPCCell "Gro-Bagrat Plantation" == 1 )
set cell to 433
elseif ( GetPCCell "Gnisis, Yahaz Hut" == 1 )
set cell to 432
elseif ( GetPCCell "Gnisis, Vabdas Hut" == 1 )
set cell to 431
elseif ( GetPCCell "Gnisis, Underground Stream" == 1 )
set cell to 430
elseif ( GetPCCell "Gnisis, Temple" == 1 )
set cell to 429
elseif ( GetPCCell "Gnisis, Tansumiran Cave Dwelling" == 1 )
set cell to 428
elseif ( GetPCCell "Gnisis, Shishara Hut" == 1 )
set cell to 427
elseif ( GetPCCell "Gnisis, Shand Hut" == 1 )
set cell to 426
elseif ( GetPCCell "Gnisis, Mantiti Cave Dwelling" == 1 )
set cell to 425
elseif ( GetPCCell "Gnisis, Man-llu Hut" == 1 )
set cell to 424
elseif ( GetPCCell "Gnisis, Madach Tradehouse" == 1 )
set cell to 423
elseif ( GetPCCell "Gnisis, Lower Eggmine" == 1 )
set cell to 422
elseif ( GetPCCell "Gnisis, Lasamsi Cave Dwelling" == 1 )
set cell to 421
elseif ( GetPCCell "Gnisis, Fort Darius" == 1 )
set cell to 420
elseif ( GetPCCell "Gnisis, Eggmine" == 1 )
set cell to 419
elseif ( GetPCCell "Gnisis, Dinadad Hut" == 1 )
set cell to 418
elseif ( GetPCCell "Gnisis, Bethamez" == 1 )
set cell to 417
elseif ( GetPCCell "Gnisis, Barracks" == 1 )
set cell to 416
elseif ( GetPCCell "Gnisis, Arvs-Drelen" == 1 )
set cell to 415
elseif ( GetPCCell "Gnisis, Almu Cave Dwelling" == 1 )
set cell to 414
elseif ( GetPCCell "Gnisis, Abelmawia Hut" == 1 )
set cell to 413
elseif ( GetPCCell "Gnaar Mok, Rostlogi's Shack" == 1 )
set cell to 412
elseif ( GetPCCell "Gnaar Mok, Nadene Rotheran's Shack" == 1 )
set cell to 411
elseif ( GetPCCell "Gnaar Mok, Mush-Mere's Shack" == 1 )
set cell to 410
elseif ( GetPCCell "Gnaar Mok, Jerian Dolbanitte's Shack" == 1 )
set cell to 409
elseif ( GetPCCell "Gnaar Mok, Druegh-jigger's Rest" == 1 )
set cell to 408
elseif ( GetPCCell "Gnaar Mok, Caryarel's Shack" == 1 )
set cell to 407
elseif ( GetPCCell "Gnaar Mok, Arenim Manor" == 1 )
set cell to 406
elseif ( GetPCCell "Gnaar Mok, Anglalos's Shack" == 1 )
set cell to 405
elseif ( GetPCCell "Ginith Ancestral Tomb" == 1 )
set cell to 404
elseif ( GetPCCell "Gimothran Ancestral Tomb" == 1 )
set cell to 403
elseif ( GetPCCell "Ghostgate, Tower of Dusk Lower Level" == 1 )
set cell to 402
elseif ( GetPCCell "Ghostgate, Tower of Dusk" == 1 )
set cell to 401
elseif ( GetPCCell "Ghostgate, Tower of Dawn Lower Level" == 1 )
set cell to 400
elseif ( GetPCCell "Ghostgate, Tower of Dawn" == 1 )
set cell to 399
elseif ( GetPCCell "Ghostgate, Temple" == 1 )
set cell to 398
elseif ( GetPCCell "Galom Daeus, Observatory" == 1 )
set cell to 397
elseif ( GetPCCell "Galom Daeus, Entry" == 1 )
set cell to 396
elseif ( GetPCCell "Forgotten Vaults of Anudnabia, Forge of Hilbongard" == 1 )
set cell to 395
elseif ( GetPCCell "Forgotten Shipwreck" == 1 )
set cell to 394
elseif ( GetPCCell "Favel Ancestral Tomb" == 1 )
set cell to 393
elseif ( GetPCCell "Falvilo's Endeavor, Upper Level" == 1 )
set cell to 392
elseif ( GetPCCell "Falvillo's Endeavor, Lower Level" == 1 )
set cell to 391
elseif ( GetPCCell "Falvillo's Endeavor, Cabin" == 1 )
set cell to 390
elseif ( GetPCCell "Falensarano, Upper Level" == 1 )
set cell to 389
elseif ( GetPCCell "Falensarano, Propylon Chamber" == 1 )
set cell to 388
elseif ( GetPCCell "Falensarano, Lower Level" == 1 )
set cell to 387
elseif ( GetPCCell "Falasmaryon, Upper Level" == 1 )
set cell to 386
elseif ( GetPCCell "Falasmaryon, Sewers" == 1 )
set cell to 385
elseif ( GetPCCell "Falasmaryon, Propylon Chamber" == 1 )
set cell to 384
elseif ( GetPCCell "Falasmaryon, Missun Akin's Hut" == 1 )
set cell to 383
elseif ( GetPCCell "Falasmaryon, Lower Level" == 1 )
set cell to 382
elseif ( GetPCCell "Falas Ancestral Tomb" == 1 )
set cell to 381
elseif ( GetPCCell "Fair Helas, Upper Level" == 1 )
set cell to 380
elseif ( GetPCCell "Fair Helas, Lower Level" == 1 )
set cell to 379
elseif ( GetPCCell "Fair Helas, Cabin" == 1 )
set cell to 378
elseif ( GetPCCell "Fadathram Ancestral Tomb" == 1 )
set cell to 377
elseif ( GetPCCell "Esutanamus, Shrine" == 1 )
set cell to 376
elseif ( GetPCCell "Eretammus-Sennammu Egg Mine" == 1 )
set cell to 375
elseif ( GetPCCell "Erabenimsun Camp, Wise Woman's Yurt" == 1 )
set cell to 374
elseif ( GetPCCell "Erabenimsun Camp, Salattanat's Yurt" == 1 )
set cell to 373
elseif ( GetPCCell "Erabenimsun Camp, Ranabi's Yurt" == 1 )
set cell to 372
elseif ( GetPCCell "Erabenimsun Camp, Massarapal's Yurt" == 1 )
set cell to 371
elseif ( GetPCCell "Erabenimsun Camp, Han-Ammu's Yurt" == 1 )
set cell to 370
elseif ( GetPCCell "Erabenimsun Camp, Assemmus' Yurt" == 1 )
set cell to 369
elseif ( GetPCCell "Erabenimsun Camp, Ashu-Ahhe's Yurt" == 1 )
set cell to 368
elseif ( GetPCCell "Erabenimsun Camp, Ashkhan's Yurt" == 1 )
set cell to 367
elseif ( GetPCCell "Erabenimsun Camp, Ainab's Yurt" == 1 )
set cell to 366
elseif ( GetPCCell "Erabenimsun Camp, Addut-Lamanu's Yurt" == 1 )
set cell to 365
elseif ( GetPCCell "Endusal, Kagrenac's study" == 1 )
set cell to 364
elseif ( GetPCCell "Eluba-Addon Grotto" == 1 )
set cell to 363
elseif ( GetPCCell "Eluba-Addon Egg Mine" == 1 )
set cell to 362
elseif ( GetPCCell "Elith-Pal Mine" == 1 )
set cell to 361
elseif ( GetPCCell "Elf-Skerring, Upper Level" == 1 )
set cell to 360
elseif ( GetPCCell "Elf-Skerring, Lower Level" == 1 )
set cell to 359
elseif ( GetPCCell "Elf-Skerring, Cabin" == 1 )
set cell to 358
elseif ( GetPCCell "Elanius Camp, Yapal's Yurt" == 1 )
set cell to 357
elseif ( GetPCCell "Ebonheart, Underground Caves" == 1 )
set cell to 356
elseif ( GetPCCell "Ebonheart, Skyrim Mission" == 1 )
set cell to 355
elseif ( GetPCCell "Ebonheart, Six Fishes" == 1 )
set cell to 354
elseif ( GetPCCell "Ebonheart, Imperial Guard Garrison" == 1 )
set cell to 353
elseif ( GetPCCell "Ebonheart, Imperial Commission" == 1 )
set cell to 352
elseif ( GetPCCell "Ebonheart, Imperial Chapels" == 1 )
set cell to 351
elseif ( GetPCCell "Ebonheart, Hawkmoth Towers" == 1 )
set cell to 350
elseif ( GetPCCell "Ebonheart, Hawkmoth Legion Garrison" == 1 )
set cell to 349
elseif ( GetPCCell "Ebonheart, Grand Council Chambers Tower" == 1 )
set cell to 348
elseif ( GetPCCell "Ebonheart, Grand Council Chambers" == 1 )
set cell to 347
elseif ( GetPCCell "Ebonheart, East Empire South Warehouse" == 1 )
set cell to 346
elseif ( GetPCCell "Ebonheart, East Empire North Warehouse" == 1 )
set cell to 345
elseif ( GetPCCell "Ebonheart, East Empire Company Hall" == 1 )
set cell to 344
elseif ( GetPCCell "Ebonheart, Argonian Mission" == 1 )
set cell to 343
elseif ( GetPCCell "Ebernanit, Shrine" == 1 )
set cell to 342
elseif ( GetPCCell "Dushariran, Shrine" == 1 )
set cell to 341
elseif ( GetPCCell "Dunirai Caverns" == 1 )
set cell to 340
elseif ( GetPCCell "Dun-Ahhe" == 1 )
set cell to 339
elseif ( GetPCCell "Dulo Ancestral Tomb" == 1 )
set cell to 338
elseif ( GetPCCell "Dubdilla, Uncharted Caverns, Lower" == 1 )
set cell to 337
elseif ( GetPCCell "Dubdilla, Uncharted Caverns" == 1 )
set cell to 336
elseif ( GetPCCell "Dubdilla" == 1 )
set cell to 335
elseif ( GetPCCell "Druscashti, Upper Level" == 1 )
set cell to 334
elseif ( GetPCCell "Druscashti, Lower Level" == 1 )
set cell to 333
elseif ( GetPCCell "Drulene Falen's Hut" == 1 )
set cell to 332
elseif ( GetPCCell "Drinith Ancestral Tomb" == 1 )
set cell to 331
elseif ( GetPCCell "Drethan Ancestral Tomb" == 1 )
set cell to 330
elseif ( GetPCCell "Dren Plantation, Verethi and Dralor" == 1 )
set cell to 329
elseif ( GetPCCell "Dren Plantation, Tower Shack" == 1 )
set cell to 328
elseif ( GetPCCell "Dren Plantation, Storage Shack" == 1 )
set cell to 327
elseif ( GetPCCell "Dren Plantation, Shipping House" == 1 )
set cell to 326
elseif ( GetPCCell "Dren Plantation, Rethan's Shack" == 1 )
set cell to 325
elseif ( GetPCCell "Dren Plantation, Hlevala's Shack" == 1 )
set cell to 324
elseif ( GetPCCell "Dren Plantation, Helvi's Shack" == 1 )
set cell to 323
elseif ( GetPCCell "Dren Plantation, Guardhouse" == 1 )
set cell to 322
elseif ( GetPCCell "Dren Plantation, Dren's Villa" == 1 )
set cell to 321
elseif ( GetPCCell "Dren Plantation, Doves' Shack" == 1 )
set cell to 320
elseif ( GetPCCell "Dreloth Ancestral Tomb" == 1 )
set cell to 319
elseif ( GetPCCell "Drath Ancestral Tomb" == 1 )
set cell to 318
elseif ( GetPCCell "Dralas Ancestral Tomb" == 1 )
set cell to 317
elseif ( GetPCCell "Dissapla Mine" == 1 )
set cell to 316
elseif ( GetPCCell "Dirara's Farmhouse" == 1 )
set cell to 315
elseif ( GetPCCell "Desolate Shipwreck, Upper Level" == 1 )
set cell to 314
elseif ( GetPCCell "Desolate Shipwreck, Lower Level" == 1 )
set cell to 313
elseif ( GetPCCell "Desolate Shipwreck, Cabin" == 1 )
set cell to 312
elseif ( GetPCCell "Deserted Shipwreck, Upper Level" == 1 )
set cell to 311
elseif ( GetPCCell "Deserted Shipwreck, Lower Level" == 1 )
set cell to 310
elseif ( GetPCCell "Deserted Shipwreck, Cabin" == 1 )
set cell to 309
elseif ( GetPCCell "Derelict Shipwreck, Upper Level" == 1 )
set cell to 308
elseif ( GetPCCell "Derelict Shipwreck, Lower Level" == 1 )
set cell to 307
elseif ( GetPCCell "Derelict Shipwreck, Cabin" == 1 )
set cell to 306
elseif ( GetPCCell "Dareleth Ancestral Tomb" == 1 )
set cell to 305
elseif ( GetPCCell "Dagoth Ur, Outer Facility" == 1 )
set cell to 304
elseif ( GetPCCell "Dagoth Ur, Lower Facility" == 1 )
set cell to 303
elseif ( GetPCCell "Dagoth Ur, Inner Tower" == 1 )
set cell to 302
elseif ( GetPCCell "Dagoth Ur, Inner Facility" == 1 )
set cell to 301
elseif ( GetPCCell "Dagoth Ur, Facility Cavern" == 1 )
set cell to 300
elseif ( GetPCCell "Dagon Fel, Watch Tower" == 1 )
set cell to 299
elseif ( GetPCCell "Dagon Fel, Vacant Tower" == 1 )
set cell to 298
elseif ( GetPCCell "Dagon Fel, The End of the World" == 1 )
set cell to 297
elseif ( GetPCCell "Dagon Fel, Sorkvild's Tower" == 1 )
set cell to 296
elseif ( GetPCCell "Dagon Fel, Onmi Hard-mouth's House" == 1 )
set cell to 295
elseif ( GetPCCell "Dagon Fel, Mette's House" == 1 )
set cell to 294
elseif ( GetPCCell "Dagon Fel, Itar the Gentle's House" == 1 )
set cell to 293
elseif ( GetPCCell "Dagon Fel, Hurg's House" == 1 )
set cell to 292
elseif ( GetPCCell "Dagon Fel, Heifnir: Trader" == 1 )
set cell to 291
elseif ( GetPCCell "Dagon Fel, Greidil Half-Troll's House" == 1 )
set cell to 290
elseif ( GetPCCell "Dagon Fel, Fjorrod's House" == 1 )
set cell to 289
elseif ( GetPCCell "Dagon Fel, Fanar Fork-Beard's House" == 1 )
set cell to 288
elseif ( GetPCCell "Dagon Fel, End of the World Renter Rooms" == 1 )
set cell to 287
elseif ( GetPCCell "Dagon Fel, Anja Swift-Sailer's House" == 1 )
set cell to 286
elseif ( GetPCCell "Dagon Fel, Andre Maul's Tower" == 1 )
set cell to 285
elseif ( GetPCCell "Corprusarium Bowels" == 1 )
set cell to 284
elseif ( GetPCCell "Corprusarium" == 1 )
set cell to 283
elseif ( GetPCCell "Clutter Warehouse - Everything Must Go!" == 1 )
set cell to 282
elseif ( GetPCCell "Chun-Ook, Upper Level" == 1 )
set cell to 281
elseif ( GetPCCell "Chun-Ook, Lower Level" == 1 )
set cell to 280
elseif ( GetPCCell "Chun-Ook, Cabin" == 1 )
set cell to 279
elseif ( GetPCCell "Character Stuff Wonderland" == 1 )
set cell to 278
elseif ( GetPCCell "Cavern of the Incarnate" == 1 )
set cell to 277
elseif ( GetPCCell "Caldera, Verick Gemain: Trader" == 1 )
set cell to 276
elseif ( GetPCCell "Caldera, Valvius Mevureius' House" == 1 )
set cell to 275
elseif ( GetPCCell "Caldera, Surane Leoriane's House" == 1 )
set cell to 274
elseif ( GetPCCell "Caldera, South Guard Towers" == 1 )
set cell to 273
elseif ( GetPCCell "Caldera, Slave Shack Two" == 1 )
set cell to 272
elseif ( GetPCCell "Caldera, Slave Shack One" == 1 )
set cell to 271
elseif ( GetPCCell "Caldera, Shenk's Shovel" == 1 )
set cell to 270
elseif ( GetPCCell "Caldera, Odairan Ashummi-Ammus' House" == 1 )
set cell to 269
elseif ( GetPCCell "Caldera, North Guard Towers" == 1 )
set cell to 268
elseif ( GetPCCell "Caldera, Nedhelas' House" == 1 )
set cell to 267
elseif ( GetPCCell "Caldera, Mining Guard Tower" == 1 )
set cell to 266
elseif ( GetPCCell "Caldera, Mining Company Office" == 1 )
set cell to 265
elseif ( GetPCCell "Caldera, Mining Bunkhouse" == 1 )
set cell to 264
elseif ( GetPCCell "Caldera, Keel-Raniur's House" == 1 )
set cell to 263
elseif ( GetPCCell "Caldera, Irgola: Pawnbroker" == 1 )
set cell to 262
elseif ( GetPCCell "Caldera, Hodlismod: Armorer" == 1 )
set cell to 261
elseif ( GetPCCell "Caldera, Guild of Mages" == 1 )
set cell to 260
elseif ( GetPCCell "Caldera, Governor's Hall" == 1 )
set cell to 259
elseif ( GetPCCell "Caldera, Ghorak Manor" == 1 )
set cell to 258
elseif ( GetPCCell "Caldera, Falanaamo: Clothier" == 1 )
set cell to 257
elseif ( GetPCCell "Caldera, Elmussa Damori's House" == 1 )
set cell to 256
elseif ( GetPCCell "Caldera, Dro'Shavir's House" == 1 )
set cell to 255
elseif ( GetPCCell "Caldera, Canodia Felannus' House" == 1 )
set cell to 254
elseif ( GetPCCell "Caldera, Bashuk gra-Bat's House" == 1 )
set cell to 253
elseif ( GetPCCell "Caldera Mine" == 1 )
set cell to 252
endif

if ( cell != -1 )
	set vn_TeleportCell to cell
endif

StopScript "vn_Teleport_getCell_Sub2"

End

# vn_Teleport_getCell_Sub3 ====================================================
Begin vn_Teleport_getCell_Sub3

short cell
set cell to -1

if ( GetPCCell "Remote Shipwreck, Upper Level" == 1 )
set cell to 765
elseif ( GetPCCell "Remote Shipwreck, Lower Level" == 1 )
set cell to 764
elseif ( GetPCCell "Remote Shipwreck, Cabin" == 1 )
set cell to 763
elseif ( GetPCCell "Reloth Ancestral Tomb" == 1 )
set cell to 762
elseif ( GetPCCell "Releth Ancestral Tomb" == 1 )
set cell to 761
elseif ( GetPCCell "Redoran interior2" == 1 )
set cell to 760
elseif ( GetPCCell "Redoran interior" == 1 )
set cell to 759
elseif ( GetPCCell "Redas Ancestral Tomb" == 1 )
set cell to 758
elseif ( GetPCCell "Rayna Drolan's Shack" == 1 )
set cell to 757
elseif ( GetPCCell "Raviro Ancestral Tomb" == 1 )
set cell to 756
elseif ( GetPCCell "Ravel Ancestral Tomb" == 1 )
set cell to 755
elseif ( GetPCCell "Randas Ancestral Tomb" == 1 )
set cell to 754
elseif ( GetPCCell "Ramimilk, Shrine" == 1 )
set cell to 753
elseif ( GetPCCell "Punsabanit" == 1 )
set cell to 752
elseif ( GetPCCell "Punammu" == 1 )
set cell to 751
elseif ( GetPCCell "Punabi" == 1 )
set cell to 750
elseif ( GetPCCell "Pulk" == 1 )
set cell to 749
elseif ( GetPCCell "Pudai Egg Mine, Queen's Lair" == 1 )
set cell to 748
elseif ( GetPCCell "Pudai Egg Mine" == 1 )
set cell to 747
elseif ( GetPCCell "Prelude Shipwreck, Upper Level" == 1 )
set cell to 746
elseif ( GetPCCell "Prelude Shipwreck, Lower Level" == 1 )
set cell to 745
elseif ( GetPCCell "Prelude Shipwreck, Cabin" == 1 )
set cell to 744
elseif ( GetPCCell "Piran" == 1 )
set cell to 743
elseif ( GetPCCell "Pinsun" == 1 )
set cell to 742
elseif ( GetPCCell "Piernette's Farmhouse" == 1 )
set cell to 741
elseif ( GetPCCell "Pelagiad, Uulernil : Armorer" == 1 )
set cell to 740
elseif ( GetPCCell "Pelagiad, South Wall" == 1 )
set cell to 739
elseif ( GetPCCell "Pelagiad, North Wall" == 1 )
set cell to 738
elseif ( GetPCCell "Pelagiad, Murberius Harmevus' House" == 1 )
set cell to 737
elseif ( GetPCCell "Pelagiad, Mebestien Ence: Trader" == 1 )
set cell to 736
elseif ( GetPCCell "Pelagiad, Madres Navur's House" == 1 )
set cell to 735
elseif ( GetPCCell "Pelagiad, Junal-lei's House" == 1 )
set cell to 734
elseif ( GetPCCell "Pelagiad, Halfway Tavern" == 1 )
set cell to 732
elseif ( GetPCCell "Pelagiad, Guard Tower" == 1 )
set cell to 731
elseif ( GetPCCell "Pelagiad, Fort Pelagiad" == 1 )
set cell to 730
elseif ( GetPCCell "Pelagiad, Farusea Salas' House" == 1 )
set cell to 729
elseif ( GetPCCell "Pelagiad, Erval's House" == 1 )
set cell to 728
elseif ( GetPCCell "Pelagiad, Dralas Gilu's House" == 1 )
set cell to 727
elseif ( GetPCCell "Pelagiad, Ahnassi's House" == 1 )
set cell to 726
elseif ( GetPCCell "Pelagiad, Adanja's House" == 1 )
set cell to 725
elseif ( GetPCCell "Panud Egg Mine" == 1 )
set cell to 724
elseif ( GetPCCell "Panat" == 1 )
set cell to 723
elseif ( GetPCCell "Panabanit-Nimawia Egg Mine" == 1 )
set cell to 722
elseif ( GetPCCell "Palansour" == 1 )
set cell to 721
elseif ( GetPCCell "Othrelas Ancestral Tomb" == 1 )
set cell to 720
elseif ( GetPCCell "Orethi Ancestral Tomb" == 1 )
set cell to 719
elseif ( GetPCCell "Onnissiralis, Shrine" == 1 )
set cell to 718
elseif ( GetPCCell "Omaren Ancestral Tomb" == 1 )
set cell to 717
elseif ( GetPCCell "Omani Manor" == 1 )
set cell to 716
elseif ( GetPCCell "Omalen Ancestral Tomb" == 1 )
set cell to 715
elseif ( GetPCCell "Odrosal, Tower" == 1 )
set cell to 688
elseif ( GetPCCell "Odrosal, Dwemer Training Academy" == 1 )
set cell to 687
elseif ( GetPCCell "Odirniran, Tower" == 1 )
set cell to 686
elseif ( GetPCCell "Odirniran" == 1 )
set cell to 685
elseif ( GetPCCell "Odirnamat" == 1 )
set cell to 684
elseif ( GetPCCell "Odibaal" == 1 )
set cell to 683
elseif ( GetPCCell "Odaishah" == 1 )
set cell to 682
elseif ( GetPCCell "Obscure Shipwreck, Upper Level" == 1 )
set cell to 681
elseif ( GetPCCell "Obscure Shipwreck, Lower Level" == 1 )
set cell to 680
elseif ( GetPCCell "Obscure Shipwreck, Cabin" == 1 )
set cell to 679
elseif ( GetPCCell "Nund" == 1 )
set cell to 678
elseif ( GetPCCell "Norvayn Ancestral Tomb" == 1 )
set cell to 677
elseif ( GetPCCell "Nissintu" == 1 )
set cell to 670
elseif ( GetPCCell "Nimawia Grotto" == 1 )
set cell to 669
elseif ( GetPCCell "Nilera's Farmhouse" == 1 )
set cell to 668
elseif ( GetPCCell "Nerano Ancestral Tomb" == 1 )
set cell to 667
elseif ( GetPCCell "Nelas Ancestral Tomb" == 1 )
set cell to 666
elseif ( GetPCCell "Neglected Shipwreck, Upper Level" == 1 )
set cell to 665
elseif ( GetPCCell "Neglected Shipwreck, Lower Level" == 1 )
set cell to 664
elseif ( GetPCCell "Neglected Shipwreck, Cabin" == 1 )
set cell to 663
elseif ( GetPCCell "Nchurdamz, Interior" == 1 )
set cell to 662
elseif ( GetPCCell "Nchuleftingth, Upper Levels" == 1 )
set cell to 661
elseif ( GetPCCell "Nchuleftingth, Test of Pattern" == 1 )
set cell to 660
elseif ( GetPCCell "Nchuleftingth, Lower Levels" == 1 )
set cell to 659
elseif ( GetPCCell "Nchuleft" == 1 )
set cell to 658
elseif ( GetPCCell "Nchardumz Lower Level" == 1 )
set cell to 657
elseif ( GetPCCell "Nchardumz" == 1 )
set cell to 656
elseif ( GetPCCell "Nchardahrk" == 1 )
set cell to 655
elseif ( GetPCCell "Nammu" == 1 )
set cell to 654
elseif ( GetPCCell "Nallit" == 1 )
set cell to 653
elseif ( GetPCCell "Mzuleft" == 1 )
set cell to 652
elseif ( GetPCCell "Mzanchend" == 1 )
set cell to 651
elseif ( GetPCCell "Mzahnch Lower Level" == 1 )
set cell to 650
elseif ( GetPCCell "Mzahnch" == 1 )
set cell to 649
elseif ( GetPCCell "Mul Grotto" == 1 )
set cell to 648
elseif ( GetPCCell "Mudan-Mul Egg Mine" == 1 )
set cell to 647
elseif ( GetPCCell "Mudan, Right Tower" == 1 )
set cell to 646
elseif ( GetPCCell "Mudan, Lost Dwemer Checkpoint" == 1 )
set cell to 645
elseif ( GetPCCell "Mudan, Central Vault" == 1 )
set cell to 644
elseif ( GetPCCell "Mudan Grotto" == 1 )
set cell to 643
elseif ( GetPCCell "Mount Kand, Cavern" == 1 )
set cell to 601
elseif ( GetPCCell "Morvayn Manor" == 1 )
set cell to 600
elseif ( GetPCCell "Moonmoth Legion Fort, Prison Towers" == 1 )
set cell to 599
elseif ( GetPCCell "Moonmoth Legion Fort, Interior" == 1 )
set cell to 598
elseif ( GetPCCell "Molag Mar, Waistworks" == 1 )
set cell to 597
elseif ( GetPCCell "Molag Mar, Vasesius Viciulus: Trader" == 1 )
set cell to 596
elseif ( GetPCCell "Molag Mar, Underworks" == 1 )
set cell to 595
elseif ( GetPCCell "Molag Mar, The Pilgrim's Rest" == 1 )
set cell to 594
elseif ( GetPCCell "Molag Mar, Temple" == 1 )
set cell to 593
elseif ( GetPCCell "Molag Mar, St. Veloth's Hostel" == 1 )
set cell to 592
elseif ( GetPCCell "Molag Mar, Saetring the Nord: Smith" == 1 )
set cell to 591
elseif ( GetPCCell "Molag Mar, Redoran Stronghold" == 1 )
set cell to 590
elseif ( GetPCCell "Molag Mar, Canalworks" == 1 )
set cell to 589
elseif ( GetPCCell "Molag Mar, Armigers Stronghold" == 1 )
set cell to 588
elseif ( GetPCCell "Missir-Dadalit Egg Mine" == 1 )
set cell to 587
elseif ( GetPCCell "Missamsi" == 1 )
set cell to 586
elseif ( GetPCCell "Ministry of Truth, Prison Keep" == 1 )
set cell to 585
elseif ( GetPCCell "Ministry of Truth, Holding Cells" == 1 )
set cell to 584
elseif ( GetPCCell "Ministry of Truth, Hall of Processing" == 1 )
set cell to 583
elseif ( GetPCCell "Minabi, Bandit Lair" == 1 )
set cell to 582
elseif ( GetPCCell "Minabi" == 1 )
set cell to 581
elseif ( GetPCCell "Milk" == 1 )
set cell to 580
elseif ( GetPCCell "Mila-Nipal, Manat's Yurt" == 1 )
set cell to 579
elseif ( GetPCCell "Mawia" == 1 )
set cell to 578
elseif ( GetPCCell "Mausur Caverns" == 1 )
set cell to 577
elseif ( GetPCCell "Matus-Akin Egg Mine, Queen's Lair" == 1 )
set cell to 576
elseif ( GetPCCell "Matus-Akin Egg Mine" == 1 )
set cell to 575
elseif ( GetPCCell "Mat" == 1 )
set cell to 574
elseif ( GetPCCell "Masseranit" == 1 )
set cell to 573
elseif ( GetPCCell "Massama Cave" == 1 )
set cell to 572
elseif ( GetPCCell "Massahanud Camp, Sargon's Yurt" == 1 )
set cell to 571
elseif ( GetPCCell "Marvani Ancestral Tomb" == 1 )
set cell to 570
elseif ( GetPCCell "Mark's Vampire Test Cell" == 1 )
set cell to 569
elseif ( GetPCCell "Maren Ancestral Tomb" == 1 )
set cell to 568
elseif ( GetPCCell "Marandus, Upper Level" == 1 )
set cell to 567
elseif ( GetPCCell "Marandus, Propylon Chamber" == 1 )
set cell to 566
elseif ( GetPCCell "Marandus, Lower Level" == 1 )
set cell to 565
elseif ( GetPCCell "Marandus, Dome" == 1 )
set cell to 564
elseif ( GetPCCell "Maran-Adon" == 1 )
set cell to 563
elseif ( GetPCCell "Mannammu" == 1 )
set cell to 562
elseif ( GetPCCell "Manat's Farmhouse" == 1 )
set cell to 561
elseif ( GetPCCell "Mamshar-Disamus Camp, Maesat's Yurt" == 1 )
set cell to 560
elseif ( GetPCCell "Mamaea, Shrine of Pitted Dreams" == 1 )
set cell to 559
elseif ( GetPCCell "Mamaea, Sanctum of Black Hope" == 1 )
set cell to 558
elseif ( GetPCCell "Mamaea, Sanctum of Awakening" == 1 )
set cell to 557
elseif ( GetPCCell "Malmus Grotto" == 1 )
set cell to 556
elseif ( GetPCCell "Mallapi" == 1 )
set cell to 555
elseif ( GetPCCell "Magas Volar" == 1 )
set cell to 554
elseif ( GetPCCell "Maesa-Shammus Egg Mine" == 1 )
set cell to 553
elseif ( GetPCCell "Maelu Egg Mine" == 1 )
set cell to 552
elseif ( GetPCCell "Maelkashishi, Shrine, Forgotten Galleries" == 1 )
set cell to 551
elseif ( GetPCCell "Maelkashishi, Shrine" == 1 )
set cell to 550
elseif ( GetPCCell "Madas-Zebba Egg Mine" == 1 )
set cell to 549
elseif ( GetPCCell "Madas Grotto" == 1 )
set cell to 548
elseif ( GetPCCell "Mababi" == 1 )
set cell to 547
elseif ( GetPCCell "Maba-Ilu" == 1 )
set cell to 546
elseif ( GetPCCell "Maar Gan, Yeherradad's Hut" == 1 )
set cell to 545
elseif ( GetPCCell "Maar Gan, Ulisamsi Shaddarnuran's Hut" == 1 )
set cell to 544
elseif ( GetPCCell "Maar Gan, Tashpi Ashibael's Hut" == 1 )
set cell to 543
elseif ( GetPCCell "Maar Gan, Shrine" == 1 )
set cell to 542
elseif ( GetPCCell "Maar Gan, Shilipuran Zama-Rasour's Hut" == 1 )
set cell to 541
elseif ( GetPCCell "Maar Gan, Outpost" == 1 )
set cell to 540
elseif ( GetPCCell "Maar Gan, Mabrelle Geles's Hut" == 1 )
set cell to 539
elseif ( GetPCCell "Maar Gan, Kind Erushara's Hut" == 1 )
set cell to 538
elseif ( GetPCCell "Maar Gan, Huleen's Hut" == 1 )
set cell to 537
elseif ( GetPCCell "Maar Gan, Guard Tower 3" == 1 )
set cell to 536
elseif ( GetPCCell "Maar Gan, Guard Tower 2" == 1 )
set cell to 535
elseif ( GetPCCell "Maar Gan, Guard Tower 1" == 1 )
set cell to 534
elseif ( GetPCCell "Maar Gan, Garry's Hut" == 1 )
set cell to 533
elseif ( GetPCCell "Maar Gan, Assirari Zama-Rasour's Hut" == 1 )
set cell to 532
elseif ( GetPCCell "Maar Gan, Assi Serimilk's Hut" == 1 )
set cell to 531
elseif ( GetPCCell "Maar Gan, Andus Tradehouse" == 1 )
set cell to 530
elseif ( GetPCCell "Lost Shipwreck, Upper Level" == 1 )
set cell to 529
elseif ( GetPCCell "Lost Shipwreck, Lower Level" == 1 )
set cell to 528
elseif ( GetPCCell "Lost Shipwreck, Cabin" == 1 )
set cell to 527
elseif ( GetPCCell "Lonesome Shipwreck, Upper Level" == 1 )
set cell to 526
elseif ( GetPCCell "Lonesome Shipwreck, Lower Level" == 1 )
set cell to 525
elseif ( GetPCCell "Lonesome Shipwreck, Cabin" == 1 )
set cell to 524
elseif ( GetPCCell "Lonely Shipwreck, Upper Level" == 1 )
set cell to 523
elseif ( GetPCCell "Lonely Shipwreck, Lower Level" == 1 )
set cell to 522
elseif ( GetPCCell "Lonely Shipwreck, Cabin" == 1 )
set cell to 521
elseif ( GetPCCell "Llovyn's Farmhouse" == 1 )
set cell to 520
elseif ( GetPCCell "Llirala's Shack" == 1 )
set cell to 519
elseif ( GetPCCell "Llervu Ancestral Tomb" == 1 )
set cell to 518
elseif ( GetPCCell "Lleran Ancestral Tomb" == 1 )
set cell to 517
elseif ( GetPCCell "Llando Ancestral Tomb" == 1 )
set cell to 516
elseif ( GetPCCell "Kushtashpi, Shrine" == 1 )
set cell to 515
elseif ( GetPCCell "Kunirai" == 1 )
set cell to 514
elseif ( GetPCCell "Kumarahaz" == 1 )
set cell to 513
elseif ( GetPCCell "Kudanat" == 1 )
set cell to 512
endif

if ( cell != -1 )
	set vn_TeleportCell to cell
endif

StopScript "vn_Teleport_getCell_Sub3"

End

# vn_Teleport_getCell_Sub4 ====================================================
Begin vn_Teleport_getCell_Sub4

short cell
set cell to -1

if ( GetPCCell "Uveran Ancestral Tomb" == 1 )
set cell to 1022
elseif ( GetPCCell "Urshilaku, Laterus Burial" == 1 )
set cell to 1021
elseif ( GetPCCell "Urshilaku, Kefka Burial" == 1 )
set cell to 1020
elseif ( GetPCCell "Urshilaku, Karma Burial" == 1 )
set cell to 1019
elseif ( GetPCCell "Urshilaku, Kakuna Burial" == 1 )
set cell to 1018
elseif ( GetPCCell "Urshilaku, Juno Burial" == 1 )
set cell to 1017
elseif ( GetPCCell "Urshilaku, Fragile Burial" == 1 )
set cell to 1016
elseif ( GetPCCell "Urshilaku, Astral Burial" == 1 )
set cell to 1015
elseif ( GetPCCell "Urshilaku Camp, Zanummu's Yurt" == 1 )
set cell to 1014
elseif ( GetPCCell "Urshilaku Camp, Zabamund's Yurt" == 1 )
set cell to 1013
elseif ( GetPCCell "Urshilaku Camp, Wise Woman's Yurt" == 1 )
set cell to 1012
elseif ( GetPCCell "Urshilaku Camp, Shimsun's Yurt" == 1 )
set cell to 1011
elseif ( GetPCCell "Urshilaku Camp, Shara's Yurt" == 1 )
set cell to 1010
elseif ( GetPCCell "Urshilaku Camp, Sakiran's Yurt" == 1 )
set cell to 1009
elseif ( GetPCCell "Urshilaku Camp, Maeli's Yurt" == 1 )
set cell to 1008
elseif ( GetPCCell "Urshilaku Camp, Kurapli's Yurt" == 1 )
set cell to 1007
elseif ( GetPCCell "Urshilaku Camp, Ashkhan's Yurt" == 1 )
set cell to 1006
elseif ( GetPCCell "Urshilaku Camp, Ahasour's Yurt" == 1 )
set cell to 1005
elseif ( GetPCCell "Unmarked Shipwreck, Upper Level" == 1 )
set cell to 1004
elseif ( GetPCCell "Unmarked Shipwreck, Lower Level" == 1 )
set cell to 1003
elseif ( GetPCCell "Unknown Shipwreck, Upper Level" == 1 )
set cell to 1002
elseif ( GetPCCell "Unknown Shipwreck, Lower Level" == 1 )
set cell to 1001
elseif ( GetPCCell "Unknown Shipwreck, Cabin" == 1 )
set cell to 1000
elseif ( GetPCCell "Unexplored Shipwreck, Upper Level" == 1 )
set cell to 999
elseif ( GetPCCell "Unexplored Shipwreck, Lower Level" == 1 )
set cell to 998
elseif ( GetPCCell "Unexplored Shipwreck, Cabin" == 1 )
set cell to 997
elseif ( GetPCCell "Unchartered Shipwreck, Upper Level" == 1 )
set cell to 996
elseif ( GetPCCell "Unchartered Shipwreck, Cabin" == 1 )
set cell to 995
elseif ( GetPCCell "Uncharted Shipwreck, Lower Level" == 1 )
set cell to 994
elseif ( GetPCCell "Ulummusa" == 1 )
set cell to 993
elseif ( GetPCCell "Ules Manor, Slavemaster's Shack" == 1 )
set cell to 992
elseif ( GetPCCell "Ules Manor, Slave Shack" == 1 )
set cell to 991
elseif ( GetPCCell "Ules Manor" == 1 )
set cell to 990
elseif ( GetPCCell "Ularradallaku, Shrine" == 1 )
set cell to 989
elseif ( GetPCCell "Tusenend, Shrine" == 1 )
set cell to 988
elseif ( GetPCCell "Tureynulal, Kagrenac's Library" == 1 )
set cell to 987
elseif ( GetPCCell "Tureynulal, Eye of Thom Wye" == 1 )
set cell to 986
elseif ( GetPCCell "Tureynulal, Eye of Duggan" == 1 )
set cell to 985
elseif ( GetPCCell "Tureynulal, Bladder of Clovis" == 1 )
set cell to 984
elseif ( GetPCCell "Tukushapal, Sepulcher" == 1 )
set cell to 983
elseif ( GetPCCell "Tukushapal" == 1 )
set cell to 982
elseif ( GetPCCell "Tower of Tel Fyr, Onyx Hall" == 1 )
set cell to 981
elseif ( GetPCCell "Tower of Tel Fyr, Hall of Fyr" == 1 )
set cell to 980
elseif ( GetPCCell "ToddTest" == 1 )
set cell to 979
elseif ( GetPCCell "Tin-Ahhe" == 1 )
set cell to 978
elseif ( GetPCCell "Thiralas Ancestral Tomb" == 1 )
set cell to 977
elseif ( GetPCCell "Thelas Ancestral Tomb" == 1 )
set cell to 976
elseif ( GetPCCell "Tharys Ancestral Tomb" == 1 )
set cell to 975
elseif ( GetPCCell "Thalas Ancestral Tomb" == 1 )
set cell to 974
elseif ( GetPCCell "Telvayn Ancestral Tomb" == 1 )
set cell to 973
elseif ( GetPCCell "Telasero, Upper Level" == 1 )
set cell to 972
elseif ( GetPCCell "Telasero, Propylon Chamber" == 1 )
set cell to 971
elseif ( GetPCCell "Telasero, Lower Level" == 1 )
set cell to 970
elseif ( GetPCCell "Tel Vos, Southern Tower" == 1 )
set cell to 969
elseif ( GetPCCell "Tel Vos, Services Tower" == 1 )
set cell to 968
elseif ( GetPCCell "Tel Vos, Northeastern Tower" == 1 )
set cell to 967
elseif ( GetPCCell "Tel Vos, Jail" == 1 )
set cell to 966
elseif ( GetPCCell "Tel Vos, Dungeon" == 1 )
set cell to 965
elseif ( GetPCCell "Tel Vos, Central Tower" == 1 )
set cell to 964
elseif ( GetPCCell "Tel Vos, Barracks and Armory" == 1 )
set cell to 963
elseif ( GetPCCell "Tel Vos, Aryon's Chambers" == 1 )
set cell to 962
elseif ( GetPCCell "Tel Uvirith, Tower Upper" == 1 )
set cell to 961
elseif ( GetPCCell "Tel Uvirith, Tower Lower" == 1 )
set cell to 960
elseif ( GetPCCell "Tel Uvirith, Tower Dungeon" == 1 )
set cell to 959
elseif ( GetPCCell "Tel Uvirith, Seleth's House" == 1 )
set cell to 958
elseif ( GetPCCell "Tel Uvirith, Omavel's House" == 1 )
set cell to 957
elseif ( GetPCCell "Tel Uvirith, Menas' House" == 1 )
set cell to 956
elseif ( GetPCCell "Tel Uvirith, Arelas' House" == 1 )
set cell to 955
elseif ( GetPCCell "Tel Mora, Upper Tower" == 1 )
set cell to 954
elseif ( GetPCCell "Tel Mora, Tower Services" == 1 )
set cell to 953
elseif ( GetPCCell "Tel Mora, The Covenant" == 1 )
set cell to 952
elseif ( GetPCCell "Tel Mora, Radras: Smith" == 1 )
set cell to 951
elseif ( GetPCCell "Tel Mora, Nona's House" == 1 )
set cell to 950
elseif ( GetPCCell "Tel Mora, Lower Tower" == 1 )
set cell to 949
elseif ( GetPCCell "Tel Mora, Liette's House" == 1 )
set cell to 948
elseif ( GetPCCell "Tel Mora, Kirsty's House" == 1 )
set cell to 947
elseif ( GetPCCell "Tel Mora, Jolda: Apothecary" == 1 )
set cell to 946
elseif ( GetPCCell "Tel Mora, Elegnan: Clothier" == 1 )
set cell to 945
elseif ( GetPCCell "Tel Mora, Berwen: Trader" == 1 )
set cell to 944
elseif ( GetPCCell "Tel Branora, Upper Tower: Therana's Chamber" == 1 )
set cell to 943
elseif ( GetPCCell "Tel Branora, Upper Tower" == 1 )
set cell to 942
elseif ( GetPCCell "Tel Branora, Tower Guardpost" == 1 )
set cell to 941
elseif ( GetPCCell "Tel Branora, Tower Dungeon" == 1 )
set cell to 940
elseif ( GetPCCell "Tel Branora, Sethan's Tradehouse" == 1 )
set cell to 939
elseif ( GetPCCell "Tel Branora, Seryne Relas's House" == 1 )
set cell to 938
elseif ( GetPCCell "Tel Branora, Manos Vavyn's House" == 1 )
set cell to 937
elseif ( GetPCCell "Tel Branora, Lower Tower" == 1 )
set cell to 936
elseif ( GetPCCell "Tel Branora, Giron Manas's Shack" == 1 )
set cell to 935
elseif ( GetPCCell "Tel Branora, Galen Berer: Armorer" == 1 )
set cell to 934
elseif ( GetPCCell "Tel Branora, Fedar Davus's House" == 1 )
set cell to 933
elseif ( GetPCCell "Tel Branora, Fadase Selvayn: Trader" == 1 )
set cell to 932
elseif ( GetPCCell "Tel Branora, Evos Goran's House" == 1 )
set cell to 931
elseif ( GetPCCell "Tel Branora, Ervyna Hlervu's Shack" == 1 )
set cell to 930
elseif ( GetPCCell "Tel Aruhn, Upper Tower" == 1 )
set cell to 929
elseif ( GetPCCell "Tel Aruhn, Underground" == 1 )
set cell to 928
elseif ( GetPCCell "Tel Aruhn, Tower Living Quarters" == 1 )
set cell to 927
elseif ( GetPCCell "Tel Aruhn, Tower Entry" == 1 )
set cell to 926
elseif ( GetPCCell "Tel Aruhn, Plot and Plaster" == 1 )
set cell to 925
elseif ( GetPCCell "Tel Aruhn, Maren Uvaren: Enchanter" == 1 )
set cell to 924
elseif ( GetPCCell "Tel Aruhn, Ferele Athram: Trader" == 1 )
set cell to 923
elseif ( GetPCCell "Tel Aruhn, Bildren Areleth: Apothecary" == 1 )
set cell to 922
elseif ( GetPCCell "Tel Aruhn, Aryne Telnim: Smith" == 1 )
set cell to 921
elseif ( GetPCCell "Surirulk" == 1 )
set cell to 920
elseif ( GetPCCell "Suran, Verara Rendo: Clothier" == 1 )
set cell to 919
elseif ( GetPCCell "Suran, Suran Tradehouse" == 1 )
set cell to 918
elseif ( GetPCCell "Suran, Suran Temple" == 1 )
set cell to 917
elseif ( GetPCCell "Suran, Suran Slave Market" == 1 )
set cell to 916
elseif ( GetPCCell "Suran, Ranosa Gilvayn: Outfitter" == 1 )
set cell to 915
elseif ( GetPCCell "Suran, Ralds Oril: Trader" == 1 )
set cell to 914
elseif ( GetPCCell "Suran, Oran Manor" == 1 )
set cell to 913
elseif ( GetPCCell "Suran, Ibarnadad Assirnarari: Apothecary" == 1 )
set cell to 912
elseif ( GetPCCell "Suran, Guard Tower" == 1 )
set cell to 911
elseif ( GetPCCell "Suran, Goldyn Belaram: Pawnbroker" == 1 )
set cell to 910
elseif ( GetPCCell "Suran, Garothmuk gro-Muzgub: Smith" == 1 )
set cell to 909
elseif ( GetPCCell "Suran, Desele's House of Earthly Delights" == 1 )
set cell to 908
elseif ( GetPCCell "Sur Egg Mine" == 1 )
set cell to 907
elseif ( GetPCCell "Sulipund" == 1 )
set cell to 906
elseif ( GetPCCell "Sudanit Mine" == 1 )
set cell to 905
elseif ( GetPCCell "Sud" == 1 )
set cell to 904
elseif ( GetPCCell "Subdun, Shrine" == 1 )
set cell to 903
elseif ( GetPCCell "Subdun" == 1 )
set cell to 902
elseif ( GetPCCell "Strange Shipwreck, Upper Level" == 1 )
set cell to 901
elseif ( GetPCCell "Strange Shipwreck, Lower Level" == 1 )
set cell to 900
elseif ( GetPCCell "Strange Shipwreck, Cabin" == 1 )
set cell to 899
elseif ( GetPCCell "Sterdecan's Farmhouse" == 1 )
set cell to 898
elseif ( GetPCCell "Sobitbael Camp, Mal's Yurt" == 1 )
set cell to 883
elseif ( GetPCCell "Small Farmhouse" == 1 )
set cell to 882
elseif ( GetPCCell "Sjorvar Horse-Mouth's House" == 1 )
set cell to 881
elseif ( GetPCCell "Sinsibadon" == 1 )
set cell to 880
elseif ( GetPCCell "Sinarralit Egg Mine" == 1 )
set cell to 879
elseif ( GetPCCell "Sinamusa Egg Mine" == 1 )
set cell to 878
elseif ( GetPCCell "Shushishi" == 1 )
set cell to 877
elseif ( GetPCCell "Shushan" == 1 )
set cell to 876
elseif ( GetPCCell "Shurinbaal" == 1 )
set cell to 875
elseif ( GetPCCell "Shurdan-Raplay Egg Mine" == 1 )
set cell to 874
elseif ( GetPCCell "Shunned Shipwreck, Upper Level" == 1 )
set cell to 873
elseif ( GetPCCell "Shunned Shipwreck, Lower Level" == 1 )
set cell to 872
elseif ( GetPCCell "Shunned Shipwreck, Cabin" == 1 )
set cell to 871
elseif ( GetPCCell "Shulk Egg Mine, Queen's Lair" == 1 )
set cell to 870
elseif ( GetPCCell "Shulk Egg Mine, Mining Camp" == 1 )
set cell to 869
elseif ( GetPCCell "Shulk Egg Mine" == 1 )
set cell to 868
elseif ( GetPCCell "Shrine of Azura" == 1 )
set cell to 867
elseif ( GetPCCell "Shishi" == 1 )
set cell to 866
elseif ( GetPCCell "Shishara" == 1 )
set cell to 865
elseif ( GetPCCell "Shashurari Camp, Zennammu's Yurt" == 1 )
set cell to 864
elseif ( GetPCCell "Shashpilamat, Shrine" == 1 )
set cell to 863
elseif ( GetPCCell "Shashpilamat" == 1 )
set cell to 862
elseif ( GetPCCell "Shashmanu Camp, Anit's Yurt" == 1 )
set cell to 861
elseif ( GetPCCell "Sharapli" == 1 )
set cell to 860
elseif ( GetPCCell "Shara" == 1 )
set cell to 859
elseif ( GetPCCell "Shallit" == 1 )
set cell to 858
elseif ( GetPCCell "Shal" == 1 )
set cell to 857
elseif ( GetPCCell "Sha-Adnius" == 1 )
set cell to 856
elseif ( GetPCCell "Seyda Neen, Vodunius Nuccius' House" == 1 )
set cell to 855
elseif ( GetPCCell "Seyda Neen, Terurise Girvayne's House" == 1 )
set cell to 854
elseif ( GetPCCell "Seyda Neen, Lighthouse" == 1 )
set cell to 853
elseif ( GetPCCell "Seyda Neen, Indrele Rathryon's Shack" == 1 )
set cell to 852
elseif ( GetPCCell "Seyda Neen, Foryn Gilnith's Shack" == 1 )
set cell to 851
elseif ( GetPCCell "Seyda Neen, Fine-Mouth's Shack" == 1 )
set cell to 850
elseif ( GetPCCell "Seyda Neen, Fargoth's House" == 1 )
set cell to 849
elseif ( GetPCCell "Seyda Neen, Erene Llenim's Shack" == 1 )
set cell to 848
elseif ( GetPCCell "Seyda Neen, Eldafire's House" == 1 )
set cell to 847
elseif ( GetPCCell "Seyda Neen, Draren Thiralas' House" == 1 )
set cell to 846
elseif ( GetPCCell "Seyda Neen, Census and Excise Warehouse" == 1 )
set cell to 845
elseif ( GetPCCell "Seyda Neen, Census and Excise Office" == 1 )
set cell to 844
elseif ( GetPCCell "Seyda Neen, Arrille's Tradehouse" == 1 )
set cell to 843
elseif ( GetPCCell "Setus Egg Mine" == 1 )
set cell to 842
elseif ( GetPCCell "Sethan Ancestral Tomb" == 1 )
set cell to 841
elseif ( GetPCCell "Serano Ancestral Tomb" == 1 )
set cell to 840
elseif ( GetPCCell "Seran Ancestral Tomb" == 1 )
set cell to 839
elseif ( GetPCCell "Sennananit" == 1 )
set cell to 838
elseif ( GetPCCell "Senim Ancestral Tomb" == 1 )
set cell to 837
elseif ( GetPCCell "Savel Ancestral Tomb" == 1 )
set cell to 836
elseif ( GetPCCell "Saturan" == 1 )
set cell to 835
elseif ( GetPCCell "Sarys Ancestral Tomb" == 1 )
set cell to 834
elseif ( GetPCCell "Sarimisun-Assa Egg Mine, Queen's Lair" == 1 )
set cell to 833
elseif ( GetPCCell "Sarimisun-Assa Egg Mine" == 1 )
set cell to 832
elseif ( GetPCCell "Sargon" == 1 )
set cell to 831
elseif ( GetPCCell "Sarethi Ancestral Tomb" == 1 )
set cell to 830
elseif ( GetPCCell "Saren Ancestral Tomb" == 1 )
set cell to 829
elseif ( GetPCCell "Sarano Ancestral Tomb" == 1 )
set cell to 828
elseif ( GetPCCell "Sanni" == 1 )
set cell to 827
elseif ( GetPCCell "Sanit, Shrine" == 1 )
set cell to 826
elseif ( GetPCCell "Sanit" == 1 )
set cell to 825
elseif ( GetPCCell "Sandus Ancestral Tomb" == 1 )
set cell to 824
elseif ( GetPCCell "Sandas Ancestral Tomb" == 1 )
set cell to 823
elseif ( GetPCCell "Sanabi" == 1 )
set cell to 822
elseif ( GetPCCell "Samarys Ancestral Tomb" == 1 )
set cell to 821
elseif ( GetPCCell "Salvel Ancestral Tomb" == 1 )
set cell to 820
elseif ( GetPCCell "Salothran Ancestral Tomb" == 1 )
set cell to 819
elseif ( GetPCCell "Salothan Ancestral Tomb" == 1 )
set cell to 818
elseif ( GetPCCell "Salmantu, Shrine" == 1 )
set cell to 817
elseif ( GetPCCell "Salmantu" == 1 )
set cell to 816
elseif ( GetPCCell "Salit Camp, Zelay's Yurt" == 1 )
set cell to 815
elseif ( GetPCCell "Salit Camp, Zalit's Yurt" == 1 )
set cell to 814
elseif ( GetPCCell "Sadryon Ancestral Tomb" == 1 )
set cell to 813
elseif ( GetPCCell "Sadrith Mora, Wolverine Hall: Mage's Guild" == 1 )
set cell to 812
elseif ( GetPCCell "Sadrith Mora, Wolverine Hall: Imperial Shrine" == 1 )
set cell to 811
elseif ( GetPCCell "Sadrith Mora, Wolverine Hall: Fighter's Guild" == 1 )
set cell to 810
elseif ( GetPCCell "Sadrith Mora, Wolverine Hall" == 1 )
set cell to 809
elseif ( GetPCCell "Sadrith Mora, Volmyni Dral's House" == 1 )
set cell to 808
elseif ( GetPCCell "Sadrith Mora, Vaden Belas' House" == 1 )
set cell to 807
elseif ( GetPCCell "Sadrith Mora, Urtiso Faryon: Sorcerer" == 1 )
set cell to 806
elseif ( GetPCCell "Sadrith Mora, Urtisa Romayn's House" == 1 )
set cell to 805
elseif ( GetPCCell "Sadrith Mora, Trendrus Dral's House" == 1 )
set cell to 804
elseif ( GetPCCell "Sadrith Mora, Thervul Serethi: Healer" == 1 )
set cell to 803
elseif ( GetPCCell "Sadrith Mora, Telvanni Council House, Hermitage" == 1 )
set cell to 802
elseif ( GetPCCell "Sadrith Mora, Telvanni Council House, Entry" == 1 )
set cell to 801
elseif ( GetPCCell "Sadrith Mora, Telvanni Council House, Chambers" == 1 )
set cell to 800
elseif ( GetPCCell "Sadrith Mora, Telvanni Council House" == 1 )
set cell to 799
elseif ( GetPCCell "Sadrith Mora, Tel Naga Upper Tower" == 1 )
set cell to 798
elseif ( GetPCCell "Sadrith Mora, Tel Naga Upper Hall" == 1 )
set cell to 797
elseif ( GetPCCell "Sadrith Mora, Tel Naga Great Hall" == 1 )
set cell to 796
elseif ( GetPCCell "Sadrith Mora, Tel Naga General Quarters" == 1 )
set cell to 795
elseif ( GetPCCell "Sadrith Mora, Rolis Garvon's House" == 1 )
set cell to 794
elseif ( GetPCCell "Sadrith Mora, Pierlette Rostorard: Apothecary" == 1 )
set cell to 793
elseif ( GetPCCell "Sadrith Mora, Nirasa Aren's House" == 1 )
set cell to 792
elseif ( GetPCCell "Sadrith Mora, Nevrila Areloth's House" == 1 )
set cell to 791
elseif ( GetPCCell "Sadrith Mora, Morag Tong Guild" == 1 )
set cell to 790
elseif ( GetPCCell "Sadrith Mora, Milara Vedran's House" == 1 )
set cell to 789
elseif ( GetPCCell "Sadrith Mora, Meluria Seleth's House" == 1 )
set cell to 788
elseif ( GetPCCell "Sadrith Mora, Madran Ulvel's House" == 1 )
set cell to 787
elseif ( GetPCCell "Sadrith Mora, Llaalam Madalas: Mage" == 1 )
set cell to 786
elseif ( GetPCCell "Sadrith Mora, Hleras Gidren's House" == 1 )
set cell to 785
elseif ( GetPCCell "Sadrith Mora, Gateway Inn: West Wing" == 1 )
set cell to 784
elseif ( GetPCCell "Sadrith Mora, Gateway Inn: South Wing" == 1 )
set cell to 783
elseif ( GetPCCell "Sadrith Mora, Gateway Inn: North Wing" == 1 )
set cell to 782
elseif ( GetPCCell "Sadrith Mora, Gateway Inn" == 1 )
set cell to 781
elseif ( GetPCCell "Sadrith Mora, Fara's Hole in the Wall" == 1 )
set cell to 780
elseif ( GetPCCell "Sadrith Mora, Dirty Muriel's Cornerclub" == 1 )
set cell to 779
elseif ( GetPCCell "Sadrith Mora, Balen Vendu: Monk" == 1 )
set cell to 778
elseif ( GetPCCell "Sadrith Mora, Anis Seloth: Alchemist" == 1 )
set cell to 777
elseif ( GetPCCell "Rotheran, Propylon Chamber" == 1 )
set cell to 776
elseif ( GetPCCell "Rotheran, Communal Hut" == 1 )
set cell to 775
elseif ( GetPCCell "Rotheran, Arena" == 1 )
set cell to 774
elseif ( GetPCCell "Rothan Ancestral Tomb" == 1 )
set cell to 773
elseif ( GetPCCell "Rissun" == 1 )
set cell to 772
elseif ( GetPCCell "Rethandus Ancestral Tomb" == 1 )
set cell to 771
elseif ( GetPCCell "Rethan Manor, Tures' House" == 1 )
set cell to 770
elseif ( GetPCCell "Rethan Manor, Gols' House" == 1 )
set cell to 769
elseif ( GetPCCell "Rethan Manor, Drelas' House" == 1 )
set cell to 768
elseif ( GetPCCell "Rethan Manor, Berendas' House" == 1 )
set cell to 767
elseif ( GetPCCell "Rethan Manor" == 1 )
set cell to 766
endif

if ( cell != -1 )
	set vn_TeleportCell to cell
endif

StopScript "vn_Teleport_getCell_Sub4"

End

# vn_Teleport_getCell_Sub5 ====================================================
Begin vn_Teleport_getCell_Sub5

short cell
set cell to -1

if ( GetPCCell "Zergonipal, Shrine" == 1 )
set cell to 1229
elseif ( GetPCCell "Zenarbael" == 1 )
set cell to 1228
elseif ( GetPCCell "Zebabi" == 1 )
set cell to 1227
elseif ( GetPCCell "Zanabi" == 1 )
set cell to 1226
elseif ( GetPCCell "Zalkin-Sul Egg Mine" == 1 )
set cell to 1225
elseif ( GetPCCell "Zalkin Grotto" == 1 )
set cell to 1224
elseif ( GetPCCell "Zaintiraris, Shrine" == 1 )
set cell to 1223
elseif ( GetPCCell "Zaintirari" == 1 )
set cell to 1222
elseif ( GetPCCell "Zainsipilu" == 1 )
set cell to 1221
elseif ( GetPCCell "Zainab Camp, Wise Woman's Yurt" == 1 )
set cell to 1220
elseif ( GetPCCell "Zainab Camp, Tussi's Yurt" == 1 )
set cell to 1219
elseif ( GetPCCell "Zainab Camp, Patababi's Yurt" == 1 )
set cell to 1218
elseif ( GetPCCell "Zainab Camp, Minassour's Yurt" == 1 )
set cell to 1217
elseif ( GetPCCell "Zainab Camp, Kummu's Yurt" == 1 )
set cell to 1216
elseif ( GetPCCell "Zainab Camp, Kuda's Yurt" == 1 )
set cell to 1215
elseif ( GetPCCell "Zainab Camp, Ashur-Dan's Yurt" == 1 )
set cell to 1214
elseif ( GetPCCell "Zainab Camp, Ashkhan's Yurt" == 1 )
set cell to 1213
elseif ( GetPCCell "Zainab Camp, Ashibaal's Yurt" == 1 )
set cell to 1212
elseif ( GetPCCell "Zainab Camp, Ababael Timsar-Dadisun's Yurt" == 1 )
set cell to 1211
elseif ( GetPCCell "Yesamsi" == 1 )
set cell to 1210
elseif ( GetPCCell "Yassu Mine" == 1 )
set cell to 1209
elseif ( GetPCCell "Yasamsi" == 1 )
set cell to 1208
elseif ( GetPCCell "Yasammidan, Shrine" == 1 )
set cell to 1207
elseif ( GetPCCell "Yansirramus, Shrine" == 1 )
set cell to 1206
elseif ( GetPCCell "Yanemus Mine" == 1 )
set cell to 1205
elseif ( GetPCCell "Yakin, Shrine" == 1 )
set cell to 1204
elseif ( GetPCCell "Yakin" == 1 )
set cell to 1203
elseif ( GetPCCell "Yakaridan Camp, Kitbael's Yurt" == 1 )
set cell to 1202
elseif ( GetPCCell "Yakanalit" == 1 )
set cell to 1201
elseif ( GetPCCell "Vos, Vos Chapel" == 1 )
set cell to 1200
elseif ( GetPCCell "Vos, Varo Tradehouse Storage" == 1 )
set cell to 1199
elseif ( GetPCCell "Vos, Varo Tradehouse Entrance" == 1 )
set cell to 1198
elseif ( GetPCCell "Vos, Varo Tradehouse" == 1 )
set cell to 1197
elseif ( GetPCCell "Vos, Ulvil Llothas's Farmhouse" == 1 )
set cell to 1196
elseif ( GetPCCell "Vos, Trilam Drolnor's Farmhouse" == 1 )
set cell to 1195
elseif ( GetPCCell "Vos, Thilse Aralas's Farmhouse" == 1 )
set cell to 1194
elseif ( GetPCCell "Vos, Runethyne Andas's Farmhouse" == 1 )
set cell to 1193
elseif ( GetPCCell "Vos, Menus Felas's Farmhouse" == 1 )
set cell to 1192
elseif ( GetPCCell "Vos, Mandyn Ralas's Farmhouse" == 1 )
set cell to 1191
elseif ( GetPCCell "Vos, Maela Kaushad's Farmhouse" == 1 )
set cell to 1190
elseif ( GetPCCell "Vos, Ienasa Radas's Farmhouse" == 1 )
set cell to 1189
elseif ( GetPCCell "Vos, Fanisea Irano's Farmhouse" == 1 )
set cell to 1188
elseif ( GetPCCell "Vos, Dreynos Elvul's Farmhouse" == 1 )
set cell to 1187
elseif ( GetPCCell "Vivec, The Lizard's Head" == 1 )
set cell to 1186
elseif ( GetPCCell "Vivec, The Flowers of Gold" == 1 )
set cell to 1185
elseif ( GetPCCell "Vivec, The Abbey of St. Delyn the Wise" == 1 )
set cell to 1184
elseif ( GetPCCell "Vivec, Tervur Braven: Trader" == 1 )
set cell to 1183
elseif ( GetPCCell "Vivec, Temporary Telvanni Housing" == 1 )
set cell to 1182
elseif ( GetPCCell "Vivec, Telvanni Waistworks" == 1 )
set cell to 1181
elseif ( GetPCCell "Vivec, Telvanni Vault" == 1 )
set cell to 1180
elseif ( GetPCCell "Vivec, Telvanni Upper Storage" == 1 )
set cell to 1179
elseif ( GetPCCell "Vivec, Telvanni Underworks" == 1 )
set cell to 1178
elseif ( GetPCCell "Vivec, Telvanni Tower" == 1 )
set cell to 1177
elseif ( GetPCCell "Vivec, Telvanni Temple" == 1 )
set cell to 1176
elseif ( GetPCCell "Vivec, Telvanni Sorcerer" == 1 )
set cell to 1175
elseif ( GetPCCell "Vivec, Telvanni Prison Cells" == 1 )
set cell to 1174
elseif ( GetPCCell "Vivec, Telvanni Plaza" == 1 )
set cell to 1173
elseif ( GetPCCell "Vivec, Telvanni Monster Lab" == 1 )
set cell to 1172
elseif ( GetPCCell "Vivec, Telvanni Mage" == 1 )
set cell to 1171
elseif ( GetPCCell "Vivec, Telvanni Enchanter" == 1 )
set cell to 1170
elseif ( GetPCCell "Vivec, Telvanni Canalworks" == 1 )
set cell to 1169
elseif ( GetPCCell "Vivec, Telvanni Apothecary" == 1 )
set cell to 1168
elseif ( GetPCCell "Vivec, Telvanni Alchemist" == 1 )
set cell to 1167
elseif ( GetPCCell "Vivec, St. Olms Yngling Manor Basement" == 1 )
set cell to 1166
elseif ( GetPCCell "Vivec, St. Olms Yngling Manor" == 1 )
set cell to 1165
elseif ( GetPCCell "Vivec, St. Olms Waistworks" == 1 )
set cell to 1164
elseif ( GetPCCell "Vivec, St. Olms Waist South-Two" == 1 )
set cell to 1163
elseif ( GetPCCell "Vivec, St. Olms Waist South-One" == 1 )
set cell to 1162
elseif ( GetPCCell "Vivec, St. Olms Waist North-Two" == 1 )
set cell to 1161
elseif ( GetPCCell "Vivec, St. Olms Waist North-One" == 1 )
set cell to 1160
elseif ( GetPCCell "Vivec, St. Olms Upper South-One" == 1 )
set cell to 1159
elseif ( GetPCCell "Vivec, St. Olms Upper North-Two" == 1 )
set cell to 1158
elseif ( GetPCCell "Vivec, St. Olms Upper North-One" == 1 )
set cell to 1157
elseif ( GetPCCell "Vivec, St. Olms Underworks" == 1 )
set cell to 1156
elseif ( GetPCCell "Vivec, St. Olms Temple" == 1 )
set cell to 1155
elseif ( GetPCCell "Vivec, St. Olms Tanners and Miners Hall" == 1 )
set cell to 1154
elseif ( GetPCCell "Vivec, St. Olms Tailors and Dyers Hall" == 1 )
set cell to 1153
elseif ( GetPCCell "Vivec, St. Olms Storage" == 1 )
set cell to 1152
elseif ( GetPCCell "Vivec, St. Olms Plaza" == 1 )
set cell to 1151
elseif ( GetPCCell "Vivec, St. Olms Haunted Manor" == 1 )
set cell to 1150
elseif ( GetPCCell "Vivec, St. Olms Farmers and Laborers Hall" == 1 )
set cell to 1149
elseif ( GetPCCell "Vivec, St. Olms Canalworks" == 1 )
set cell to 1148
elseif ( GetPCCell "Vivec, St. Olms Canal South-Two" == 1 )
set cell to 1147
elseif ( GetPCCell "Vivec, St. Olms Canal South-Three" == 1 )
set cell to 1146
elseif ( GetPCCell "Vivec, St. Olms Canal South-One" == 1 )
set cell to 1145
elseif ( GetPCCell "Vivec, St. Olms Canal North-Two" == 1 )
set cell to 1144
elseif ( GetPCCell "Vivec, St. Olms Canal North-Three" == 1 )
set cell to 1143
elseif ( GetPCCell "Vivec, St. Olms Canal North-One" == 1 )
set cell to 1142
elseif ( GetPCCell "Vivec, St. Olms Brewers and Fishmongers Hall" == 1 )
set cell to 1141
elseif ( GetPCCell "Vivec, St. Delyn Waistworks" == 1 )
set cell to 1140
elseif ( GetPCCell "Vivec, St. Delyn Waist South-Two" == 1 )
set cell to 1139
elseif ( GetPCCell "Vivec, St. Delyn Waist South-One" == 1 )
set cell to 1138
elseif ( GetPCCell "Vivec, St. Delyn Waist North-Two" == 1 )
set cell to 1137
elseif ( GetPCCell "Vivec, St. Delyn Waist North-One" == 1 )
set cell to 1136
elseif ( GetPCCell "Vivec, St. Delyn Underworks" == 1 )
set cell to 1135
elseif ( GetPCCell "Vivec, St. Delyn Storage" == 1 )
set cell to 1134
elseif ( GetPCCell "Vivec, St. Delyn Potter's Hall" == 1 )
set cell to 1133
elseif ( GetPCCell "Vivec, St. Delyn Plaza" == 1 )
set cell to 1132
elseif ( GetPCCell "Vivec, St. Delyn Glassworker's Hall" == 1 )
set cell to 1131
elseif ( GetPCCell "Vivec, St. Delyn Canalworks" == 1 )
set cell to 1130
elseif ( GetPCCell "Vivec, St. Delyn Canal South-Two" == 1 )
set cell to 1129
elseif ( GetPCCell "Vivec, St. Delyn Canal South-Three" == 1 )
set cell to 1128
elseif ( GetPCCell "Vivec, St. Delyn Canal South-One" == 1 )
set cell to 1127
elseif ( GetPCCell "Vivec, St. Delyn Canal North-Two" == 1 )
set cell to 1126
elseif ( GetPCCell "Vivec, St. Delyn Canal North-Three" == 1 )
set cell to 1125
elseif ( GetPCCell "Vivec, St. Delyn Canal North-One" == 1 )
set cell to 1124
elseif ( GetPCCell "Vivec, Simine Fralinie: Bookseller" == 1 )
set cell to 1123
elseif ( GetPCCell "Vivec, Saren Manor" == 1 )
set cell to 1122
elseif ( GetPCCell "Vivec, Redoran Waistworks" == 1 )
set cell to 1121
elseif ( GetPCCell "Vivec, Redoran Vaults" == 1 )
set cell to 1120
elseif ( GetPCCell "Vivec, Redoran Underworks" == 1 )
set cell to 1119
elseif ( GetPCCell "Vivec, Redoran Treasury" == 1 )
set cell to 1118
elseif ( GetPCCell "Vivec, Redoran Trader" == 1 )
set cell to 1117
elseif ( GetPCCell "Vivec, Redoran Temple Shrine" == 1 )
set cell to 1116
elseif ( GetPCCell "Vivec, Redoran Smith" == 1 )
set cell to 1115
elseif ( GetPCCell "Vivec, Redoran Scout & Drillmaster" == 1 )
set cell to 1114
elseif ( GetPCCell "Vivec, Redoran Records" == 1 )
set cell to 1113
elseif ( GetPCCell "Vivec, Redoran Prison Cells" == 1 )
set cell to 1112
elseif ( GetPCCell "Vivec, Redoran Plaza" == 1 )
set cell to 1111
elseif ( GetPCCell "Vivec, Redoran Canalworks" == 1 )
set cell to 1110
elseif ( GetPCCell "Vivec, Redoran Ancestral Vaults" == 1 )
set cell to 1109
elseif ( GetPCCell "Vivec, Ralen Tilvur: Smith" == 1 )
set cell to 1108
elseif ( GetPCCell "Vivec, Puzzle Canal, Level 5" == 1 )
set cell to 1107
elseif ( GetPCCell "Vivec, Puzzle Canal, Level 4" == 1 )
set cell to 1106
elseif ( GetPCCell "Vivec, Puzzle Canal, Level 3" == 1 )
set cell to 1105
elseif ( GetPCCell "Vivec, Puzzle Canal, Level 2" == 1 )
set cell to 1104
elseif ( GetPCCell "Vivec, Puzzle Canal, Level 1" == 1 )
set cell to 1103
elseif ( GetPCCell "Vivec, Puzzle Canal, Center" == 1 )
set cell to 1102
elseif ( GetPCCell "Vivec, Palace of Vivec" == 1 )
set cell to 1101
elseif ( GetPCCell "Vivec, Ordinator Barracks" == 1 )
set cell to 1100
elseif ( GetPCCell "Vivec, Office of the Watch" == 1 )
set cell to 1099
elseif ( GetPCCell "Vivec, No Name Club" == 1 )
set cell to 1098
elseif ( GetPCCell "Vivec, Miun-Gei: Enchanter" == 1 )
set cell to 1097
elseif ( GetPCCell "Vivec, Milo's Quarters" == 1 )
set cell to 1096
elseif ( GetPCCell "Vivec, Mevel Fererus: Trader" == 1 )
set cell to 1095
elseif ( GetPCCell "Vivec, Lucretinaus Olcinius: Trader" == 1 )
set cell to 1094
elseif ( GetPCCell "Vivec, Library of Vivec" == 1 )
set cell to 1093
elseif ( GetPCCell "Vivec, Justice Offices" == 1 )
set cell to 1092
elseif ( GetPCCell "Vivec, Jobasha's Rare Books" == 1 )
set cell to 1091
elseif ( GetPCCell "Vivec, Jeanne: Trader" == 1 )
set cell to 1090
elseif ( GetPCCell "Vivec, J'Rasha: Healer" == 1 )
set cell to 1089
elseif ( GetPCCell "Vivec, Hlaren Residence" == 1 )
set cell to 1088
elseif ( GetPCCell "Vivec, Hlaalu Weaponsmith" == 1 )
set cell to 1087
elseif ( GetPCCell "Vivec, Hlaalu Waistworks" == 1 )
set cell to 1086
elseif ( GetPCCell "Vivec, Hlaalu Vaults" == 1 )
set cell to 1085
elseif ( GetPCCell "Vivec, Hlaalu Underworks" == 1 )
set cell to 1084
elseif ( GetPCCell "Vivec, Hlaalu Treasury" == 1 )
set cell to 1083
elseif ( GetPCCell "Vivec, Hlaalu Temple" == 1 )
set cell to 1082
elseif ( GetPCCell "Vivec, Hlaalu Records" == 1 )
set cell to 1081
elseif ( GetPCCell "Vivec, Hlaalu Prison Cells" == 1 )
set cell to 1080
elseif ( GetPCCell "Vivec, Hlaalu Plaza" == 1 )
set cell to 1079
elseif ( GetPCCell "Vivec, Hlaalu Pawnbroker" == 1 )
set cell to 1078
elseif ( GetPCCell "Vivec, Hlaalu General Goods" == 1 )
set cell to 1077
elseif ( GetPCCell "Vivec, Hlaalu Edryno Arethi's House" == 1 )
set cell to 1076
elseif ( GetPCCell "Vivec, Hlaalu Canalworks" == 1 )
set cell to 1075
elseif ( GetPCCell "Vivec, Hlaalu Ancestral Vaults" == 1 )
set cell to 1074
elseif ( GetPCCell "Vivec, Hlaalu Alchemist" == 1 )
set cell to 1073
elseif ( GetPCCell "Vivec, High Fane" == 1 )
set cell to 1072
elseif ( GetPCCell "Vivec, Hall Underworks" == 1 )
set cell to 1071
elseif ( GetPCCell "Vivec, Hall of Wisdom" == 1 )
set cell to 1070
elseif ( GetPCCell "Vivec, Hall of Justice Secret Library" == 1 )
set cell to 1069
elseif ( GetPCCell "Vivec, Hall of Justice" == 1 )
set cell to 1068
elseif ( GetPCCell "Vivec, Guild of Mages" == 1 )
set cell to 1067
elseif ( GetPCCell "Vivec, Guild of Fighters" == 1 )
set cell to 1066
elseif ( GetPCCell "Vivec, Foreign Quarter Upper Waistworks" == 1 )
set cell to 1065
elseif ( GetPCCell "Vivec, Foreign Quarter Underworks" == 1 )
set cell to 1064
elseif ( GetPCCell "Vivec, Foreign Quarter Tomb" == 1 )
set cell to 1063
elseif ( GetPCCell "Vivec, Foreign Quarter Plaza" == 1 )
set cell to 1062
elseif ( GetPCCell "Vivec, Foreign Quarter Lower Waistworks" == 1 )
set cell to 1061
elseif ( GetPCCell "Vivec, Foreign Quarter Canalworks" == 1 )
set cell to 1060
elseif ( GetPCCell "Vivec, Elven Nations Cornerclub" == 1 )
set cell to 1059
elseif ( GetPCCell "Vivec, Dralor Manor" == 1 )
set cell to 1058
elseif ( GetPCCell "Vivec, Curio Manor" == 1 )
set cell to 1057
elseif ( GetPCCell "Vivec, Canon Quarters" == 1 )
set cell to 1056
elseif ( GetPCCell "Vivec, Canon Offices" == 1 )
set cell to 1055
elseif ( GetPCCell "Vivec, Black Shalk Cornerclub" == 1 )
set cell to 1054
elseif ( GetPCCell "Vivec, Aurane Frernis: Apothecary" == 1 )
set cell to 1053
elseif ( GetPCCell "Vivec, Arena Waistworks" == 1 )
set cell to 1052
elseif ( GetPCCell "Vivec, Arena Underworks" == 1 )
set cell to 1051
elseif ( GetPCCell "Vivec, Arena Storage" == 1 )
set cell to 1050
elseif ( GetPCCell "Vivec, Arena Pit" == 1 )
set cell to 1049
elseif ( GetPCCell "Vivec, Arena Holding Cells" == 1 )
set cell to 1048
elseif ( GetPCCell "Vivec, Arena Hidden Area" == 1 )
set cell to 1047
elseif ( GetPCCell "Vivec, Arena Fighters Training" == 1 )
set cell to 1046
elseif ( GetPCCell "Vivec, Arena Fighters Quarters" == 1 )
set cell to 1045
elseif ( GetPCCell "Vivec, Arena Canalworks" == 1 )
set cell to 1044
elseif ( GetPCCell "Vivec, Andilu Drothan: Alchemist" == 1 )
set cell to 1043
elseif ( GetPCCell "Vivec, Alusaron: Smith" == 1 )
set cell to 1042
elseif ( GetPCCell "Vivec, Agrippina Herennia: Clothier" == 1 )
set cell to 1041
elseif ( GetPCCell "Verelnim Ancestral Tomb" == 1 )
set cell to 1040
elseif ( GetPCCell "Venim Ancestral Tomb" == 1 )
set cell to 1039
elseif ( GetPCCell "Vemynal, Outer Fortress" == 1 )
set cell to 1038
elseif ( GetPCCell "Vemynal, Hall of Torque" == 1 )
set cell to 1037
elseif ( GetPCCell "Veloth Ancestral Tomb" == 1 )
set cell to 1036
elseif ( GetPCCell "Velas Ancestral Tomb" == 1 )
set cell to 1035
elseif ( GetPCCell "Vassir-Didanat Cave" == 1 )
set cell to 1034
elseif ( GetPCCell "Vassamsi Grotto" == 1 )
set cell to 1033
elseif ( GetPCCell "Vas, Tower" == 1 )
set cell to 1032
elseif ( GetPCCell "Vas, Entry Level" == 1 )
set cell to 1031
elseif ( GetPCCell "Vansunalit Egg Mine" == 1 )
set cell to 1030
elseif ( GetPCCell "Vandus Ancestral Tomb" == 1 )
set cell to 1029
elseif ( GetPCCell "Valenvaryon, Umug's Hut" == 1 )
set cell to 1028
elseif ( GetPCCell "Valenvaryon, Propylon Chamber" == 1 )
set cell to 1027
elseif ( GetPCCell "Valenvaryon, Lurog's Hut" == 1 )
set cell to 1026
elseif ( GetPCCell "Valenvaryon, Lambug's Hut" == 1 )
set cell to 1025
elseif ( GetPCCell "Valenvaryon, Gashna's Hut" == 1 )
set cell to 1024
elseif ( GetPCCell "Valenvaryon, Durz's Hut" == 1 )
set cell to 1023
endif

if ( cell != -1 )
	set vn_TeleportCell to cell
endif

StopScript "vn_Teleport_getCell_Sub5"

End

# vn_Teleport_getGrid_Sub1 ====================================================
Begin vn_Teleport_getGrid_Sub1

short cell
set cell to -1

if ( GetPCCell "Zergonipal" == 1 )
set cell to 1391
elseif ( GetPCCell "Zaintiraris" == 1 )
set cell to 1390
elseif ( GetPCCell "Zainab Camp" == 1 )
set cell to 1389
elseif ( GetPCCell "Yansirramus" == 1 )
set cell to 1388
elseif ( GetPCCell "Wolverine Hall" == 1 )
set cell to 1387
elseif ( GetPCCell "West Gash Region" == 1 )
set cell to 1386
elseif ( GetPCCell "Vos" == 1 )
set cell to 1385
elseif ( GetPCCell "Vivec, Temple" == 1 )
set cell to 1384
elseif ( GetPCCell "Vivec, Telvanni" == 1 )
set cell to 1383
elseif ( GetPCCell "Vivec, St. Olms" == 1 )
set cell to 1382
elseif ( GetPCCell "Vivec, St. Delyn" == 1 )
set cell to 1381
elseif ( GetPCCell "Vivec, Redoran" == 1 )
set cell to 1380
elseif ( GetPCCell "Vivec, Hlaalu" == 1 )
set cell to 1379
elseif ( GetPCCell "Vivec, Foreign Quarter" == 1 )
set cell to 1378
elseif ( GetPCCell "Vivec, Arena" == 1 )
set cell to 1377
elseif ( GetPCCell "Vivec" == 1 )
set cell to 1376
elseif ( GetPCCell "Vemynal" == 1 )
set cell to 1375
elseif ( GetPCCell "Vas" == 1 )
set cell to 1374
elseif ( GetPCCell "Valenvaryon" == 1 )
set cell to 1373
elseif ( GetPCCell "Uvirith's Grave" == 1 )
set cell to 1372
elseif ( GetPCCell "Urshilaku Camp" == 1 )
set cell to 1371
elseif ( GetPCCell "Tureynulal" == 1 )
set cell to 1370
elseif ( GetPCCell "Telasero" == 1 )
set cell to 1369
elseif ( GetPCCell "Tel Vos" == 1 )
set cell to 1368
elseif ( GetPCCell "Tel Mora" == 1 )
set cell to 1367
elseif ( GetPCCell "Tel Fyr" == 1 )
set cell to 1366
elseif ( GetPCCell "Tel Branora" == 1 )
set cell to 1365
elseif ( GetPCCell "Tel Aruhn" == 1 )
set cell to 1364
elseif ( GetPCCell "Suran" == 1 )
set cell to 1363
elseif ( GetPCCell "Sheogorad Region" == 1 )
set cell to 1362
elseif ( GetPCCell "Seyda Neen" == 1 )
set cell to 1361
elseif ( GetPCCell "Sanctus Shrine" == 1 )
set cell to 1360
elseif ( GetPCCell "Sadrith Mora" == 1 )
set cell to 1359
elseif ( GetPCCell "Rotheran" == 1 )
set cell to 1358
elseif ( GetPCCell "Red Mountain Region" == 1 )
set cell to 1357
elseif ( GetPCCell "Pelagiad" == 1 )
set cell to 1356
elseif ( GetPCCell "Odrosal" == 1 )
set cell to 1355
elseif ( GetPCCell "Odai Plateau" == 1 )
set cell to 1354
elseif ( GetPCCell "Nchurdamz" == 1 )
set cell to 1353
elseif ( GetPCCell "Nchuleftingth" == 1 )
set cell to 1352
elseif ( GetPCCell "Nchuleft Ruin" == 1 )
set cell to 1351
elseif ( GetPCCell "Mzuleft Ruin" == 1 )
set cell to 1350
elseif ( GetPCCell "Mzahnch Ruin" == 1 )
set cell to 1349
elseif ( GetPCCell "Mount Kand" == 1 )
set cell to 1348
elseif ( GetPCCell "Mount Assarnibibi" == 1 )
set cell to 1347
elseif ( GetPCCell "Moonmoth Legion Fort" == 1 )
set cell to 1346
elseif ( GetPCCell "Molag Mar" == 1 )
set cell to 1345
elseif ( GetPCCell "Molag Amur Region" == 1 )
set cell to 1344
elseif ( GetPCCell "Marandus" == 1 )
set cell to 1343
elseif ( GetPCCell "Maar Gan" == 1 )
set cell to 1342
elseif ( GetPCCell "Kogoruhn" == 1 )
set cell to 1341
elseif ( GetPCCell "Koal Cave Entrance" == 1 )
set cell to 1340
elseif ( GetPCCell "Khuul" == 1 )
set cell to 1339
elseif ( GetPCCell "Khartag Point" == 1 )
set cell to 1338
elseif ( GetPCCell "Holamayan" == 1 )
set cell to 1337
elseif ( GetPCCell "Hlormaren" == 1 )
set cell to 1336
elseif ( GetPCCell "Hla Oad" == 1 )
set cell to 1335
elseif ( GetPCCell "Grazelands Region" == 1 )
set cell to 1334
elseif ( GetPCCell "Gnisis" == 1 )
set cell to 1333
elseif ( GetPCCell "Gnaar Mok" == 1 )
set cell to 1332
elseif ( GetPCCell "Ghostgate" == 1 )
set cell to 1331
elseif ( GetPCCell "Fields of Kummu" == 1 )
set cell to 1330
elseif ( GetPCCell "Falensarano" == 1 )
set cell to 1329
elseif ( GetPCCell "Falasmaryon" == 1 )
set cell to 1328
elseif ( GetPCCell "Erabenimsun Camp" == 1 )
set cell to 1327
elseif ( GetPCCell "Ebonheart" == 1 )
set cell to 1326
elseif ( GetPCCell "Dren Plantation" == 1 )
set cell to 1325
elseif ( GetPCCell "Dagoth Ur" == 1 )
set cell to 1324
elseif ( GetPCCell "Dagon Fel" == 1 )
set cell to 1323
elseif ( GetPCCell "Caldera" == 1 )
set cell to 1322
elseif ( GetPCCell "Buckmoth Legion Fort" == 1 )
set cell to 1321
elseif ( GetPCCell "Bitter Coast Region" == 1 )
set cell to 1320
elseif ( GetPCCell "Berandas" == 1 )
set cell to 1319
elseif ( GetPCCell "Balmora" == 1 )
set cell to 1318
elseif ( GetPCCell "Bal Ur" == 1 )
set cell to 1317
elseif ( GetPCCell "Bal Isra" == 1 )
set cell to 1316
elseif ( GetPCCell "Bal Fell" == 1 )
set cell to 1315
elseif ( GetPCCell "Azura's Coast Region" == 1 )
set cell to 1314
elseif ( GetPCCell "Ashurnibibi" == 1 )
set cell to 1313
elseif ( GetPCCell "Ashurnabitashpi" == 1 )
set cell to 1312
elseif ( GetPCCell "Ashlands Region" == 1 )
set cell to 1311
elseif ( GetPCCell "Ashalmawia" == 1 )
set cell to 1310
elseif ( GetPCCell "Ascadian Isles Region" == 1 )
set cell to 1309
elseif ( GetPCCell "Arvel Plantation" == 1 )
set cell to 1308
elseif ( GetPCCell "Andasreth" == 1 )
set cell to 1307
elseif ( GetPCCell "Ald-ruhn" == 1 )
set cell to 1306
elseif ( GetPCCell "Ald Velothi" == 1 )
set cell to 1305
elseif ( GetPCCell "Ald Sotha" == 1 )
set cell to 1304
elseif ( GetPCCell "Ald Redaynia" == 1 )
set cell to 1303
elseif ( GetPCCell "Ald Daedroth" == 1 )
set cell to 1302
elseif ( GetPCCell "Ahemmusa Camp" == 1 )
set cell to 1301
endif

if ( cell == -1 )
	if ( vn_PosY >= -155648 )
	if ( vn_PosY < 237568 )
	if ( vn_PosX >= -237568 )
	if ( vn_PosX < 196608 )
	if ( vn_TeleportCell < 0 )
	set cell to 1300
	endif
	endif
	endif
	endif
	endif
endif

if ( cell != -1 )
	set vn_TeleportCell to cell
endif

StopScript "vn_Teleport_getGrid_Sub1"

End

# vn_Teleport_info_BloodMoon ==================================================
Begin vn_Teleport_info_BloodMoon

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

; regions
if ( cell == 1483 )
MessageBox "%g. Solstheim, Felsaad Coast Region" num
elseif ( cell == 1484 )
MessageBox "%g. Solstheim, Hirstaang Forest" num
elseif ( cell == 1485 )
MessageBox "%g. Solstheim, Isinfier Plains" num
elseif ( cell == 1486 )
MessageBox "%g. Solstheim, Moesring Mountains" num
elseif ( cell == 1487 )
MessageBox "%g. Fort Frostmoth" num
elseif ( cell == 1488 )
MessageBox "%g. Raven Rock" num
elseif ( cell == 1489 )
MessageBox "%g. Skaal Village" num
elseif ( cell == 1490 )
MessageBox "%g. Solstheim, Altar of Thrond" num
elseif ( cell == 1491 )
MessageBox "%g. Solstheim, Brodir Grove" num
elseif ( cell == 1492 )
MessageBox "%g. Solstheim, Castle Karstaag" num
elseif ( cell == 1493 )
MessageBox "%g. Solstheim, Gyldenhul Barrow Entrance" num
elseif ( cell == 1494 )
MessageBox "%g. Solstheim, Hrothmund's Bane" num
elseif ( cell == 1495 )
MessageBox "%g. Solstheim, Hvitkald Peak" num
elseif ( cell == 1496 )
MessageBox "%g. Solstheim, Lake Fjalding" num
elseif ( cell == 1497 )
MessageBox "%g. Solstheim, Mortrag Glacier" num
elseif ( cell == 1498 )
MessageBox "%g. Solstheim, Thormoor's Watch" num
elseif ( cell == 1499 )
MessageBox "%g. Thirsk" num

; internal cells
elseif ( cell == 1900 )
MessageBox "%g. Draugr Test" num
elseif ( cell == 1901 )
MessageBox "%g. Fort Frostmoth, Armory" num
elseif ( cell == 1902 )
MessageBox "%g. Fort Frostmoth, Carius' Chambers" num
elseif ( cell == 1903 )
MessageBox "%g. Fort Frostmoth, Curtain Wall" num
elseif ( cell == 1904 )
MessageBox "%g. Fort Frostmoth, General Quarters" num
elseif ( cell == 1905 )
MessageBox "%g. Fort Frostmoth, General Quarters, Upper Level" num
elseif ( cell == 1906 )
MessageBox "%g. Fort Frostmoth, Imperial Cult Shrine" num
elseif ( cell == 1907 )
MessageBox "%g. Fort Frostmoth, Prison" num
elseif ( cell == 1908 )
MessageBox "%g. Fort Frostmoth, Supply Room" num
elseif ( cell == 1909 )
MessageBox "%g. Mark's Script Testing Cell" num
elseif ( cell == 1910 )
MessageBox "%g. Raven Rock, Abandoned Mine Shaft" num
elseif ( cell == 1911 )
MessageBox "%g. Raven Rock, Afer Flaccus' House" num
elseif ( cell == 1912 )
MessageBox "%g. Raven Rock, Bar" num
elseif ( cell == 1913 )
MessageBox "%g. Raven Rock, Factor's Estate" num
elseif ( cell == 1914 )
MessageBox "%g. Raven Rock, Garnas Uvalen's House" num
elseif ( cell == 1915 )
MessageBox "%g. Raven Rock, Gidar Verothan's House" num
elseif ( cell == 1916 )
MessageBox "%g. Raven Rock, Gratian Caerellius' House" num
elseif ( cell == 1917 )
MessageBox "%g. Raven Rock, Mine" num
elseif ( cell == 1918 )
MessageBox "%g. Raven Rock, Mine Entrance" num
elseif ( cell == 1919 )
MessageBox "%g. Raven Rock, North Storehouse" num
elseif ( cell == 1920 )
MessageBox "%g. Raven Rock, Sabinus Oranius' House" num
elseif ( cell == 1921 )
MessageBox "%g. Raven Rock, Sados Relothan's House" num
elseif ( cell == 1922 )
MessageBox "%g. Raven Rock, Seler Favelnim's House" num
elseif ( cell == 1923 )
MessageBox "%g. Raven Rock, Smith" num
elseif ( cell == 1924 )
MessageBox "%g. Raven Rock, South Storehouse" num
elseif ( cell == 1925 )
MessageBox "%g. Raven Rock, SouthEast Storehouse" num
elseif ( cell == 1926 )
MessageBox "%g. Raven Rock, Supply Ship" num
elseif ( cell == 1927 )
MessageBox "%g. Raven Rock, Trader" num
elseif ( cell == 1928 )
MessageBox "%g. Raven Rock, Uryn Maren's House" num
elseif ( cell == 1929 )
MessageBox "%g. Raven Rock, Vacant House" num
elseif ( cell == 1930 )
MessageBox "%g. Skaal Village, Bronrod the Roarer's House" num
elseif ( cell == 1931 )
MessageBox "%g. Skaal Village, Erna the Quiet's House" num
elseif ( cell == 1932 )
MessageBox "%g. Skaal Village, Ice-Mane's Hut" num
elseif ( cell == 1933 )
MessageBox "%g. Skaal Village, Ingmar's House" num
elseif ( cell == 1934 )
MessageBox "%g. Skaal Village, Lassnr's House" num
elseif ( cell == 1935 )
MessageBox "%g. Skaal Village, Rigmor's Hut" num
elseif ( cell == 1936 )
MessageBox "%g. Skaal Village, Shaman's Hut" num
elseif ( cell == 1937 )
MessageBox "%g. Skaal village, Snedbrir the Smith" num
elseif ( cell == 1938 )
MessageBox "%g. Skaal Village, The Blodskaal's House" num
elseif ( cell == 1939 )
MessageBox "%g. Skaal Village, The Greathall" num
elseif ( cell == 1940 )
MessageBox "%g. Solstheim" num
elseif ( cell == 1941 )
MessageBox "%g. Solstheim, Aesliip's Lair" num
elseif ( cell == 1942 )
MessageBox "%g. Solstheim, Aesliip's Lair, Caverns" num
elseif ( cell == 1943 )
MessageBox "%g. Solstheim, Benkongerike" num
elseif ( cell == 1944 )
MessageBox "%g. Solstheim, Bjorn" num
elseif ( cell == 1945 )
MessageBox "%g. Solstheim, Bloodskal Barrow" num
elseif ( cell == 1946 )
MessageBox "%g. Solstheim, Castle Karstaag, Banquet Hall" num
elseif ( cell == 1947 )
MessageBox "%g. Solstheim, Castle Karstaag, Caverns of Karstaag" num
elseif ( cell == 1948 )
MessageBox "%g. Solstheim, Castle Karstaag, Karstaag's Chambers" num
elseif ( cell == 1949 )
MessageBox "%g. Solstheim, Castle Karstaag, Throne Room" num
elseif ( cell == 1950 )
MessageBox "%g. Solstheim, Castle Karstaag, Tower" num
elseif ( cell == 1951 )
MessageBox "%g. Solstheim, Cave of Hidden Music" num
elseif ( cell == 1952 )
MessageBox "%g. Solstheim, Caves of Fjalding" num
elseif ( cell == 1953 )
MessageBox "%g. Solstheim, Chamber of Song" num
elseif ( cell == 1954 )
MessageBox "%g. Solstheim, Connorflenge Barrow" num
elseif ( cell == 1955 )
MessageBox "%g. Solstheim, Domme" num
elseif ( cell == 1956 )
MessageBox "%g. Solstheim, Eddard Barrow" num
elseif ( cell == 1957 )
MessageBox "%g. Solstheim, Fjell" num
elseif ( cell == 1958 )
MessageBox "%g. Solstheim, Frossel" num
elseif ( cell == 1959 )
MessageBox "%g. Solstheim, Frosselmane Barrow" num
elseif ( cell == 1960 )
MessageBox "%g. Solstheim, Frykte" num
elseif ( cell == 1961 )
MessageBox "%g. Solstheim, Gandrung Caverns" num
elseif ( cell == 1962 )
MessageBox "%g. Solstheim, Geilir the Mumbling's Dwelling" num
elseif ( cell == 1963 )
MessageBox "%g. Solstheim, Glenschul's Tomb" num
elseif ( cell == 1964 )
MessageBox "%g. Solstheim, Gloomy Cave" num
elseif ( cell == 1965 )
MessageBox "%g. Solstheim, Graring's House" num
elseif ( cell == 1966 )
MessageBox "%g. Solstheim, Gronn" num
elseif ( cell == 1967 )
MessageBox "%g. Solstheim, Gyldenhul Barrow" num
elseif ( cell == 1968 )
MessageBox "%g. Solstheim, Halls of Penumbra" num
elseif ( cell == 1969 )
MessageBox "%g. Solstheim, Himmelhost Barrow" num
elseif ( cell == 1970 )
MessageBox "%g. Solstheim, Hrothmund's Barrow" num
elseif ( cell == 1971 )
MessageBox "%g. Solstheim, Jolgeirr Barrow" num
elseif ( cell == 1972 )
MessageBox "%g. Solstheim, Kelsedolk Barrow" num
elseif ( cell == 1973 )
MessageBox "%g. Solstheim, Kjolver's Dwelling" num
elseif ( cell == 1974 )
MessageBox "%g. Solstheim, Kolbjorn Barrow" num
elseif ( cell == 1975 )
MessageBox "%g. Solstheim, Kolfinna's Dwelling" num
elseif ( cell == 1976 )
MessageBox "%g. Solstheim, Lair of the Udyrfrykte" num
elseif ( cell == 1977 )
MessageBox "%g. Solstheim, Legge" num
elseif ( cell == 1978 )
MessageBox "%g. Solstheim, Lukesturm Barrow" num
elseif ( cell == 1979 )
MessageBox "%g. Solstheim, Mortrag Glacier: Entry" num
elseif ( cell == 1980 )
MessageBox "%g. Solstheim, Mortrag Glacier: Huntsman's Hall" num
elseif ( cell == 1981 )
MessageBox "%g. Solstheim, Mortrag Glacier: Inner Ring" num
elseif ( cell == 1982 )
MessageBox "%g. Solstheim, Mortrag Glacier: Outer Ring" num
elseif ( cell == 1983 )
MessageBox "%g. Solstheim, Rimhull" num
elseif ( cell == 1984 )
MessageBox "%g. Solstheim, Sjobal" num
elseif ( cell == 1985 )
MessageBox "%g. Solstheim, Skogsdrake Barrow" num
elseif ( cell == 1986 )
MessageBox "%g. Solstheim, Skygge" num
elseif ( cell == 1987 )
MessageBox "%g. Solstheim, Solvjord" num
elseif ( cell == 1988 )
MessageBox "%g. Solstheim, Stahlman's Gorge" num
elseif ( cell == 1989 )
MessageBox "%g. Solstheim, Stormpfund Barrow" num
elseif ( cell == 1990 )
MessageBox "%g. Solstheim, Thirsk" num
elseif ( cell == 1991 )
MessageBox "%g. Solstheim, Tombs of Skaalara" num
elseif ( cell == 1992 )
MessageBox "%g. Solstheim, Ulfgar the Unending's Dwelling" num
elseif ( cell == 1993 )
MessageBox "%g. Solstheim, Uncle Sweetshare's Workshop" num
elseif ( cell == 1994 )
MessageBox "%g. Solstheim, Valbrandr Barrow" num
elseif ( cell == 1995 )
MessageBox "%g. Solstheim, Varstaad Caves" num
elseif ( cell == 1996 )
MessageBox "%g. Vor Lair, Chambers of Alta Vor" num
elseif ( cell == 1997 )
MessageBox "%g. Vor Lair, Interior" num
endif

StopScript "vn_Teleport_info_BloodMoon"

End

# vn_Teleport_infoCell_Sub1 ===================================================
Begin vn_Teleport_infoCell_Sub1

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

if ( cell == 0 )
MessageBox "%g. Abaelun Mine" num
elseif ( cell == 1 )
MessageBox "%g. Abaesen-Pulu Egg Mine" num
elseif ( cell == 2 )
MessageBox "%g. Abanabi" num
elseif ( cell == 3 )
MessageBox "%g. Abandoned Shipwreck, Cabin" num
elseif ( cell == 4 )
MessageBox "%g. Abandoned Shipwreck, Lower Level" num
elseif ( cell == 5 )
MessageBox "%g. Abandoned Shipwreck, Upper Level" num
elseif ( cell == 6 )
MessageBox "%g. Abebaal Egg Mine" num
elseif ( cell == 7 )
MessageBox "%g. Abernanit" num
elseif ( cell == 8 )
MessageBox "%g. Abinabi" num
elseif ( cell == 9 )
MessageBox "%g. Adanumuran" num
elseif ( cell == 10 )
MessageBox "%g. Addadshashanammu, Shrine" num
elseif ( cell == 11 )
MessageBox "%g. Addamasartus" num
elseif ( cell == 12 )
MessageBox "%g. Ahallaraddon Egg Mine" num
elseif ( cell == 13 )
MessageBox "%g. Ahanibi-Malmus Egg Mine" num
elseif ( cell == 14 )
MessageBox "%g. Aharasaplit Camp, Zallay's Yurt" num
elseif ( cell == 15 )
MessageBox "%g. Aharnabi" num
elseif ( cell == 16 )
MessageBox "%g. Aharunartus" num
elseif ( cell == 17 )
MessageBox "%g. Ahemmusa Camp, Addammus's Yurt" num
elseif ( cell == 18 )
MessageBox "%g. Ahemmusa Camp, Ashkhan's Yurt" num
elseif ( cell == 19 )
MessageBox "%g. Ahemmusa Camp, Assamma-Idan's Yurt" num
elseif ( cell == 20 )
MessageBox "%g. Ahemmusa Camp, Dutadalk's Yurt" num
elseif ( cell == 21 )
MessageBox "%g. Ahemmusa Camp, Kausi's Yurt" num
elseif ( cell == 22 )
MessageBox "%g. Ahemmusa Camp, Lanabi's Yurt" num
elseif ( cell == 23 )
MessageBox "%g. Ahemmusa Camp, Mamaea's Yurt" num
elseif ( cell == 24 )
MessageBox "%g. Ahemmusa Camp, Nummu's Yurt" num
elseif ( cell == 25 )
MessageBox "%g. Ahemmusa Camp, Wise Woman's Yurt" num
elseif ( cell == 26 )
MessageBox "%g. Ahinipalit" num
elseif ( cell == 27 )
MessageBox "%g. Aidanat Camp, Abassel's Yurt" num
elseif ( cell == 28 )
MessageBox "%g. Ainab" num
elseif ( cell == 29 )
MessageBox "%g. Ainab, Shrine" num
elseif ( cell == 30 )
MessageBox "%g. Ainat" num
elseif ( cell == 31 )
MessageBox "%g. Akimaes Grotto" num
elseif ( cell == 32 )
MessageBox "%g. Akimaes-Ilanipu Egg Mine" num
elseif ( cell == 33 )
MessageBox "%g. Akulakhan's Chamber" num
elseif ( cell == 34 )
MessageBox "%g. Alas Ancestral Tomb" num
elseif ( cell == 35 )
MessageBox "%g. Ald Daedroth, Antechamber" num
elseif ( cell == 36 )
MessageBox "%g. Ald Daedroth, Inner Shrine" num
elseif ( cell == 37 )
MessageBox "%g. Ald Daedroth, Left Wing" num
elseif ( cell == 38 )
MessageBox "%g. Ald Daedroth, Outer Shrine" num
elseif ( cell == 39 )
MessageBox "%g. Ald Daedroth, Right Wing" num
elseif ( cell == 40 )
MessageBox "%g. Ald Redaynia, Tower" num
elseif ( cell == 41 )
MessageBox "%g. Ald Sotha, Lower Level" num
elseif ( cell == 42 )
MessageBox "%g. Ald Sotha, Shrine" num
elseif ( cell == 43 )
MessageBox "%g. Ald Sotha, Upper Level" num
elseif ( cell == 44 )
MessageBox "%g. Ald Velothi, Fevila Bethrano's Shack" num
elseif ( cell == 45 )
MessageBox "%g. Ald Velothi, Ganus Lloryn's Shack" num
elseif ( cell == 46 )
MessageBox "%g. Ald Velothi, Ienas Arvel's Shack" num
elseif ( cell == 47 )
MessageBox "%g. Ald Velothi, Lledsea Relas's Shack" num
elseif ( cell == 48 )
MessageBox "%g. Ald Velothi, Llerar Vinden's Shack" num
elseif ( cell == 49 )
MessageBox "%g. Ald Velothi, Outpost" num
elseif ( cell == 50 )
MessageBox "%g. Ald Velothi, Sathas Rivul's Shack" num
elseif ( cell == 51 )
MessageBox "%g. Ald Velothi, Vireveri Darethran's Shack" num
elseif ( cell == 52 )
MessageBox "%g. Ald-ruhn, Ald Skar Inn" num
elseif ( cell == 53 )
MessageBox "%g. Ald-ruhn, Arobar Guard Quarters" num
elseif ( cell == 54 )
MessageBox "%g. Ald-ruhn, Arobar Manor Bedrooms" num
elseif ( cell == 55 )
MessageBox "%g. Ald-ruhn, Arobar Manor Entrance" num
elseif ( cell == 56 )
MessageBox "%g. Ald-ruhn, Arobar Private Quarters" num
elseif ( cell == 57 )
MessageBox "%g. Ald-ruhn, Aryni Orethi's House" num
elseif ( cell == 58 )
MessageBox "%g. Ald-ruhn, Bevene Releth: Clothier" num
elseif ( cell == 59 )
MessageBox "%g. Ald-ruhn, Bivale Teneran: Clothier" num
elseif ( cell == 60 )
MessageBox "%g. Ald-ruhn, Boldrisa Andrano's House" num
elseif ( cell == 61 )
MessageBox "%g. Ald-ruhn, Braynas Hlervu's House" num
elseif ( cell == 62 )
MessageBox "%g. Ald-ruhn, Cienne Sintieve: Alchemist" num
elseif ( cell == 63 )
MessageBox "%g. Ald-ruhn, Codus Callonus: Bookseller" num
elseif ( cell == 64 )
MessageBox "%g. Ald-ruhn, Council Club" num
elseif ( cell == 65 )
MessageBox "%g. Ald-ruhn, Council Hostel" num
elseif ( cell == 66 )
MessageBox "%g. Ald-ruhn, Dandera Selaro: Smith" num
elseif ( cell == 67 )
MessageBox "%g. Ald-ruhn, Daynes Redothril: Pawnbroker" num
elseif ( cell == 68 )
MessageBox "%g. Ald-ruhn, Dravasa Andrethi's House" num
elseif ( cell == 69 )
MessageBox "%g. Ald-ruhn, Drinar Varyon's House" num
elseif ( cell == 70 )
MessageBox "%g. Ald-ruhn, Galsa Gindu's House" num
elseif ( cell == 71 )
MessageBox "%g. Ald-ruhn, Galthragoth's House" num
elseif ( cell == 72 )
MessageBox "%g. Ald-ruhn, Gildan's House" num
elseif ( cell == 73 )
MessageBox "%g. Ald-ruhn, Gindrala Hleran's House" num
elseif ( cell == 74 )
MessageBox "%g. Ald-ruhn, Goras Andrelo's House" num
elseif ( cell == 75 )
MessageBox "%g. Ald-ruhn, Guard Tower 1" num
elseif ( cell == 76 )
MessageBox "%g. Ald-ruhn, Guard Tower 2" num
elseif ( cell == 77 )
MessageBox "%g. Ald-ruhn, Guild of Fighters" num
elseif ( cell == 78 )
MessageBox "%g. Ald-ruhn, Guild of Mages" num
elseif ( cell == 79 )
MessageBox "%g. Ald-ruhn, Guls Llervu's House" num
elseif ( cell == 80 )
MessageBox "%g. Ald-ruhn, Hanarai Assutlanipal's House" num
elseif ( cell == 81 )
MessageBox "%g. Ald-ruhn, Ienas Sarandas's House" num
elseif ( cell == 82 )
MessageBox "%g. Ald-ruhn, Ilmiril's House" num
elseif ( cell == 83 )
MessageBox "%g. Ald-ruhn, Llether Vari: Enchanter" num
elseif ( cell == 84 )
MessageBox "%g. Ald-ruhn, Llethri Guard Quarters" num
elseif ( cell == 85 )
MessageBox "%g. Ald-ruhn, Llethri Manor Bedrooms" num
elseif ( cell == 86 )
MessageBox "%g. Ald-ruhn, Llethri Manor Entrance" num
elseif ( cell == 87 )
MessageBox "%g. Ald-ruhn, Llethri Private Quarters" num
elseif ( cell == 88 )
MessageBox "%g. Ald-ruhn, Malpenix Blonia: Trader" num
elseif ( cell == 89 )
MessageBox "%g. Ald-ruhn, Manor District" num
elseif ( cell == 90 )
MessageBox "%g. Ald-ruhn, Morag Tong Guildhall" num
elseif ( cell == 91 )
MessageBox "%g. Ald-ruhn, Morvayn Quarters" num
elseif ( cell == 92 )
MessageBox "%g. Ald-ruhn, Pellecia Aurrus's House" num
elseif ( cell == 93 )
MessageBox "%g. Ald-ruhn, Practice Room" num
elseif ( cell == 94 )
MessageBox "%g. Ald-ruhn, Ramoran Manor" num
elseif ( cell == 95 )
MessageBox "%g. Ald-ruhn, Ramoran Private Quarters" num
elseif ( cell == 96 )
MessageBox "%g. Ald-ruhn, Redoran Council Entrance" num
elseif ( cell == 97 )
MessageBox "%g. Ald-ruhn, Redoran Council Hall" num
elseif ( cell == 98 )
MessageBox "%g. Ald-ruhn, Sarethi Guard Quarters" num
elseif ( cell == 99 )
MessageBox "%g. Ald-ruhn, Sarethi Manor" num
endif

StopScript "vn_Teleport_infoCell_Sub1"

End

# vn_Teleport_infoCell_Sub2 ===================================================
Begin vn_Teleport_infoCell_Sub2

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

if ( cell == 100 )
MessageBox "%g. Ald-ruhn, Tauryon's House" num
elseif ( cell == 101 )
MessageBox "%g. Ald-ruhn, Temple" num
elseif ( cell == 102 )
MessageBox "%g. Ald-ruhn, The Rat In The Pot" num
elseif ( cell == 103 )
MessageBox "%g. Ald-ruhn, Tiras Sadus: General Merchandise" num
elseif ( cell == 104 )
MessageBox "%g. Ald-ruhn, Tuveso Beleth: Smith" num
elseif ( cell == 105 )
MessageBox "%g. Ald-ruhn, Venim Manor Bedrooms" num
elseif ( cell == 106 )
MessageBox "%g. Ald-ruhn, Venim Manor Entrance" num
elseif ( cell == 107 )
MessageBox "%g. Ald-ruhn, Venim Manor Guard Quarters" num
elseif ( cell == 108 )
MessageBox "%g. Ald-ruhn, Venim Manor Private Quarters" num
elseif ( cell == 109 )
MessageBox "%g. Ald-ruhn, Venim Manor Right Wing" num
elseif ( cell == 110 )
MessageBox "%g. Aleft" num
elseif ( cell == 111 )
MessageBox "%g. Alen Ancestral Tomb" num
elseif ( cell == 112 )
MessageBox "%g. Almurbalarammi, Shrine" num
elseif ( cell == 113 )
MessageBox "%g. Alof's Farmhouse" num
elseif ( cell == 114 )
MessageBox "%g. An Abandoned Shack" num
elseif ( cell == 115 )
MessageBox "%g. Ancient Shipwreck, Cabin" num
elseif ( cell == 116 )
MessageBox "%g. Ancient Shipwreck, Lower Level" num
elseif ( cell == 117 )
MessageBox "%g. Ancient Shipwreck, Upper Level" num
elseif ( cell == 118 )
MessageBox "%g. Andalen Ancestral Tomb" num
elseif ( cell == 119 )
MessageBox "%g. Andalor Ancestral Tomb" num
elseif ( cell == 120 )
MessageBox "%g. Andas Ancestral Tomb" num
elseif ( cell == 121 )
MessageBox "%g. Andasreth, Lower Level" num
elseif ( cell == 122 )
MessageBox "%g. Andasreth, Propylon Chamber" num
elseif ( cell == 123 )
MessageBox "%g. Andasreth, Upper Level" num
elseif ( cell == 124 )
MessageBox "%g. Andavel Ancestral Tomb" num
elseif ( cell == 125 )
MessageBox "%g. Andrano Ancestral Tomb" num
elseif ( cell == 126 )
MessageBox "%g. Andrethi Ancestral Tomb" num
elseif ( cell == 127 )
MessageBox "%g. Andules Ancestral Tomb" num
elseif ( cell == 128 )
MessageBox "%g. Ansi" num
elseif ( cell == 129 )
MessageBox "%g. Aralen Ancestral Tomb" num
elseif ( cell == 130 )
MessageBox "%g. Aran Ancestral Tomb" num
elseif ( cell == 131 )
MessageBox "%g. Arano Ancestral Tomb" num
elseif ( cell == 132 )
MessageBox "%g. Arano Plantation" num
elseif ( cell == 133 )
MessageBox "%g. Arenim Ancestral Tomb" num
elseif ( cell == 134 )
MessageBox "%g. Arethan Ancestral Tomb" num
elseif ( cell == 135 )
MessageBox "%g. Arkngthand, Cells of Hollow Hand" num
elseif ( cell == 136 )
MessageBox "%g. Arkngthand, Deep Ore Passage" num
elseif ( cell == 137 )
MessageBox "%g. Arkngthand, Hall of Centrifuge" num
elseif ( cell == 138 )
MessageBox "%g. Arkngthand, Heaven's Gallery" num
elseif ( cell == 139 )
MessageBox "%g. Arkngthand, Land's Blood Gallery" num
elseif ( cell == 140 )
MessageBox "%g. Arkngthand, Weepingbell Hall" num
elseif ( cell == 141 )
MessageBox "%g. Arkngthunch-Sturdumz" num
elseif ( cell == 142 )
MessageBox "%g. Arrow, Cabin" num
elseif ( cell == 143 )
MessageBox "%g. Arrow, Lower Level" num
elseif ( cell == 144 )
MessageBox "%g. Arrow, Upper Level" num
elseif ( cell == 145 )
MessageBox "%g. Arvel Manor" num
elseif ( cell == 146 )
MessageBox "%g. Arvel Manor, Slave Shack" num
elseif ( cell == 147 )
MessageBox "%g. Arvel Manor, Slavemaster's Shack" num
elseif ( cell == 148 )
MessageBox "%g. Arvel Manor, Storage Shack" num
elseif ( cell == 149 )
MessageBox "%g. Aryon Ancestral Tomb" num
elseif ( cell == 150 )
MessageBox "%g. Arys Ancestral Tomb" num
elseif ( cell == 151 )
MessageBox "%g. Asha-Ahhe Egg Mine" num
elseif ( cell == 152 )
MessageBox "%g. Ashalmawia, Shrine" num
elseif ( cell == 153 )
MessageBox "%g. Ashalmawia, Shrine, Sunken Vaults" num
elseif ( cell == 154 )
MessageBox "%g. Ashalmimilkala, Shrine" num
elseif ( cell == 155 )
MessageBox "%g. Ashamanu Camp, Kausha's Yurt" num
elseif ( cell == 156 )
MessageBox "%g. Ashanammu" num
elseif ( cell == 157 )
MessageBox "%g. Ashimanu Egg Mine" num
elseif ( cell == 158 )
MessageBox "%g. Ashimanu Egg Mine, Queen's Lair" num
elseif ( cell == 159 )
MessageBox "%g. Ashinabi" num
elseif ( cell == 160 )
MessageBox "%g. Ashinabi, Smuggler Den" num
elseif ( cell == 161 )
MessageBox "%g. Ashir-Dan" num
elseif ( cell == 162 )
MessageBox "%g. Ashirbadon" num
elseif ( cell == 163 )
MessageBox "%g. Ashmelech" num
elseif ( cell == 164 )
MessageBox "%g. Ashunartes, Shrine" num
elseif ( cell == 165 )
MessageBox "%g. Ashurnibibi, Shrine" num
elseif ( cell == 166 )
MessageBox "%g. Assalkushalit, Shrine" num
elseif ( cell == 167 )
MessageBox "%g. Assarnatamat, Shrine" num
elseif ( cell == 168 )
MessageBox "%g. Assarnud" num
elseif ( cell == 169 )
MessageBox "%g. Assemanu" num
elseif ( cell == 170 )
MessageBox "%g. Assemanu, Shrine" num
elseif ( cell == 171 )
MessageBox "%g. Assernerairan, Shrine" num
elseif ( cell == 172 )
MessageBox "%g. Assu" num
elseif ( cell == 173 )
MessageBox "%g. Assumanu" num
elseif ( cell == 174 )
MessageBox "%g. Assurdirapal, Inner Shrine" num
elseif ( cell == 175 )
MessageBox "%g. Assurdirapal, Shrine" num
elseif ( cell == 176 )
MessageBox "%g. Assurnabitashpi" num
elseif ( cell == 177 )
MessageBox "%g. Assurnabitashpi, Shrine" num
elseif ( cell == 178 )
MessageBox "%g. Bal Fell, East Wing" num
elseif ( cell == 179 )
MessageBox "%g. Bal Fell, Inner Shrine" num
elseif ( cell == 180 )
MessageBox "%g. Bal Fell, Outer Shrine" num
elseif ( cell == 181 )
MessageBox "%g. Bal Fell, West Wing" num
elseif ( cell == 182 )
MessageBox "%g. Bal Ur, Shrine" num
elseif ( cell == 183 )
MessageBox "%g. Bal Ur, Underground" num
elseif ( cell == 184 )
MessageBox "%g. Balmora, Astius Hanotepelus' House" num
elseif ( cell == 185 )
MessageBox "%g. Balmora, Balyn Omarel's House" num
elseif ( cell == 186 )
MessageBox "%g. Balmora, Caius Cosades' House" num
elseif ( cell == 187 )
MessageBox "%g. Balmora, Clagius Clanler: Outfitter" num
elseif ( cell == 188 )
MessageBox "%g. Balmora, Council Club" num
elseif ( cell == 189 )
MessageBox "%g. Balmora, Dorisa Darvel: Bookseller" num
elseif ( cell == 190 )
MessageBox "%g. Balmora, Dralasa Nithryon: Pawnbroker" num
elseif ( cell == 191 )
MessageBox "%g. Balmora, Dralcea Arethi's House" num
elseif ( cell == 192 )
MessageBox "%g. Balmora, Dralosa Athren's House" num
elseif ( cell == 193 )
MessageBox "%g. Balmora, Drarayne Thelas' House" num
elseif ( cell == 194 )
MessageBox "%g. Balmora, Drarayne Thelas' Storage" num
elseif ( cell == 195 )
MessageBox "%g. Balmora, Dura gra-Bol's House" num
elseif ( cell == 196 )
MessageBox "%g. Balmora, Eastern Guard Tower" num
elseif ( cell == 197 )
MessageBox "%g. Balmora, Eight Plates" num
elseif ( cell == 198 )
MessageBox "%g. Balmora, Fast Eddie's House" num
elseif ( cell == 199 )
MessageBox "%g. Balmora, Guild of Fighters" num
endif

StopScript "vn_Teleport_infoCell_Sub2"

End

# vn_Teleport_infoCell_Sub3 ===================================================
Begin vn_Teleport_infoCell_Sub3

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

if ( cell == 200 )
MessageBox "%g. Balmora, Guild of Mages" num
elseif ( cell == 201 )
MessageBox "%g. Balmora, Hecerinde's House" num
elseif ( cell == 202 )
MessageBox "%g. Balmora, Hlaalo Manor" num
elseif ( cell == 203 )
MessageBox "%g. Balmora, Hlaalu Council Manor" num
elseif ( cell == 204 )
MessageBox "%g. Balmora, Itan's House" num
elseif ( cell == 205 )
MessageBox "%g. Balmora, Karlirah's House" num
elseif ( cell == 206 )
MessageBox "%g. Balmora, Lucky Lockup" num
elseif ( cell == 207 )
MessageBox "%g. Balmora, Meldor: Armorer" num
elseif ( cell == 208 )
MessageBox "%g. Balmora, Milie Hastien: Fine Clothier" num
elseif ( cell == 209 )
MessageBox "%g. Balmora, Morag Tong Guild" num
elseif ( cell == 210 )
MessageBox "%g. Balmora, Nalcarya of White Haven: Fine Alchemist" num
elseif ( cell == 211 )
MessageBox "%g. Balmora, Nerano Manor" num
elseif ( cell == 212 )
MessageBox "%g. Balmora, Nine Toes' House" num
elseif ( cell == 213 )
MessageBox "%g. Balmora, Ra'Virr: Trader" num
elseif ( cell == 214 )
MessageBox "%g. Balmora, Rarayn Radarys' House" num
elseif ( cell == 215 )
MessageBox "%g. Balmora, Rithleen's House" num
elseif ( cell == 216 )
MessageBox "%g. Balmora, South Wall Cornerclub" num
elseif ( cell == 217 )
MessageBox "%g. Balmora, Temple" num
elseif ( cell == 218 )
MessageBox "%g. Balmora, The Razor Hole" num
elseif ( cell == 219 )
MessageBox "%g. Balmora, Tsiya's House" num
elseif ( cell == 220 )
MessageBox "%g. Balmora, Tyermaillin's House" num
elseif ( cell == 221 )
MessageBox "%g. Balmora, Tyravel Manor" num
elseif ( cell == 222 )
MessageBox "%g. Balmora, Vorar Helas' House" num
elseif ( cell == 223 )
MessageBox "%g. Balmora, Vori's House" num
elseif ( cell == 224 )
MessageBox "%g. Balmora, Western Guard Tower North" num
elseif ( cell == 225 )
MessageBox "%g. Balmora, Western Guard Tower South" num
elseif ( cell == 226 )
MessageBox "%g. Balur's Farmhouse" num
elseif ( cell == 227 )
MessageBox "%g. Bamz-Amschend, Hall of Wails" num
elseif ( cell == 228 )
MessageBox "%g. Bamz-Amschend, Hall of Winds" num
elseif ( cell == 229 )
MessageBox "%g. Bamz-Amschend, Hearthfire Hall" num
elseif ( cell == 230 )
MessageBox "%g. Bamz-Amschend, King's Walk" num
elseif ( cell == 231 )
MessageBox "%g. Bamz-Amschend, Passage of the Walker" num
elseif ( cell == 232 )
MessageBox "%g. Bamz-Amschend, Passage of Whispers" num
elseif ( cell == 233 )
MessageBox "%g. Bamz-Amschend, Radac's Forge" num
elseif ( cell == 234 )
MessageBox "%g. Bamz-Amschend, Skybreak Gallery" num
elseif ( cell == 235 )
MessageBox "%g. Band Egg Mine" num
elseif ( cell == 236 )
MessageBox "%g. Baram Ancestral Tomb" num
elseif ( cell == 237 )
MessageBox "%g. Bensamsi" num
elseif ( cell == 238 )
MessageBox "%g. Bensiberib Camp, Odaishah's Yurt" num
elseif ( cell == 239 )
MessageBox "%g. Beran Ancestral Tomb" num
elseif ( cell == 240 )
MessageBox "%g. Berandas, Keep, Bottom Level" num
elseif ( cell == 241 )
MessageBox "%g. Berandas, Keep, Top Level" num
elseif ( cell == 242 )
MessageBox "%g. Berandas, Propylon Chamber" num
elseif ( cell == 243 )
MessageBox "%g. Berandas, Underground" num
elseif ( cell == 244 )
MessageBox "%g. Beshara" num
elseif ( cell == 245 )
MessageBox "%g. Big Head's Shack" num
elseif ( cell == 246 )
MessageBox "%g. Bthanchend" num
elseif ( cell == 247 )
MessageBox "%g. Bthuand" num
elseif ( cell == 248 )
MessageBox "%g. Bthungthumz" num
elseif ( cell == 249 )
MessageBox "%g. Buckmoth Legion Fort, Interior" num
elseif ( cell == 250 )
MessageBox "%g. Buckmoth Legion Fort, Prison" num
elseif ( cell == 251 )
MessageBox "%g. Buckmoth Legion Fort, Towers" num
elseif ( cell == 252 )
MessageBox "%g. Caldera Mine" num
elseif ( cell == 253 )
MessageBox "%g. Caldera, Bashuk gra-Bat's House" num
elseif ( cell == 254 )
MessageBox "%g. Caldera, Canodia Felannus' House" num
elseif ( cell == 255 )
MessageBox "%g. Caldera, Dro'Shavir's House" num
elseif ( cell == 256 )
MessageBox "%g. Caldera, Elmussa Damori's House" num
elseif ( cell == 257 )
MessageBox "%g. Caldera, Falanaamo: Clothier" num
elseif ( cell == 258 )
MessageBox "%g. Caldera, Ghorak Manor" num
elseif ( cell == 259 )
MessageBox "%g. Caldera, Governor's Hall" num
elseif ( cell == 260 )
MessageBox "%g. Caldera, Guild of Mages" num
elseif ( cell == 261 )
MessageBox "%g. Caldera, Hodlismod: Armorer" num
elseif ( cell == 262 )
MessageBox "%g. Caldera, Irgola: Pawnbroker" num
elseif ( cell == 263 )
MessageBox "%g. Caldera, Keel-Raniur's House" num
elseif ( cell == 264 )
MessageBox "%g. Caldera, Mining Bunkhouse" num
elseif ( cell == 265 )
MessageBox "%g. Caldera, Mining Company Office" num
elseif ( cell == 266 )
MessageBox "%g. Caldera, Mining Guard Tower" num
elseif ( cell == 267 )
MessageBox "%g. Caldera, Nedhelas' House" num
elseif ( cell == 268 )
MessageBox "%g. Caldera, North Guard Towers" num
elseif ( cell == 269 )
MessageBox "%g. Caldera, Odairan Ashummi-Ammus' House" num
elseif ( cell == 270 )
MessageBox "%g. Caldera, Shenk's Shovel" num
elseif ( cell == 271 )
MessageBox "%g. Caldera, Slave Shack One" num
elseif ( cell == 272 )
MessageBox "%g. Caldera, Slave Shack Two" num
elseif ( cell == 273 )
MessageBox "%g. Caldera, South Guard Towers" num
elseif ( cell == 274 )
MessageBox "%g. Caldera, Surane Leoriane's House" num
elseif ( cell == 275 )
MessageBox "%g. Caldera, Valvius Mevureius' House" num
elseif ( cell == 276 )
MessageBox "%g. Caldera, Verick Gemain: Trader" num
elseif ( cell == 277 )
MessageBox "%g. Cavern of the Incarnate" num
elseif ( cell == 278 )
MessageBox "%g. Character Stuff Wonderland" num
elseif ( cell == 279 )
MessageBox "%g. Chun-Ook, Cabin" num
elseif ( cell == 280 )
MessageBox "%g. Chun-Ook, Lower Level" num
elseif ( cell == 281 )
MessageBox "%g. Chun-Ook, Upper Level" num
elseif ( cell == 282 )
MessageBox "%g. Clutter Warehouse - Everything Must Go!" num
elseif ( cell == 283 )
MessageBox "%g. Corprusarium" num
elseif ( cell == 284 )
MessageBox "%g. Corprusarium Bowels" num
elseif ( cell == 285 )
MessageBox "%g. Dagon Fel, Andre Maul's Tower" num
elseif ( cell == 286 )
MessageBox "%g. Dagon Fel, Anja Swift-Sailer's House" num
elseif ( cell == 287 )
MessageBox "%g. Dagon Fel, End of the World Renter Rooms" num
elseif ( cell == 288 )
MessageBox "%g. Dagon Fel, Fanar Fork-Beard's House" num
elseif ( cell == 289 )
MessageBox "%g. Dagon Fel, Fjorrod's House" num
elseif ( cell == 290 )
MessageBox "%g. Dagon Fel, Greidil Half-Troll's House" num
elseif ( cell == 291 )
MessageBox "%g. Dagon Fel, Heifnir: Trader" num
elseif ( cell == 292 )
MessageBox "%g. Dagon Fel, Hurg's House" num
elseif ( cell == 293 )
MessageBox "%g. Dagon Fel, Itar the Gentle's House" num
elseif ( cell == 294 )
MessageBox "%g. Dagon Fel, Mette's House" num
elseif ( cell == 295 )
MessageBox "%g. Dagon Fel, Onmi Hard-mouth's House" num
elseif ( cell == 296 )
MessageBox "%g. Dagon Fel, Sorkvild's Tower" num
elseif ( cell == 297 )
MessageBox "%g. Dagon Fel, The End of the World" num
elseif ( cell == 298 )
MessageBox "%g. Dagon Fel, Vacant Tower" num
elseif ( cell == 299 )
MessageBox "%g. Dagon Fel, Watch Tower" num
endif

StopScript "vn_Teleport_infoCell_Sub3"

End

# vn_Teleport_infoCell_Sub4 ===================================================
Begin vn_Teleport_infoCell_Sub4

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

if ( cell == 300 )
MessageBox "%g. Dagoth Ur, Facility Cavern" num
elseif ( cell == 301 )
MessageBox "%g. Dagoth Ur, Inner Facility" num
elseif ( cell == 302 )
MessageBox "%g. Dagoth Ur, Inner Tower" num
elseif ( cell == 303 )
MessageBox "%g. Dagoth Ur, Lower Facility" num
elseif ( cell == 304 )
MessageBox "%g. Dagoth Ur, Outer Facility" num
elseif ( cell == 305 )
MessageBox "%g. Dareleth Ancestral Tomb" num
elseif ( cell == 306 )
MessageBox "%g. Derelict Shipwreck, Cabin" num
elseif ( cell == 307 )
MessageBox "%g. Derelict Shipwreck, Lower Level" num
elseif ( cell == 308 )
MessageBox "%g. Derelict Shipwreck, Upper Level" num
elseif ( cell == 309 )
MessageBox "%g. Deserted Shipwreck, Cabin" num
elseif ( cell == 310 )
MessageBox "%g. Deserted Shipwreck, Lower Level" num
elseif ( cell == 311 )
MessageBox "%g. Deserted Shipwreck, Upper Level" num
elseif ( cell == 312 )
MessageBox "%g. Desolate Shipwreck, Cabin" num
elseif ( cell == 313 )
MessageBox "%g. Desolate Shipwreck, Lower Level" num
elseif ( cell == 314 )
MessageBox "%g. Desolate Shipwreck, Upper Level" num
elseif ( cell == 315 )
MessageBox "%g. Dirara's Farmhouse" num
elseif ( cell == 316 )
MessageBox "%g. Dissapla Mine" num
elseif ( cell == 317 )
MessageBox "%g. Dralas Ancestral Tomb" num
elseif ( cell == 318 )
MessageBox "%g. Drath Ancestral Tomb" num
elseif ( cell == 319 )
MessageBox "%g. Dreloth Ancestral Tomb" num
elseif ( cell == 320 )
MessageBox "%g. Dren Plantation, Doves' Shack" num
elseif ( cell == 321 )
MessageBox "%g. Dren Plantation, Dren's Villa" num
elseif ( cell == 322 )
MessageBox "%g. Dren Plantation, Guardhouse" num
elseif ( cell == 323 )
MessageBox "%g. Dren Plantation, Helvi's Shack" num
elseif ( cell == 324 )
MessageBox "%g. Dren Plantation, Hlevala's Shack" num
elseif ( cell == 325 )
MessageBox "%g. Dren Plantation, Rethan's Shack" num
elseif ( cell == 326 )
MessageBox "%g. Dren Plantation, Shipping House" num
elseif ( cell == 327 )
MessageBox "%g. Dren Plantation, Storage Shack" num
elseif ( cell == 328 )
MessageBox "%g. Dren Plantation, Tower Shack" num
elseif ( cell == 329 )
MessageBox "%g. Dren Plantation, Verethi and Dralor" num
elseif ( cell == 330 )
MessageBox "%g. Drethan Ancestral Tomb" num
elseif ( cell == 331 )
MessageBox "%g. Drinith Ancestral Tomb" num
elseif ( cell == 332 )
MessageBox "%g. Drulene Falen's Hut" num
elseif ( cell == 333 )
MessageBox "%g. Druscashti, Lower Level" num
elseif ( cell == 334 )
MessageBox "%g. Druscashti, Upper Level" num
elseif ( cell == 335 )
MessageBox "%g. Dubdilla" num
elseif ( cell == 336 )
MessageBox "%g. Dubdilla, Uncharted Caverns" num
elseif ( cell == 337 )
MessageBox "%g. Dubdilla, Uncharted Caverns, Lower" num
elseif ( cell == 338 )
MessageBox "%g. Dulo Ancestral Tomb" num
elseif ( cell == 339 )
MessageBox "%g. Dun-Ahhe" num
elseif ( cell == 340 )
MessageBox "%g. Dunirai Caverns" num
elseif ( cell == 341 )
MessageBox "%g. Dushariran, Shrine" num
elseif ( cell == 342 )
MessageBox "%g. Ebernanit, Shrine" num
elseif ( cell == 343 )
MessageBox "%g. Ebonheart, Argonian Mission" num
elseif ( cell == 344 )
MessageBox "%g. Ebonheart, East Empire Company Hall" num
elseif ( cell == 345 )
MessageBox "%g. Ebonheart, East Empire North Warehouse" num
elseif ( cell == 346 )
MessageBox "%g. Ebonheart, East Empire South Warehouse" num
elseif ( cell == 347 )
MessageBox "%g. Ebonheart, Grand Council Chambers" num
elseif ( cell == 348 )
MessageBox "%g. Ebonheart, Grand Council Chambers Tower" num
elseif ( cell == 349 )
MessageBox "%g. Ebonheart, Hawkmoth Legion Garrison" num
elseif ( cell == 350 )
MessageBox "%g. Ebonheart, Hawkmoth Towers" num
elseif ( cell == 351 )
MessageBox "%g. Ebonheart, Imperial Chapels" num
elseif ( cell == 352 )
MessageBox "%g. Ebonheart, Imperial Commission" num
elseif ( cell == 353 )
MessageBox "%g. Ebonheart, Imperial Guard Garrison" num
elseif ( cell == 354 )
MessageBox "%g. Ebonheart, Six Fishes" num
elseif ( cell == 355 )
MessageBox "%g. Ebonheart, Skyrim Mission" num
elseif ( cell == 356 )
MessageBox "%g. Ebonheart, Underground Caves" num
elseif ( cell == 357 )
MessageBox "%g. Elanius Camp, Yapal's Yurt" num
elseif ( cell == 358 )
MessageBox "%g. Elf-Skerring, Cabin" num
elseif ( cell == 359 )
MessageBox "%g. Elf-Skerring, Lower Level" num
elseif ( cell == 360 )
MessageBox "%g. Elf-Skerring, Upper Level" num
elseif ( cell == 361 )
MessageBox "%g. Elith-Pal Mine" num
elseif ( cell == 362 )
MessageBox "%g. Eluba-Addon Egg Mine" num
elseif ( cell == 363 )
MessageBox "%g. Eluba-Addon Grotto" num
elseif ( cell == 364 )
MessageBox "%g. Endusal, Kagrenac's study" num
elseif ( cell == 365 )
MessageBox "%g. Erabenimsun Camp, Addut-Lamanu's Yurt" num
elseif ( cell == 366 )
MessageBox "%g. Erabenimsun Camp, Ainab's Yurt" num
elseif ( cell == 367 )
MessageBox "%g. Erabenimsun Camp, Ashkhan's Yurt" num
elseif ( cell == 368 )
MessageBox "%g. Erabenimsun Camp, Ashu-Ahhe's Yurt" num
elseif ( cell == 369 )
MessageBox "%g. Erabenimsun Camp, Assemmus' Yurt" num
elseif ( cell == 370 )
MessageBox "%g. Erabenimsun Camp, Han-Ammu's Yurt" num
elseif ( cell == 371 )
MessageBox "%g. Erabenimsun Camp, Massarapal's Yurt" num
elseif ( cell == 372 )
MessageBox "%g. Erabenimsun Camp, Ranabi's Yurt" num
elseif ( cell == 373 )
MessageBox "%g. Erabenimsun Camp, Salattanat's Yurt" num
elseif ( cell == 374 )
MessageBox "%g. Erabenimsun Camp, Wise Woman's Yurt" num
elseif ( cell == 375 )
MessageBox "%g. Eretammus-Sennammu Egg Mine" num
elseif ( cell == 376 )
MessageBox "%g. Esutanamus, Shrine" num
elseif ( cell == 377 )
MessageBox "%g. Fadathram Ancestral Tomb" num
elseif ( cell == 378 )
MessageBox "%g. Fair Helas, Cabin" num
elseif ( cell == 379 )
MessageBox "%g. Fair Helas, Lower Level" num
elseif ( cell == 380 )
MessageBox "%g. Fair Helas, Upper Level" num
elseif ( cell == 381 )
MessageBox "%g. Falas Ancestral Tomb" num
elseif ( cell == 382 )
MessageBox "%g. Falasmaryon, Lower Level" num
elseif ( cell == 383 )
MessageBox "%g. Falasmaryon, Missun Akin's Hut" num
elseif ( cell == 384 )
MessageBox "%g. Falasmaryon, Propylon Chamber" num
elseif ( cell == 385 )
MessageBox "%g. Falasmaryon, Sewers" num
elseif ( cell == 386 )
MessageBox "%g. Falasmaryon, Upper Level" num
elseif ( cell == 387 )
MessageBox "%g. Falensarano, Lower Level" num
elseif ( cell == 388 )
MessageBox "%g. Falensarano, Propylon Chamber" num
elseif ( cell == 389 )
MessageBox "%g. Falensarano, Upper Level" num
elseif ( cell == 390 )
MessageBox "%g. Falvillo's Endeavor, Cabin" num
elseif ( cell == 391 )
MessageBox "%g. Falvillo's Endeavor, Lower Level" num
elseif ( cell == 392 )
MessageBox "%g. Falvilo's Endeavor, Upper Level" num
elseif ( cell == 393 )
MessageBox "%g. Favel Ancestral Tomb" num
elseif ( cell == 394 )
MessageBox "%g. Forgotten Shipwreck" num
elseif ( cell == 395 )
MessageBox "%g. Forgotten Vaults of Anudnabia, Forge of Hilbongard" num
elseif ( cell == 396 )
MessageBox "%g. Galom Daeus, Entry" num
elseif ( cell == 397 )
MessageBox "%g. Galom Daeus, Observatory" num
elseif ( cell == 398 )
MessageBox "%g. Ghostgate, Temple" num
elseif ( cell == 399 )
MessageBox "%g. Ghostgate, Tower of Dawn" num
endif

StopScript "vn_Teleport_infoCell_Sub4"

End

# vn_Teleport_infoCell_Sub5 ===================================================
Begin vn_Teleport_infoCell_Sub5

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

if ( cell == 400 )
MessageBox "%g. Ghostgate, Tower of Dawn Lower Level" num
elseif ( cell == 401 )
MessageBox "%g. Ghostgate, Tower of Dusk" num
elseif ( cell == 402 )
MessageBox "%g. Ghostgate, Tower of Dusk Lower Level" num
elseif ( cell == 403 )
MessageBox "%g. Gimothran Ancestral Tomb" num
elseif ( cell == 404 )
MessageBox "%g. Ginith Ancestral Tomb" num
elseif ( cell == 405 )
MessageBox "%g. Gnaar Mok, Anglalos's Shack" num
elseif ( cell == 406 )
MessageBox "%g. Gnaar Mok, Arenim Manor" num
elseif ( cell == 407 )
MessageBox "%g. Gnaar Mok, Caryarel's Shack" num
elseif ( cell == 408 )
MessageBox "%g. Gnaar Mok, Druegh-jigger's Rest" num
elseif ( cell == 409 )
MessageBox "%g. Gnaar Mok, Jerian Dolbanitte's Shack" num
elseif ( cell == 410 )
MessageBox "%g. Gnaar Mok, Mush-Mere's Shack" num
elseif ( cell == 411 )
MessageBox "%g. Gnaar Mok, Nadene Rotheran's Shack" num
elseif ( cell == 412 )
MessageBox "%g. Gnaar Mok, Rostlogi's Shack" num
elseif ( cell == 413 )
MessageBox "%g. Gnisis, Abelmawia Hut" num
elseif ( cell == 414 )
MessageBox "%g. Gnisis, Almu Cave Dwelling" num
elseif ( cell == 415 )
MessageBox "%g. Gnisis, Arvs-Drelen" num
elseif ( cell == 416 )
MessageBox "%g. Gnisis, Barracks" num
elseif ( cell == 417 )
MessageBox "%g. Gnisis, Bethamez" num
elseif ( cell == 418 )
MessageBox "%g. Gnisis, Dinadad Hut" num
elseif ( cell == 419 )
MessageBox "%g. Gnisis, Eggmine" num
elseif ( cell == 420 )
MessageBox "%g. Gnisis, Fort Darius" num
elseif ( cell == 421 )
MessageBox "%g. Gnisis, Lasamsi Cave Dwelling" num
elseif ( cell == 422 )
MessageBox "%g. Gnisis, Lower Eggmine" num
elseif ( cell == 423 )
MessageBox "%g. Gnisis, Madach Tradehouse" num
elseif ( cell == 424 )
MessageBox "%g. Gnisis, Man-llu Hut" num
elseif ( cell == 425 )
MessageBox "%g. Gnisis, Mantiti Cave Dwelling" num
elseif ( cell == 426 )
MessageBox "%g. Gnisis, Shand Hut" num
elseif ( cell == 427 )
MessageBox "%g. Gnisis, Shishara Hut" num
elseif ( cell == 428 )
MessageBox "%g. Gnisis, Tansumiran Cave Dwelling" num
elseif ( cell == 429 )
MessageBox "%g. Gnisis, Temple" num
elseif ( cell == 430 )
MessageBox "%g. Gnisis, Underground Stream" num
elseif ( cell == 431 )
MessageBox "%g. Gnisis, Vabdas Hut" num
elseif ( cell == 432 )
MessageBox "%g. Gnisis, Yahaz Hut" num
elseif ( cell == 433 )
MessageBox "%g. Gro-Bagrat Plantation" num
elseif ( cell == 434 )
MessageBox "%g. Grytewake, Cabin" num
elseif ( cell == 435 )
MessageBox "%g. Grytewake, Lower Level" num
elseif ( cell == 436 )
MessageBox "%g. Grytewake, Upper Level" num
elseif ( cell == 437 )
MessageBox "%g. Habinbaes" num
elseif ( cell == 438 )
MessageBox "%g. Hairat-Vassamsi Egg Mine" num
elseif ( cell == 439 )
MessageBox "%g. Hairat-Vassamsi Egg Mine, Queen's Lair" num
elseif ( cell == 440 )
MessageBox "%g. Halit Mine" num
elseif ( cell == 441 )
MessageBox "%g. Hanud" num
elseif ( cell == 442 )
MessageBox "%g. Hanud, Tower" num
elseif ( cell == 443 )
MessageBox "%g. Hassour" num
elseif ( cell == 444 )
MessageBox "%g. Hassour, Shrine" num
elseif ( cell == 445 )
MessageBox "%g. Hawia Egg Mine" num
elseif ( cell == 446 )
MessageBox "%g. Helan Ancestral Tomb" num
elseif ( cell == 447 )
MessageBox "%g. Helas Ancestral Tomb" num
elseif ( cell == 448 )
MessageBox "%g. Heleran Ancestral Tomb" num
elseif ( cell == 449 )
MessageBox "%g. Heran Ancestral Tomb" num
elseif ( cell == 450 )
MessageBox "%g. Hinnabi" num
elseif ( cell == 451 )
MessageBox "%g. Hla Oad, Fadila Balvel's House" num
elseif ( cell == 452 )
MessageBox "%g. Hla Oad, Fatleg's Drop Off" num
elseif ( cell == 453 )
MessageBox "%g. Hla Oad, Murudius Flaeus's House" num
elseif ( cell == 454 )
MessageBox "%g. Hla Oad, Okur's House" num
elseif ( cell == 455 )
MessageBox "%g. Hla Oad, Relien Rirne's House" num
elseif ( cell == 456 )
MessageBox "%g. Hla Oad, Shurkul gro-Sharga's House" num
elseif ( cell == 457 )
MessageBox "%g. Hlaalu Ancestral Tomb" num
elseif ( cell == 458 )
MessageBox "%g. Hleran Ancestral Tomb" num
elseif ( cell == 459 )
MessageBox "%g. Hlervi Ancestral Tomb" num
elseif ( cell == 460 )
MessageBox "%g. Hlervu Ancestral Tomb" num
elseif ( cell == 461 )
MessageBox "%g. Hlormaren, Dome" num
elseif ( cell == 462 )
MessageBox "%g. Hlormaren, Keep, Bottom Level" num
elseif ( cell == 463 )
MessageBox "%g. Hlormaren, Keep, Top Level" num
elseif ( cell == 464 )
MessageBox "%g. Hlormaren, Propylon Chamber" num
elseif ( cell == 465 )
MessageBox "%g. Hlormaren, Sewers" num
elseif ( cell == 466 )
MessageBox "%g. Hlormaren, Underground" num
elseif ( cell == 467 )
MessageBox "%g. Holamayan Monastery" num
elseif ( cell == 468 )
MessageBox "%g. Ibar-Dad" num
elseif ( cell == 469 )
MessageBox "%g. Ibishammus, Shrine" num
elseif ( cell == 470 )
MessageBox "%g. Ienith Ancestral Tomb" num
elseif ( cell == 471 )
MessageBox "%g. Ihinipalit, Shrine" num
elseif ( cell == 472 )
MessageBox "%g. Ilanipu Grotto" num
elseif ( cell == 473 )
MessageBox "%g. Ilunibi, Blackened Heart" num
elseif ( cell == 474 )
MessageBox "%g. Ilunibi, Carcass of the Saint" num
elseif ( cell == 475 )
MessageBox "%g. Ilunibi, Marowak's Spine" num
elseif ( cell == 476 )
MessageBox "%g. Ilunibi, Soul's Rattle" num
elseif ( cell == 477 )
MessageBox "%g. Ilunibi, Tainted Marrow" num
elseif ( cell == 478 )
MessageBox "%g. Imperial Prison Ship" num
elseif ( cell == 479 )
MessageBox "%g. Inanius Egg Mine" num
elseif ( cell == 480 )
MessageBox "%g. Indalen Ancestral Tomb" num
elseif ( cell == 481 )
MessageBox "%g. Indaren Ancestral Tomb" num
elseif ( cell == 482 )
MessageBox "%g. Indarys Manor" num
elseif ( cell == 483 )
MessageBox "%g. Indarys Manor, Berendas' House" num
elseif ( cell == 484 )
MessageBox "%g. Indarys Manor, Manor Services" num
elseif ( cell == 485 )
MessageBox "%g. Indarys Manor, Raram's House" num
elseif ( cell == 486 )
MessageBox "%g. Indoranyon" num
elseif ( cell == 487 )
MessageBox "%g. Indoranyon, Propylon Chamber" num
elseif ( cell == 488 )
MessageBox "%g. Kaushtababi Camp, Adibael's Yurt" num
elseif ( cell == 489 )
MessageBox "%g. Kaushtarari, Shrine" num
elseif ( cell == 490 )
MessageBox "%g. ken's test hole" num
elseif ( cell == 491 )
MessageBox "%g. Khuul, Aldi's Shack" num
elseif ( cell == 492 )
MessageBox "%g. Khuul, Brurid's Shack" num
elseif ( cell == 493 )
MessageBox "%g. Khuul, Endris Dilmyn's Shack" num
elseif ( cell == 494 )
MessageBox "%g. Khuul, Helga's Shack" num
elseif ( cell == 495 )
MessageBox "%g. Khuul, Miron Garer's Shack" num
elseif ( cell == 496 )
MessageBox "%g. Khuul, Nelmyne Andules's Shack" num
elseif ( cell == 497 )
MessageBox "%g. Khuul, Rivame Samandas's Shack" num
elseif ( cell == 498 )
MessageBox "%g. Khuul, Svadstar's Shack" num
elseif ( cell == 499 )
MessageBox "%g. Khuul, Thongar's Tradehouse" num
endif

StopScript "vn_Teleport_infoCell_Sub5"

End

# vn_Teleport_infoCell_Sub6 ===================================================
Begin vn_Teleport_infoCell_Sub6

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

if ( cell == 500 )
MessageBox "%g. Koal Cave" num
elseif ( cell == 501 )
MessageBox "%g. Kogoruhn, Bleeding Heart" num
elseif ( cell == 502 )
MessageBox "%g. Kogoruhn, Charma's Breath" num
elseif ( cell == 503 )
MessageBox "%g. Kogoruhn, Dome of Pollock's Eve" num
elseif ( cell == 504 )
MessageBox "%g. Kogoruhn, Dome of Urso" num
elseif ( cell == 505 )
MessageBox "%g. Kogoruhn, Hall of Maki" num
elseif ( cell == 506 )
MessageBox "%g. Kogoruhn, Hall of Phisto" num
elseif ( cell == 507 )
MessageBox "%g. Kogoruhn, Hall of the Watchful Touch" num
elseif ( cell == 508 )
MessageBox "%g. Kogoruhn, Nabith Waterway" num
elseif ( cell == 509 )
MessageBox "%g. Kogoruhn, Temple of Fey" num
elseif ( cell == 510 )
MessageBox "%g. Kogoruhn, Vault of Aerode" num
elseif ( cell == 511 )
MessageBox "%g. Kora-Dur" num
elseif ( cell == 512 )
MessageBox "%g. Kudanat" num
elseif ( cell == 513 )
MessageBox "%g. Kumarahaz" num
elseif ( cell == 514 )
MessageBox "%g. Kunirai" num
elseif ( cell == 515 )
MessageBox "%g. Kushtashpi, Shrine" num
elseif ( cell == 516 )
MessageBox "%g. Llando Ancestral Tomb" num
elseif ( cell == 517 )
MessageBox "%g. Lleran Ancestral Tomb" num
elseif ( cell == 518 )
MessageBox "%g. Llervu Ancestral Tomb" num
elseif ( cell == 519 )
MessageBox "%g. Llirala's Shack" num
elseif ( cell == 520 )
MessageBox "%g. Llovyn's Farmhouse" num
elseif ( cell == 521 )
MessageBox "%g. Lonely Shipwreck, Cabin" num
elseif ( cell == 522 )
MessageBox "%g. Lonely Shipwreck, Lower Level" num
elseif ( cell == 523 )
MessageBox "%g. Lonely Shipwreck, Upper Level" num
elseif ( cell == 524 )
MessageBox "%g. Lonesome Shipwreck, Cabin" num
elseif ( cell == 525 )
MessageBox "%g. Lonesome Shipwreck, Lower Level" num
elseif ( cell == 526 )
MessageBox "%g. Lonesome Shipwreck, Upper Level" num
elseif ( cell == 527 )
MessageBox "%g. Lost Shipwreck, Cabin" num
elseif ( cell == 528 )
MessageBox "%g. Lost Shipwreck, Lower Level" num
elseif ( cell == 529 )
MessageBox "%g. Lost Shipwreck, Upper Level" num
elseif ( cell == 530 )
MessageBox "%g. Maar Gan, Andus Tradehouse" num
elseif ( cell == 531 )
MessageBox "%g. Maar Gan, Assi Serimilk's Hut" num
elseif ( cell == 532 )
MessageBox "%g. Maar Gan, Assirari Zama-Rasour's Hut" num
elseif ( cell == 533 )
MessageBox "%g. Maar Gan, Garry's Hut" num
elseif ( cell == 534 )
MessageBox "%g. Maar Gan, Guard Tower 1" num
elseif ( cell == 535 )
MessageBox "%g. Maar Gan, Guard Tower 2" num
elseif ( cell == 536 )
MessageBox "%g. Maar Gan, Guard Tower 3" num
elseif ( cell == 537 )
MessageBox "%g. Maar Gan, Huleen's Hut" num
elseif ( cell == 538 )
MessageBox "%g. Maar Gan, Kind Erushara's Hut" num
elseif ( cell == 539 )
MessageBox "%g. Maar Gan, Mabrelle Geles's Hut" num
elseif ( cell == 540 )
MessageBox "%g. Maar Gan, Outpost" num
elseif ( cell == 541 )
MessageBox "%g. Maar Gan, Shilipuran Zama-Rasour's Hut" num
elseif ( cell == 542 )
MessageBox "%g. Maar Gan, Shrine" num
elseif ( cell == 543 )
MessageBox "%g. Maar Gan, Tashpi Ashibael's Hut" num
elseif ( cell == 544 )
MessageBox "%g. Maar Gan, Ulisamsi Shaddarnuran's Hut" num
elseif ( cell == 545 )
MessageBox "%g. Maar Gan, Yeherradad's Hut" num
elseif ( cell == 546 )
MessageBox "%g. Maba-Ilu" num
elseif ( cell == 547 )
MessageBox "%g. Mababi" num
elseif ( cell == 548 )
MessageBox "%g. Madas Grotto" num
elseif ( cell == 549 )
MessageBox "%g. Madas-Zebba Egg Mine" num
elseif ( cell == 550 )
MessageBox "%g. Maelkashishi, Shrine" num
elseif ( cell == 551 )
MessageBox "%g. Maelkashishi, Shrine, Forgotten Galleries" num
elseif ( cell == 552 )
MessageBox "%g. Maelu Egg Mine" num
elseif ( cell == 553 )
MessageBox "%g. Maesa-Shammus Egg Mine" num
elseif ( cell == 554 )
MessageBox "%g. Magas Volar" num
elseif ( cell == 555 )
MessageBox "%g. Mallapi" num
elseif ( cell == 556 )
MessageBox "%g. Malmus Grotto" num
elseif ( cell == 557 )
MessageBox "%g. Mamaea, Sanctum of Awakening" num
elseif ( cell == 558 )
MessageBox "%g. Mamaea, Sanctum of Black Hope" num
elseif ( cell == 559 )
MessageBox "%g. Mamaea, Shrine of Pitted Dreams" num
elseif ( cell == 560 )
MessageBox "%g. Mamshar-Disamus Camp, Maesat's Yurt" num
elseif ( cell == 561 )
MessageBox "%g. Manat's Farmhouse" num
elseif ( cell == 562 )
MessageBox "%g. Mannammu" num
elseif ( cell == 563 )
MessageBox "%g. Maran-Adon" num
elseif ( cell == 564 )
MessageBox "%g. Marandus, Dome" num
elseif ( cell == 565 )
MessageBox "%g. Marandus, Lower Level" num
elseif ( cell == 566 )
MessageBox "%g. Marandus, Propylon Chamber" num
elseif ( cell == 567 )
MessageBox "%g. Marandus, Upper Level" num
elseif ( cell == 568 )
MessageBox "%g. Maren Ancestral Tomb" num
elseif ( cell == 569 )
MessageBox "%g. Mark's Vampire Test Cell" num
elseif ( cell == 570 )
MessageBox "%g. Marvani Ancestral Tomb" num
elseif ( cell == 571 )
MessageBox "%g. Massahanud Camp, Sargon's Yurt" num
elseif ( cell == 572 )
MessageBox "%g. Massama Cave" num
elseif ( cell == 573 )
MessageBox "%g. Masseranit" num
elseif ( cell == 574 )
MessageBox "%g. Mat" num
elseif ( cell == 575 )
MessageBox "%g. Matus-Akin Egg Mine" num
elseif ( cell == 576 )
MessageBox "%g. Matus-Akin Egg Mine, Queen's Lair" num
elseif ( cell == 577 )
MessageBox "%g. Mausur Caverns" num
elseif ( cell == 578 )
MessageBox "%g. Mawia" num
elseif ( cell == 579 )
MessageBox "%g. Mila-Nipal, Manat's Yurt" num
elseif ( cell == 580 )
MessageBox "%g. Milk" num
elseif ( cell == 581 )
MessageBox "%g. Minabi" num
elseif ( cell == 582 )
MessageBox "%g. Minabi, Bandit Lair" num
elseif ( cell == 583 )
MessageBox "%g. Ministry of Truth, Hall of Processing" num
elseif ( cell == 584 )
MessageBox "%g. Ministry of Truth, Holding Cells" num
elseif ( cell == 585 )
MessageBox "%g. Ministry of Truth, Prison Keep" num
elseif ( cell == 586 )
MessageBox "%g. Missamsi" num
elseif ( cell == 587 )
MessageBox "%g. Missir-Dadalit Egg Mine" num
elseif ( cell == 588 )
MessageBox "%g. Molag Mar, Armigers Stronghold" num
elseif ( cell == 589 )
MessageBox "%g. Molag Mar, Canalworks" num
elseif ( cell == 590 )
MessageBox "%g. Molag Mar, Redoran Stronghold" num
elseif ( cell == 591 )
MessageBox "%g. Molag Mar, Saetring the Nord: Smith" num
elseif ( cell == 592 )
MessageBox "%g. Molag Mar, St. Veloth's Hostel" num
elseif ( cell == 593 )
MessageBox "%g. Molag Mar, Temple" num
elseif ( cell == 594 )
MessageBox "%g. Molag Mar, The Pilgrim's Rest" num
elseif ( cell == 595 )
MessageBox "%g. Molag Mar, Underworks" num
elseif ( cell == 596 )
MessageBox "%g. Molag Mar, Vasesius Viciulus: Trader" num
elseif ( cell == 597 )
MessageBox "%g. Molag Mar, Waistworks" num
elseif ( cell == 598 )
MessageBox "%g. Moonmoth Legion Fort, Interior" num
elseif ( cell == 599 )
MessageBox "%g. Moonmoth Legion Fort, Prison Towers" num
endif

StopScript "vn_Teleport_infoCell_Sub6"

End

# vn_Teleport_infoCell_Sub7 ===================================================
Begin vn_Teleport_infoCell_Sub7

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

if ( cell == 600 )
MessageBox "%g. Morvayn Manor" num
elseif ( cell == 601 )
MessageBox "%g. Mount Kand, Cavern" num
elseif ( cell == 602 )
MessageBox "%g. Mournhold" num
elseif ( cell == 603 )
MessageBox "%g. Mournhold Temple" num
elseif ( cell == 604 )
MessageBox "%g. Mournhold Temple: Basement" num
elseif ( cell == 605 )
MessageBox "%g. Mournhold Temple: Hall of Ministry" num
elseif ( cell == 606 )
MessageBox "%g. Mournhold Temple: High Chapel" num
elseif ( cell == 607 )
MessageBox "%g. Mournhold Temple: Infirmary" num
elseif ( cell == 608 )
MessageBox "%g. Mournhold Temple: Office of the Lord Archcanon" num
elseif ( cell == 609 )
MessageBox "%g. Mournhold Temple: Reception Area" num
elseif ( cell == 610 )
MessageBox "%g. Mournhold, Andoren Manor" num
elseif ( cell == 611 )
MessageBox "%g. Mournhold, Armory" num
elseif ( cell == 612 )
MessageBox "%g. Mournhold, Bookseller" num
elseif ( cell == 613 )
MessageBox "%g. Mournhold, Clothier" num
elseif ( cell == 614 )
MessageBox "%g. Mournhold, Craftsmen's Hall" num
elseif ( cell == 615 )
MessageBox "%g. Mournhold, Geon Auline's House" num
elseif ( cell == 616 )
MessageBox "%g. Mournhold, Godsreach" num
elseif ( cell == 617 )
MessageBox "%g. Mournhold, Great Bazaar" num
elseif ( cell == 618 )
MessageBox "%g. Mournhold, Ignatius Flaccus' House" num
elseif ( cell == 619 )
MessageBox "%g. Mournhold, Llethan Manor" num
elseif ( cell == 620 )
MessageBox "%g. Mournhold, Magic Shop" num
elseif ( cell == 621 )
MessageBox "%g. Mournhold, Museum of Artifacts" num
elseif ( cell == 622 )
MessageBox "%g. Mournhold, Pawnbroker" num
elseif ( cell == 623 )
MessageBox "%g. Mournhold, Plaza Brindisi Dorom" num
elseif ( cell == 624 )
MessageBox "%g. Mournhold, Royal Palace" num
elseif ( cell == 625 )
MessageBox "%g. Mournhold, Royal Palace Throne Room" num
elseif ( cell == 626 )
MessageBox "%g. Mournhold, Royal Palace: Barenziah's Chambers" num
elseif ( cell == 627 )
MessageBox "%g. Mournhold, Royal Palace: Basement" num
elseif ( cell == 628 )
MessageBox "%g. Mournhold, Royal Palace: Courtyard" num
elseif ( cell == 629 )
MessageBox "%g. Mournhold, Royal Palace: Guards' Quarters" num
elseif ( cell == 630 )
MessageBox "%g. Mournhold, Royal Palace: Helseth's Chambers" num
elseif ( cell == 631 )
MessageBox "%g. Mournhold, Royal Palace: Imperial Cult Services" num
elseif ( cell == 632 )
MessageBox "%g. Mournhold, Royal Palace: Jail" num
elseif ( cell == 633 )
MessageBox "%g. Mournhold, Royal Palace: Legion Depot" num
elseif ( cell == 634 )
MessageBox "%g. Mournhold, Royal Palace: Reception Area" num
elseif ( cell == 635 )
MessageBox "%g. Mournhold, Sadri Manor" num
elseif ( cell == 636 )
MessageBox "%g. Mournhold, Secret Office" num
elseif ( cell == 637 )
MessageBox "%g. Mournhold, Temple Courtyard" num
elseif ( cell == 638 )
MessageBox "%g. Mournhold, The Winged Guar" num
elseif ( cell == 639 )
MessageBox "%g. Mournhold, Thendas Manor" num
elseif ( cell == 640 )
MessageBox "%g. Mournhold, Trader" num
elseif ( cell == 641 )
MessageBox "%g. Mournhold, Vacant Manor" num
elseif ( cell == 642 )
MessageBox "%g. Mournhold, Velas Manor" num
elseif ( cell == 643 )
MessageBox "%g. Mudan Grotto" num
elseif ( cell == 644 )
MessageBox "%g. Mudan, Central Vault" num
elseif ( cell == 645 )
MessageBox "%g. Mudan, Lost Dwemer Checkpoint" num
elseif ( cell == 646 )
MessageBox "%g. Mudan, Right Tower" num
elseif ( cell == 647 )
MessageBox "%g. Mudan-Mul Egg Mine" num
elseif ( cell == 648 )
MessageBox "%g. Mul Grotto" num
elseif ( cell == 649 )
MessageBox "%g. Mzahnch" num
elseif ( cell == 650 )
MessageBox "%g. Mzahnch Lower Level" num
elseif ( cell == 651 )
MessageBox "%g. Mzanchend" num
elseif ( cell == 652 )
MessageBox "%g. Mzuleft" num
elseif ( cell == 653 )
MessageBox "%g. Nallit" num
elseif ( cell == 654 )
MessageBox "%g. Nammu" num
elseif ( cell == 655 )
MessageBox "%g. Nchardahrk" num
elseif ( cell == 656 )
MessageBox "%g. Nchardumz" num
elseif ( cell == 657 )
MessageBox "%g. Nchardumz Lower Level" num
elseif ( cell == 658 )
MessageBox "%g. Nchuleft" num
elseif ( cell == 659 )
MessageBox "%g. Nchuleftingth, Lower Levels" num
elseif ( cell == 660 )
MessageBox "%g. Nchuleftingth, Test of Pattern" num
elseif ( cell == 661 )
MessageBox "%g. Nchuleftingth, Upper Levels" num
elseif ( cell == 662 )
MessageBox "%g. Nchurdamz, Interior" num
elseif ( cell == 663 )
MessageBox "%g. Neglected Shipwreck, Cabin" num
elseif ( cell == 664 )
MessageBox "%g. Neglected Shipwreck, Lower Level" num
elseif ( cell == 665 )
MessageBox "%g. Neglected Shipwreck, Upper Level" num
elseif ( cell == 666 )
MessageBox "%g. Nelas Ancestral Tomb" num
elseif ( cell == 667 )
MessageBox "%g. Nerano Ancestral Tomb" num
elseif ( cell == 668 )
MessageBox "%g. Nilera's Farmhouse" num
elseif ( cell == 669 )
MessageBox "%g. Nimawia Grotto" num
elseif ( cell == 670 )
MessageBox "%g. Nissintu" num
elseif ( cell == 671 )
MessageBox "%g. Norenen-dur" num
elseif ( cell == 672 )
MessageBox "%g. Norenen-dur, Basilica of Divine Whispers" num
elseif ( cell == 673 )
MessageBox "%g. Norenen-dur, Citadel of Myn Dhrur" num
elseif ( cell == 674 )
MessageBox "%g. Norenen-dur, The Grand Stair" num
elseif ( cell == 675 )
MessageBox "%g. Norenen-dur, The Teeth that Gnash" num
elseif ( cell == 676 )
MessageBox "%g. Norenen-dur, The Wailingdelve" num
elseif ( cell == 677 )
MessageBox "%g. Norvayn Ancestral Tomb" num
elseif ( cell == 678 )
MessageBox "%g. Nund" num
elseif ( cell == 679 )
MessageBox "%g. Obscure Shipwreck, Cabin" num
elseif ( cell == 680 )
MessageBox "%g. Obscure Shipwreck, Lower Level" num
elseif ( cell == 681 )
MessageBox "%g. Obscure Shipwreck, Upper Level" num
elseif ( cell == 682 )
MessageBox "%g. Odaishah" num
elseif ( cell == 683 )
MessageBox "%g. Odibaal" num
elseif ( cell == 684 )
MessageBox "%g. Odirnamat" num
elseif ( cell == 685 )
MessageBox "%g. Odirniran" num
elseif ( cell == 686 )
MessageBox "%g. Odirniran, Tower" num
elseif ( cell == 687 )
MessageBox "%g. Odrosal, Dwemer Training Academy" num
elseif ( cell == 688 )
MessageBox "%g. Odrosal, Tower" num
elseif ( cell == 689 )
MessageBox "%g. Old Mournhold: Abandoned Crypt" num
elseif ( cell == 690 )
MessageBox "%g. Old Mournhold: Abandoned Passageway" num
elseif ( cell == 691 )
MessageBox "%g. Old Mournhold: Armory Ruins" num
elseif ( cell == 692 )
MessageBox "%g. Old Mournhold: Battlefield" num
elseif ( cell == 693 )
MessageBox "%g. Old Mournhold: Bazaar Sewers" num
elseif ( cell == 694 )
MessageBox "%g. Old Mournhold: City Gate" num
elseif ( cell == 695 )
MessageBox "%g. Old Mournhold: Forgotten Sewer" num
elseif ( cell == 696 )
MessageBox "%g. Old Mournhold: Gedna Relvel's Tomb" num
elseif ( cell == 697 )
MessageBox "%g. Old Mournhold: Manor District" num
elseif ( cell == 698 )
MessageBox "%g. Old Mournhold: Moril Manor, Courtyard" num
elseif ( cell == 699 )
MessageBox "%g. Old Mournhold: Moril Manor, East Building" num
endif

StopScript "vn_Teleport_infoCell_Sub7"

End

# vn_Teleport_infoCell_Sub8 ===================================================
Begin vn_Teleport_infoCell_Sub8

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

if ( cell == 700 )
MessageBox "%g. Old Mournhold: Moril Manor, North Building" num
elseif ( cell == 701 )
MessageBox "%g. Old Mournhold: Palace Sewers" num
elseif ( cell == 702 )
MessageBox "%g. Old Mournhold: Residential Ruins" num
elseif ( cell == 703 )
MessageBox "%g. Old Mournhold: Residential Sewers" num
elseif ( cell == 704 )
MessageBox "%g. Old Mournhold: Tears of Amun-Shae" num
elseif ( cell == 705 )
MessageBox "%g. Old Mournhold: Temple Catacombs" num
elseif ( cell == 706 )
MessageBox "%g. Old Mournhold: Temple Crypt" num
elseif ( cell == 707 )
MessageBox "%g. Old Mournhold: Temple Gardens" num
elseif ( cell == 708 )
MessageBox "%g. Old Mournhold: Temple Sewers" num
elseif ( cell == 709 )
MessageBox "%g. Old Mournhold: Temple Sewers East" num
elseif ( cell == 710 )
MessageBox "%g. Old Mournhold: Temple Sewers West" num
elseif ( cell == 711 )
MessageBox "%g. Old Mournhold: Temple Shrine" num
elseif ( cell == 712 )
MessageBox "%g. Old Mournhold: Teran Hall" num
elseif ( cell == 713 )
MessageBox "%g. Old Mournhold: Teran Hall, East Bldg" num
elseif ( cell == 714 )
MessageBox "%g. Old Mournhold: West Sewers" num
elseif ( cell == 715 )
MessageBox "%g. Omalen Ancestral Tomb" num
elseif ( cell == 716 )
MessageBox "%g. Omani Manor" num
elseif ( cell == 717 )
MessageBox "%g. Omaren Ancestral Tomb" num
elseif ( cell == 718 )
MessageBox "%g. Onnissiralis, Shrine" num
elseif ( cell == 719 )
MessageBox "%g. Orethi Ancestral Tomb" num
elseif ( cell == 720 )
MessageBox "%g. Othrelas Ancestral Tomb" num
elseif ( cell == 721 )
MessageBox "%g. Palansour" num
elseif ( cell == 722 )
MessageBox "%g. Panabanit-Nimawia Egg Mine" num
elseif ( cell == 723 )
MessageBox "%g. Panat" num
elseif ( cell == 724 )
MessageBox "%g. Panud Egg Mine" num
elseif ( cell == 725 )
MessageBox "%g. Pelagiad, Adanja's House" num
elseif ( cell == 726 )
MessageBox "%g. Pelagiad, Ahnassi's House" num
elseif ( cell == 727 )
MessageBox "%g. Pelagiad, Dralas Gilu's House" num
elseif ( cell == 728 )
MessageBox "%g. Pelagiad, Erval's House" num
elseif ( cell == 729 )
MessageBox "%g. Pelagiad, Farusea Salas' House" num
elseif ( cell == 730 )
MessageBox "%g. Pelagiad, Fort Pelagiad" num
elseif ( cell == 731 )
MessageBox "%g. Pelagiad, Guard Tower" num
elseif ( cell == 732 )
MessageBox "%g. Pelagiad, Halfway Tavern" num
elseif ( cell == 733 )
MessageBox "%g. Pelagiad, Ignatius Flaccus' House" num
elseif ( cell == 734 )
MessageBox "%g. Pelagiad, Junal-lei's House" num
elseif ( cell == 735 )
MessageBox "%g. Pelagiad, Madres Navur's House" num
elseif ( cell == 736 )
MessageBox "%g. Pelagiad, Mebestien Ence: Trader" num
elseif ( cell == 737 )
MessageBox "%g. Pelagiad, Murberius Harmevus' House" num
elseif ( cell == 738 )
MessageBox "%g. Pelagiad, North Wall" num
elseif ( cell == 739 )
MessageBox "%g. Pelagiad, South Wall" num
elseif ( cell == 740 )
MessageBox "%g. Pelagiad, Uulernil : Armorer" num
elseif ( cell == 741 )
MessageBox "%g. Piernette's Farmhouse" num
elseif ( cell == 742 )
MessageBox "%g. Pinsun" num
elseif ( cell == 743 )
MessageBox "%g. Piran" num
elseif ( cell == 744 )
MessageBox "%g. Prelude Shipwreck, Cabin" num
elseif ( cell == 745 )
MessageBox "%g. Prelude Shipwreck, Lower Level" num
elseif ( cell == 746 )
MessageBox "%g. Prelude Shipwreck, Upper Level" num
elseif ( cell == 747 )
MessageBox "%g. Pudai Egg Mine" num
elseif ( cell == 748 )
MessageBox "%g. Pudai Egg Mine, Queen's Lair" num
elseif ( cell == 749 )
MessageBox "%g. Pulk" num
elseif ( cell == 750 )
MessageBox "%g. Punabi" num
elseif ( cell == 751 )
MessageBox "%g. Punammu" num
elseif ( cell == 752 )
MessageBox "%g. Punsabanit" num
elseif ( cell == 753 )
MessageBox "%g. Ramimilk, Shrine" num
elseif ( cell == 754 )
MessageBox "%g. Randas Ancestral Tomb" num
elseif ( cell == 755 )
MessageBox "%g. Ravel Ancestral Tomb" num
elseif ( cell == 756 )
MessageBox "%g. Raviro Ancestral Tomb" num
elseif ( cell == 757 )
MessageBox "%g. Rayna Drolan's Shack" num
elseif ( cell == 758 )
MessageBox "%g. Redas Ancestral Tomb" num
elseif ( cell == 759 )
MessageBox "%g. Redoran interior" num
elseif ( cell == 760 )
MessageBox "%g. Redoran interior2" num
elseif ( cell == 761 )
MessageBox "%g. Releth Ancestral Tomb" num
elseif ( cell == 762 )
MessageBox "%g. Reloth Ancestral Tomb" num
elseif ( cell == 763 )
MessageBox "%g. Remote Shipwreck, Cabin" num
elseif ( cell == 764 )
MessageBox "%g. Remote Shipwreck, Lower Level" num
elseif ( cell == 765 )
MessageBox "%g. Remote Shipwreck, Upper Level" num
elseif ( cell == 766 )
MessageBox "%g. Rethan Manor" num
elseif ( cell == 767 )
MessageBox "%g. Rethan Manor, Berendas' House" num
elseif ( cell == 768 )
MessageBox "%g. Rethan Manor, Drelas' House" num
elseif ( cell == 769 )
MessageBox "%g. Rethan Manor, Gols' House" num
elseif ( cell == 770 )
MessageBox "%g. Rethan Manor, Tures' House" num
elseif ( cell == 771 )
MessageBox "%g. Rethandus Ancestral Tomb" num
elseif ( cell == 772 )
MessageBox "%g. Rissun" num
elseif ( cell == 773 )
MessageBox "%g. Rothan Ancestral Tomb" num
elseif ( cell == 774 )
MessageBox "%g. Rotheran, Arena" num
elseif ( cell == 775 )
MessageBox "%g. Rotheran, Communal Hut" num
elseif ( cell == 776 )
MessageBox "%g. Rotheran, Propylon Chamber" num
elseif ( cell == 777 )
MessageBox "%g. Sadrith Mora, Anis Seloth: Alchemist" num
elseif ( cell == 778 )
MessageBox "%g. Sadrith Mora, Balen Vendu: Monk" num
elseif ( cell == 779 )
MessageBox "%g. Sadrith Mora, Dirty Muriel's Cornerclub" num
elseif ( cell == 780 )
MessageBox "%g. Sadrith Mora, Fara's Hole in the Wall" num
elseif ( cell == 781 )
MessageBox "%g. Sadrith Mora, Gateway Inn" num
elseif ( cell == 782 )
MessageBox "%g. Sadrith Mora, Gateway Inn: North Wing" num
elseif ( cell == 783 )
MessageBox "%g. Sadrith Mora, Gateway Inn: South Wing" num
elseif ( cell == 784 )
MessageBox "%g. Sadrith Mora, Gateway Inn: West Wing" num
elseif ( cell == 785 )
MessageBox "%g. Sadrith Mora, Hleras Gidren's House" num
elseif ( cell == 786 )
MessageBox "%g. Sadrith Mora, Llaalam Madalas: Mage" num
elseif ( cell == 787 )
MessageBox "%g. Sadrith Mora, Madran Ulvel's House" num
elseif ( cell == 788 )
MessageBox "%g. Sadrith Mora, Meluria Seleth's House" num
elseif ( cell == 789 )
MessageBox "%g. Sadrith Mora, Milara Vedran's House" num
elseif ( cell == 790 )
MessageBox "%g. Sadrith Mora, Morag Tong Guild" num
elseif ( cell == 791 )
MessageBox "%g. Sadrith Mora, Nevrila Areloth's House" num
elseif ( cell == 792 )
MessageBox "%g. Sadrith Mora, Nirasa Aren's House" num
elseif ( cell == 793 )
MessageBox "%g. Sadrith Mora, Pierlette Rostorard: Apothecary" num
elseif ( cell == 794 )
MessageBox "%g. Sadrith Mora, Rolis Garvon's House" num
elseif ( cell == 795 )
MessageBox "%g. Sadrith Mora, Tel Naga General Quarters" num
elseif ( cell == 796 )
MessageBox "%g. Sadrith Mora, Tel Naga Great Hall" num
elseif ( cell == 797 )
MessageBox "%g. Sadrith Mora, Tel Naga Upper Hall" num
elseif ( cell == 798 )
MessageBox "%g. Sadrith Mora, Tel Naga Upper Tower" num
elseif ( cell == 799 )
MessageBox "%g. Sadrith Mora, Telvanni Council House" num
endif

StopScript "vn_Teleport_infoCell_Sub8"

End

# vn_Teleport_infoCell_Sub9 ===================================================
Begin vn_Teleport_infoCell_Sub9

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

if ( cell == 800 )
MessageBox "%g. Sadrith Mora, Telvanni Council House, Chambers" num
elseif ( cell == 801 )
MessageBox "%g. Sadrith Mora, Telvanni Council House, Entry" num
elseif ( cell == 802 )
MessageBox "%g. Sadrith Mora, Telvanni Council House, Hermitage" num
elseif ( cell == 803 )
MessageBox "%g. Sadrith Mora, Thervul Serethi: Healer" num
elseif ( cell == 804 )
MessageBox "%g. Sadrith Mora, Trendrus Dral's House" num
elseif ( cell == 805 )
MessageBox "%g. Sadrith Mora, Urtisa Romayn's House" num
elseif ( cell == 806 )
MessageBox "%g. Sadrith Mora, Urtiso Faryon: Sorcerer" num
elseif ( cell == 807 )
MessageBox "%g. Sadrith Mora, Vaden Belas' House" num
elseif ( cell == 808 )
MessageBox "%g. Sadrith Mora, Volmyni Dral's House" num
elseif ( cell == 809 )
MessageBox "%g. Sadrith Mora, Wolverine Hall" num
elseif ( cell == 810 )
MessageBox "%g. Sadrith Mora, Wolverine Hall: Fighter's Guild" num
elseif ( cell == 811 )
MessageBox "%g. Sadrith Mora, Wolverine Hall: Imperial Shrine" num
elseif ( cell == 812 )
MessageBox "%g. Sadrith Mora, Wolverine Hall: Mage's Guild" num
elseif ( cell == 813 )
MessageBox "%g. Sadryon Ancestral Tomb" num
elseif ( cell == 814 )
MessageBox "%g. Salit Camp, Zalit's Yurt" num
elseif ( cell == 815 )
MessageBox "%g. Salit Camp, Zelay's Yurt" num
elseif ( cell == 816 )
MessageBox "%g. Salmantu" num
elseif ( cell == 817 )
MessageBox "%g. Salmantu, Shrine" num
elseif ( cell == 818 )
MessageBox "%g. Salothan Ancestral Tomb" num
elseif ( cell == 819 )
MessageBox "%g. Salothran Ancestral Tomb" num
elseif ( cell == 820 )
MessageBox "%g. Salvel Ancestral Tomb" num
elseif ( cell == 821 )
MessageBox "%g. Samarys Ancestral Tomb" num
elseif ( cell == 822 )
MessageBox "%g. Sanabi" num
elseif ( cell == 823 )
MessageBox "%g. Sandas Ancestral Tomb" num
elseif ( cell == 824 )
MessageBox "%g. Sandus Ancestral Tomb" num
elseif ( cell == 825 )
MessageBox "%g. Sanit" num
elseif ( cell == 826 )
MessageBox "%g. Sanit, Shrine" num
elseif ( cell == 827 )
MessageBox "%g. Sanni" num
elseif ( cell == 828 )
MessageBox "%g. Sarano Ancestral Tomb" num
elseif ( cell == 829 )
MessageBox "%g. Saren Ancestral Tomb" num
elseif ( cell == 830 )
MessageBox "%g. Sarethi Ancestral Tomb" num
elseif ( cell == 831 )
MessageBox "%g. Sargon" num
elseif ( cell == 832 )
MessageBox "%g. Sarimisun-Assa Egg Mine" num
elseif ( cell == 833 )
MessageBox "%g. Sarimisun-Assa Egg Mine, Queen's Lair" num
elseif ( cell == 834 )
MessageBox "%g. Sarys Ancestral Tomb" num
elseif ( cell == 835 )
MessageBox "%g. Saturan" num
elseif ( cell == 836 )
MessageBox "%g. Savel Ancestral Tomb" num
elseif ( cell == 837 )
MessageBox "%g. Senim Ancestral Tomb" num
elseif ( cell == 838 )
MessageBox "%g. Sennananit" num
elseif ( cell == 839 )
MessageBox "%g. Seran Ancestral Tomb" num
elseif ( cell == 840 )
MessageBox "%g. Serano Ancestral Tomb" num
elseif ( cell == 841 )
MessageBox "%g. Sethan Ancestral Tomb" num
elseif ( cell == 842 )
MessageBox "%g. Setus Egg Mine" num
elseif ( cell == 843 )
MessageBox "%g. Seyda Neen, Arrille's Tradehouse" num
elseif ( cell == 844 )
MessageBox "%g. Seyda Neen, Census and Excise Office" num
elseif ( cell == 845 )
MessageBox "%g. Seyda Neen, Census and Excise Warehouse" num
elseif ( cell == 846 )
MessageBox "%g. Seyda Neen, Draren Thiralas' House" num
elseif ( cell == 847 )
MessageBox "%g. Seyda Neen, Eldafire's House" num
elseif ( cell == 848 )
MessageBox "%g. Seyda Neen, Erene Llenim's Shack" num
elseif ( cell == 849 )
MessageBox "%g. Seyda Neen, Fargoth's House" num
elseif ( cell == 850 )
MessageBox "%g. Seyda Neen, Fine-Mouth's Shack" num
elseif ( cell == 851 )
MessageBox "%g. Seyda Neen, Foryn Gilnith's Shack" num
elseif ( cell == 852 )
MessageBox "%g. Seyda Neen, Indrele Rathryon's Shack" num
elseif ( cell == 853 )
MessageBox "%g. Seyda Neen, Lighthouse" num
elseif ( cell == 854 )
MessageBox "%g. Seyda Neen, Terurise Girvayne's House" num
elseif ( cell == 855 )
MessageBox "%g. Seyda Neen, Vodunius Nuccius' House" num
elseif ( cell == 856 )
MessageBox "%g. Sha-Adnius" num
elseif ( cell == 857 )
MessageBox "%g. Shal" num
elseif ( cell == 858 )
MessageBox "%g. Shallit" num
elseif ( cell == 859 )
MessageBox "%g. Shara" num
elseif ( cell == 860 )
MessageBox "%g. Sharapli" num
elseif ( cell == 861 )
MessageBox "%g. Shashmanu Camp, Anit's Yurt" num
elseif ( cell == 862 )
MessageBox "%g. Shashpilamat" num
elseif ( cell == 863 )
MessageBox "%g. Shashpilamat, Shrine" num
elseif ( cell == 864 )
MessageBox "%g. Shashurari Camp, Zennammu's Yurt" num
elseif ( cell == 865 )
MessageBox "%g. Shishara" num
elseif ( cell == 866 )
MessageBox "%g. Shishi" num
elseif ( cell == 867 )
MessageBox "%g. Shrine of Azura" num
elseif ( cell == 868 )
MessageBox "%g. Shulk Egg Mine" num
elseif ( cell == 869 )
MessageBox "%g. Shulk Egg Mine, Mining Camp" num
elseif ( cell == 870 )
MessageBox "%g. Shulk Egg Mine, Queen's Lair" num
elseif ( cell == 871 )
MessageBox "%g. Shunned Shipwreck, Cabin" num
elseif ( cell == 872 )
MessageBox "%g. Shunned Shipwreck, Lower Level" num
elseif ( cell == 873 )
MessageBox "%g. Shunned Shipwreck, Upper Level" num
elseif ( cell == 874 )
MessageBox "%g. Shurdan-Raplay Egg Mine" num
elseif ( cell == 875 )
MessageBox "%g. Shurinbaal" num
elseif ( cell == 876 )
MessageBox "%g. Shushan" num
elseif ( cell == 877 )
MessageBox "%g. Shushishi" num
elseif ( cell == 878 )
MessageBox "%g. Sinamusa Egg Mine" num
elseif ( cell == 879 )
MessageBox "%g. Sinarralit Egg Mine" num
elseif ( cell == 880 )
MessageBox "%g. Sinsibadon" num
elseif ( cell == 881 )
MessageBox "%g. Sjorvar Horse-Mouth's House" num
elseif ( cell == 882 )
MessageBox "%g. Small Farmhouse" num
elseif ( cell == 883 )
MessageBox "%g. Sobitbael Camp, Mal's Yurt" num
elseif ( cell == 884 )
MessageBox "%g. Sotha Sil," num
elseif ( cell == 885 )
MessageBox "%g. Sotha Sil, Central Gearworks" num
elseif ( cell == 886 )
MessageBox "%g. Sotha Sil, Chamber of Sohleh" num
elseif ( cell == 887 )
MessageBox "%g. Sotha Sil, Dome of Kasia" num
elseif ( cell == 888 )
MessageBox "%g. Sotha Sil, Dome of Serlyn" num
elseif ( cell == 889 )
MessageBox "%g. Sotha Sil, Dome of Sotha Sil" num
elseif ( cell == 890 )
MessageBox "%g. Sotha Sil, Dome of the Imperfect" num
elseif ( cell == 891 )
MessageBox "%g. Sotha Sil, Dome of Udok" num
elseif ( cell == 892 )
MessageBox "%g. Sotha Sil, Hall of Delirium" num
elseif ( cell == 893 )
MessageBox "%g. Sotha Sil, Hall of Mileitho" num
elseif ( cell == 894 )
MessageBox "%g. Sotha Sil, Hall of Sallaemu" num
elseif ( cell == 895 )
MessageBox "%g. Sotha Sil, Hall of Theuda" num
elseif ( cell == 896 )
MessageBox "%g. Sotha Sil, Inner Flooded Halls" num
elseif ( cell == 897 )
MessageBox "%g. Sotha Sil, Outer Flooded Halls" num
elseif ( cell == 898 )
MessageBox "%g. Sterdecan's Farmhouse" num
elseif ( cell == 899 )
MessageBox "%g. Strange Shipwreck, Cabin" num
endif

StopScript "vn_Teleport_infoCell_Sub9"

End

# vn_Teleport_infoCell_SubA ===================================================
Begin vn_Teleport_infoCell_SubA

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

if ( cell == 900 )
MessageBox "%g. Strange Shipwreck, Lower Level" num
elseif ( cell == 901 )
MessageBox "%g. Strange Shipwreck, Upper Level" num
elseif ( cell == 902 )
MessageBox "%g. Subdun" num
elseif ( cell == 903 )
MessageBox "%g. Subdun, Shrine" num
elseif ( cell == 904 )
MessageBox "%g. Sud" num
elseif ( cell == 905 )
MessageBox "%g. Sudanit Mine" num
elseif ( cell == 906 )
MessageBox "%g. Sulipund" num
elseif ( cell == 907 )
MessageBox "%g. Sur Egg Mine" num
elseif ( cell == 908 )
MessageBox "%g. Suran, Desele's House of Earthly Delights" num
elseif ( cell == 909 )
MessageBox "%g. Suran, Garothmuk gro-Muzgub: Smith" num
elseif ( cell == 910 )
MessageBox "%g. Suran, Goldyn Belaram: Pawnbroker" num
elseif ( cell == 911 )
MessageBox "%g. Suran, Guard Tower" num
elseif ( cell == 912 )
MessageBox "%g. Suran, Ibarnadad Assirnarari: Apothecary" num
elseif ( cell == 913 )
MessageBox "%g. Suran, Oran Manor" num
elseif ( cell == 914 )
MessageBox "%g. Suran, Ralds Oril: Trader" num
elseif ( cell == 915 )
MessageBox "%g. Suran, Ranosa Gilvayn: Outfitter" num
elseif ( cell == 916 )
MessageBox "%g. Suran, Suran Slave Market" num
elseif ( cell == 917 )
MessageBox "%g. Suran, Suran Temple" num
elseif ( cell == 918 )
MessageBox "%g. Suran, Suran Tradehouse" num
elseif ( cell == 919 )
MessageBox "%g. Suran, Verara Rendo: Clothier" num
elseif ( cell == 920 )
MessageBox "%g. Surirulk" num
elseif ( cell == 921 )
MessageBox "%g. Tel Aruhn, Aryne Telnim: Smith" num
elseif ( cell == 922 )
MessageBox "%g. Tel Aruhn, Bildren Areleth: Apothecary" num
elseif ( cell == 923 )
MessageBox "%g. Tel Aruhn, Ferele Athram: Trader" num
elseif ( cell == 924 )
MessageBox "%g. Tel Aruhn, Maren Uvaren: Enchanter" num
elseif ( cell == 925 )
MessageBox "%g. Tel Aruhn, Plot and Plaster" num
elseif ( cell == 926 )
MessageBox "%g. Tel Aruhn, Tower Entry" num
elseif ( cell == 927 )
MessageBox "%g. Tel Aruhn, Tower Living Quarters" num
elseif ( cell == 928 )
MessageBox "%g. Tel Aruhn, Underground" num
elseif ( cell == 929 )
MessageBox "%g. Tel Aruhn, Upper Tower" num
elseif ( cell == 930 )
MessageBox "%g. Tel Branora, Ervyna Hlervu's Shack" num
elseif ( cell == 931 )
MessageBox "%g. Tel Branora, Evos Goran's House" num
elseif ( cell == 932 )
MessageBox "%g. Tel Branora, Fadase Selvayn: Trader" num
elseif ( cell == 933 )
MessageBox "%g. Tel Branora, Fedar Davus's House" num
elseif ( cell == 934 )
MessageBox "%g. Tel Branora, Galen Berer: Armorer" num
elseif ( cell == 935 )
MessageBox "%g. Tel Branora, Giron Manas's Shack" num
elseif ( cell == 936 )
MessageBox "%g. Tel Branora, Lower Tower" num
elseif ( cell == 937 )
MessageBox "%g. Tel Branora, Manos Vavyn's House" num
elseif ( cell == 938 )
MessageBox "%g. Tel Branora, Seryne Relas's House" num
elseif ( cell == 939 )
MessageBox "%g. Tel Branora, Sethan's Tradehouse" num
elseif ( cell == 940 )
MessageBox "%g. Tel Branora, Tower Dungeon" num
elseif ( cell == 941 )
MessageBox "%g. Tel Branora, Tower Guardpost" num
elseif ( cell == 942 )
MessageBox "%g. Tel Branora, Upper Tower" num
elseif ( cell == 943 )
MessageBox "%g. Tel Branora, Upper Tower: Therana's Chamber" num
elseif ( cell == 944 )
MessageBox "%g. Tel Mora, Berwen: Trader" num
elseif ( cell == 945 )
MessageBox "%g. Tel Mora, Elegnan: Clothier" num
elseif ( cell == 946 )
MessageBox "%g. Tel Mora, Jolda: Apothecary" num
elseif ( cell == 947 )
MessageBox "%g. Tel Mora, Kirsty's House" num
elseif ( cell == 948 )
MessageBox "%g. Tel Mora, Liette's House" num
elseif ( cell == 949 )
MessageBox "%g. Tel Mora, Lower Tower" num
elseif ( cell == 950 )
MessageBox "%g. Tel Mora, Nona's House" num
elseif ( cell == 951 )
MessageBox "%g. Tel Mora, Radras: Smith" num
elseif ( cell == 952 )
MessageBox "%g. Tel Mora, The Covenant" num
elseif ( cell == 953 )
MessageBox "%g. Tel Mora, Tower Services" num
elseif ( cell == 954 )
MessageBox "%g. Tel Mora, Upper Tower" num
elseif ( cell == 955 )
MessageBox "%g. Tel Uvirith, Arelas' House" num
elseif ( cell == 956 )
MessageBox "%g. Tel Uvirith, Menas' House" num
elseif ( cell == 957 )
MessageBox "%g. Tel Uvirith, Omavel's House" num
elseif ( cell == 958 )
MessageBox "%g. Tel Uvirith, Seleth's House" num
elseif ( cell == 959 )
MessageBox "%g. Tel Uvirith, Tower Dungeon" num
elseif ( cell == 960 )
MessageBox "%g. Tel Uvirith, Tower Lower" num
elseif ( cell == 961 )
MessageBox "%g. Tel Uvirith, Tower Upper" num
elseif ( cell == 962 )
MessageBox "%g. Tel Vos, Aryon's Chambers" num
elseif ( cell == 963 )
MessageBox "%g. Tel Vos, Barracks and Armory" num
elseif ( cell == 964 )
MessageBox "%g. Tel Vos, Central Tower" num
elseif ( cell == 965 )
MessageBox "%g. Tel Vos, Dungeon" num
elseif ( cell == 966 )
MessageBox "%g. Tel Vos, Jail" num
elseif ( cell == 967 )
MessageBox "%g. Tel Vos, Northeastern Tower" num
elseif ( cell == 968 )
MessageBox "%g. Tel Vos, Services Tower" num
elseif ( cell == 969 )
MessageBox "%g. Tel Vos, Southern Tower" num
elseif ( cell == 970 )
MessageBox "%g. Telasero, Lower Level" num
elseif ( cell == 971 )
MessageBox "%g. Telasero, Propylon Chamber" num
elseif ( cell == 972 )
MessageBox "%g. Telasero, Upper Level" num
elseif ( cell == 973 )
MessageBox "%g. Telvayn Ancestral Tomb" num
elseif ( cell == 974 )
MessageBox "%g. Thalas Ancestral Tomb" num
elseif ( cell == 975 )
MessageBox "%g. Tharys Ancestral Tomb" num
elseif ( cell == 976 )
MessageBox "%g. Thelas Ancestral Tomb" num
elseif ( cell == 977 )
MessageBox "%g. Thiralas Ancestral Tomb" num
elseif ( cell == 978 )
MessageBox "%g. Tin-Ahhe" num
elseif ( cell == 979 )
MessageBox "%g. ToddTest" num
elseif ( cell == 980 )
MessageBox "%g. Tower of Tel Fyr, Hall of Fyr" num
elseif ( cell == 981 )
MessageBox "%g. Tower of Tel Fyr, Onyx Hall" num
elseif ( cell == 982 )
MessageBox "%g. Tukushapal" num
elseif ( cell == 983 )
MessageBox "%g. Tukushapal, Sepulcher" num
elseif ( cell == 984 )
MessageBox "%g. Tureynulal, Bladder of Clovis" num
elseif ( cell == 985 )
MessageBox "%g. Tureynulal, Eye of Duggan" num
elseif ( cell == 986 )
MessageBox "%g. Tureynulal, Eye of Thom Wye" num
elseif ( cell == 987 )
MessageBox "%g. Tureynulal, Kagrenac's Library" num
elseif ( cell == 988 )
MessageBox "%g. Tusenend, Shrine" num
elseif ( cell == 989 )
MessageBox "%g. Ularradallaku, Shrine" num
elseif ( cell == 990 )
MessageBox "%g. Ules Manor" num
elseif ( cell == 991 )
MessageBox "%g. Ules Manor, Slave Shack" num
elseif ( cell == 992 )
MessageBox "%g. Ules Manor, Slavemaster's Shack" num
elseif ( cell == 993 )
MessageBox "%g. Ulummusa" num
elseif ( cell == 994 )
MessageBox "%g. Uncharted Shipwreck, Lower Level" num
elseif ( cell == 995 )
MessageBox "%g. Unchartered Shipwreck, Cabin" num
elseif ( cell == 996 )
MessageBox "%g. Unchartered Shipwreck, Upper Level" num
elseif ( cell == 997 )
MessageBox "%g. Unexplored Shipwreck, Cabin" num
elseif ( cell == 998 )
MessageBox "%g. Unexplored Shipwreck, Lower Level" num
elseif ( cell == 999 )
MessageBox "%g. Unexplored Shipwreck, Upper Level" num
endif

StopScript "vn_Teleport_infoCell_SubA"

End

# vn_Teleport_infoCell_SubB ===================================================
Begin vn_Teleport_infoCell_SubB

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

if ( cell == 1000 )
MessageBox "%g. Unknown Shipwreck, Cabin" num
elseif ( cell == 1001 )
MessageBox "%g. Unknown Shipwreck, Lower Level" num
elseif ( cell == 1002 )
MessageBox "%g. Unknown Shipwreck, Upper Level" num
elseif ( cell == 1003 )
MessageBox "%g. Unmarked Shipwreck, Lower Level" num
elseif ( cell == 1004 )
MessageBox "%g. Unmarked Shipwreck, Upper Level" num
elseif ( cell == 1005 )
MessageBox "%g. Urshilaku Camp, Ahasour's Yurt" num
elseif ( cell == 1006 )
MessageBox "%g. Urshilaku Camp, Ashkhan's Yurt" num
elseif ( cell == 1007 )
MessageBox "%g. Urshilaku Camp, Kurapli's Yurt" num
elseif ( cell == 1008 )
MessageBox "%g. Urshilaku Camp, Maeli's Yurt" num
elseif ( cell == 1009 )
MessageBox "%g. Urshilaku Camp, Sakiran's Yurt" num
elseif ( cell == 1010 )
MessageBox "%g. Urshilaku Camp, Shara's Yurt" num
elseif ( cell == 1011 )
MessageBox "%g. Urshilaku Camp, Shimsun's Yurt" num
elseif ( cell == 1012 )
MessageBox "%g. Urshilaku Camp, Wise Woman's Yurt" num
elseif ( cell == 1013 )
MessageBox "%g. Urshilaku Camp, Zabamund's Yurt" num
elseif ( cell == 1014 )
MessageBox "%g. Urshilaku Camp, Zanummu's Yurt" num
elseif ( cell == 1015 )
MessageBox "%g. Urshilaku, Astral Burial" num
elseif ( cell == 1016 )
MessageBox "%g. Urshilaku, Fragile Burial" num
elseif ( cell == 1017 )
MessageBox "%g. Urshilaku, Juno Burial" num
elseif ( cell == 1018 )
MessageBox "%g. Urshilaku, Kakuna Burial" num
elseif ( cell == 1019 )
MessageBox "%g. Urshilaku, Karma Burial" num
elseif ( cell == 1020 )
MessageBox "%g. Urshilaku, Kefka Burial" num
elseif ( cell == 1021 )
MessageBox "%g. Urshilaku, Laterus Burial" num
elseif ( cell == 1022 )
MessageBox "%g. Uveran Ancestral Tomb" num
elseif ( cell == 1023 )
MessageBox "%g. Valenvaryon, Durz's Hut" num
elseif ( cell == 1024 )
MessageBox "%g. Valenvaryon, Gashna's Hut" num
elseif ( cell == 1025 )
MessageBox "%g. Valenvaryon, Lambug's Hut" num
elseif ( cell == 1026 )
MessageBox "%g. Valenvaryon, Lurog's Hut" num
elseif ( cell == 1027 )
MessageBox "%g. Valenvaryon, Propylon Chamber" num
elseif ( cell == 1028 )
MessageBox "%g. Valenvaryon, Umug's Hut" num
elseif ( cell == 1029 )
MessageBox "%g. Vandus Ancestral Tomb" num
elseif ( cell == 1030 )
MessageBox "%g. Vansunalit Egg Mine" num
elseif ( cell == 1031 )
MessageBox "%g. Vas, Entry Level" num
elseif ( cell == 1032 )
MessageBox "%g. Vas, Tower" num
elseif ( cell == 1033 )
MessageBox "%g. Vassamsi Grotto" num
elseif ( cell == 1034 )
MessageBox "%g. Vassir-Didanat Cave" num
elseif ( cell == 1035 )
MessageBox "%g. Velas Ancestral Tomb" num
elseif ( cell == 1036 )
MessageBox "%g. Veloth Ancestral Tomb" num
elseif ( cell == 1037 )
MessageBox "%g. Vemynal, Hall of Torque" num
elseif ( cell == 1038 )
MessageBox "%g. Vemynal, Outer Fortress" num
elseif ( cell == 1039 )
MessageBox "%g. Venim Ancestral Tomb" num
elseif ( cell == 1040 )
MessageBox "%g. Verelnim Ancestral Tomb" num
elseif ( cell == 1041 )
MessageBox "%g. Vivec, Agrippina Herennia: Clothier" num
elseif ( cell == 1042 )
MessageBox "%g. Vivec, Alusaron: Smith" num
elseif ( cell == 1043 )
MessageBox "%g. Vivec, Andilu Drothan: Alchemist" num
elseif ( cell == 1044 )
MessageBox "%g. Vivec, Arena Canalworks" num
elseif ( cell == 1045 )
MessageBox "%g. Vivec, Arena Fighters Quarters" num
elseif ( cell == 1046 )
MessageBox "%g. Vivec, Arena Fighters Training" num
elseif ( cell == 1047 )
MessageBox "%g. Vivec, Arena Hidden Area" num
elseif ( cell == 1048 )
MessageBox "%g. Vivec, Arena Holding Cells" num
elseif ( cell == 1049 )
MessageBox "%g. Vivec, Arena Pit" num
elseif ( cell == 1050 )
MessageBox "%g. Vivec, Arena Storage" num
elseif ( cell == 1051 )
MessageBox "%g. Vivec, Arena Underworks" num
elseif ( cell == 1052 )
MessageBox "%g. Vivec, Arena Waistworks" num
elseif ( cell == 1053 )
MessageBox "%g. Vivec, Aurane Frernis: Apothecary" num
elseif ( cell == 1054 )
MessageBox "%g. Vivec, Black Shalk Cornerclub" num
elseif ( cell == 1055 )
MessageBox "%g. Vivec, Canon Offices" num
elseif ( cell == 1056 )
MessageBox "%g. Vivec, Canon Quarters" num
elseif ( cell == 1057 )
MessageBox "%g. Vivec, Curio Manor" num
elseif ( cell == 1058 )
MessageBox "%g. Vivec, Dralor Manor" num
elseif ( cell == 1059 )
MessageBox "%g. Vivec, Elven Nations Cornerclub" num
elseif ( cell == 1060 )
MessageBox "%g. Vivec, Foreign Quarter Canalworks" num
elseif ( cell == 1061 )
MessageBox "%g. Vivec, Foreign Quarter Lower Waistworks" num
elseif ( cell == 1062 )
MessageBox "%g. Vivec, Foreign Quarter Plaza" num
elseif ( cell == 1063 )
MessageBox "%g. Vivec, Foreign Quarter Tomb" num
elseif ( cell == 1064 )
MessageBox "%g. Vivec, Foreign Quarter Underworks" num
elseif ( cell == 1065 )
MessageBox "%g. Vivec, Foreign Quarter Upper Waistworks" num
elseif ( cell == 1066 )
MessageBox "%g. Vivec, Guild of Fighters" num
elseif ( cell == 1067 )
MessageBox "%g. Vivec, Guild of Mages" num
elseif ( cell == 1068 )
MessageBox "%g. Vivec, Hall of Justice" num
elseif ( cell == 1069 )
MessageBox "%g. Vivec, Hall of Justice Secret Library" num
elseif ( cell == 1070 )
MessageBox "%g. Vivec, Hall of Wisdom" num
elseif ( cell == 1071 )
MessageBox "%g. Vivec, Hall Underworks" num
elseif ( cell == 1072 )
MessageBox "%g. Vivec, High Fane" num
elseif ( cell == 1073 )
MessageBox "%g. Vivec, Hlaalu Alchemist" num
elseif ( cell == 1074 )
MessageBox "%g. Vivec, Hlaalu Ancestral Vaults" num
elseif ( cell == 1075 )
MessageBox "%g. Vivec, Hlaalu Canalworks" num
elseif ( cell == 1076 )
MessageBox "%g. Vivec, Hlaalu Edryno Arethi's House" num
elseif ( cell == 1077 )
MessageBox "%g. Vivec, Hlaalu General Goods" num
elseif ( cell == 1078 )
MessageBox "%g. Vivec, Hlaalu Pawnbroker" num
elseif ( cell == 1079 )
MessageBox "%g. Vivec, Hlaalu Plaza" num
elseif ( cell == 1080 )
MessageBox "%g. Vivec, Hlaalu Prison Cells" num
elseif ( cell == 1081 )
MessageBox "%g. Vivec, Hlaalu Records" num
elseif ( cell == 1082 )
MessageBox "%g. Vivec, Hlaalu Temple" num
elseif ( cell == 1083 )
MessageBox "%g. Vivec, Hlaalu Treasury" num
elseif ( cell == 1084 )
MessageBox "%g. Vivec, Hlaalu Underworks" num
elseif ( cell == 1085 )
MessageBox "%g. Vivec, Hlaalu Vaults" num
elseif ( cell == 1086 )
MessageBox "%g. Vivec, Hlaalu Waistworks" num
elseif ( cell == 1087 )
MessageBox "%g. Vivec, Hlaalu Weaponsmith" num
elseif ( cell == 1088 )
MessageBox "%g. Vivec, Hlaren Residence" num
elseif ( cell == 1089 )
MessageBox "%g. Vivec, J'Rasha: Healer" num
elseif ( cell == 1090 )
MessageBox "%g. Vivec, Jeanne: Trader" num
elseif ( cell == 1091 )
MessageBox "%g. Vivec, Jobasha's Rare Books" num
elseif ( cell == 1092 )
MessageBox "%g. Vivec, Justice Offices" num
elseif ( cell == 1093 )
MessageBox "%g. Vivec, Library of Vivec" num
elseif ( cell == 1094 )
MessageBox "%g. Vivec, Lucretinaus Olcinius: Trader" num
elseif ( cell == 1095 )
MessageBox "%g. Vivec, Mevel Fererus: Trader" num
elseif ( cell == 1096 )
MessageBox "%g. Vivec, Milo's Quarters" num
elseif ( cell == 1097 )
MessageBox "%g. Vivec, Miun-Gei: Enchanter" num
elseif ( cell == 1098 )
MessageBox "%g. Vivec, No Name Club" num
elseif ( cell == 1099 )
MessageBox "%g. Vivec, Office of the Watch" num
endif

StopScript "vn_Teleport_infoCell_SubB"

End

# vn_Teleport_infoCell_SubC ===================================================
Begin vn_Teleport_infoCell_SubC

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

if ( cell == 1100 )
MessageBox "%g. Vivec, Ordinator Barracks" num
elseif ( cell == 1101 )
MessageBox "%g. Vivec, Palace of Vivec" num
elseif ( cell == 1102 )
MessageBox "%g. Vivec, Puzzle Canal, Center" num
elseif ( cell == 1103 )
MessageBox "%g. Vivec, Puzzle Canal, Level 1" num
elseif ( cell == 1104 )
MessageBox "%g. Vivec, Puzzle Canal, Level 2" num
elseif ( cell == 1105 )
MessageBox "%g. Vivec, Puzzle Canal, Level 3" num
elseif ( cell == 1106 )
MessageBox "%g. Vivec, Puzzle Canal, Level 4" num
elseif ( cell == 1107 )
MessageBox "%g. Vivec, Puzzle Canal, Level 5" num
elseif ( cell == 1108 )
MessageBox "%g. Vivec, Ralen Tilvur: Smith" num
elseif ( cell == 1109 )
MessageBox "%g. Vivec, Redoran Ancestral Vaults" num
elseif ( cell == 1110 )
MessageBox "%g. Vivec, Redoran Canalworks" num
elseif ( cell == 1111 )
MessageBox "%g. Vivec, Redoran Plaza" num
elseif ( cell == 1112 )
MessageBox "%g. Vivec, Redoran Prison Cells" num
elseif ( cell == 1113 )
MessageBox "%g. Vivec, Redoran Records" num
elseif ( cell == 1114 )
MessageBox "%g. Vivec, Redoran Scout & Drillmaster" num
elseif ( cell == 1115 )
MessageBox "%g. Vivec, Redoran Smith" num
elseif ( cell == 1116 )
MessageBox "%g. Vivec, Redoran Temple Shrine" num
elseif ( cell == 1117 )
MessageBox "%g. Vivec, Redoran Trader" num
elseif ( cell == 1118 )
MessageBox "%g. Vivec, Redoran Treasury" num
elseif ( cell == 1119 )
MessageBox "%g. Vivec, Redoran Underworks" num
elseif ( cell == 1120 )
MessageBox "%g. Vivec, Redoran Vaults" num
elseif ( cell == 1121 )
MessageBox "%g. Vivec, Redoran Waistworks" num
elseif ( cell == 1122 )
MessageBox "%g. Vivec, Saren Manor" num
elseif ( cell == 1123 )
MessageBox "%g. Vivec, Simine Fralinie: Bookseller" num
elseif ( cell == 1124 )
MessageBox "%g. Vivec, St. Delyn Canal North-One" num
elseif ( cell == 1125 )
MessageBox "%g. Vivec, St. Delyn Canal North-Three" num
elseif ( cell == 1126 )
MessageBox "%g. Vivec, St. Delyn Canal North-Two" num
elseif ( cell == 1127 )
MessageBox "%g. Vivec, St. Delyn Canal South-One" num
elseif ( cell == 1128 )
MessageBox "%g. Vivec, St. Delyn Canal South-Three" num
elseif ( cell == 1129 )
MessageBox "%g. Vivec, St. Delyn Canal South-Two" num
elseif ( cell == 1130 )
MessageBox "%g. Vivec, St. Delyn Canalworks" num
elseif ( cell == 1131 )
MessageBox "%g. Vivec, St. Delyn Glassworker's Hall" num
elseif ( cell == 1132 )
MessageBox "%g. Vivec, St. Delyn Plaza" num
elseif ( cell == 1133 )
MessageBox "%g. Vivec, St. Delyn Potter's Hall" num
elseif ( cell == 1134 )
MessageBox "%g. Vivec, St. Delyn Storage" num
elseif ( cell == 1135 )
MessageBox "%g. Vivec, St. Delyn Underworks" num
elseif ( cell == 1136 )
MessageBox "%g. Vivec, St. Delyn Waist North-One" num
elseif ( cell == 1137 )
MessageBox "%g. Vivec, St. Delyn Waist North-Two" num
elseif ( cell == 1138 )
MessageBox "%g. Vivec, St. Delyn Waist South-One" num
elseif ( cell == 1139 )
MessageBox "%g. Vivec, St. Delyn Waist South-Two" num
elseif ( cell == 1140 )
MessageBox "%g. Vivec, St. Delyn Waistworks" num
elseif ( cell == 1141 )
MessageBox "%g. Vivec, St. Olms Brewers and Fishmongers Hall" num
elseif ( cell == 1142 )
MessageBox "%g. Vivec, St. Olms Canal North-One" num
elseif ( cell == 1143 )
MessageBox "%g. Vivec, St. Olms Canal North-Three" num
elseif ( cell == 1144 )
MessageBox "%g. Vivec, St. Olms Canal North-Two" num
elseif ( cell == 1145 )
MessageBox "%g. Vivec, St. Olms Canal South-One" num
elseif ( cell == 1146 )
MessageBox "%g. Vivec, St. Olms Canal South-Three" num
elseif ( cell == 1147 )
MessageBox "%g. Vivec, St. Olms Canal South-Two" num
elseif ( cell == 1148 )
MessageBox "%g. Vivec, St. Olms Canalworks" num
elseif ( cell == 1149 )
MessageBox "%g. Vivec, St. Olms Farmers and Laborers Hall" num
elseif ( cell == 1150 )
MessageBox "%g. Vivec, St. Olms Haunted Manor" num
elseif ( cell == 1151 )
MessageBox "%g. Vivec, St. Olms Plaza" num
elseif ( cell == 1152 )
MessageBox "%g. Vivec, St. Olms Storage" num
elseif ( cell == 1153 )
MessageBox "%g. Vivec, St. Olms Tailors and Dyers Hall" num
elseif ( cell == 1154 )
MessageBox "%g. Vivec, St. Olms Tanners and Miners Hall" num
elseif ( cell == 1155 )
MessageBox "%g. Vivec, St. Olms Temple" num
elseif ( cell == 1156 )
MessageBox "%g. Vivec, St. Olms Underworks" num
elseif ( cell == 1157 )
MessageBox "%g. Vivec, St. Olms Upper North-One" num
elseif ( cell == 1158 )
MessageBox "%g. Vivec, St. Olms Upper North-Two" num
elseif ( cell == 1159 )
MessageBox "%g. Vivec, St. Olms Upper South-One" num
elseif ( cell == 1160 )
MessageBox "%g. Vivec, St. Olms Waist North-One" num
elseif ( cell == 1161 )
MessageBox "%g. Vivec, St. Olms Waist North-Two" num
elseif ( cell == 1162 )
MessageBox "%g. Vivec, St. Olms Waist South-One" num
elseif ( cell == 1163 )
MessageBox "%g. Vivec, St. Olms Waist South-Two" num
elseif ( cell == 1164 )
MessageBox "%g. Vivec, St. Olms Waistworks" num
elseif ( cell == 1165 )
MessageBox "%g. Vivec, St. Olms Yngling Manor" num
elseif ( cell == 1166 )
MessageBox "%g. Vivec, St. Olms Yngling Manor Basement" num
elseif ( cell == 1167 )
MessageBox "%g. Vivec, Telvanni Alchemist" num
elseif ( cell == 1168 )
MessageBox "%g. Vivec, Telvanni Apothecary" num
elseif ( cell == 1169 )
MessageBox "%g. Vivec, Telvanni Canalworks" num
elseif ( cell == 1170 )
MessageBox "%g. Vivec, Telvanni Enchanter" num
elseif ( cell == 1171 )
MessageBox "%g. Vivec, Telvanni Mage" num
elseif ( cell == 1172 )
MessageBox "%g. Vivec, Telvanni Monster Lab" num
elseif ( cell == 1173 )
MessageBox "%g. Vivec, Telvanni Plaza" num
elseif ( cell == 1174 )
MessageBox "%g. Vivec, Telvanni Prison Cells" num
elseif ( cell == 1175 )
MessageBox "%g. Vivec, Telvanni Sorcerer" num
elseif ( cell == 1176 )
MessageBox "%g. Vivec, Telvanni Temple" num
elseif ( cell == 1177 )
MessageBox "%g. Vivec, Telvanni Tower" num
elseif ( cell == 1178 )
MessageBox "%g. Vivec, Telvanni Underworks" num
elseif ( cell == 1179 )
MessageBox "%g. Vivec, Telvanni Upper Storage" num
elseif ( cell == 1180 )
MessageBox "%g. Vivec, Telvanni Vault" num
elseif ( cell == 1181 )
MessageBox "%g. Vivec, Telvanni Waistworks" num
elseif ( cell == 1182 )
MessageBox "%g. Vivec, Temporary Telvanni Housing" num
elseif ( cell == 1183 )
MessageBox "%g. Vivec, Tervur Braven: Trader" num
elseif ( cell == 1184 )
MessageBox "%g. Vivec, The Abbey of St. Delyn the Wise" num
elseif ( cell == 1185 )
MessageBox "%g. Vivec, The Flowers of Gold" num
elseif ( cell == 1186 )
MessageBox "%g. Vivec, The Lizard's Head" num
elseif ( cell == 1187 )
MessageBox "%g. Vos, Dreynos Elvul's Farmhouse" num
elseif ( cell == 1188 )
MessageBox "%g. Vos, Fanisea Irano's Farmhouse" num
elseif ( cell == 1189 )
MessageBox "%g. Vos, Ienasa Radas's Farmhouse" num
elseif ( cell == 1190 )
MessageBox "%g. Vos, Maela Kaushad's Farmhouse" num
elseif ( cell == 1191 )
MessageBox "%g. Vos, Mandyn Ralas's Farmhouse" num
elseif ( cell == 1192 )
MessageBox "%g. Vos, Menus Felas's Farmhouse" num
elseif ( cell == 1193 )
MessageBox "%g. Vos, Runethyne Andas's Farmhouse" num
elseif ( cell == 1194 )
MessageBox "%g. Vos, Thilse Aralas's Farmhouse" num
elseif ( cell == 1195 )
MessageBox "%g. Vos, Trilam Drolnor's Farmhouse" num
elseif ( cell == 1196 )
MessageBox "%g. Vos, Ulvil Llothas's Farmhouse" num
elseif ( cell == 1197 )
MessageBox "%g. Vos, Varo Tradehouse" num
elseif ( cell == 1198 )
MessageBox "%g. Vos, Varo Tradehouse Entrance" num
elseif ( cell == 1199 )
MessageBox "%g. Vos, Varo Tradehouse Storage" num
endif

StopScript "vn_Teleport_infoCell_SubC"

End

# vn_Teleport_infoCell_SubD ===================================================
Begin vn_Teleport_infoCell_SubD

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

if ( cell == 1200 )
MessageBox "%g. Vos, Vos Chapel" num
elseif ( cell == 1201 )
MessageBox "%g. Yakanalit" num
elseif ( cell == 1202 )
MessageBox "%g. Yakaridan Camp, Kitbael's Yurt" num
elseif ( cell == 1203 )
MessageBox "%g. Yakin" num
elseif ( cell == 1204 )
MessageBox "%g. Yakin, Shrine" num
elseif ( cell == 1205 )
MessageBox "%g. Yanemus Mine" num
elseif ( cell == 1206 )
MessageBox "%g. Yansirramus, Shrine" num
elseif ( cell == 1207 )
MessageBox "%g. Yasammidan, Shrine" num
elseif ( cell == 1208 )
MessageBox "%g. Yasamsi" num
elseif ( cell == 1209 )
MessageBox "%g. Yassu Mine" num
elseif ( cell == 1210 )
MessageBox "%g. Yesamsi" num
elseif ( cell == 1211 )
MessageBox "%g. Zainab Camp, Ababael Timsar-Dadisun's Yurt" num
elseif ( cell == 1212 )
MessageBox "%g. Zainab Camp, Ashibaal's Yurt" num
elseif ( cell == 1213 )
MessageBox "%g. Zainab Camp, Ashkhan's Yurt" num
elseif ( cell == 1214 )
MessageBox "%g. Zainab Camp, Ashur-Dan's Yurt" num
elseif ( cell == 1215 )
MessageBox "%g. Zainab Camp, Kuda's Yurt" num
elseif ( cell == 1216 )
MessageBox "%g. Zainab Camp, Kummu's Yurt" num
elseif ( cell == 1217 )
MessageBox "%g. Zainab Camp, Minassour's Yurt" num
elseif ( cell == 1218 )
MessageBox "%g. Zainab Camp, Patababi's Yurt" num
elseif ( cell == 1219 )
MessageBox "%g. Zainab Camp, Tussi's Yurt" num
elseif ( cell == 1220 )
MessageBox "%g. Zainab Camp, Wise Woman's Yurt" num
elseif ( cell == 1221 )
MessageBox "%g. Zainsipilu" num
elseif ( cell == 1222 )
MessageBox "%g. Zaintirari" num
elseif ( cell == 1223 )
MessageBox "%g. Zaintiraris, Shrine" num
elseif ( cell == 1224 )
MessageBox "%g. Zalkin Grotto" num
elseif ( cell == 1225 )
MessageBox "%g. Zalkin-Sul Egg Mine" num
elseif ( cell == 1226 )
MessageBox "%g. Zanabi" num
elseif ( cell == 1227 )
MessageBox "%g. Zebabi" num
elseif ( cell == 1228 )
MessageBox "%g. Zenarbael" num
elseif ( cell == 1229 )
MessageBox "%g. Zergonipal, Shrine" num
endif

StopScript "vn_Teleport_infoCell_SubD"

End

# vn_Teleport_infoGrid_Sub1 ===================================================
Begin vn_Teleport_infoGrid_Sub1

short cell
short num
set cell to vn_TeleportCell
set num to vn_TeleportSlot

if ( cell == 1300 )
MessageBox "%g. Outer Regions" num
elseif ( cell == 1301 )
MessageBox "%g. Ahemmusa Camp" num
elseif ( cell == 1302 )
MessageBox "%g. Ald Daedroth" num
elseif ( cell == 1303 )
MessageBox "%g. Ald Redaynia" num
elseif ( cell == 1304 )
MessageBox "%g. Ald Sotha" num
elseif ( cell == 1305 )
MessageBox "%g. Ald Velothi" num
elseif ( cell == 1306 )
MessageBox "%g. Ald-ruhn" num
elseif ( cell == 1307 )
MessageBox "%g. Andasreth" num
elseif ( cell == 1308 )
MessageBox "%g. Arvel Plantation" num
elseif ( cell == 1309 )
MessageBox "%g. Ascadian Isles Region" num
elseif ( cell == 1310 )
MessageBox "%g. Ashalmawia" num
elseif ( cell == 1311 )
MessageBox "%g. Ashlands Region" num
elseif ( cell == 1312 )
MessageBox "%g. Ashurnabitashpi" num
elseif ( cell == 1313 )
MessageBox "%g. Ashurnibibi" num
elseif ( cell == 1314 )
MessageBox "%g. Azura's Coast Region" num
elseif ( cell == 1315 )
MessageBox "%g. Bal Fell" num
elseif ( cell == 1316 )
MessageBox "%g. Bal Isra" num
elseif ( cell == 1317 )
MessageBox "%g. Bal Ur" num
elseif ( cell == 1318 )
MessageBox "%g. Balmora" num
elseif ( cell == 1319 )
MessageBox "%g. Berandas" num
elseif ( cell == 1320 )
MessageBox "%g. Bitter Coast Region" num
elseif ( cell == 1321 )
MessageBox "%g. Buckmoth Legion Fort" num
elseif ( cell == 1322 )
MessageBox "%g. Caldera" num
elseif ( cell == 1323 )
MessageBox "%g. Dagon Fel" num
elseif ( cell == 1324 )
MessageBox "%g. Dagoth Ur" num
elseif ( cell == 1325 )
MessageBox "%g. Dren Plantation" num
elseif ( cell == 1326 )
MessageBox "%g. Ebonheart" num
elseif ( cell == 1327 )
MessageBox "%g. Erabenimsun Camp" num
elseif ( cell == 1328 )
MessageBox "%g. Falasmaryon" num
elseif ( cell == 1329 )
MessageBox "%g. Falensarano" num
elseif ( cell == 1330 )
MessageBox "%g. Fields of Kummu" num
elseif ( cell == 1331 )
MessageBox "%g. Ghostgate" num
elseif ( cell == 1332 )
MessageBox "%g. Gnaar Mok" num
elseif ( cell == 1333 )
MessageBox "%g. Gnisis" num
elseif ( cell == 1334 )
MessageBox "%g. Grazelands Region" num
elseif ( cell == 1335 )
MessageBox "%g. Hla Oad" num
elseif ( cell == 1336 )
MessageBox "%g. Hlormaren" num
elseif ( cell == 1337 )
MessageBox "%g. Holamayan" num
elseif ( cell == 1338 )
MessageBox "%g. Khartag Point" num
elseif ( cell == 1339 )
MessageBox "%g. Khuul" num
elseif ( cell == 1340 )
MessageBox "%g. Koal Cave Entrance" num
elseif ( cell == 1341 )
MessageBox "%g. Kogoruhn" num
elseif ( cell == 1342 )
MessageBox "%g. Maar Gan" num
elseif ( cell == 1343 )
MessageBox "%g. Marandus" num
elseif ( cell == 1344 )
MessageBox "%g. Molag Amur Region" num
elseif ( cell == 1345 )
MessageBox "%g. Molag Mar" num
elseif ( cell == 1346 )
MessageBox "%g. Moonmoth Legion Fort" num
elseif ( cell == 1347 )
MessageBox "%g. Mount Assarnibibi" num
elseif ( cell == 1348 )
MessageBox "%g. Mount Kand" num
elseif ( cell == 1349 )
MessageBox "%g. Mzahnch Ruin" num
elseif ( cell == 1350 )
MessageBox "%g. Mzuleft Ruin" num
elseif ( cell == 1351 )
MessageBox "%g. Nchuleft Ruin" num
elseif ( cell == 1352 )
MessageBox "%g. Nchuleftingth" num
elseif ( cell == 1353 )
MessageBox "%g. Nchurdamz" num
elseif ( cell == 1354 )
MessageBox "%g. Odai Plateau" num
elseif ( cell == 1355 )
MessageBox "%g. Odrosal" num
elseif ( cell == 1356 )
MessageBox "%g. Pelagiad" num
elseif ( cell == 1357 )
MessageBox "%g. Red Mountain Region" num
elseif ( cell == 1358 )
MessageBox "%g. Rotheran" num
elseif ( cell == 1359 )
MessageBox "%g. Sadrith Mora" num
elseif ( cell == 1360 )
MessageBox "%g. Sanctus Shrine" num
elseif ( cell == 1361 )
MessageBox "%g. Seyda Neen" num
elseif ( cell == 1362 )
MessageBox "%g. Sheogorad Region" num
elseif ( cell == 1363 )
MessageBox "%g. Suran" num
elseif ( cell == 1364 )
MessageBox "%g. Tel Aruhn" num
elseif ( cell == 1365 )
MessageBox "%g. Tel Branora" num
elseif ( cell == 1366 )
MessageBox "%g. Tel Fyr" num
elseif ( cell == 1367 )
MessageBox "%g. Tel Mora" num
elseif ( cell == 1368 )
MessageBox "%g. Tel Vos" num
elseif ( cell == 1369 )
MessageBox "%g. Telasero" num
elseif ( cell == 1370 )
MessageBox "%g. Tureynulal" num
elseif ( cell == 1371 )
MessageBox "%g. Urshilaku Camp" num
elseif ( cell == 1372 )
MessageBox "%g. Uvirith's Grave" num
elseif ( cell == 1373 )
MessageBox "%g. Valenvaryon" num
elseif ( cell == 1374 )
MessageBox "%g. Vas" num
elseif ( cell == 1375 )
MessageBox "%g. Vemynal" num
elseif ( cell == 1376 )
MessageBox "%g. Vivec" num
elseif ( cell == 1377 )
MessageBox "%g. Vivec, Arena" num
elseif ( cell == 1378 )
MessageBox "%g. Vivec, Foreign Quarter" num
elseif ( cell == 1379 )
MessageBox "%g. Vivec, Hlaalu" num
elseif ( cell == 1380 )
MessageBox "%g. Vivec, Redoran" num
elseif ( cell == 1381 )
MessageBox "%g. Vivec, St. Delyn" num
elseif ( cell == 1382 )
MessageBox "%g. Vivec, St. Olms" num
elseif ( cell == 1383 )
MessageBox "%g. Vivec, Telvanni" num
elseif ( cell == 1384 )
MessageBox "%g. Vivec, Temple" num
elseif ( cell == 1385 )
MessageBox "%g. Vos" num
elseif ( cell == 1386 )
MessageBox "%g. West Gash Region" num
elseif ( cell == 1387 )
MessageBox "%g. Wolverine Hall" num
elseif ( cell == 1388 )
MessageBox "%g. Yansirramus" num
elseif ( cell == 1389 )
MessageBox "%g. Zainab Camp" num
elseif ( cell == 1390 )
MessageBox "%g. Zaintiraris" num
elseif ( cell == 1391 )
MessageBox "%g. Zergonipal" num
endif

StopScript "vn_Teleport_infoGrid_Sub1"

End

# vn_Teleport_plugin_BloodMoon ================================================
Begin vn_Teleport_plugin_BloodMoon
; This script adds Multiple Marking Support for the areas of BloodMoon
; For historic reasons the info and set cell code is part of the main mod
; For more details on how to build Teleport plugins see Teleport_plugin_skelett script in the main mod.

; nothing to do
if ( vn_TeleportPluginAction <= 0 )
	return
endif

; forbid teleporting
if ( vn_TeleportPluginAction == 6 )
	if ( GetPCCell "Solstheim, Mortrag Glacier: Entry" == 1 )
		set vn_TeleportPluginAction to 0
	elseif ( GetPCCell "Solstheim, Mortrag Glacier: Outer Ring" == 1 )
		set vn_TeleportPluginAction to 0
	elseif ( GetPCCell "Solstheim, Mortrag Glacier: Inner Ring" == 1 )
		set vn_TeleportPluginAction to 0
	elseif ( GetPCCell "Solstheim, Mortrag Glacier: Huntsman's Hall" == 1 )
		set vn_TeleportPluginAction to 0
	endif
	return
endif

; TeleportCell request
if ( vn_TeleportPluginAction == 1 )
; look for regions
if ( GetInterior == 0 )
	if ( GetPCCell "Thirsk" == 1 )
	set vn_TeleportCell to 1499
	elseif ( GetPCCell "Solstheim, Thormoor's Watch" == 1 )
	set vn_TeleportCell to 1498
	elseif ( GetPCCell "Solstheim, Mortrag Glacier" == 1 )
	set vn_TeleportCell to 1497
	elseif ( GetPCCell "Solstheim, Lake Fjalding" == 1 )
	set vn_TeleportCell to 1496
	elseif ( GetPCCell "Solstheim, Hvitkald Peak" == 1 )
	set vn_TeleportCell to 1495
	elseif ( GetPCCell "Solstheim, Hrothmund's Bane" == 1 )
	set vn_TeleportCell to 1494
	elseif ( GetPCCell "Solstheim, Gyldenhul Barrow Entrance" == 1 )
	set vn_TeleportCell to 1493
	elseif ( GetPCCell "Solstheim, Castle Karstaag" == 1 )
	set vn_TeleportCell to 1492
	elseif ( GetPCCell "Solstheim, Brodir Grove" == 1 )
	set vn_TeleportCell to 1491
	elseif ( GetPCCell "Solstheim, Altar of Thrond" == 1 )
	set vn_TeleportCell to 1490
	elseif ( GetPCCell "Skaal Village" == 1 )
	set vn_TeleportCell to 1489
	elseif ( GetPCCell "Raven Rock" == 1 )
	set vn_TeleportCell to 1488	
	elseif ( GetPCCell "Fort Frostmoth" == 1 )
	set vn_TeleportCell to 1487
	elseif ( GetPCCell "Solstheim, Moesring Mountains" == 1 )
	set vn_TeleportCell to 1486
	elseif ( GetPCCell "Solstheim, Isinfier Plains" == 1 )
	set vn_TeleportCell to 1485
	elseif ( GetPCCell "Solstheim, Hirstaang Forest" == 1 )
	set vn_TeleportCell to 1484
	elseif ( GetPCCell "Solstheim, Felsaad Coast Region" == 1 )
	set vn_TeleportCell to 1483
	endif

; look for internal TeleportCells
elseif ( GetPCCell "Vor Lair, Interior" == 1 )
set vn_TeleportCell to 1997
elseif ( GetPCCell "Vor Lair, Chambers of Alta Vor" == 1 )
set vn_TeleportCell to 1996
elseif ( GetPCCell "Solstheim, Varstaad Caves" == 1 )
set vn_TeleportCell to 1995
elseif ( GetPCCell "Solstheim, Valbrandr Barrow" == 1 )
set vn_TeleportCell to 1994
elseif ( GetPCCell "Solstheim, Uncle Sweetshare's Workshop" == 1 )
set vn_TeleportCell to 1993
elseif ( GetPCCell "Solstheim, Ulfgar the Unending's Dwelling" == 1 )
set vn_TeleportCell to 1992
elseif ( GetPCCell "Solstheim, Tombs of Skaalara" == 1 )
set vn_TeleportCell to 1991
elseif ( GetPCCell "Solstheim, Thirsk" == 1 )
set vn_TeleportCell to 1990
elseif ( GetPCCell "Solstheim, Stormpfund Barrow" == 1 )
set vn_TeleportCell to 1989
elseif ( GetPCCell "Solstheim, Stahlman's Gorge" == 1 )
set vn_TeleportCell to 1988
elseif ( GetPCCell "Solstheim, Solvjord" == 1 )
set vn_TeleportCell to 1987
elseif ( GetPCCell "Solstheim, Skygge" == 1 )
set vn_TeleportCell to 1986
elseif ( GetPCCell "Solstheim, Skogsdrake Barrow" == 1 )
set vn_TeleportCell to 1985
elseif ( GetPCCell "Solstheim, Sjobal" == 1 )
set vn_TeleportCell to 1984
elseif ( GetPCCell "Solstheim, Rimhull" == 1 )
set vn_TeleportCell to 1983
elseif ( GetPCCell "Solstheim, Mortrag Glacier: Outer Ring" == 1 )
set vn_TeleportCell to 1982
elseif ( GetPCCell "Solstheim, Mortrag Glacier: Inner Ring" == 1 )
set vn_TeleportCell to 1981
elseif ( GetPCCell "Solstheim, Mortrag Glacier: Huntsman's Hall" == 1 )
set vn_TeleportCell to 1980
elseif ( GetPCCell "Solstheim, Mortrag Glacier: Entry" == 1 )
set vn_TeleportCell to 1979
elseif ( GetPCCell "Solstheim, Lukesturm Barrow" == 1 )
set vn_TeleportCell to 1978
elseif ( GetPCCell "Solstheim, Legge" == 1 )
set vn_TeleportCell to 1977
elseif ( GetPCCell "Solstheim, Lair of the Udyrfrykte" == 1 )
set vn_TeleportCell to 1976
elseif ( GetPCCell "Solstheim, Kolfinna's Dwelling" == 1 )
set vn_TeleportCell to 1975
elseif ( GetPCCell "Solstheim, Kolbjorn Barrow" == 1 )
set vn_TeleportCell to 1974
elseif ( GetPCCell "Solstheim, Kjolver's Dwelling" == 1 )
set vn_TeleportCell to 1973
elseif ( GetPCCell "Solstheim, Kelsedolk Barrow" == 1 )
set vn_TeleportCell to 1972
elseif ( GetPCCell "Solstheim, Jolgeirr Barrow" == 1 )
set vn_TeleportCell to 1971
elseif ( GetPCCell "Solstheim, Hrothmund's Barrow" == 1 )
set vn_TeleportCell to 1970
elseif ( GetPCCell "Solstheim, Himmelhost Barrow" == 1 )
set vn_TeleportCell to 1969
elseif ( GetPCCell "Solstheim, Halls of Penumbra" == 1 )
set vn_TeleportCell to 1968
elseif ( GetPCCell "Solstheim, Gyldenhul Barrow" == 1 )
set vn_TeleportCell to 1967
elseif ( GetPCCell "Solstheim, Gronn" == 1 )
set vn_TeleportCell to 1966
elseif ( GetPCCell "Solstheim, Graring's House" == 1 )
set vn_TeleportCell to 1965
elseif ( GetPCCell "Solstheim, Gloomy Cave" == 1 )
set vn_TeleportCell to 1964
elseif ( GetPCCell "Solstheim, Glenschul's Tomb" == 1 )
set vn_TeleportCell to 1963
elseif ( GetPCCell "Solstheim, Geilir the Mumbling's Dwelling" == 1 )
set vn_TeleportCell to 1962
elseif ( GetPCCell "Solstheim, Gandrung Caverns" == 1 )
set vn_TeleportCell to 1961
elseif ( GetPCCell "Solstheim, Frykte" == 1 )
set vn_TeleportCell to 1960
elseif ( GetPCCell "Solstheim, Frosselmane Barrow" == 1 )
set vn_TeleportCell to 1959
elseif ( GetPCCell "Solstheim, Frossel" == 1 )
set vn_TeleportCell to 1958
elseif ( GetPCCell "Solstheim, Fjell" == 1 )
set vn_TeleportCell to 1957
elseif ( GetPCCell "Solstheim, Eddard Barrow" == 1 )
set vn_TeleportCell to 1956
elseif ( GetPCCell "Solstheim, Domme" == 1 )
set vn_TeleportCell to 1955
elseif ( GetPCCell "Solstheim, Connorflenge Barrow" == 1 )
set vn_TeleportCell to 1954
elseif ( GetPCCell "Solstheim, Chamber of Song" == 1 )
set vn_TeleportCell to 1953
elseif ( GetPCCell "Solstheim, Caves of Fjalding" == 1 )
set vn_TeleportCell to 1952
elseif ( GetPCCell "Solstheim, Cave of Hidden Music" == 1 )
set vn_TeleportCell to 1951
elseif ( GetPCCell "Solstheim, Castle Karstaag, Tower" == 1 )
set vn_TeleportCell to 1950
elseif ( GetPCCell "Solstheim, Castle Karstaag, Throne Room" == 1 )
set vn_TeleportCell to 1949
elseif ( GetPCCell "Solstheim, Castle Karstaag, Karstaag's Chambers" == 1 )
set vn_TeleportCell to 1948
elseif ( GetPCCell "Solstheim, Castle Karstaag, Caverns of Karstaag" == 1 )
set vn_TeleportCell to 1947
elseif ( GetPCCell "Solstheim, Castle Karstaag, Banquet Hall" == 1 )
set vn_TeleportCell to 1946
elseif ( GetPCCell "Solstheim, Bloodskal Barrow" == 1 )
set vn_TeleportCell to 1945
elseif ( GetPCCell "Solstheim, Bjorn" == 1 )
set vn_TeleportCell to 1944
elseif ( GetPCCell "Solstheim, Benkongerike" == 1 )
set vn_TeleportCell to 1943
elseif ( GetPCCell "Solstheim, Aesliip's Lair, Caverns" == 1 )
set vn_TeleportCell to 1942
elseif ( GetPCCell "Solstheim, Aesliip's Lair" == 1 )
set vn_TeleportCell to 1941
elseif ( GetPCCell "Solstheim" == 1 )
set vn_TeleportCell to 1940
elseif ( GetPCCell "Skaal Village, The Greathall" == 1 )
set vn_TeleportCell to 1939
elseif ( GetPCCell "Skaal Village, The Blodskaal's House" == 1 )
set vn_TeleportCell to 1938
elseif ( GetPCCell "Skaal village, Snedbrir the Smith" == 1 )
set vn_TeleportCell to 1937
elseif ( GetPCCell "Skaal Village, Shaman's Hut" == 1 )
set vn_TeleportCell to 1936
elseif ( GetPCCell "Skaal Village, Rigmor's Hut" == 1 )
set vn_TeleportCell to 1935
elseif ( GetPCCell "Skaal Village, Lassnr's House" == 1 )
set vn_TeleportCell to 1934
elseif ( GetPCCell "Skaal Village, Ingmar's House" == 1 )
set vn_TeleportCell to 1933
elseif ( GetPCCell "Skaal Village, Ice-Mane's Hut" == 1 )
set vn_TeleportCell to 1932
elseif ( GetPCCell "Skaal Village, Erna the Quiet's House" == 1 )
set vn_TeleportCell to 1931
elseif ( GetPCCell "Skaal Village, Bronrod the Roarer's House" == 1 )
set vn_TeleportCell to 1930
elseif ( GetPCCell "Raven Rock, Vacant House" == 1 )
set vn_TeleportCell to 1929
elseif ( GetPCCell "Raven Rock, Uryn Maren's House" == 1 )
set vn_TeleportCell to 1928
elseif ( GetPCCell "Raven Rock, Trader" == 1 )
set vn_TeleportCell to 1927
elseif ( GetPCCell "Raven Rock, Supply Ship" == 1 )
set vn_TeleportCell to 1926
elseif ( GetPCCell "Raven Rock, SouthEast Storehouse" == 1 )
set vn_TeleportCell to 1925
elseif ( GetPCCell "Raven Rock, South Storehouse" == 1 )
set vn_TeleportCell to 1924
elseif ( GetPCCell "Raven Rock, Smith" == 1 )
set vn_TeleportCell to 1923
elseif ( GetPCCell "Raven Rock, Seler Favelnim's House" == 1 )
set vn_TeleportCell to 1922
elseif ( GetPCCell "Raven Rock, Sados Relothan's House" == 1 )
set vn_TeleportCell to 1921
elseif ( GetPCCell "Raven Rock, Sabinus Oranius' House" == 1 )
set vn_TeleportCell to 1920
elseif ( GetPCCell "Raven Rock, North Storehouse" == 1 )
set vn_TeleportCell to 1919
elseif ( GetPCCell "Raven Rock, Mine Entrance" == 1 )
set vn_TeleportCell to 1918
elseif ( GetPCCell "Raven Rock, Mine" == 1 )
set vn_TeleportCell to 1917
elseif ( GetPCCell "Raven Rock, Gratian Caerellius' House" == 1 )
set vn_TeleportCell to 1916
elseif ( GetPCCell "Raven Rock, Gidar Verothan's House" == 1 )
set vn_TeleportCell to 1915
elseif ( GetPCCell "Raven Rock, Garnas Uvalen's House" == 1 )
set vn_TeleportCell to 1914
elseif ( GetPCCell "Raven Rock, Factor's Estate" == 1 )
set vn_TeleportCell to 1913
elseif ( GetPCCell "Raven Rock, Bar" == 1 )
set vn_TeleportCell to 1912
elseif ( GetPCCell "Raven Rock, Afer Flaccus' House" == 1 )
set vn_TeleportCell to 1911
elseif ( GetPCCell "Raven Rock, Abandoned Mine Shaft" == 1 )
set vn_TeleportCell to 1910
elseif ( GetPCCell "Mark's Script Testing Cell" == 1 )
set vn_TeleportCell to 1909
elseif ( GetPCCell "Fort Frostmoth, Supply Room" == 1 )
set vn_TeleportCell to 1908
elseif ( GetPCCell "Fort Frostmoth, Prison" == 1 )
set vn_TeleportCell to 1907
elseif ( GetPCCell "Fort Frostmoth, Imperial Cult Shrine" == 1 )
set vn_TeleportCell to 1906
elseif ( GetPCCell "Fort Frostmoth, General Quarters, Upper Level" == 1 )
set vn_TeleportCell to 1905
elseif ( GetPCCell "Fort Frostmoth, General Quarters" == 1 )
set vn_TeleportCell to 1904
elseif ( GetPCCell "Fort Frostmoth, Curtain Wall" == 1 )
set vn_TeleportCell to 1903
elseif ( GetPCCell "Fort Frostmoth, Carius' Chambers" == 1 )
set vn_TeleportCell to 1902
elseif ( GetPCCell "Fort Frostmoth, Armory" == 1 )
set vn_TeleportCell to 1901
elseif ( GetPCCell "Draugr Test" == 1 )
set vn_TeleportCell to 1900
endif
return
endif

End

# vn_Teleport_plugin_Tribunal =================================================
Begin vn_Teleport_plugin_Tribunal
; This script adds Multiple Marking Support for the areas of Tribunal
; For historic reasons the info and set cell code is part of the main mod
; For more details on how to build Teleport plugins see Teleport_plugin_skelett script in the main mod.

; nothing to do
if ( vn_TeleportPluginAction <= 0 )
	return
endif

; forbid teleporting out of "Sotha Sil,"
if ( vn_TeleportPluginAction == 6 )
	if ( GetPCCell "Sotha Sil," == 1 )
		set vn_TeleportPluginAction to 0
	endif
	return
endif

; cell request
if ( vn_TeleportPluginAction == 1 )
if ( GetPCCell "Bamz-Amschend, Skybreak Gallery" == 1 )
set vn_TeleportCell to 234
elseif ( GetPCCell "Bamz-Amschend, Radac's Forge" == 1 )
set vn_TeleportCell to 233
elseif ( GetPCCell "Bamz-Amschend, Passage of Whispers" == 1 )
set vn_TeleportCell to 232
elseif ( GetPCCell "Bamz-Amschend, Passage of the Walker" == 1 )
set vn_TeleportCell to 231
elseif ( GetPCCell "Bamz-Amschend, King's Walk" == 1 )
set vn_TeleportCell to 230
elseif ( GetPCCell "Bamz-Amschend, Hearthfire Hall" == 1 )
set vn_TeleportCell to 229
elseif ( GetPCCell "Bamz-Amschend, Hall of Winds" == 1 )
set vn_TeleportCell to 228
elseif ( GetPCCell "Bamz-Amschend, Hall of Wails" == 1 )
set vn_TeleportCell to 227
elseif ( GetPCCell "Old Mournhold: West Sewers" == 1 )
set vn_TeleportCell to 714
elseif ( GetPCCell "Old Mournhold: Teran Hall, East Bldg" == 1 )
set vn_TeleportCell to 713
elseif ( GetPCCell "Old Mournhold: Teran Hall" == 1 )
set vn_TeleportCell to 712
elseif ( GetPCCell "Old Mournhold: Temple Shrine" == 1 )
set vn_TeleportCell to 711
elseif ( GetPCCell "Old Mournhold: Temple Sewers West" == 1 )
set vn_TeleportCell to 710
elseif ( GetPCCell "Old Mournhold: Temple Sewers East" == 1 )
set vn_TeleportCell to 709
elseif ( GetPCCell "Old Mournhold: Temple Sewers" == 1 )
set vn_TeleportCell to 708
elseif ( GetPCCell "Old Mournhold: Temple Gardens" == 1 )
set vn_TeleportCell to 707
elseif ( GetPCCell "Old Mournhold: Temple Crypt" == 1 )
set vn_TeleportCell to 706
elseif ( GetPCCell "Old Mournhold: Temple Catacombs" == 1 )
set vn_TeleportCell to 705
elseif ( GetPCCell "Old Mournhold: Tears of Amun-Shae" == 1 )
set vn_TeleportCell to 704
elseif ( GetPCCell "Old Mournhold: Residential Sewers" == 1 )
set vn_TeleportCell to 703
elseif ( GetPCCell "Old Mournhold: Residential Ruins" == 1 )
set vn_TeleportCell to 702
elseif ( GetPCCell "Old Mournhold: Palace Sewers" == 1 )
set vn_TeleportCell to 701
elseif ( GetPCCell "Old Mournhold: Moril Manor, North Building" == 1 )
set vn_TeleportCell to 700
elseif ( GetPCCell "Old Mournhold: Moril Manor, East Building" == 1 )
set vn_TeleportCell to 699
elseif ( GetPCCell "Old Mournhold: Moril Manor, Courtyard" == 1 )
set vn_TeleportCell to 698
elseif ( GetPCCell "Old Mournhold: Manor District" == 1 )
set vn_TeleportCell to 697
elseif ( GetPCCell "Old Mournhold: Gedna Relvel's Tomb" == 1 )
set vn_TeleportCell to 696
elseif ( GetPCCell "Old Mournhold: Forgotten Sewer" == 1 )
set vn_TeleportCell to 695
elseif ( GetPCCell "Old Mournhold: City Gate" == 1 )
set vn_TeleportCell to 694
elseif ( GetPCCell "Old Mournhold: Bazaar Sewers" == 1 )
set vn_TeleportCell to 693
elseif ( GetPCCell "Old Mournhold: Battlefield" == 1 )
set vn_TeleportCell to 692
elseif ( GetPCCell "Old Mournhold: Armory Ruins" == 1 )
set vn_TeleportCell to 691
elseif ( GetPCCell "Old Mournhold: Abandoned Passageway" == 1 )
set vn_TeleportCell to 690
elseif ( GetPCCell "Old Mournhold: Abandoned Crypt" == 1 )
set vn_TeleportCell to 689
elseif ( GetPCCell "Norenen-dur, The Wailingdelve" == 1 )
set vn_TeleportCell to 676
elseif ( GetPCCell "Norenen-dur, The Teeth that Gnash" == 1 )
set vn_TeleportCell to 675
elseif ( GetPCCell "Norenen-dur, The Grand Stair" == 1 )
set vn_TeleportCell to 674
elseif ( GetPCCell "Norenen-dur, Citadel of Myn Dhrur" == 1 )
set vn_TeleportCell to 673
elseif ( GetPCCell "Norenen-dur, Basilica of Divine Whispers" == 1 )
set vn_TeleportCell to 672
elseif ( GetPCCell "Norenen-dur" == 1 )
set vn_TeleportCell to 671
elseif ( GetPCCell "Mournhold, Velas Manor" == 1 )
set vn_TeleportCell to 642
elseif ( GetPCCell "Mournhold, Vacant Manor" == 1 )
set vn_TeleportCell to 641
elseif ( GetPCCell "Mournhold, Trader" == 1 )
set vn_TeleportCell to 640
elseif ( GetPCCell "Mournhold, Thendas Manor" == 1 )
set vn_TeleportCell to 639
elseif ( GetPCCell "Mournhold, The Winged Guar" == 1 )
set vn_TeleportCell to 638
elseif ( GetPCCell "Mournhold, Temple Courtyard" == 1 )
set vn_TeleportCell to 637
elseif ( GetPCCell "Mournhold, Secret Office" == 1 )
set vn_TeleportCell to 636
elseif ( GetPCCell "Mournhold, Sadri Manor" == 1 )
set vn_TeleportCell to 635
elseif ( GetPCCell "Mournhold, Royal Palace: Reception Area" == 1 )
set vn_TeleportCell to 634
elseif ( GetPCCell "Mournhold, Royal Palace: Legion Depot" == 1 )
set vn_TeleportCell to 633
elseif ( GetPCCell "Mournhold, Royal Palace: Jail" == 1 )
set vn_TeleportCell to 632
elseif ( GetPCCell "Mournhold, Royal Palace: Imperial Cult Services" == 1 )
set vn_TeleportCell to 631
elseif ( GetPCCell "Mournhold, Royal Palace: Helseth's Chambers" == 1 )
set vn_TeleportCell to 630
elseif ( GetPCCell "Mournhold, Royal Palace: Guards' Quarters" == 1 )
set vn_TeleportCell to 629
elseif ( GetPCCell "Mournhold, Royal Palace: Courtyard" == 1 )
set vn_TeleportCell to 628
elseif ( GetPCCell "Mournhold, Royal Palace: Basement" == 1 )
set vn_TeleportCell to 627
elseif ( GetPCCell "Mournhold, Royal Palace: Barenziah's Chambers" == 1 )
set vn_TeleportCell to 626
elseif ( GetPCCell "Mournhold, Royal Palace Throne Room" == 1 )
set vn_TeleportCell to 625
elseif ( GetPCCell "Mournhold, Royal Palace" == 1 )
set vn_TeleportCell to 624
elseif ( GetPCCell "Mournhold, Plaza Brindisi Dorom" == 1 )
set vn_TeleportCell to 623
elseif ( GetPCCell "Mournhold, Pawnbroker" == 1 )
set vn_TeleportCell to 622
elseif ( GetPCCell "Mournhold, Museum of Artifacts" == 1 )
set vn_TeleportCell to 621
elseif ( GetPCCell "Mournhold, Magic Shop" == 1 )
set vn_TeleportCell to 620
elseif ( GetPCCell "Mournhold, Llethan Manor" == 1 )
set vn_TeleportCell to 619
elseif ( GetPCCell "Mournhold, Ignatius Flaccus' House" == 1 )
set vn_TeleportCell to 618
elseif ( GetPCCell "Mournhold, Great Bazaar" == 1 )
set vn_TeleportCell to 617
elseif ( GetPCCell "Mournhold, Godsreach" == 1 )
set vn_TeleportCell to 616
elseif ( GetPCCell "Mournhold, Geon Auline's House" == 1 )
set vn_TeleportCell to 615
elseif ( GetPCCell "Mournhold, Craftsmen's Hall" == 1 )
set vn_TeleportCell to 614
elseif ( GetPCCell "Mournhold, Clothier" == 1 )
set vn_TeleportCell to 613
elseif ( GetPCCell "Mournhold, Bookseller" == 1 )
set vn_TeleportCell to 612
elseif ( GetPCCell "Mournhold, Armory" == 1 )
set vn_TeleportCell to 611
elseif ( GetPCCell "Mournhold, Andoren Manor" == 1 )
set vn_TeleportCell to 610
elseif ( GetPCCell "Mournhold Temple: Reception Area" == 1 )
set vn_TeleportCell to 609
elseif ( GetPCCell "Mournhold Temple: Office of the Lord Archcanon" == 1 )
set vn_TeleportCell to 608
elseif ( GetPCCell "Mournhold Temple: Infirmary" == 1 )
set vn_TeleportCell to 607
elseif ( GetPCCell "Mournhold Temple: High Chapel" == 1 )
set vn_TeleportCell to 606
elseif ( GetPCCell "Mournhold Temple: Hall of Ministry" == 1 )
set vn_TeleportCell to 605
elseif ( GetPCCell "Mournhold Temple: Basement" == 1 )
set vn_TeleportCell to 604
elseif ( GetPCCell "Mournhold Temple" == 1 )
set vn_TeleportCell to 603
elseif ( GetPCCell "Mournhold" == 1 )
set vn_TeleportCell to 602
elseif ( GetPCCell "Pelagiad, Ignatius Flaccus' House" == 1 )
set vn_TeleportCell to 733
elseif ( GetPCCell "Sotha Sil, Outer Flooded Halls" == 1 )
set vn_TeleportCell to 897
elseif ( GetPCCell "Sotha Sil, Inner Flooded Halls" == 1 )
set vn_TeleportCell to 896
elseif ( GetPCCell "Sotha Sil, Hall of Theuda" == 1 )
set vn_TeleportCell to 895
elseif ( GetPCCell "Sotha Sil, Hall of Sallaemu" == 1 )
set vn_TeleportCell to 894
elseif ( GetPCCell "Sotha Sil, Hall of Mileitho" == 1 )
set vn_TeleportCell to 893
elseif ( GetPCCell "Sotha Sil, Hall of Delirium" == 1 )
set vn_TeleportCell to 892
elseif ( GetPCCell "Sotha Sil, Dome of Udok" == 1 )
set vn_TeleportCell to 891
elseif ( GetPCCell "Sotha Sil, Dome of the Imperfect" == 1 )
set vn_TeleportCell to 890
elseif ( GetPCCell "Sotha Sil, Dome of Sotha Sil" == 1 )
set vn_TeleportCell to 889
elseif ( GetPCCell "Sotha Sil, Dome of Serlyn" == 1 )
set vn_TeleportCell to 888
elseif ( GetPCCell "Sotha Sil, Dome of Kasia" == 1 )
set vn_TeleportCell to 887
elseif ( GetPCCell "Sotha Sil, Chamber of Sohleh" == 1 )
set vn_TeleportCell to 886
elseif ( GetPCCell "Sotha Sil, Central Gearworks" == 1 )
set vn_TeleportCell to 885
elseif ( GetPCCell "Sotha Sil," == 1 )
set vn_TeleportCell to 884
endif
return
endif

End

# vn_Teleport_setCell_BloodMoon ===============================================
Begin vn_Teleport_setCell_BloodMoon

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

if ( cell == 1900 )
Player->PositionCell 0 0 0 0 "Draugr Test"
elseif ( cell == 1901 )
Player->PositionCell 0 0 0 0 "Fort Frostmoth, Armory"
elseif ( cell == 1902 )
Player->PositionCell 0 0 0 0 "Fort Frostmoth, Carius' Chambers"
elseif ( cell == 1903 )
Player->PositionCell 0 0 0 0 "Fort Frostmoth, Curtain Wall"
elseif ( cell == 1904 )
Player->PositionCell 0 0 0 0 "Fort Frostmoth, General Quarters"
elseif ( cell == 1905 )
Player->PositionCell 0 0 0 0 "Fort Frostmoth, General Quarters, Upper Level"
elseif ( cell == 1906 )
Player->PositionCell 0 0 0 0 "Fort Frostmoth, Imperial Cult Shrine"
elseif ( cell == 1907 )
Player->PositionCell 0 0 0 0 "Fort Frostmoth, Prison"
elseif ( cell == 1908 )
Player->PositionCell 0 0 0 0 "Fort Frostmoth, Supply Room"
elseif ( cell == 1909 )
Player->PositionCell 0 0 0 0 "Mark's Script Testing Cell"
elseif ( cell == 1910 )
Player->PositionCell 0 0 0 0 "Raven Rock, Abandoned Mine Shaft"
elseif ( cell == 1911 )
Player->PositionCell 0 0 0 0 "Raven Rock, Afer Flaccus' House"
elseif ( cell == 1912 )
Player->PositionCell 0 0 0 0 "Raven Rock, Bar"
elseif ( cell == 1913 )
Player->PositionCell 0 0 0 0 "Raven Rock, Factor's Estate"
elseif ( cell == 1914 )
Player->PositionCell 0 0 0 0 "Raven Rock, Garnas Uvalen's House"
elseif ( cell == 1915 )
Player->PositionCell 0 0 0 0 "Raven Rock, Gidar Verothan's House"
elseif ( cell == 1916 )
Player->PositionCell 0 0 0 0 "Raven Rock, Gratian Caerellius' House"
elseif ( cell == 1917 )
Player->PositionCell 0 0 0 0 "Raven Rock, Mine"
elseif ( cell == 1918 )
Player->PositionCell 0 0 0 0 "Raven Rock, Mine Entrance"
elseif ( cell == 1919 )
Player->PositionCell 0 0 0 0 "Raven Rock, North Storehouse"
elseif ( cell == 1920 )
Player->PositionCell 0 0 0 0 "Raven Rock, Sabinus Oranius' House"
elseif ( cell == 1921 )
Player->PositionCell 0 0 0 0 "Raven Rock, Sados Relothan's House"
elseif ( cell == 1922 )
Player->PositionCell 0 0 0 0 "Raven Rock, Seler Favelnim's House"
elseif ( cell == 1923 )
Player->PositionCell 0 0 0 0 "Raven Rock, Smith"
elseif ( cell == 1924 )
Player->PositionCell 0 0 0 0 "Raven Rock, South Storehouse"
elseif ( cell == 1925 )
Player->PositionCell 0 0 0 0 "Raven Rock, SouthEast Storehouse"
elseif ( cell == 1926 )
Player->PositionCell 0 0 0 0 "Raven Rock, Supply Ship"
elseif ( cell == 1927 )
Player->PositionCell 0 0 0 0 "Raven Rock, Trader"
elseif ( cell == 1928 )
Player->PositionCell 0 0 0 0 "Raven Rock, Uryn Maren's House"
elseif ( cell == 1929 )
Player->PositionCell 0 0 0 0 "Raven Rock, Vacant House"
elseif ( cell == 1930 )
Player->PositionCell 0 0 0 0 "Skaal Village, Bronrod the Roarer's House"
elseif ( cell == 1931 )
Player->PositionCell 0 0 0 0 "Skaal Village, Erna the Quiet's House"
elseif ( cell == 1932 )
Player->PositionCell 0 0 0 0 "Skaal Village, Ice-Mane's Hut"
elseif ( cell == 1933 )
Player->PositionCell 0 0 0 0 "Skaal Village, Ingmar's House"
elseif ( cell == 1934 )
Player->PositionCell 0 0 0 0 "Skaal Village, Lassnr's House"
elseif ( cell == 1935 )
Player->PositionCell 0 0 0 0 "Skaal Village, Rigmor's Hut"
elseif ( cell == 1936 )
Player->PositionCell 0 0 0 0 "Skaal Village, Shaman's Hut"
elseif ( cell == 1937 )
Player->PositionCell 0 0 0 0 "Skaal village, Snedbrir the Smith"
elseif ( cell == 1938 )
Player->PositionCell 0 0 0 0 "Skaal Village, The Blodskaal's House"
elseif ( cell == 1939 )
Player->PositionCell 0 0 0 0 "Skaal Village, The Greathall"
elseif ( cell == 1940 )
Player->PositionCell 0 0 0 0 "Solstheim"
elseif ( cell == 1941 )
Player->PositionCell 0 0 0 0 "Solstheim, Aesliip's Lair"
elseif ( cell == 1942 )
Player->PositionCell 0 0 0 0 "Solstheim, Aesliip's Lair, Caverns"
elseif ( cell == 1943 )
Player->PositionCell 0 0 0 0 "Solstheim, Benkongerike"
elseif ( cell == 1944 )
Player->PositionCell 0 0 0 0 "Solstheim, Bjorn"
elseif ( cell == 1945 )
Player->PositionCell 0 0 0 0 "Solstheim, Bloodskal Barrow"
elseif ( cell == 1946 )
Player->PositionCell 0 0 0 0 "Solstheim, Castle Karstaag, Banquet Hall"
elseif ( cell == 1947 )
Player->PositionCell 0 0 0 0 "Solstheim, Castle Karstaag, Caverns of Karstaag"
elseif ( cell == 1948 )
Player->PositionCell 0 0 0 0 "Solstheim, Castle Karstaag, Karstaag's Chambers"
elseif ( cell == 1949 )
Player->PositionCell 0 0 0 0 "Solstheim, Castle Karstaag, Throne Room"
elseif ( cell == 1950 )
Player->PositionCell 0 0 0 0 "Solstheim, Castle Karstaag, Tower"
elseif ( cell == 1951 )
Player->PositionCell 0 0 0 0 "Solstheim, Cave of Hidden Music"
elseif ( cell == 1952 )
Player->PositionCell 0 0 0 0 "Solstheim, Caves of Fjalding"
elseif ( cell == 1953 )
Player->PositionCell 0 0 0 0 "Solstheim, Chamber of Song"
elseif ( cell == 1954 )
Player->PositionCell 0 0 0 0 "Solstheim, Connorflenge Barrow"
elseif ( cell == 1955 )
Player->PositionCell 0 0 0 0 "Solstheim, Domme"
elseif ( cell == 1956 )
Player->PositionCell 0 0 0 0 "Solstheim, Eddard Barrow"
elseif ( cell == 1957 )
Player->PositionCell 0 0 0 0 "Solstheim, Fjell"
elseif ( cell == 1958 )
Player->PositionCell 0 0 0 0 "Solstheim, Frossel"
elseif ( cell == 1959 )
Player->PositionCell 0 0 0 0 "Solstheim, Frosselmane Barrow"
elseif ( cell == 1960 )
Player->PositionCell 0 0 0 0 "Solstheim, Frykte"
elseif ( cell == 1961 )
Player->PositionCell 0 0 0 0 "Solstheim, Gandrung Caverns"
elseif ( cell == 1962 )
Player->PositionCell 0 0 0 0 "Solstheim, Geilir the Mumbling's Dwelling"
elseif ( cell == 1963 )
Player->PositionCell 0 0 0 0 "Solstheim, Glenschul's Tomb"
elseif ( cell == 1964 )
Player->PositionCell 0 0 0 0 "Solstheim, Gloomy Cave"
elseif ( cell == 1965 )
Player->PositionCell 0 0 0 0 "Solstheim, Graring's House"
elseif ( cell == 1966 )
Player->PositionCell 0 0 0 0 "Solstheim, Gronn"
elseif ( cell == 1967 )
Player->PositionCell 0 0 0 0 "Solstheim, Gyldenhul Barrow"
elseif ( cell == 1968 )
Player->PositionCell 0 0 0 0 "Solstheim, Halls of Penumbra"
elseif ( cell == 1969 )
Player->PositionCell 0 0 0 0 "Solstheim, Himmelhost Barrow"
elseif ( cell == 1970 )
Player->PositionCell 0 0 0 0 "Solstheim, Hrothmund's Barrow"
elseif ( cell == 1971 )
Player->PositionCell 0 0 0 0 "Solstheim, Jolgeirr Barrow"
elseif ( cell == 1972 )
Player->PositionCell 0 0 0 0 "Solstheim, Kelsedolk Barrow"
elseif ( cell == 1973 )
Player->PositionCell 0 0 0 0 "Solstheim, Kjolver's Dwelling"
elseif ( cell == 1974 )
Player->PositionCell 0 0 0 0 "Solstheim, Kolbjorn Barrow"
elseif ( cell == 1975 )
Player->PositionCell 0 0 0 0 "Solstheim, Kolfinna's Dwelling"
elseif ( cell == 1976 )
Player->PositionCell 0 0 0 0 "Solstheim, Lair of the Udyrfrykte"
elseif ( cell == 1977 )
Player->PositionCell 0 0 0 0 "Solstheim, Legge"
elseif ( cell == 1978 )
Player->PositionCell 0 0 0 0 "Solstheim, Lukesturm Barrow"
elseif ( cell == 1979 )
Player->PositionCell 0 0 0 0 "Solstheim, Mortrag Glacier: Entry"
elseif ( cell == 1980 )
Player->PositionCell 0 0 0 0 "Solstheim, Mortrag Glacier: Huntsman's Hall"
elseif ( cell == 1981 )
Player->PositionCell 0 0 0 0 "Solstheim, Mortrag Glacier: Inner Ring"
elseif ( cell == 1982 )
Player->PositionCell 0 0 0 0 "Solstheim, Mortrag Glacier: Outer Ring"
elseif ( cell == 1983 )
Player->PositionCell 0 0 0 0 "Solstheim, Rimhull"
elseif ( cell == 1984 )
Player->PositionCell 0 0 0 0 "Solstheim, Sjobal"
elseif ( cell == 1985 )
Player->PositionCell 0 0 0 0 "Solstheim, Skogsdrake Barrow"
elseif ( cell == 1986 )
Player->PositionCell 0 0 0 0 "Solstheim, Skygge"
elseif ( cell == 1987 )
Player->PositionCell 0 0 0 0 "Solstheim, Solvjord"
elseif ( cell == 1988 )
Player->PositionCell 0 0 0 0 "Solstheim, Stahlman's Gorge"
elseif ( cell == 1989 )
Player->PositionCell 0 0 0 0 "Solstheim, Stormpfund Barrow"
elseif ( cell == 1990 )
Player->PositionCell 0 0 0 0 "Solstheim, Thirsk"
elseif ( cell == 1991 )
Player->PositionCell 0 0 0 0 "Solstheim, Tombs of Skaalara"
elseif ( cell == 1992 )
Player->PositionCell 0 0 0 0 "Solstheim, Ulfgar the Unending's Dwelling"
elseif ( cell == 1993 )
Player->PositionCell 0 0 0 0 "Solstheim, Uncle Sweetshare's Workshop"
elseif ( cell == 1994 )
Player->PositionCell 0 0 0 0 "Solstheim, Valbrandr Barrow"
elseif ( cell == 1995 )
Player->PositionCell 0 0 0 0 "Solstheim, Varstaad Caves"
elseif ( cell == 1996 )
Player->PositionCell 0 0 0 0 "Vor Lair, Chambers of Alta Vor"
elseif ( cell == 1997 )
Player->PositionCell 0 0 0 0 "Vor Lair, Interior"
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setCell_BloodMoon"

End

# vn_Teleport_setCell_Sub1 ====================================================
Begin vn_Teleport_setCell_Sub1

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

if ( cell == 0 )
Player->PositionCell 0 0 0 0 "Abaelun Mine"
elseif ( cell == 1 )
Player->PositionCell 0 0 0 0 "Abaesen-Pulu Egg Mine"
elseif ( cell == 2 )
Player->PositionCell 0 0 0 0 "Abanabi"
elseif ( cell == 3 )
Player->PositionCell 0 0 0 0 "Abandoned Shipwreck, Cabin"
elseif ( cell == 4 )
Player->PositionCell 0 0 0 0 "Abandoned Shipwreck, Lower Level"
elseif ( cell == 5 )
Player->PositionCell 0 0 0 0 "Abandoned Shipwreck, Upper Level"
elseif ( cell == 6 )
Player->PositionCell 0 0 0 0 "Abebaal Egg Mine"
elseif ( cell == 7 )
Player->PositionCell 0 0 0 0 "Abernanit"
elseif ( cell == 8 )
Player->PositionCell 0 0 0 0 "Abinabi"
elseif ( cell == 9 )
Player->PositionCell 0 0 0 0 "Adanumuran"
elseif ( cell == 10 )
Player->PositionCell 0 0 0 0 "Addadshashanammu, Shrine"
elseif ( cell == 11 )
Player->PositionCell 0 0 0 0 "Addamasartus"
elseif ( cell == 12 )
Player->PositionCell 0 0 0 0 "Ahallaraddon Egg Mine"
elseif ( cell == 13 )
Player->PositionCell 0 0 0 0 "Ahanibi-Malmus Egg Mine"
elseif ( cell == 14 )
Player->PositionCell 0 0 0 0 "Aharasaplit Camp, Zallay's Yurt"
elseif ( cell == 15 )
Player->PositionCell 0 0 0 0 "Aharnabi"
elseif ( cell == 16 )
Player->PositionCell 0 0 0 0 "Aharunartus"
elseif ( cell == 17 )
Player->PositionCell 0 0 0 0 "Ahemmusa Camp, Addammus's Yurt"
elseif ( cell == 18 )
Player->PositionCell 0 0 0 0 "Ahemmusa Camp, Ashkhan's Yurt"
elseif ( cell == 19 )
Player->PositionCell 0 0 0 0 "Ahemmusa Camp, Assamma-Idan's Yurt"
elseif ( cell == 20 )
Player->PositionCell 0 0 0 0 "Ahemmusa Camp, Dutadalk's Yurt"
elseif ( cell == 21 )
Player->PositionCell 0 0 0 0 "Ahemmusa Camp, Kausi's Yurt"
elseif ( cell == 22 )
Player->PositionCell 0 0 0 0 "Ahemmusa Camp, Lanabi's Yurt"
elseif ( cell == 23 )
Player->PositionCell 0 0 0 0 "Ahemmusa Camp, Mamaea's Yurt"
elseif ( cell == 24 )
Player->PositionCell 0 0 0 0 "Ahemmusa Camp, Nummu's Yurt"
elseif ( cell == 25 )
Player->PositionCell 0 0 0 0 "Ahemmusa Camp, Wise Woman's Yurt"
elseif ( cell == 26 )
Player->PositionCell 0 0 0 0 "Ahinipalit"
elseif ( cell == 27 )
Player->PositionCell 0 0 0 0 "Aidanat Camp, Abassel's Yurt"
elseif ( cell == 28 )
Player->PositionCell 0 0 0 0 "Ainab"
elseif ( cell == 29 )
Player->PositionCell 0 0 0 0 "Ainab, Shrine"
elseif ( cell == 30 )
Player->PositionCell 0 0 0 0 "Ainat"
elseif ( cell == 31 )
Player->PositionCell 0 0 0 0 "Akimaes Grotto"
elseif ( cell == 32 )
Player->PositionCell 0 0 0 0 "Akimaes-Ilanipu Egg Mine"
elseif ( cell == 33 )
Player->PositionCell 0 0 0 0 "Akulakhan's Chamber"
elseif ( cell == 34 )
Player->PositionCell 0 0 0 0 "Alas Ancestral Tomb"
elseif ( cell == 35 )
Player->PositionCell 0 0 0 0 "Ald Daedroth, Antechamber"
elseif ( cell == 36 )
Player->PositionCell 0 0 0 0 "Ald Daedroth, Inner Shrine"
elseif ( cell == 37 )
Player->PositionCell 0 0 0 0 "Ald Daedroth, Left Wing"
elseif ( cell == 38 )
Player->PositionCell 0 0 0 0 "Ald Daedroth, Outer Shrine"
elseif ( cell == 39 )
Player->PositionCell 0 0 0 0 "Ald Daedroth, Right Wing"
elseif ( cell == 40 )
Player->PositionCell 0 0 0 0 "Ald Redaynia, Tower"
elseif ( cell == 41 )
Player->PositionCell 0 0 0 0 "Ald Sotha, Lower Level"
elseif ( cell == 42 )
Player->PositionCell 0 0 0 0 "Ald Sotha, Shrine"
elseif ( cell == 43 )
Player->PositionCell 0 0 0 0 "Ald Sotha, Upper Level"
elseif ( cell == 44 )
Player->PositionCell 0 0 0 0 "Ald Velothi, Fevila Bethrano's Shack"
elseif ( cell == 45 )
Player->PositionCell 0 0 0 0 "Ald Velothi, Ganus Lloryn's Shack"
elseif ( cell == 46 )
Player->PositionCell 0 0 0 0 "Ald Velothi, Ienas Arvel's Shack"
elseif ( cell == 47 )
Player->PositionCell 0 0 0 0 "Ald Velothi, Lledsea Relas's Shack"
elseif ( cell == 48 )
Player->PositionCell 0 0 0 0 "Ald Velothi, Llerar Vinden's Shack"
elseif ( cell == 49 )
Player->PositionCell 0 0 0 0 "Ald Velothi, Outpost"
elseif ( cell == 50 )
Player->PositionCell 0 0 0 0 "Ald Velothi, Sathas Rivul's Shack"
elseif ( cell == 51 )
Player->PositionCell 0 0 0 0 "Ald Velothi, Vireveri Darethran's Shack"
elseif ( cell == 52 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Ald Skar Inn"
elseif ( cell == 53 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Arobar Guard Quarters"
elseif ( cell == 54 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Arobar Manor Bedrooms"
elseif ( cell == 55 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Arobar Manor Entrance"
elseif ( cell == 56 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Arobar Private Quarters"
elseif ( cell == 57 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Aryni Orethi's House"
elseif ( cell == 58 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Bevene Releth: Clothier"
elseif ( cell == 59 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Bivale Teneran: Clothier"
elseif ( cell == 60 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Boldrisa Andrano's House"
elseif ( cell == 61 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Braynas Hlervu's House"
elseif ( cell == 62 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Cienne Sintieve: Alchemist"
elseif ( cell == 63 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Codus Callonus: Bookseller"
elseif ( cell == 64 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Council Club"
elseif ( cell == 65 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Council Hostel"
elseif ( cell == 66 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Dandera Selaro: Smith"
elseif ( cell == 67 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Daynes Redothril: Pawnbroker"
elseif ( cell == 68 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Dravasa Andrethi's House"
elseif ( cell == 69 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Drinar Varyon's House"
elseif ( cell == 70 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Galsa Gindu's House"
elseif ( cell == 71 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Galthragoth's House"
elseif ( cell == 72 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Gildan's House"
elseif ( cell == 73 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Gindrala Hleran's House"
elseif ( cell == 74 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Goras Andrelo's House"
elseif ( cell == 75 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Guard Tower 1"
elseif ( cell == 76 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Guard Tower 2"
elseif ( cell == 77 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Guild of Fighters"
elseif ( cell == 78 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Guild of Mages"
elseif ( cell == 79 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Guls Llervu's House"
elseif ( cell == 80 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Hanarai Assutlanipal's House"
elseif ( cell == 81 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Ienas Sarandas's House"
elseif ( cell == 82 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Ilmiril's House"
elseif ( cell == 83 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Llether Vari: Enchanter"
elseif ( cell == 84 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Llethri Guard Quarters"
elseif ( cell == 85 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Llethri Manor Bedrooms"
elseif ( cell == 86 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Llethri Manor Entrance"
elseif ( cell == 87 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Llethri Private Quarters"
elseif ( cell == 88 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Malpenix Blonia: Trader"
elseif ( cell == 89 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Manor District"
elseif ( cell == 90 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Morag Tong Guildhall"
elseif ( cell == 91 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Morvayn Quarters"
elseif ( cell == 92 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Pellecia Aurrus's House"
elseif ( cell == 93 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Practice Room"
elseif ( cell == 94 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Ramoran Manor"
elseif ( cell == 95 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Ramoran Private Quarters"
elseif ( cell == 96 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Redoran Council Entrance"
elseif ( cell == 97 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Redoran Council Hall"
elseif ( cell == 98 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Sarethi Guard Quarters"
elseif ( cell == 99 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Sarethi Manor"
elseif ( cell == 100 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Tauryon's House"
elseif ( cell == 101 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Temple"
elseif ( cell == 102 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, The Rat In The Pot"
elseif ( cell == 103 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Tiras Sadus: General Merchandise"
elseif ( cell == 104 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Tuveso Beleth: Smith"
elseif ( cell == 105 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Venim Manor Bedrooms"
elseif ( cell == 106 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Venim Manor Entrance"
elseif ( cell == 107 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Venim Manor Guard Quarters"
elseif ( cell == 108 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Venim Manor Private Quarters"
elseif ( cell == 109 )
Player->PositionCell 0 0 0 0 "Ald-ruhn, Venim Manor Right Wing"
elseif ( cell == 110 )
Player->PositionCell 0 0 0 0 "Aleft"
elseif ( cell == 111 )
Player->PositionCell 0 0 0 0 "Alen Ancestral Tomb"
elseif ( cell == 112 )
Player->PositionCell 0 0 0 0 "Almurbalarammi, Shrine"
elseif ( cell == 113 )
Player->PositionCell 0 0 0 0 "Alof's Farmhouse"
elseif ( cell == 114 )
Player->PositionCell 0 0 0 0 "An Abandoned Shack"
elseif ( cell == 115 )
Player->PositionCell 0 0 0 0 "Ancient Shipwreck, Cabin"
elseif ( cell == 116 )
Player->PositionCell 0 0 0 0 "Ancient Shipwreck, Lower Level"
elseif ( cell == 117 )
Player->PositionCell 0 0 0 0 "Ancient Shipwreck, Upper Level"
elseif ( cell == 118 )
Player->PositionCell 0 0 0 0 "Andalen Ancestral Tomb"
elseif ( cell == 119 )
Player->PositionCell 0 0 0 0 "Andalor Ancestral Tomb"
elseif ( cell == 120 )
Player->PositionCell 0 0 0 0 "Andas Ancestral Tomb"
elseif ( cell == 121 )
Player->PositionCell 0 0 0 0 "Andasreth, Lower Level"
elseif ( cell == 122 )
Player->PositionCell 0 0 0 0 "Andasreth, Propylon Chamber"
elseif ( cell == 123 )
Player->PositionCell 0 0 0 0 "Andasreth, Upper Level"
elseif ( cell == 124 )
Player->PositionCell 0 0 0 0 "Andavel Ancestral Tomb"
elseif ( cell == 125 )
Player->PositionCell 0 0 0 0 "Andrano Ancestral Tomb"
elseif ( cell == 126 )
Player->PositionCell 0 0 0 0 "Andrethi Ancestral Tomb"
elseif ( cell == 127 )
Player->PositionCell 0 0 0 0 "Andules Ancestral Tomb"
elseif ( cell == 128 )
Player->PositionCell 0 0 0 0 "Ansi"
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setCell_Sub1"

End

# vn_Teleport_setCell_Sub2 ====================================================
Begin vn_Teleport_setCell_Sub2

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

if ( cell == 128 )
Player->PositionCell 0 0 0 0 "Ansi"
elseif ( cell == 129 )
Player->PositionCell 0 0 0 0 "Aralen Ancestral Tomb"
elseif ( cell == 130 )
Player->PositionCell 0 0 0 0 "Aran Ancestral Tomb"
elseif ( cell == 131 )
Player->PositionCell 0 0 0 0 "Arano Ancestral Tomb"
elseif ( cell == 132 )
Player->PositionCell 0 0 0 0 "Arano Plantation"
elseif ( cell == 133 )
Player->PositionCell 0 0 0 0 "Arenim Ancestral Tomb"
elseif ( cell == 134 )
Player->PositionCell 0 0 0 0 "Arethan Ancestral Tomb"
elseif ( cell == 135 )
Player->PositionCell 0 0 0 0 "Arkngthand, Cells of Hollow Hand"
elseif ( cell == 136 )
Player->PositionCell 0 0 0 0 "Arkngthand, Deep Ore Passage"
elseif ( cell == 137 )
Player->PositionCell 0 0 0 0 "Arkngthand, Hall of Centrifuge"
elseif ( cell == 138 )
Player->PositionCell 0 0 0 0 "Arkngthand, Heaven's Gallery"
elseif ( cell == 139 )
Player->PositionCell 0 0 0 0 "Arkngthand, Land's Blood Gallery"
elseif ( cell == 140 )
Player->PositionCell 0 0 0 0 "Arkngthand, Weepingbell Hall"
elseif ( cell == 141 )
Player->PositionCell 0 0 0 0 "Arkngthunch-Sturdumz"
elseif ( cell == 142 )
Player->PositionCell 0 0 0 0 "Arrow, Cabin"
elseif ( cell == 143 )
Player->PositionCell 0 0 0 0 "Arrow, Lower Level"
elseif ( cell == 144 )
Player->PositionCell 0 0 0 0 "Arrow, Upper Level"
elseif ( cell == 145 )
Player->PositionCell 0 0 0 0 "Arvel Manor"
elseif ( cell == 146 )
Player->PositionCell 0 0 0 0 "Arvel Manor, Slave Shack"
elseif ( cell == 147 )
Player->PositionCell 0 0 0 0 "Arvel Manor, Slavemaster's Shack"
elseif ( cell == 148 )
Player->PositionCell 0 0 0 0 "Arvel Manor, Storage Shack"
elseif ( cell == 149 )
Player->PositionCell 0 0 0 0 "Aryon Ancestral Tomb"
elseif ( cell == 150 )
Player->PositionCell 0 0 0 0 "Arys Ancestral Tomb"
elseif ( cell == 151 )
Player->PositionCell 0 0 0 0 "Asha-Ahhe Egg Mine"
elseif ( cell == 152 )
Player->PositionCell 0 0 0 0 "Ashalmawia, Shrine"
elseif ( cell == 153 )
Player->PositionCell 0 0 0 0 "Ashalmawia, Shrine, Sunken Vaults"
elseif ( cell == 154 )
Player->PositionCell 0 0 0 0 "Ashalmimilkala, Shrine"
elseif ( cell == 155 )
Player->PositionCell 0 0 0 0 "Ashamanu Camp, Kausha's Yurt"
elseif ( cell == 156 )
Player->PositionCell 0 0 0 0 "Ashanammu"
elseif ( cell == 157 )
Player->PositionCell 0 0 0 0 "Ashimanu Egg Mine"
elseif ( cell == 158 )
Player->PositionCell 0 0 0 0 "Ashimanu Egg Mine, Queen's Lair"
elseif ( cell == 159 )
Player->PositionCell 0 0 0 0 "Ashinabi"
elseif ( cell == 160 )
Player->PositionCell 0 0 0 0 "Ashinabi, Smuggler Den"
elseif ( cell == 161 )
Player->PositionCell 0 0 0 0 "Ashir-Dan"
elseif ( cell == 162 )
Player->PositionCell 0 0 0 0 "Ashirbadon"
elseif ( cell == 163 )
Player->PositionCell 0 0 0 0 "Ashmelech"
elseif ( cell == 164 )
Player->PositionCell 0 0 0 0 "Ashunartes, Shrine"
elseif ( cell == 165 )
Player->PositionCell 0 0 0 0 "Ashurnibibi, Shrine"
elseif ( cell == 166 )
Player->PositionCell 0 0 0 0 "Assalkushalit, Shrine"
elseif ( cell == 167 )
Player->PositionCell 0 0 0 0 "Assarnatamat, Shrine"
elseif ( cell == 168 )
Player->PositionCell 0 0 0 0 "Assarnud"
elseif ( cell == 169 )
Player->PositionCell 0 0 0 0 "Assemanu"
elseif ( cell == 170 )
Player->PositionCell 0 0 0 0 "Assemanu, Shrine"
elseif ( cell == 171 )
Player->PositionCell 0 0 0 0 "Assernerairan, Shrine"
elseif ( cell == 172 )
Player->PositionCell 0 0 0 0 "Assu"
elseif ( cell == 173 )
Player->PositionCell 0 0 0 0 "Assumanu"
elseif ( cell == 174 )
Player->PositionCell 0 0 0 0 "Assurdirapal, Inner Shrine"
elseif ( cell == 175 )
Player->PositionCell 0 0 0 0 "Assurdirapal, Shrine"
elseif ( cell == 176 )
Player->PositionCell 0 0 0 0 "Assurnabitashpi"
elseif ( cell == 177 )
Player->PositionCell 0 0 0 0 "Assurnabitashpi, Shrine"
elseif ( cell == 178 )
Player->PositionCell 0 0 0 0 "Bal Fell, East Wing"
elseif ( cell == 179 )
Player->PositionCell 0 0 0 0 "Bal Fell, Inner Shrine"
elseif ( cell == 180 )
Player->PositionCell 0 0 0 0 "Bal Fell, Outer Shrine"
elseif ( cell == 181 )
Player->PositionCell 0 0 0 0 "Bal Fell, West Wing"
elseif ( cell == 182 )
Player->PositionCell 0 0 0 0 "Bal Ur, Shrine"
elseif ( cell == 183 )
Player->PositionCell 0 0 0 0 "Bal Ur, Underground"
elseif ( cell == 184 )
Player->PositionCell 0 0 0 0 "Balmora, Astius Hanotepelus' House"
elseif ( cell == 185 )
Player->PositionCell 0 0 0 0 "Balmora, Balyn Omarel's House"
elseif ( cell == 186 )
Player->PositionCell 0 0 0 0 "Balmora, Caius Cosades' House"
elseif ( cell == 187 )
Player->PositionCell 0 0 0 0 "Balmora, Clagius Clanler: Outfitter"
elseif ( cell == 188 )
Player->PositionCell 0 0 0 0 "Balmora, Council Club"
elseif ( cell == 189 )
Player->PositionCell 0 0 0 0 "Balmora, Dorisa Darvel: Bookseller"
elseif ( cell == 190 )
Player->PositionCell 0 0 0 0 "Balmora, Dralasa Nithryon: Pawnbroker"
elseif ( cell == 191 )
Player->PositionCell 0 0 0 0 "Balmora, Dralcea Arethi's House"
elseif ( cell == 192 )
Player->PositionCell 0 0 0 0 "Balmora, Dralosa Athren's House"
elseif ( cell == 193 )
Player->PositionCell 0 0 0 0 "Balmora, Drarayne Thelas' House"
elseif ( cell == 194 )
Player->PositionCell 0 0 0 0 "Balmora, Drarayne Thelas' Storage"
elseif ( cell == 195 )
Player->PositionCell 0 0 0 0 "Balmora, Dura gra-Bol's House"
elseif ( cell == 196 )
Player->PositionCell 0 0 0 0 "Balmora, Eastern Guard Tower"
elseif ( cell == 197 )
Player->PositionCell 0 0 0 0 "Balmora, Eight Plates"
elseif ( cell == 198 )
Player->PositionCell 0 0 0 0 "Balmora, Fast Eddie's House"
elseif ( cell == 199 )
Player->PositionCell 0 0 0 0 "Balmora, Guild of Fighters"
elseif ( cell == 200 )
Player->PositionCell 0 0 0 0 "Balmora, Guild of Mages"
elseif ( cell == 201 )
Player->PositionCell 0 0 0 0 "Balmora, Hecerinde's House"
elseif ( cell == 202 )
Player->PositionCell 0 0 0 0 "Balmora, Hlaalo Manor"
elseif ( cell == 203 )
Player->PositionCell 0 0 0 0 "Balmora, Hlaalu Council Manor"
elseif ( cell == 204 )
Player->PositionCell 0 0 0 0 "Balmora, Itan's House"
elseif ( cell == 205 )
Player->PositionCell 0 0 0 0 "Balmora, Karlirah's House"
elseif ( cell == 206 )
Player->PositionCell 0 0 0 0 "Balmora, Lucky Lockup"
elseif ( cell == 207 )
Player->PositionCell 0 0 0 0 "Balmora, Meldor: Armorer"
elseif ( cell == 208 )
Player->PositionCell 0 0 0 0 "Balmora, Milie Hastien: Fine Clothier"
elseif ( cell == 209 )
Player->PositionCell 0 0 0 0 "Balmora, Morag Tong Guild"
elseif ( cell == 210 )
Player->PositionCell 0 0 0 0 "Balmora, Nalcarya of White Haven: Fine Alchemist"
elseif ( cell == 211 )
Player->PositionCell 0 0 0 0 "Balmora, Nerano Manor"
elseif ( cell == 212 )
Player->PositionCell 0 0 0 0 "Balmora, Nine Toes' House"
elseif ( cell == 213 )
Player->PositionCell 0 0 0 0 "Balmora, Ra'Virr: Trader"
elseif ( cell == 214 )
Player->PositionCell 0 0 0 0 "Balmora, Rarayn Radarys' House"
elseif ( cell == 215 )
Player->PositionCell 0 0 0 0 "Balmora, Rithleen's House"
elseif ( cell == 216 )
Player->PositionCell 0 0 0 0 "Balmora, South Wall Cornerclub"
elseif ( cell == 217 )
Player->PositionCell 0 0 0 0 "Balmora, Temple"
elseif ( cell == 218 )
Player->PositionCell 0 0 0 0 "Balmora, The Razor Hole"
elseif ( cell == 219 )
Player->PositionCell 0 0 0 0 "Balmora, Tsiya's House"
elseif ( cell == 220 )
Player->PositionCell 0 0 0 0 "Balmora, Tyermaillin's House"
elseif ( cell == 221 )
Player->PositionCell 0 0 0 0 "Balmora, Tyravel Manor"
elseif ( cell == 222 )
Player->PositionCell 0 0 0 0 "Balmora, Vorar Helas' House"
elseif ( cell == 223 )
Player->PositionCell 0 0 0 0 "Balmora, Vori's House"
elseif ( cell == 224 )
Player->PositionCell 0 0 0 0 "Balmora, Western Guard Tower North"
elseif ( cell == 225 )
Player->PositionCell 0 0 0 0 "Balmora, Western Guard Tower South"
elseif ( cell == 226 )
Player->PositionCell 0 0 0 0 "Balur's Farmhouse"
elseif ( cell == 227 )
Player->PositionCell 0 0 0 0 "Bamz-Amschend, Hall of Wails"
elseif ( cell == 228 )
Player->PositionCell 0 0 0 0 "Bamz-Amschend, Hall of Winds"
elseif ( cell == 229 )
Player->PositionCell 0 0 0 0 "Bamz-Amschend, Hearthfire Hall"
elseif ( cell == 230 )
Player->PositionCell 0 0 0 0 "Bamz-Amschend, King's Walk"
elseif ( cell == 231 )
Player->PositionCell 0 0 0 0 "Bamz-Amschend, Passage of the Walker"
elseif ( cell == 232 )
Player->PositionCell 0 0 0 0 "Bamz-Amschend, Passage of Whispers"
elseif ( cell == 233 )
Player->PositionCell 0 0 0 0 "Bamz-Amschend, Radac's Forge"
elseif ( cell == 234 )
Player->PositionCell 0 0 0 0 "Bamz-Amschend, Skybreak Gallery"
elseif ( cell == 235 )
Player->PositionCell 0 0 0 0 "Band Egg Mine"
elseif ( cell == 236 )
Player->PositionCell 0 0 0 0 "Baram Ancestral Tomb"
elseif ( cell == 237 )
Player->PositionCell 0 0 0 0 "Bensamsi"
elseif ( cell == 238 )
Player->PositionCell 0 0 0 0 "Bensiberib Camp, Odaishah's Yurt"
elseif ( cell == 239 )
Player->PositionCell 0 0 0 0 "Beran Ancestral Tomb"
elseif ( cell == 240 )
Player->PositionCell 0 0 0 0 "Berandas, Keep, Bottom Level"
elseif ( cell == 241 )
Player->PositionCell 0 0 0 0 "Berandas, Keep, Top Level"
elseif ( cell == 242 )
Player->PositionCell 0 0 0 0 "Berandas, Propylon Chamber"
elseif ( cell == 243 )
Player->PositionCell 0 0 0 0 "Berandas, Underground"
elseif ( cell == 244 )
Player->PositionCell 0 0 0 0 "Beshara"
elseif ( cell == 245 )
Player->PositionCell 0 0 0 0 "Big Head's Shack"
elseif ( cell == 246 )
Player->PositionCell 0 0 0 0 "Bthanchend"
elseif ( cell == 247 )
Player->PositionCell 0 0 0 0 "Bthuand"
elseif ( cell == 248 )
Player->PositionCell 0 0 0 0 "Bthungthumz"
elseif ( cell == 249 )
Player->PositionCell 0 0 0 0 "Buckmoth Legion Fort, Interior"
elseif ( cell == 250 )
Player->PositionCell 0 0 0 0 "Buckmoth Legion Fort, Prison"
elseif ( cell == 251 )
Player->PositionCell 0 0 0 0 "Buckmoth Legion Fort, Towers"
elseif ( cell == 252 )
Player->PositionCell 0 0 0 0 "Caldera Mine"
elseif ( cell == 253 )
Player->PositionCell 0 0 0 0 "Caldera, Bashuk gra-Bat's House"
elseif ( cell == 254 )
Player->PositionCell 0 0 0 0 "Caldera, Canodia Felannus' House"
elseif ( cell == 255 )
Player->PositionCell 0 0 0 0 "Caldera, Dro'Shavir's House"
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setCell_Sub2"

End

# vn_Teleport_setCell_Sub3 ====================================================
Begin vn_Teleport_setCell_Sub3

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

if ( cell == 256 )
Player->PositionCell 0 0 0 0 "Caldera, Elmussa Damori's House"
elseif ( cell == 257 )
Player->PositionCell 0 0 0 0 "Caldera, Falanaamo: Clothier"
elseif ( cell == 258 )
Player->PositionCell 0 0 0 0 "Caldera, Ghorak Manor"
elseif ( cell == 259 )
Player->PositionCell 0 0 0 0 "Caldera, Governor's Hall"
elseif ( cell == 260 )
Player->PositionCell 0 0 0 0 "Caldera, Guild of Mages"
elseif ( cell == 261 )
Player->PositionCell 0 0 0 0 "Caldera, Hodlismod: Armorer"
elseif ( cell == 262 )
Player->PositionCell 0 0 0 0 "Caldera, Irgola: Pawnbroker"
elseif ( cell == 263 )
Player->PositionCell 0 0 0 0 "Caldera, Keel-Raniur's House"
elseif ( cell == 264 )
Player->PositionCell 0 0 0 0 "Caldera, Mining Bunkhouse"
elseif ( cell == 265 )
Player->PositionCell 0 0 0 0 "Caldera, Mining Company Office"
elseif ( cell == 266 )
Player->PositionCell 0 0 0 0 "Caldera, Mining Guard Tower"
elseif ( cell == 267 )
Player->PositionCell 0 0 0 0 "Caldera, Nedhelas' House"
elseif ( cell == 268 )
Player->PositionCell 0 0 0 0 "Caldera, North Guard Towers"
elseif ( cell == 269 )
Player->PositionCell 0 0 0 0 "Caldera, Odairan Ashummi-Ammus' House"
elseif ( cell == 270 )
Player->PositionCell 0 0 0 0 "Caldera, Shenk's Shovel"
elseif ( cell == 271 )
Player->PositionCell 0 0 0 0 "Caldera, Slave Shack One"
elseif ( cell == 272 )
Player->PositionCell 0 0 0 0 "Caldera, Slave Shack Two"
elseif ( cell == 273 )
Player->PositionCell 0 0 0 0 "Caldera, South Guard Towers"
elseif ( cell == 274 )
Player->PositionCell 0 0 0 0 "Caldera, Surane Leoriane's House"
elseif ( cell == 275 )
Player->PositionCell 0 0 0 0 "Caldera, Valvius Mevureius' House"
elseif ( cell == 276 )
Player->PositionCell 0 0 0 0 "Caldera, Verick Gemain: Trader"
elseif ( cell == 277 )
Player->PositionCell 0 0 0 0 "Cavern of the Incarnate"
elseif ( cell == 278 )
Player->PositionCell 0 0 0 0 "Character Stuff Wonderland"
elseif ( cell == 279 )
Player->PositionCell 0 0 0 0 "Chun-Ook, Cabin"
elseif ( cell == 280 )
Player->PositionCell 0 0 0 0 "Chun-Ook, Lower Level"
elseif ( cell == 281 )
Player->PositionCell 0 0 0 0 "Chun-Ook, Upper Level"
elseif ( cell == 282 )
Player->PositionCell 0 0 0 0 "Clutter Warehouse - Everything Must Go!"
elseif ( cell == 283 )
Player->PositionCell 0 0 0 0 "Corprusarium"
elseif ( cell == 284 )
Player->PositionCell 0 0 0 0 "Corprusarium Bowels"
elseif ( cell == 285 )
Player->PositionCell 0 0 0 0 "Dagon Fel, Andre Maul's Tower"
elseif ( cell == 286 )
Player->PositionCell 0 0 0 0 "Dagon Fel, Anja Swift-Sailer's House"
elseif ( cell == 287 )
Player->PositionCell 0 0 0 0 "Dagon Fel, End of the World Renter Rooms"
elseif ( cell == 288 )
Player->PositionCell 0 0 0 0 "Dagon Fel, Fanar Fork-Beard's House"
elseif ( cell == 289 )
Player->PositionCell 0 0 0 0 "Dagon Fel, Fjorrod's House"
elseif ( cell == 290 )
Player->PositionCell 0 0 0 0 "Dagon Fel, Greidil Half-Troll's House"
elseif ( cell == 291 )
Player->PositionCell 0 0 0 0 "Dagon Fel, Heifnir: Trader"
elseif ( cell == 292 )
Player->PositionCell 0 0 0 0 "Dagon Fel, Hurg's House"
elseif ( cell == 293 )
Player->PositionCell 0 0 0 0 "Dagon Fel, Itar the Gentle's House"
elseif ( cell == 294 )
Player->PositionCell 0 0 0 0 "Dagon Fel, Mette's House"
elseif ( cell == 295 )
Player->PositionCell 0 0 0 0 "Dagon Fel, Onmi Hard-mouth's House"
elseif ( cell == 296 )
Player->PositionCell 0 0 0 0 "Dagon Fel, Sorkvild's Tower"
elseif ( cell == 297 )
Player->PositionCell 0 0 0 0 "Dagon Fel, The End of the World"
elseif ( cell == 298 )
Player->PositionCell 0 0 0 0 "Dagon Fel, Vacant Tower"
elseif ( cell == 299 )
Player->PositionCell 0 0 0 0 "Dagon Fel, Watch Tower"
elseif ( cell == 300 )
Player->PositionCell 0 0 0 0 "Dagoth Ur, Facility Cavern"
elseif ( cell == 301 )
Player->PositionCell 0 0 0 0 "Dagoth Ur, Inner Facility"
elseif ( cell == 302 )
Player->PositionCell 0 0 0 0 "Dagoth Ur, Inner Tower"
elseif ( cell == 303 )
Player->PositionCell 0 0 0 0 "Dagoth Ur, Lower Facility"
elseif ( cell == 304 )
Player->PositionCell 0 0 0 0 "Dagoth Ur, Outer Facility"
elseif ( cell == 305 )
Player->PositionCell 0 0 0 0 "Dareleth Ancestral Tomb"
elseif ( cell == 306 )
Player->PositionCell 0 0 0 0 "Derelict Shipwreck, Cabin"
elseif ( cell == 307 )
Player->PositionCell 0 0 0 0 "Derelict Shipwreck, Lower Level"
elseif ( cell == 308 )
Player->PositionCell 0 0 0 0 "Derelict Shipwreck, Upper Level"
elseif ( cell == 309 )
Player->PositionCell 0 0 0 0 "Deserted Shipwreck, Cabin"
elseif ( cell == 310 )
Player->PositionCell 0 0 0 0 "Deserted Shipwreck, Lower Level"
elseif ( cell == 311 )
Player->PositionCell 0 0 0 0 "Deserted Shipwreck, Upper Level"
elseif ( cell == 312 )
Player->PositionCell 0 0 0 0 "Desolate Shipwreck, Cabin"
elseif ( cell == 313 )
Player->PositionCell 0 0 0 0 "Desolate Shipwreck, Lower Level"
elseif ( cell == 314 )
Player->PositionCell 0 0 0 0 "Desolate Shipwreck, Upper Level"
elseif ( cell == 315 )
Player->PositionCell 0 0 0 0 "Dirara's Farmhouse"
elseif ( cell == 316 )
Player->PositionCell 0 0 0 0 "Dissapla Mine"
elseif ( cell == 317 )
Player->PositionCell 0 0 0 0 "Dralas Ancestral Tomb"
elseif ( cell == 318 )
Player->PositionCell 0 0 0 0 "Drath Ancestral Tomb"
elseif ( cell == 319 )
Player->PositionCell 0 0 0 0 "Dreloth Ancestral Tomb"
elseif ( cell == 320 )
Player->PositionCell 0 0 0 0 "Dren Plantation, Doves' Shack"
elseif ( cell == 321 )
Player->PositionCell 0 0 0 0 "Dren Plantation, Dren's Villa"
elseif ( cell == 322 )
Player->PositionCell 0 0 0 0 "Dren Plantation, Guardhouse"
elseif ( cell == 323 )
Player->PositionCell 0 0 0 0 "Dren Plantation, Helvi's Shack"
elseif ( cell == 324 )
Player->PositionCell 0 0 0 0 "Dren Plantation, Hlevala's Shack"
elseif ( cell == 325 )
Player->PositionCell 0 0 0 0 "Dren Plantation, Rethan's Shack"
elseif ( cell == 326 )
Player->PositionCell 0 0 0 0 "Dren Plantation, Shipping House"
elseif ( cell == 327 )
Player->PositionCell 0 0 0 0 "Dren Plantation, Storage Shack"
elseif ( cell == 328 )
Player->PositionCell 0 0 0 0 "Dren Plantation, Tower Shack"
elseif ( cell == 329 )
Player->PositionCell 0 0 0 0 "Dren Plantation, Verethi and Dralor"
elseif ( cell == 330 )
Player->PositionCell 0 0 0 0 "Drethan Ancestral Tomb"
elseif ( cell == 331 )
Player->PositionCell 0 0 0 0 "Drinith Ancestral Tomb"
elseif ( cell == 332 )
Player->PositionCell 0 0 0 0 "Drulene Falen's Hut"
elseif ( cell == 333 )
Player->PositionCell 0 0 0 0 "Druscashti, Lower Level"
elseif ( cell == 334 )
Player->PositionCell 0 0 0 0 "Druscashti, Upper Level"
elseif ( cell == 335 )
Player->PositionCell 0 0 0 0 "Dubdilla"
elseif ( cell == 336 )
Player->PositionCell 0 0 0 0 "Dubdilla, Uncharted Caverns"
elseif ( cell == 337 )
Player->PositionCell 0 0 0 0 "Dubdilla, Uncharted Caverns, Lower"
elseif ( cell == 338 )
Player->PositionCell 0 0 0 0 "Dulo Ancestral Tomb"
elseif ( cell == 339 )
Player->PositionCell 0 0 0 0 "Dun-Ahhe"
elseif ( cell == 340 )
Player->PositionCell 0 0 0 0 "Dunirai Caverns"
elseif ( cell == 341 )
Player->PositionCell 0 0 0 0 "Dushariran, Shrine"
elseif ( cell == 342 )
Player->PositionCell 0 0 0 0 "Ebernanit, Shrine"
elseif ( cell == 343 )
Player->PositionCell 0 0 0 0 "Ebonheart, Argonian Mission"
elseif ( cell == 344 )
Player->PositionCell 0 0 0 0 "Ebonheart, East Empire Company Hall"
elseif ( cell == 345 )
Player->PositionCell 0 0 0 0 "Ebonheart, East Empire North Warehouse"
elseif ( cell == 346 )
Player->PositionCell 0 0 0 0 "Ebonheart, East Empire South Warehouse"
elseif ( cell == 347 )
Player->PositionCell 0 0 0 0 "Ebonheart, Grand Council Chambers"
elseif ( cell == 348 )
Player->PositionCell 0 0 0 0 "Ebonheart, Grand Council Chambers Tower"
elseif ( cell == 349 )
Player->PositionCell 0 0 0 0 "Ebonheart, Hawkmoth Legion Garrison"
elseif ( cell == 350 )
Player->PositionCell 0 0 0 0 "Ebonheart, Hawkmoth Towers"
elseif ( cell == 351 )
Player->PositionCell 0 0 0 0 "Ebonheart, Imperial Chapels"
elseif ( cell == 352 )
Player->PositionCell 0 0 0 0 "Ebonheart, Imperial Commission"
elseif ( cell == 353 )
Player->PositionCell 0 0 0 0 "Ebonheart, Imperial Guard Garrison"
elseif ( cell == 354 )
Player->PositionCell 0 0 0 0 "Ebonheart, Six Fishes"
elseif ( cell == 355 )
Player->PositionCell 0 0 0 0 "Ebonheart, Skyrim Mission"
elseif ( cell == 356 )
Player->PositionCell 0 0 0 0 "Ebonheart, Underground Caves"
elseif ( cell == 357 )
Player->PositionCell 0 0 0 0 "Elanius Camp, Yapal's Yurt"
elseif ( cell == 358 )
Player->PositionCell 0 0 0 0 "Elf-Skerring, Cabin"
elseif ( cell == 359 )
Player->PositionCell 0 0 0 0 "Elf-Skerring, Lower Level"
elseif ( cell == 360 )
Player->PositionCell 0 0 0 0 "Elf-Skerring, Upper Level"
elseif ( cell == 361 )
Player->PositionCell 0 0 0 0 "Elith-Pal Mine"
elseif ( cell == 362 )
Player->PositionCell 0 0 0 0 "Eluba-Addon Egg Mine"
elseif ( cell == 363 )
Player->PositionCell 0 0 0 0 "Eluba-Addon Grotto"
elseif ( cell == 364 )
Player->PositionCell 0 0 0 0 "Endusal, Kagrenac's study"
elseif ( cell == 365 )
Player->PositionCell 0 0 0 0 "Erabenimsun Camp, Addut-Lamanu's Yurt"
elseif ( cell == 366 )
Player->PositionCell 0 0 0 0 "Erabenimsun Camp, Ainab's Yurt"
elseif ( cell == 367 )
Player->PositionCell 0 0 0 0 "Erabenimsun Camp, Ashkhan's Yurt"
elseif ( cell == 368 )
Player->PositionCell 0 0 0 0 "Erabenimsun Camp, Ashu-Ahhe's Yurt"
elseif ( cell == 369 )
Player->PositionCell 0 0 0 0 "Erabenimsun Camp, Assemmus' Yurt"
elseif ( cell == 370 )
Player->PositionCell 0 0 0 0 "Erabenimsun Camp, Han-Ammu's Yurt"
elseif ( cell == 371 )
Player->PositionCell 0 0 0 0 "Erabenimsun Camp, Massarapal's Yurt"
elseif ( cell == 372 )
Player->PositionCell 0 0 0 0 "Erabenimsun Camp, Ranabi's Yurt"
elseif ( cell == 373 )
Player->PositionCell 0 0 0 0 "Erabenimsun Camp, Salattanat's Yurt"
elseif ( cell == 374 )
Player->PositionCell 0 0 0 0 "Erabenimsun Camp, Wise Woman's Yurt"
elseif ( cell == 375 )
Player->PositionCell 0 0 0 0 "Eretammus-Sennammu Egg Mine"
elseif ( cell == 376 )
Player->PositionCell 0 0 0 0 "Esutanamus, Shrine"
elseif ( cell == 377 )
Player->PositionCell 0 0 0 0 "Fadathram Ancestral Tomb"
elseif ( cell == 378 )
Player->PositionCell 0 0 0 0 "Fair Helas, Cabin"
elseif ( cell == 379 )
Player->PositionCell 0 0 0 0 "Fair Helas, Lower Level"
elseif ( cell == 380 )
Player->PositionCell 0 0 0 0 "Fair Helas, Upper Level"
elseif ( cell == 381 )
Player->PositionCell 0 0 0 0 "Falas Ancestral Tomb"
elseif ( cell == 382 )
Player->PositionCell 0 0 0 0 "Falasmaryon, Lower Level"
elseif ( cell == 383 )
Player->PositionCell 0 0 0 0 "Falasmaryon, Missun Akin's Hut"
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setCell_Sub3"

End

# vn_Teleport_setCell_Sub4 ====================================================
Begin vn_Teleport_setCell_Sub4

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

if ( cell == 384 )
Player->PositionCell 0 0 0 0 "Falasmaryon, Propylon Chamber"
elseif ( cell == 385 )
Player->PositionCell 0 0 0 0 "Falasmaryon, Sewers"
elseif ( cell == 386 )
Player->PositionCell 0 0 0 0 "Falasmaryon, Upper Level"
elseif ( cell == 387 )
Player->PositionCell 0 0 0 0 "Falensarano, Lower Level"
elseif ( cell == 388 )
Player->PositionCell 0 0 0 0 "Falensarano, Propylon Chamber"
elseif ( cell == 389 )
Player->PositionCell 0 0 0 0 "Falensarano, Upper Level"
elseif ( cell == 390 )
Player->PositionCell 0 0 0 0 "Falvillo's Endeavor, Cabin"
elseif ( cell == 391 )
Player->PositionCell 0 0 0 0 "Falvillo's Endeavor, Lower Level"
elseif ( cell == 392 )
Player->PositionCell 0 0 0 0 "Falvilo's Endeavor, Upper Level"
elseif ( cell == 393 )
Player->PositionCell 0 0 0 0 "Favel Ancestral Tomb"
elseif ( cell == 394 )
Player->PositionCell 0 0 0 0 "Forgotten Shipwreck"
elseif ( cell == 395 )
Player->PositionCell 0 0 0 0 "Forgotten Vaults of Anudnabia, Forge of Hilbongard"
elseif ( cell == 396 )
Player->PositionCell 0 0 0 0 "Galom Daeus, Entry"
elseif ( cell == 397 )
Player->PositionCell 0 0 0 0 "Galom Daeus, Observatory"
elseif ( cell == 398 )
Player->PositionCell 0 0 0 0 "Ghostgate, Temple"
elseif ( cell == 399 )
Player->PositionCell 0 0 0 0 "Ghostgate, Tower of Dawn"
elseif ( cell == 400 )
Player->PositionCell 0 0 0 0 "Ghostgate, Tower of Dawn Lower Level"
elseif ( cell == 401 )
Player->PositionCell 0 0 0 0 "Ghostgate, Tower of Dusk"
elseif ( cell == 402 )
Player->PositionCell 0 0 0 0 "Ghostgate, Tower of Dusk Lower Level"
elseif ( cell == 403 )
Player->PositionCell 0 0 0 0 "Gimothran Ancestral Tomb"
elseif ( cell == 404 )
Player->PositionCell 0 0 0 0 "Ginith Ancestral Tomb"
elseif ( cell == 405 )
Player->PositionCell 0 0 0 0 "Gnaar Mok, Anglalos's Shack"
elseif ( cell == 406 )
Player->PositionCell 0 0 0 0 "Gnaar Mok, Arenim Manor"
elseif ( cell == 407 )
Player->PositionCell 0 0 0 0 "Gnaar Mok, Caryarel's Shack"
elseif ( cell == 408 )
Player->PositionCell 0 0 0 0 "Gnaar Mok, Druegh-jigger's Rest"
elseif ( cell == 409 )
Player->PositionCell 0 0 0 0 "Gnaar Mok, Jerian Dolbanitte's Shack"
elseif ( cell == 410 )
Player->PositionCell 0 0 0 0 "Gnaar Mok, Mush-Mere's Shack"
elseif ( cell == 411 )
Player->PositionCell 0 0 0 0 "Gnaar Mok, Nadene Rotheran's Shack"
elseif ( cell == 412 )
Player->PositionCell 0 0 0 0 "Gnaar Mok, Rostlogi's Shack"
elseif ( cell == 413 )
Player->PositionCell 0 0 0 0 "Gnisis, Abelmawia Hut"
elseif ( cell == 414 )
Player->PositionCell 0 0 0 0 "Gnisis, Almu Cave Dwelling"
elseif ( cell == 415 )
Player->PositionCell 0 0 0 0 "Gnisis, Arvs-Drelen"
elseif ( cell == 416 )
Player->PositionCell 0 0 0 0 "Gnisis, Barracks"
elseif ( cell == 417 )
Player->PositionCell 0 0 0 0 "Gnisis, Bethamez"
elseif ( cell == 418 )
Player->PositionCell 0 0 0 0 "Gnisis, Dinadad Hut"
elseif ( cell == 419 )
Player->PositionCell 0 0 0 0 "Gnisis, Eggmine"
elseif ( cell == 420 )
Player->PositionCell 0 0 0 0 "Gnisis, Fort Darius"
elseif ( cell == 421 )
Player->PositionCell 0 0 0 0 "Gnisis, Lasamsi Cave Dwelling"
elseif ( cell == 422 )
Player->PositionCell 0 0 0 0 "Gnisis, Lower Eggmine"
elseif ( cell == 423 )
Player->PositionCell 0 0 0 0 "Gnisis, Madach Tradehouse"
elseif ( cell == 424 )
Player->PositionCell 0 0 0 0 "Gnisis, Man-llu Hut"
elseif ( cell == 425 )
Player->PositionCell 0 0 0 0 "Gnisis, Mantiti Cave Dwelling"
elseif ( cell == 426 )
Player->PositionCell 0 0 0 0 "Gnisis, Shand Hut"
elseif ( cell == 427 )
Player->PositionCell 0 0 0 0 "Gnisis, Shishara Hut"
elseif ( cell == 428 )
Player->PositionCell 0 0 0 0 "Gnisis, Tansumiran Cave Dwelling"
elseif ( cell == 429 )
Player->PositionCell 0 0 0 0 "Gnisis, Temple"
elseif ( cell == 430 )
Player->PositionCell 0 0 0 0 "Gnisis, Underground Stream"
elseif ( cell == 431 )
Player->PositionCell 0 0 0 0 "Gnisis, Vabdas Hut"
elseif ( cell == 432 )
Player->PositionCell 0 0 0 0 "Gnisis, Yahaz Hut"
elseif ( cell == 433 )
Player->PositionCell 0 0 0 0 "Gro-Bagrat Plantation"
elseif ( cell == 434 )
Player->PositionCell 0 0 0 0 "Grytewake, Cabin"
elseif ( cell == 435 )
Player->PositionCell 0 0 0 0 "Grytewake, Lower Level"
elseif ( cell == 436 )
Player->PositionCell 0 0 0 0 "Grytewake, Upper Level"
elseif ( cell == 437 )
Player->PositionCell 0 0 0 0 "Habinbaes"
elseif ( cell == 438 )
Player->PositionCell 0 0 0 0 "Hairat-Vassamsi Egg Mine"
elseif ( cell == 439 )
Player->PositionCell 0 0 0 0 "Hairat-Vassamsi Egg Mine, Queen's Lair"
elseif ( cell == 440 )
Player->PositionCell 0 0 0 0 "Halit Mine"
elseif ( cell == 441 )
Player->PositionCell 0 0 0 0 "Hanud"
elseif ( cell == 442 )
Player->PositionCell 0 0 0 0 "Hanud, Tower"
elseif ( cell == 443 )
Player->PositionCell 0 0 0 0 "Hassour"
elseif ( cell == 444 )
Player->PositionCell 0 0 0 0 "Hassour, Shrine"
elseif ( cell == 445 )
Player->PositionCell 0 0 0 0 "Hawia Egg Mine"
elseif ( cell == 446 )
Player->PositionCell 0 0 0 0 "Helan Ancestral Tomb"
elseif ( cell == 447 )
Player->PositionCell 0 0 0 0 "Helas Ancestral Tomb"
elseif ( cell == 448 )
Player->PositionCell 0 0 0 0 "Heleran Ancestral Tomb"
elseif ( cell == 449 )
Player->PositionCell 0 0 0 0 "Heran Ancestral Tomb"
elseif ( cell == 450 )
Player->PositionCell 0 0 0 0 "Hinnabi"
elseif ( cell == 451 )
Player->PositionCell 0 0 0 0 "Hla Oad, Fadila Balvel's House"
elseif ( cell == 452 )
Player->PositionCell 0 0 0 0 "Hla Oad, Fatleg's Drop Off"
elseif ( cell == 453 )
Player->PositionCell 0 0 0 0 "Hla Oad, Murudius Flaeus's House"
elseif ( cell == 454 )
Player->PositionCell 0 0 0 0 "Hla Oad, Okur's House"
elseif ( cell == 455 )
Player->PositionCell 0 0 0 0 "Hla Oad, Relien Rirne's House"
elseif ( cell == 456 )
Player->PositionCell 0 0 0 0 "Hla Oad, Shurkul gro-Sharga's House"
elseif ( cell == 457 )
Player->PositionCell 0 0 0 0 "Hlaalu Ancestral Tomb"
elseif ( cell == 458 )
Player->PositionCell 0 0 0 0 "Hleran Ancestral Tomb"
elseif ( cell == 459 )
Player->PositionCell 0 0 0 0 "Hlervi Ancestral Tomb"
elseif ( cell == 460 )
Player->PositionCell 0 0 0 0 "Hlervu Ancestral Tomb"
elseif ( cell == 461 )
Player->PositionCell 0 0 0 0 "Hlormaren, Dome"
elseif ( cell == 462 )
Player->PositionCell 0 0 0 0 "Hlormaren, Keep, Bottom Level"
elseif ( cell == 463 )
Player->PositionCell 0 0 0 0 "Hlormaren, Keep, Top Level"
elseif ( cell == 464 )
Player->PositionCell 0 0 0 0 "Hlormaren, Propylon Chamber"
elseif ( cell == 465 )
Player->PositionCell 0 0 0 0 "Hlormaren, Sewers"
elseif ( cell == 466 )
Player->PositionCell 0 0 0 0 "Hlormaren, Underground"
elseif ( cell == 467 )
Player->PositionCell 0 0 0 0 "Holamayan Monastery"
elseif ( cell == 468 )
Player->PositionCell 0 0 0 0 "Ibar-Dad"
elseif ( cell == 469 )
Player->PositionCell 0 0 0 0 "Ibishammus, Shrine"
elseif ( cell == 470 )
Player->PositionCell 0 0 0 0 "Ienith Ancestral Tomb"
elseif ( cell == 471 )
Player->PositionCell 0 0 0 0 "Ihinipalit, Shrine"
elseif ( cell == 472 )
Player->PositionCell 0 0 0 0 "Ilanipu Grotto"
elseif ( cell == 473 )
Player->PositionCell 0 0 0 0 "Ilunibi, Blackened Heart"
elseif ( cell == 474 )
Player->PositionCell 0 0 0 0 "Ilunibi, Carcass of the Saint"
elseif ( cell == 475 )
Player->PositionCell 0 0 0 0 "Ilunibi, Marowak's Spine"
elseif ( cell == 476 )
Player->PositionCell 0 0 0 0 "Ilunibi, Soul's Rattle"
elseif ( cell == 477 )
Player->PositionCell 0 0 0 0 "Ilunibi, Tainted Marrow"
elseif ( cell == 478 )
Player->PositionCell 0 0 0 0 "Imperial Prison Ship"
elseif ( cell == 479 )
Player->PositionCell 0 0 0 0 "Inanius Egg Mine"
elseif ( cell == 480 )
Player->PositionCell 0 0 0 0 "Indalen Ancestral Tomb"
elseif ( cell == 481 )
Player->PositionCell 0 0 0 0 "Indaren Ancestral Tomb"
elseif ( cell == 482 )
Player->PositionCell 0 0 0 0 "Indarys Manor"
elseif ( cell == 483 )
Player->PositionCell 0 0 0 0 "Indarys Manor, Berendas' House"
elseif ( cell == 484 )
Player->PositionCell 0 0 0 0 "Indarys Manor, Manor Services"
elseif ( cell == 485 )
Player->PositionCell 0 0 0 0 "Indarys Manor, Raram's House"
elseif ( cell == 486 )
Player->PositionCell 0 0 0 0 "Indoranyon"
elseif ( cell == 487 )
Player->PositionCell 0 0 0 0 "Indoranyon, Propylon Chamber"
elseif ( cell == 488 )
Player->PositionCell 0 0 0 0 "Kaushtababi Camp, Adibael's Yurt"
elseif ( cell == 489 )
Player->PositionCell 0 0 0 0 "Kaushtarari, Shrine"
elseif ( cell == 490 )
Player->PositionCell 0 0 0 0 "ken's test hole"
elseif ( cell == 491 )
Player->PositionCell 0 0 0 0 "Khuul, Aldi's Shack"
elseif ( cell == 492 )
Player->PositionCell 0 0 0 0 "Khuul, Brurid's Shack"
elseif ( cell == 493 )
Player->PositionCell 0 0 0 0 "Khuul, Endris Dilmyn's Shack"
elseif ( cell == 494 )
Player->PositionCell 0 0 0 0 "Khuul, Helga's Shack"
elseif ( cell == 495 )
Player->PositionCell 0 0 0 0 "Khuul, Miron Garer's Shack"
elseif ( cell == 496 )
Player->PositionCell 0 0 0 0 "Khuul, Nelmyne Andules's Shack"
elseif ( cell == 497 )
Player->PositionCell 0 0 0 0 "Khuul, Rivame Samandas's Shack"
elseif ( cell == 498 )
Player->PositionCell 0 0 0 0 "Khuul, Svadstar's Shack"
elseif ( cell == 499 )
Player->PositionCell 0 0 0 0 "Khuul, Thongar's Tradehouse"
elseif ( cell == 500 )
Player->PositionCell 0 0 0 0 "Koal Cave"
elseif ( cell == 501 )
Player->PositionCell 0 0 0 0 "Kogoruhn, Bleeding Heart"
elseif ( cell == 502 )
Player->PositionCell 0 0 0 0 "Kogoruhn, Charma's Breath"
elseif ( cell == 503 )
Player->PositionCell 0 0 0 0 "Kogoruhn, Dome of Pollock's Eve"
elseif ( cell == 504 )
Player->PositionCell 0 0 0 0 "Kogoruhn, Dome of Urso"
elseif ( cell == 505 )
Player->PositionCell 0 0 0 0 "Kogoruhn, Hall of Maki"
elseif ( cell == 506 )
Player->PositionCell 0 0 0 0 "Kogoruhn, Hall of Phisto"
elseif ( cell == 507 )
Player->PositionCell 0 0 0 0 "Kogoruhn, Hall of the Watchful Touch"
elseif ( cell == 508 )
Player->PositionCell 0 0 0 0 "Kogoruhn, Nabith Waterway"
elseif ( cell == 509 )
Player->PositionCell 0 0 0 0 "Kogoruhn, Temple of Fey"
elseif ( cell == 510 )
Player->PositionCell 0 0 0 0 "Kogoruhn, Vault of Aerode"
elseif ( cell == 511 )
Player->PositionCell 0 0 0 0 "Kora-Dur"
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setCell_Sub4"

End

# vn_Teleport_setCell_Sub5 ====================================================
Begin vn_Teleport_setCell_Sub5

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

if ( cell == 512 )
	Player->PositionCell 0 0 0 0 "Kudanat"
elseif ( cell == 513 )
	Player->PositionCell 0 0 0 0 "Kumarahaz"
elseif ( cell == 514 )
	Player->PositionCell 0 0 0 0 "Kunirai"
elseif ( cell == 515 )
	Player->PositionCell 0 0 0 0 "Kushtashpi, Shrine"
elseif ( cell == 516 )
	Player->PositionCell 0 0 0 0 "Llando Ancestral Tomb"
elseif ( cell == 517 )
	Player->PositionCell 0 0 0 0 "Lleran Ancestral Tomb"
elseif ( cell == 518 )
	Player->PositionCell 0 0 0 0 "Llervu Ancestral Tomb"
elseif ( cell == 519 )
	Player->PositionCell 0 0 0 0 "Llirala's Shack"
elseif ( cell == 520 )
	Player->PositionCell 0 0 0 0 "Llovyn's Farmhouse"
elseif ( cell == 521 )
	Player->PositionCell 0 0 0 0 "Lonely Shipwreck, Cabin"
elseif ( cell == 522 )
	Player->PositionCell 0 0 0 0 "Lonely Shipwreck, Lower Level"
elseif ( cell == 523 )
	Player->PositionCell 0 0 0 0 "Lonely Shipwreck, Upper Level"
elseif ( cell == 524 )
	Player->PositionCell 0 0 0 0 "Lonesome Shipwreck, Cabin"
elseif ( cell == 525 )
	Player->PositionCell 0 0 0 0 "Lonesome Shipwreck, Lower Level"
elseif ( cell == 526 )
	Player->PositionCell 0 0 0 0 "Lonesome Shipwreck, Upper Level"
elseif ( cell == 527 )
	Player->PositionCell 0 0 0 0 "Lost Shipwreck, Cabin"
elseif ( cell == 528 )
	Player->PositionCell 0 0 0 0 "Lost Shipwreck, Lower Level"
elseif ( cell == 529 )
	Player->PositionCell 0 0 0 0 "Lost Shipwreck, Upper Level"
elseif ( cell == 530 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Andus Tradehouse"
elseif ( cell == 531 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Assi Serimilk's Hut"
elseif ( cell == 532 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Assirari Zama-Rasour's Hut"
elseif ( cell == 533 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Garry's Hut"
elseif ( cell == 534 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Guard Tower 1"
elseif ( cell == 535 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Guard Tower 2"
elseif ( cell == 536 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Guard Tower 3"
elseif ( cell == 537 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Huleen's Hut"
elseif ( cell == 538 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Kind Erushara's Hut"
elseif ( cell == 539 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Mabrelle Geles's Hut"
elseif ( cell == 540 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Outpost"
elseif ( cell == 541 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Shilipuran Zama-Rasour's Hut"
elseif ( cell == 542 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Shrine"
elseif ( cell == 543 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Tashpi Ashibael's Hut"
elseif ( cell == 544 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Ulisamsi Shaddarnuran's Hut"
elseif ( cell == 545 )
	Player->PositionCell 0 0 0 0 "Maar Gan, Yeherradad's Hut"
elseif ( cell == 546 )
	Player->PositionCell 0 0 0 0 "Maba-Ilu"
elseif ( cell == 547 )
	Player->PositionCell 0 0 0 0 "Mababi"
elseif ( cell == 548 )
	Player->PositionCell 0 0 0 0 "Madas Grotto"
elseif ( cell == 549 )
	Player->PositionCell 0 0 0 0 "Madas-Zebba Egg Mine"
elseif ( cell == 550 )
	Player->PositionCell 0 0 0 0 "Maelkashishi, Shrine"
elseif ( cell == 551 )
	Player->PositionCell 0 0 0 0 "Maelkashishi, Shrine, Forgotten Galleries"
elseif ( cell == 552 )
	Player->PositionCell 0 0 0 0 "Maelu Egg Mine"
elseif ( cell == 553 )
	Player->PositionCell 0 0 0 0 "Maesa-Shammus Egg Mine"
elseif ( cell == 554 )
	Player->PositionCell 0 0 0 0 "Magas Volar"
elseif ( cell == 555 )
	Player->PositionCell 0 0 0 0 "Mallapi"
elseif ( cell == 556 )
	Player->PositionCell 0 0 0 0 "Malmus Grotto"
elseif ( cell == 557 )
	Player->PositionCell 0 0 0 0 "Mamaea, Sanctum of Awakening"
elseif ( cell == 558 )
	Player->PositionCell 0 0 0 0 "Mamaea, Sanctum of Black Hope"
elseif ( cell == 559 )
	Player->PositionCell 0 0 0 0 "Mamaea, Shrine of Pitted Dreams"
elseif ( cell == 560 )
	Player->PositionCell 0 0 0 0 "Mamshar-Disamus Camp, Maesat's Yurt"
elseif ( cell == 561 )
	Player->PositionCell 0 0 0 0 "Manat's Farmhouse"
elseif ( cell == 562 )
	Player->PositionCell 0 0 0 0 "Mannammu"
elseif ( cell == 563 )
	Player->PositionCell 0 0 0 0 "Maran-Adon"
elseif ( cell == 564 )
	Player->PositionCell 0 0 0 0 "Marandus, Dome"
elseif ( cell == 565 )
	Player->PositionCell 0 0 0 0 "Marandus, Lower Level"
elseif ( cell == 566 )
	Player->PositionCell 0 0 0 0 "Marandus, Propylon Chamber"
elseif ( cell == 567 )
	Player->PositionCell 0 0 0 0 "Marandus, Upper Level"
elseif ( cell == 568 )
	Player->PositionCell 0 0 0 0 "Maren Ancestral Tomb"
elseif ( cell == 569 )
	Player->PositionCell 0 0 0 0 "Mark's Vampire Test Cell"
elseif ( cell == 570 )
	Player->PositionCell 0 0 0 0 "Marvani Ancestral Tomb"
elseif ( cell == 571 )
	Player->PositionCell 0 0 0 0 "Massahanud Camp, Sargon's Yurt"
elseif ( cell == 572 )
	Player->PositionCell 0 0 0 0 "Massama Cave"
elseif ( cell == 573 )
	Player->PositionCell 0 0 0 0 "Masseranit"
elseif ( cell == 574 )
	Player->PositionCell 0 0 0 0 "Mat"
elseif ( cell == 575 )
	Player->PositionCell 0 0 0 0 "Matus-Akin Egg Mine"
elseif ( cell == 576 )
	Player->PositionCell 0 0 0 0 "Matus-Akin Egg Mine, Queen's Lair"
elseif ( cell == 577 )
	Player->PositionCell 0 0 0 0 "Mausur Caverns"
elseif ( cell == 578 )
	Player->PositionCell 0 0 0 0 "Mawia"
elseif ( cell == 579 )
	Player->PositionCell 0 0 0 0 "Mila-Nipal, Manat's Yurt"
elseif ( cell == 580 )
	Player->PositionCell 0 0 0 0 "Milk"
elseif ( cell == 581 )
	Player->PositionCell 0 0 0 0 "Minabi"
elseif ( cell == 582 )
	Player->PositionCell 0 0 0 0 "Minabi, Bandit Lair"
elseif ( cell == 583 )
	Player->PositionCell 0 0 0 0 "Ministry of Truth, Hall of Processing"
elseif ( cell == 584 )
	Player->PositionCell 0 0 0 0 "Ministry of Truth, Holding Cells"
elseif ( cell == 585 )
	Player->PositionCell 0 0 0 0 "Ministry of Truth, Prison Keep"
elseif ( cell == 586 )
	Player->PositionCell 0 0 0 0 "Missamsi"
elseif ( cell == 587 )
	Player->PositionCell 0 0 0 0 "Missir-Dadalit Egg Mine"
elseif ( cell == 588 )
	Player->PositionCell 0 0 0 0 "Molag Mar, Armigers Stronghold"
elseif ( cell == 589 )
	Player->PositionCell 0 0 0 0 "Molag Mar, Canalworks"
elseif ( cell == 590 )
	Player->PositionCell 0 0 0 0 "Molag Mar, Redoran Stronghold"
elseif ( cell == 591 )
	Player->PositionCell 0 0 0 0 "Molag Mar, Saetring the Nord: Smith"
elseif ( cell == 592 )
	Player->PositionCell 0 0 0 0 "Molag Mar, St. Veloth's Hostel"
elseif ( cell == 593 )
	Player->PositionCell 0 0 0 0 "Molag Mar, Temple"
elseif ( cell == 594 )
	Player->PositionCell 0 0 0 0 "Molag Mar, The Pilgrim's Rest"
elseif ( cell == 595 )
	Player->PositionCell 0 0 0 0 "Molag Mar, Underworks"
elseif ( cell == 596 )
	Player->PositionCell 0 0 0 0 "Molag Mar, Vasesius Viciulus: Trader"
elseif ( cell == 597 )
	Player->PositionCell 0 0 0 0 "Molag Mar, Waistworks"
elseif ( cell == 598 )
	Player->PositionCell 0 0 0 0 "Moonmoth Legion Fort, Interior"
elseif ( cell == 599 )
	Player->PositionCell 0 0 0 0 "Moonmoth Legion Fort, Prison Towers"
elseif ( cell == 600 )
	Player->PositionCell 0 0 0 0 "Morvayn Manor"
elseif ( cell == 601 )
	Player->PositionCell 0 0 0 0 "Mount Kand, Cavern"
elseif ( cell == 602 )
	Player->PositionCell 0 0 0 0 "Mournhold"
elseif ( cell == 603 )
	Player->PositionCell 0 0 0 0 "Mournhold Temple"
elseif ( cell == 604 )
	Player->PositionCell 0 0 0 0 "Mournhold Temple: Basement"
elseif ( cell == 605 )
	Player->PositionCell 0 0 0 0 "Mournhold Temple: Hall of Ministry"
elseif ( cell == 606 )
	Player->PositionCell 0 0 0 0 "Mournhold Temple: High Chapel"
elseif ( cell == 607 )
	Player->PositionCell 0 0 0 0 "Mournhold Temple: Infirmary"
elseif ( cell == 608 )
	Player->PositionCell 0 0 0 0 "Mournhold Temple: Office of the Lord Archcanon"
elseif ( cell == 609 )
	Player->PositionCell 0 0 0 0 "Mournhold Temple: Reception Area"
elseif ( cell == 610 )
	Player->PositionCell 0 0 0 0 "Mournhold, Andoren Manor"
elseif ( cell == 611 )
	Player->PositionCell 0 0 0 0 "Mournhold, Armory"
elseif ( cell == 612 )
	Player->PositionCell 0 0 0 0 "Mournhold, Bookseller"
elseif ( cell == 613 )
	Player->PositionCell 0 0 0 0 "Mournhold, Clothier"
elseif ( cell == 614 )
	Player->PositionCell 0 0 0 0 "Mournhold, Craftsmen's Hall"
elseif ( cell == 615 )
	Player->PositionCell 0 0 0 0 "Mournhold, Geon Auline's House"
elseif ( cell == 616 )
	Player->PositionCell 0 0 0 0 "Mournhold, Godsreach"
elseif ( cell == 617 )
	Player->PositionCell 0 0 0 0 "Mournhold, Great Bazaar"
elseif ( cell == 618 )
	Player->PositionCell 0 0 0 0 "Mournhold, Ignatius Flaccus' House"
elseif ( cell == 619 )
	Player->PositionCell 0 0 0 0 "Mournhold, Llethan Manor"
elseif ( cell == 620 )
	Player->PositionCell 0 0 0 0 "Mournhold, Magic Shop"
elseif ( cell == 621 )
	Player->PositionCell 0 0 0 0 "Mournhold, Museum of Artifacts"
elseif ( cell == 622 )
	Player->PositionCell 0 0 0 0 "Mournhold, Pawnbroker"
elseif ( cell == 623 )
	Player->PositionCell 0 0 0 0 "Mournhold, Plaza Brindisi Dorom"
elseif ( cell == 624 )
Player->PositionCell 0 0 0 0 "Mournhold, Royal Palace"
elseif ( cell == 625 )
Player->PositionCell 0 0 0 0 "Mournhold, Royal Palace Throne Room"
elseif ( cell == 626 )
Player->PositionCell 0 0 0 0 "Mournhold, Royal Palace: Barenziah's Chambers"
elseif ( cell == 627 )
Player->PositionCell 0 0 0 0 "Mournhold, Royal Palace: Basement"
elseif ( cell == 628 )
Player->PositionCell 0 0 0 0 "Mournhold, Royal Palace: Courtyard"
elseif ( cell == 629 )
Player->PositionCell 0 0 0 0 "Mournhold, Royal Palace: Guards' Quarters"
elseif ( cell == 630 )
Player->PositionCell 0 0 0 0 "Mournhold, Royal Palace: Helseth's Chambers"
elseif ( cell == 631 )
Player->PositionCell 0 0 0 0 "Mournhold, Royal Palace: Imperial Cult Services"
elseif ( cell == 632 )
Player->PositionCell 0 0 0 0 "Mournhold, Royal Palace: Jail"
elseif ( cell == 633 )
Player->PositionCell 0 0 0 0 "Mournhold, Royal Palace: Legion Depot"
elseif ( cell == 634 )
Player->PositionCell 0 0 0 0 "Mournhold, Royal Palace: Reception Area"
elseif ( cell == 635 )
Player->PositionCell 0 0 0 0 "Mournhold, Sadri Manor"
elseif ( cell == 636 )
Player->PositionCell 0 0 0 0 "Mournhold, Secret Office"
elseif ( cell == 637 )
Player->PositionCell 0 0 0 0 "Mournhold, Temple Courtyard"
elseif ( cell == 638 )
Player->PositionCell 0 0 0 0 "Mournhold, The Winged Guar"
elseif ( cell == 639 )
Player->PositionCell 0 0 0 0 "Mournhold, Thendas Manor"
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setCell_Sub5"

End

# vn_Teleport_setCell_Sub6 ====================================================
Begin vn_Teleport_setCell_Sub6

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

if ( cell == 640 )
Player->PositionCell 0 0 0 0 "Mournhold, Trader"
elseif ( cell == 641 )
Player->PositionCell 0 0 0 0 "Mournhold, Vacant Manor"
elseif ( cell == 642 )
Player->PositionCell 0 0 0 0 "Mournhold, Velas Manor"
elseif ( cell == 643 )
Player->PositionCell 0 0 0 0 "Mudan Grotto"
elseif ( cell == 644 )
Player->PositionCell 0 0 0 0 "Mudan, Central Vault"
elseif ( cell == 645 )
Player->PositionCell 0 0 0 0 "Mudan, Lost Dwemer Checkpoint"
elseif ( cell == 646 )
Player->PositionCell 0 0 0 0 "Mudan, Right Tower"
elseif ( cell == 647 )
Player->PositionCell 0 0 0 0 "Mudan-Mul Egg Mine"
elseif ( cell == 648 )
Player->PositionCell 0 0 0 0 "Mul Grotto"
elseif ( cell == 649 )
Player->PositionCell 0 0 0 0 "Mzahnch"
elseif ( cell == 650 )
Player->PositionCell 0 0 0 0 "Mzahnch Lower Level"
elseif ( cell == 651 )
Player->PositionCell 0 0 0 0 "Mzanchend"
elseif ( cell == 652 )
Player->PositionCell 0 0 0 0 "Mzuleft"
elseif ( cell == 653 )
Player->PositionCell 0 0 0 0 "Nallit"
elseif ( cell == 654 )
Player->PositionCell 0 0 0 0 "Nammu"
elseif ( cell == 655 )
Player->PositionCell 0 0 0 0 "Nchardahrk"
elseif ( cell == 656 )
Player->PositionCell 0 0 0 0 "Nchardumz"
elseif ( cell == 657 )
Player->PositionCell 0 0 0 0 "Nchardumz Lower Level"
elseif ( cell == 658 )
Player->PositionCell 0 0 0 0 "Nchuleft"
elseif ( cell == 659 )
Player->PositionCell 0 0 0 0 "Nchuleftingth, Lower Levels"
elseif ( cell == 660 )
Player->PositionCell 0 0 0 0 "Nchuleftingth, Test of Pattern"
elseif ( cell == 661 )
Player->PositionCell 0 0 0 0 "Nchuleftingth, Upper Levels"
elseif ( cell == 662 )
Player->PositionCell 0 0 0 0 "Nchurdamz, Interior"
elseif ( cell == 663 )
Player->PositionCell 0 0 0 0 "Neglected Shipwreck, Cabin"
elseif ( cell == 664 )
Player->PositionCell 0 0 0 0 "Neglected Shipwreck, Lower Level"
elseif ( cell == 665 )
Player->PositionCell 0 0 0 0 "Neglected Shipwreck, Upper Level"
elseif ( cell == 666 )
Player->PositionCell 0 0 0 0 "Nelas Ancestral Tomb"
elseif ( cell == 667 )
Player->PositionCell 0 0 0 0 "Nerano Ancestral Tomb"
elseif ( cell == 668 )
Player->PositionCell 0 0 0 0 "Nilera's Farmhouse"
elseif ( cell == 669 )
Player->PositionCell 0 0 0 0 "Nimawia Grotto"
elseif ( cell == 670 )
Player->PositionCell 0 0 0 0 "Nissintu"
elseif ( cell == 671 )
Player->PositionCell 0 0 0 0 "Norenen-dur"
elseif ( cell == 672 )
Player->PositionCell 0 0 0 0 "Norenen-dur, Basilica of Divine Whispers"
elseif ( cell == 673 )
Player->PositionCell 0 0 0 0 "Norenen-dur, Citadel of Myn Dhrur"
elseif ( cell == 674 )
Player->PositionCell 0 0 0 0 "Norenen-dur, The Grand Stair"
elseif ( cell == 675 )
Player->PositionCell 0 0 0 0 "Norenen-dur, The Teeth that Gnash"
elseif ( cell == 676 )
Player->PositionCell 0 0 0 0 "Norenen-dur, The Wailingdelve"
elseif ( cell == 677 )
Player->PositionCell 0 0 0 0 "Norvayn Ancestral Tomb"
elseif ( cell == 678 )
Player->PositionCell 0 0 0 0 "Nund"
elseif ( cell == 679 )
Player->PositionCell 0 0 0 0 "Obscure Shipwreck, Cabin"
elseif ( cell == 680 )
Player->PositionCell 0 0 0 0 "Obscure Shipwreck, Lower Level"
elseif ( cell == 681 )
Player->PositionCell 0 0 0 0 "Obscure Shipwreck, Upper Level"
elseif ( cell == 682 )
Player->PositionCell 0 0 0 0 "Odaishah"
elseif ( cell == 683 )
Player->PositionCell 0 0 0 0 "Odibaal"
elseif ( cell == 684 )
Player->PositionCell 0 0 0 0 "Odirnamat"
elseif ( cell == 685 )
Player->PositionCell 0 0 0 0 "Odirniran"
elseif ( cell == 686 )
Player->PositionCell 0 0 0 0 "Odirniran, Tower"
elseif ( cell == 687 )
Player->PositionCell 0 0 0 0 "Odrosal, Dwemer Training Academy"
elseif ( cell == 688 )
Player->PositionCell 0 0 0 0 "Odrosal, Tower"
elseif ( cell == 689 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Abandoned Crypt"
elseif ( cell == 690 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Abandoned Passageway"
elseif ( cell == 691 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Armory Ruins"
elseif ( cell == 692 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Battlefield"
elseif ( cell == 693 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Bazaar Sewers"
elseif ( cell == 694 )
Player->PositionCell 0 0 0 0 "Old Mournhold: City Gate"
elseif ( cell == 695 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Forgotten Sewer"
elseif ( cell == 696 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Gedna Relvel's Tomb"
elseif ( cell == 697 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Manor District"
elseif ( cell == 698 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Moril Manor, Courtyard"
elseif ( cell == 699 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Moril Manor, East Building"
elseif ( cell == 700 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Moril Manor, North Building"
elseif ( cell == 701 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Palace Sewers"
elseif ( cell == 702 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Residential Ruins"
elseif ( cell == 703 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Residential Sewers"
elseif ( cell == 704 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Tears of Amun-Shae"
elseif ( cell == 705 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Temple Catacombs"
elseif ( cell == 706 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Temple Crypt"
elseif ( cell == 707 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Temple Gardens"
elseif ( cell == 708 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Temple Sewers"
elseif ( cell == 709 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Temple Sewers East"
elseif ( cell == 710 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Temple Sewers West"
elseif ( cell == 711 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Temple Shrine"
elseif ( cell == 712 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Teran Hall"
elseif ( cell == 713 )
Player->PositionCell 0 0 0 0 "Old Mournhold: Teran Hall, East Bldg"
elseif ( cell == 714 )
Player->PositionCell 0 0 0 0 "Old Mournhold: West Sewers"
elseif ( cell == 715 )
Player->PositionCell 0 0 0 0 "Omalen Ancestral Tomb"
elseif ( cell == 716 )
Player->PositionCell 0 0 0 0 "Omani Manor"
elseif ( cell == 717 )
Player->PositionCell 0 0 0 0 "Omaren Ancestral Tomb"
elseif ( cell == 718 )
Player->PositionCell 0 0 0 0 "Onnissiralis, Shrine"
elseif ( cell == 719 )
Player->PositionCell 0 0 0 0 "Orethi Ancestral Tomb"
elseif ( cell == 720 )
Player->PositionCell 0 0 0 0 "Othrelas Ancestral Tomb"
elseif ( cell == 721 )
Player->PositionCell 0 0 0 0 "Palansour"
elseif ( cell == 722 )
Player->PositionCell 0 0 0 0 "Panabanit-Nimawia Egg Mine"
elseif ( cell == 723 )
Player->PositionCell 0 0 0 0 "Panat"
elseif ( cell == 724 )
Player->PositionCell 0 0 0 0 "Panud Egg Mine"
elseif ( cell == 725 )
Player->PositionCell 0 0 0 0 "Pelagiad, Adanja's House"
elseif ( cell == 726 )
Player->PositionCell 0 0 0 0 "Pelagiad, Ahnassi's House"
elseif ( cell == 727 )
Player->PositionCell 0 0 0 0 "Pelagiad, Dralas Gilu's House"
elseif ( cell == 728 )
Player->PositionCell 0 0 0 0 "Pelagiad, Erval's House"
elseif ( cell == 729 )
Player->PositionCell 0 0 0 0 "Pelagiad, Farusea Salas' House"
elseif ( cell == 730 )
Player->PositionCell 0 0 0 0 "Pelagiad, Fort Pelagiad"
elseif ( cell == 731 )
Player->PositionCell 0 0 0 0 "Pelagiad, Guard Tower"
elseif ( cell == 732 )
Player->PositionCell 0 0 0 0 "Pelagiad, Halfway Tavern"
elseif ( cell == 733 )
Player->PositionCell 0 0 0 0 "Pelagiad, Ignatius Flaccus' House"
elseif ( cell == 734 )
Player->PositionCell 0 0 0 0 "Pelagiad, Junal-lei's House"
elseif ( cell == 735 )
Player->PositionCell 0 0 0 0 "Pelagiad, Madres Navur's House"
elseif ( cell == 736 )
Player->PositionCell 0 0 0 0 "Pelagiad, Mebestien Ence: Trader"
elseif ( cell == 737 )
Player->PositionCell 0 0 0 0 "Pelagiad, Murberius Harmevus' House"
elseif ( cell == 738 )
Player->PositionCell 0 0 0 0 "Pelagiad, North Wall"
elseif ( cell == 739 )
Player->PositionCell 0 0 0 0 "Pelagiad, South Wall"
elseif ( cell == 740 )
Player->PositionCell 0 0 0 0 "Pelagiad, Uulernil : Armorer"
elseif ( cell == 741 )
Player->PositionCell 0 0 0 0 "Piernette's Farmhouse"
elseif ( cell == 742 )
Player->PositionCell 0 0 0 0 "Pinsun"
elseif ( cell == 743 )
Player->PositionCell 0 0 0 0 "Piran"
elseif ( cell == 744 )
Player->PositionCell 0 0 0 0 "Prelude Shipwreck, Cabin"
elseif ( cell == 745 )
Player->PositionCell 0 0 0 0 "Prelude Shipwreck, Lower Level"
elseif ( cell == 746 )
Player->PositionCell 0 0 0 0 "Prelude Shipwreck, Upper Level"
elseif ( cell == 747 )
Player->PositionCell 0 0 0 0 "Pudai Egg Mine"
elseif ( cell == 748 )
Player->PositionCell 0 0 0 0 "Pudai Egg Mine, Queen's Lair"
elseif ( cell == 749 )
Player->PositionCell 0 0 0 0 "Pulk"
elseif ( cell == 750 )
Player->PositionCell 0 0 0 0 "Punabi"
elseif ( cell == 751 )
Player->PositionCell 0 0 0 0 "Punammu"
elseif ( cell == 752 )
Player->PositionCell 0 0 0 0 "Punsabanit"
elseif ( cell == 753 )
Player->PositionCell 0 0 0 0 "Ramimilk, Shrine"
elseif ( cell == 754 )
Player->PositionCell 0 0 0 0 "Randas Ancestral Tomb"
elseif ( cell == 755 )
Player->PositionCell 0 0 0 0 "Ravel Ancestral Tomb"
elseif ( cell == 756 )
Player->PositionCell 0 0 0 0 "Raviro Ancestral Tomb"
elseif ( cell == 757 )
Player->PositionCell 0 0 0 0 "Rayna Drolan's Shack"
elseif ( cell == 758 )
Player->PositionCell 0 0 0 0 "Redas Ancestral Tomb"
elseif ( cell == 759 )
Player->PositionCell 0 0 0 0 "Redoran interior"
elseif ( cell == 760 )
Player->PositionCell 0 0 0 0 "Redoran interior2"
elseif ( cell == 761 )
Player->PositionCell 0 0 0 0 "Releth Ancestral Tomb"
elseif ( cell == 762 )
Player->PositionCell 0 0 0 0 "Reloth Ancestral Tomb"
elseif ( cell == 763 )
Player->PositionCell 0 0 0 0 "Remote Shipwreck, Cabin"
elseif ( cell == 764 )
Player->PositionCell 0 0 0 0 "Remote Shipwreck, Lower Level"
elseif ( cell == 765 )
Player->PositionCell 0 0 0 0 "Remote Shipwreck, Upper Level"
elseif ( cell == 766 )
Player->PositionCell 0 0 0 0 "Rethan Manor"
elseif ( cell == 767 )
Player->PositionCell 0 0 0 0 "Rethan Manor, Berendas' House"
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setCell_Sub6"

End

# vn_Teleport_setCell_Sub7 ====================================================
Begin vn_Teleport_setCell_Sub7

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

if ( cell == 768 )
Player->PositionCell 0 0 0 0 "Rethan Manor, Drelas' House"
elseif ( cell == 769 )
Player->PositionCell 0 0 0 0 "Rethan Manor, Gols' House"
elseif ( cell == 770 )
Player->PositionCell 0 0 0 0 "Rethan Manor, Tures' House"
elseif ( cell == 771 )
Player->PositionCell 0 0 0 0 "Rethandus Ancestral Tomb"
elseif ( cell == 772 )
Player->PositionCell 0 0 0 0 "Rissun"
elseif ( cell == 773 )
Player->PositionCell 0 0 0 0 "Rothan Ancestral Tomb"
elseif ( cell == 774 )
Player->PositionCell 0 0 0 0 "Rotheran, Arena"
elseif ( cell == 775 )
Player->PositionCell 0 0 0 0 "Rotheran, Communal Hut"
elseif ( cell == 776 )
Player->PositionCell 0 0 0 0 "Rotheran, Propylon Chamber"
elseif ( cell == 777 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Anis Seloth: Alchemist"
elseif ( cell == 778 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Balen Vendu: Monk"
elseif ( cell == 779 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Dirty Muriel's Cornerclub"
elseif ( cell == 780 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Fara's Hole in the Wall"
elseif ( cell == 781 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Gateway Inn"
elseif ( cell == 782 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Gateway Inn: North Wing"
elseif ( cell == 783 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Gateway Inn: South Wing"
elseif ( cell == 784 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Gateway Inn: West Wing"
elseif ( cell == 785 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Hleras Gidren's House"
elseif ( cell == 786 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Llaalam Madalas: Mage"
elseif ( cell == 787 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Madran Ulvel's House"
elseif ( cell == 788 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Meluria Seleth's House"
elseif ( cell == 789 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Milara Vedran's House"
elseif ( cell == 790 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Morag Tong Guild"
elseif ( cell == 791 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Nevrila Areloth's House"
elseif ( cell == 792 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Nirasa Aren's House"
elseif ( cell == 793 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Pierlette Rostorard: Apothecary"
elseif ( cell == 794 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Rolis Garvon's House"
elseif ( cell == 795 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Tel Naga General Quarters"
elseif ( cell == 796 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Tel Naga Great Hall"
elseif ( cell == 797 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Tel Naga Upper Hall"
elseif ( cell == 798 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Tel Naga Upper Tower"
elseif ( cell == 799 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Telvanni Council House"
elseif ( cell == 800 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Telvanni Council House, Chambers"
elseif ( cell == 801 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Telvanni Council House, Entry"
elseif ( cell == 802 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Telvanni Council House, Hermitage"
elseif ( cell == 803 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Thervul Serethi: Healer"
elseif ( cell == 804 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Trendrus Dral's House"
elseif ( cell == 805 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Urtisa Romayn's House"
elseif ( cell == 806 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Urtiso Faryon: Sorcerer"
elseif ( cell == 807 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Vaden Belas' House"
elseif ( cell == 808 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Volmyni Dral's House"
elseif ( cell == 809 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Wolverine Hall"
elseif ( cell == 810 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Wolverine Hall: Fighter's Guild"
elseif ( cell == 811 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Wolverine Hall: Imperial Shrine"
elseif ( cell == 812 )
Player->PositionCell 0 0 0 0 "Sadrith Mora, Wolverine Hall: Mage's Guild"
elseif ( cell == 813 )
Player->PositionCell 0 0 0 0 "Sadryon Ancestral Tomb"
elseif ( cell == 814 )
Player->PositionCell 0 0 0 0 "Salit Camp, Zalit's Yurt"
elseif ( cell == 815 )
Player->PositionCell 0 0 0 0 "Salit Camp, Zelay's Yurt"
elseif ( cell == 816 )
Player->PositionCell 0 0 0 0 "Salmantu"
elseif ( cell == 817 )
Player->PositionCell 0 0 0 0 "Salmantu, Shrine"
elseif ( cell == 818 )
Player->PositionCell 0 0 0 0 "Salothan Ancestral Tomb"
elseif ( cell == 819 )
Player->PositionCell 0 0 0 0 "Salothran Ancestral Tomb"
elseif ( cell == 820 )
Player->PositionCell 0 0 0 0 "Salvel Ancestral Tomb"
elseif ( cell == 821 )
Player->PositionCell 0 0 0 0 "Samarys Ancestral Tomb"
elseif ( cell == 822 )
Player->PositionCell 0 0 0 0 "Sanabi"
elseif ( cell == 823 )
Player->PositionCell 0 0 0 0 "Sandas Ancestral Tomb"
elseif ( cell == 824 )
Player->PositionCell 0 0 0 0 "Sandus Ancestral Tomb"
elseif ( cell == 825 )
Player->PositionCell 0 0 0 0 "Sanit"
elseif ( cell == 826 )
Player->PositionCell 0 0 0 0 "Sanit, Shrine"
elseif ( cell == 827 )
Player->PositionCell 0 0 0 0 "Sanni"
elseif ( cell == 828 )
Player->PositionCell 0 0 0 0 "Sarano Ancestral Tomb"
elseif ( cell == 829 )
Player->PositionCell 0 0 0 0 "Saren Ancestral Tomb"
elseif ( cell == 830 )
Player->PositionCell 0 0 0 0 "Sarethi Ancestral Tomb"
elseif ( cell == 831 )
Player->PositionCell 0 0 0 0 "Sargon"
elseif ( cell == 832 )
Player->PositionCell 0 0 0 0 "Sarimisun-Assa Egg Mine"
elseif ( cell == 833 )
Player->PositionCell 0 0 0 0 "Sarimisun-Assa Egg Mine, Queen's Lair"
elseif ( cell == 834 )
Player->PositionCell 0 0 0 0 "Sarys Ancestral Tomb"
elseif ( cell == 835 )
Player->PositionCell 0 0 0 0 "Saturan"
elseif ( cell == 836 )
Player->PositionCell 0 0 0 0 "Savel Ancestral Tomb"
elseif ( cell == 837 )
Player->PositionCell 0 0 0 0 "Senim Ancestral Tomb"
elseif ( cell == 838 )
Player->PositionCell 0 0 0 0 "Sennananit"
elseif ( cell == 839 )
Player->PositionCell 0 0 0 0 "Seran Ancestral Tomb"
elseif ( cell == 840 )
Player->PositionCell 0 0 0 0 "Serano Ancestral Tomb"
elseif ( cell == 841 )
Player->PositionCell 0 0 0 0 "Sethan Ancestral Tomb"
elseif ( cell == 842 )
Player->PositionCell 0 0 0 0 "Setus Egg Mine"
elseif ( cell == 843 )
Player->PositionCell 0 0 0 0 "Seyda Neen, Arrille's Tradehouse"
elseif ( cell == 844 )
Player->PositionCell 0 0 0 0 "Seyda Neen, Census and Excise Office"
elseif ( cell == 845 )
Player->PositionCell 0 0 0 0 "Seyda Neen, Census and Excise Warehouse"
elseif ( cell == 846 )
Player->PositionCell 0 0 0 0 "Seyda Neen, Draren Thiralas' House"
elseif ( cell == 847 )
Player->PositionCell 0 0 0 0 "Seyda Neen, Eldafire's House"
elseif ( cell == 848 )
Player->PositionCell 0 0 0 0 "Seyda Neen, Erene Llenim's Shack"
elseif ( cell == 849 )
Player->PositionCell 0 0 0 0 "Seyda Neen, Fargoth's House"
elseif ( cell == 850 )
Player->PositionCell 0 0 0 0 "Seyda Neen, Fine-Mouth's Shack"
elseif ( cell == 851 )
Player->PositionCell 0 0 0 0 "Seyda Neen, Foryn Gilnith's Shack"
elseif ( cell == 852 )
Player->PositionCell 0 0 0 0 "Seyda Neen, Indrele Rathryon's Shack"
elseif ( cell == 853 )
Player->PositionCell 0 0 0 0 "Seyda Neen, Lighthouse"
elseif ( cell == 854 )
Player->PositionCell 0 0 0 0 "Seyda Neen, Terurise Girvayne's House"
elseif ( cell == 855 )
Player->PositionCell 0 0 0 0 "Seyda Neen, Vodunius Nuccius' House"
elseif ( cell == 856 )
Player->PositionCell 0 0 0 0 "Sha-Adnius"
elseif ( cell == 857 )
Player->PositionCell 0 0 0 0 "Shal"
elseif ( cell == 858 )
Player->PositionCell 0 0 0 0 "Shallit"
elseif ( cell == 859 )
Player->PositionCell 0 0 0 0 "Shara"
elseif ( cell == 860 )
Player->PositionCell 0 0 0 0 "Sharapli"
elseif ( cell == 861 )
Player->PositionCell 0 0 0 0 "Shashmanu Camp, Anit's Yurt"
elseif ( cell == 862 )
Player->PositionCell 0 0 0 0 "Shashpilamat"
elseif ( cell == 863 )
Player->PositionCell 0 0 0 0 "Shashpilamat, Shrine"
elseif ( cell == 864 )
Player->PositionCell 0 0 0 0 "Shashurari Camp, Zennammu's Yurt"
elseif ( cell == 865 )
Player->PositionCell 0 0 0 0 "Shishara"
elseif ( cell == 866 )
Player->PositionCell 0 0 0 0 "Shishi"
elseif ( cell == 867 )
Player->PositionCell 0 0 0 0 "Shrine of Azura"
elseif ( cell == 868 )
Player->PositionCell 0 0 0 0 "Shulk Egg Mine"
elseif ( cell == 869 )
Player->PositionCell 0 0 0 0 "Shulk Egg Mine, Mining Camp"
elseif ( cell == 870 )
Player->PositionCell 0 0 0 0 "Shulk Egg Mine, Queen's Lair"
elseif ( cell == 871 )
Player->PositionCell 0 0 0 0 "Shunned Shipwreck, Cabin"
elseif ( cell == 872 )
Player->PositionCell 0 0 0 0 "Shunned Shipwreck, Lower Level"
elseif ( cell == 873 )
Player->PositionCell 0 0 0 0 "Shunned Shipwreck, Upper Level"
elseif ( cell == 874 )
Player->PositionCell 0 0 0 0 "Shurdan-Raplay Egg Mine"
elseif ( cell == 875 )
Player->PositionCell 0 0 0 0 "Shurinbaal"
elseif ( cell == 876 )
Player->PositionCell 0 0 0 0 "Shushan"
elseif ( cell == 877 )
Player->PositionCell 0 0 0 0 "Shushishi"
elseif ( cell == 878 )
Player->PositionCell 0 0 0 0 "Sinamusa Egg Mine"
elseif ( cell == 879 )
Player->PositionCell 0 0 0 0 "Sinarralit Egg Mine"
elseif ( cell == 880 )
Player->PositionCell 0 0 0 0 "Sinsibadon"
elseif ( cell == 881 )
Player->PositionCell 0 0 0 0 "Sjorvar Horse-Mouth's House"
elseif ( cell == 882 )
Player->PositionCell 0 0 0 0 "Small Farmhouse"
elseif ( cell == 883 )
Player->PositionCell 0 0 0 0 "Sobitbael Camp, Mal's Yurt"
elseif ( cell == 884 )
Player->PositionCell 0 0 0 0 "Sotha Sil,"
elseif ( cell == 885 )
Player->PositionCell 0 0 0 0 "Sotha Sil, Central Gearworks"
elseif ( cell == 886 )
Player->PositionCell 0 0 0 0 "Sotha Sil, Chamber of Sohleh"
elseif ( cell == 887 )
Player->PositionCell 0 0 0 0 "Sotha Sil, Dome of Kasia"
elseif ( cell == 888 )
Player->PositionCell 0 0 0 0 "Sotha Sil, Dome of Serlyn"
elseif ( cell == 889 )
Player->PositionCell 0 0 0 0 "Sotha Sil, Dome of Sotha Sil"
elseif ( cell == 890 )
Player->PositionCell 0 0 0 0 "Sotha Sil, Dome of the Imperfect"
elseif ( cell == 891 )
Player->PositionCell 0 0 0 0 "Sotha Sil, Dome of Udok"
elseif ( cell == 892 )
Player->PositionCell 0 0 0 0 "Sotha Sil, Hall of Delirium"
elseif ( cell == 893 )
Player->PositionCell 0 0 0 0 "Sotha Sil, Hall of Mileitho"
elseif ( cell == 894 )
Player->PositionCell 0 0 0 0 "Sotha Sil, Hall of Sallaemu"
elseif ( cell == 895 )
Player->PositionCell 0 0 0 0 "Sotha Sil, Hall of Theuda"
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setCell_Sub7"

End

# vn_Teleport_setCell_Sub8 ====================================================
Begin vn_Teleport_setCell_Sub8

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

if ( cell == 896 )
Player->PositionCell 0 0 0 0 "Sotha Sil, Inner Flooded Halls"
elseif ( cell == 897 )
Player->PositionCell 0 0 0 0 "Sotha Sil, Outer Flooded Halls"
elseif ( cell == 898 )
Player->PositionCell 0 0 0 0 "Sterdecan's Farmhouse"
elseif ( cell == 899 )
Player->PositionCell 0 0 0 0 "Strange Shipwreck, Cabin"
elseif ( cell == 900 )
Player->PositionCell 0 0 0 0 "Strange Shipwreck, Lower Level"
elseif ( cell == 901 )
Player->PositionCell 0 0 0 0 "Strange Shipwreck, Upper Level"
elseif ( cell == 902 )
Player->PositionCell 0 0 0 0 "Subdun"
elseif ( cell == 903 )
Player->PositionCell 0 0 0 0 "Subdun, Shrine"
elseif ( cell == 904 )
Player->PositionCell 0 0 0 0 "Sud"
elseif ( cell == 905 )
Player->PositionCell 0 0 0 0 "Sudanit Mine"
elseif ( cell == 906 )
Player->PositionCell 0 0 0 0 "Sulipund"
elseif ( cell == 907 )
Player->PositionCell 0 0 0 0 "Sur Egg Mine"
elseif ( cell == 908 )
Player->PositionCell 0 0 0 0 "Suran, Desele's House of Earthly Delights"
elseif ( cell == 909 )
Player->PositionCell 0 0 0 0 "Suran, Garothmuk gro-Muzgub: Smith"
elseif ( cell == 910 )
Player->PositionCell 0 0 0 0 "Suran, Goldyn Belaram: Pawnbroker"
elseif ( cell == 911 )
Player->PositionCell 0 0 0 0 "Suran, Guard Tower"
elseif ( cell == 912 )
Player->PositionCell 0 0 0 0 "Suran, Ibarnadad Assirnarari: Apothecary"
elseif ( cell == 913 )
Player->PositionCell 0 0 0 0 "Suran, Oran Manor"
elseif ( cell == 914 )
Player->PositionCell 0 0 0 0 "Suran, Ralds Oril: Trader"
elseif ( cell == 915 )
Player->PositionCell 0 0 0 0 "Suran, Ranosa Gilvayn: Outfitter"
elseif ( cell == 916 )
Player->PositionCell 0 0 0 0 "Suran, Suran Slave Market"
elseif ( cell == 917 )
Player->PositionCell 0 0 0 0 "Suran, Suran Temple"
elseif ( cell == 918 )
Player->PositionCell 0 0 0 0 "Suran, Suran Tradehouse"
elseif ( cell == 919 )
Player->PositionCell 0 0 0 0 "Suran, Verara Rendo: Clothier"
elseif ( cell == 920 )
Player->PositionCell 0 0 0 0 "Surirulk"
elseif ( cell == 921 )
Player->PositionCell 0 0 0 0 "Tel Aruhn, Aryne Telnim: Smith"
elseif ( cell == 922 )
Player->PositionCell 0 0 0 0 "Tel Aruhn, Bildren Areleth: Apothecary"
elseif ( cell == 923 )
Player->PositionCell 0 0 0 0 "Tel Aruhn, Ferele Athram: Trader"
elseif ( cell == 924 )
Player->PositionCell 0 0 0 0 "Tel Aruhn, Maren Uvaren: Enchanter"
elseif ( cell == 925 )
Player->PositionCell 0 0 0 0 "Tel Aruhn, Plot and Plaster"
elseif ( cell == 926 )
Player->PositionCell 0 0 0 0 "Tel Aruhn, Tower Entry"
elseif ( cell == 927 )
Player->PositionCell 0 0 0 0 "Tel Aruhn, Tower Living Quarters"
elseif ( cell == 928 )
Player->PositionCell 0 0 0 0 "Tel Aruhn, Underground"
elseif ( cell == 929 )
Player->PositionCell 0 0 0 0 "Tel Aruhn, Upper Tower"
elseif ( cell == 930 )
Player->PositionCell 0 0 0 0 "Tel Branora, Ervyna Hlervu's Shack"
elseif ( cell == 931 )
Player->PositionCell 0 0 0 0 "Tel Branora, Evos Goran's House"
elseif ( cell == 932 )
Player->PositionCell 0 0 0 0 "Tel Branora, Fadase Selvayn: Trader"
elseif ( cell == 933 )
Player->PositionCell 0 0 0 0 "Tel Branora, Fedar Davus's House"
elseif ( cell == 934 )
Player->PositionCell 0 0 0 0 "Tel Branora, Galen Berer: Armorer"
elseif ( cell == 935 )
Player->PositionCell 0 0 0 0 "Tel Branora, Giron Manas's Shack"
elseif ( cell == 936 )
Player->PositionCell 0 0 0 0 "Tel Branora, Lower Tower"
elseif ( cell == 937 )
Player->PositionCell 0 0 0 0 "Tel Branora, Manos Vavyn's House"
elseif ( cell == 938 )
Player->PositionCell 0 0 0 0 "Tel Branora, Seryne Relas's House"
elseif ( cell == 939 )
Player->PositionCell 0 0 0 0 "Tel Branora, Sethan's Tradehouse"
elseif ( cell == 940 )
Player->PositionCell 0 0 0 0 "Tel Branora, Tower Dungeon"
elseif ( cell == 941 )
Player->PositionCell 0 0 0 0 "Tel Branora, Tower Guardpost"
elseif ( cell == 942 )
Player->PositionCell 0 0 0 0 "Tel Branora, Upper Tower"
elseif ( cell == 943 )
Player->PositionCell 0 0 0 0 "Tel Branora, Upper Tower: Therana's Chamber"
elseif ( cell == 944 )
Player->PositionCell 0 0 0 0 "Tel Mora, Berwen: Trader"
elseif ( cell == 945 )
Player->PositionCell 0 0 0 0 "Tel Mora, Elegnan: Clothier"
elseif ( cell == 946 )
Player->PositionCell 0 0 0 0 "Tel Mora, Jolda: Apothecary"
elseif ( cell == 947 )
Player->PositionCell 0 0 0 0 "Tel Mora, Kirsty's House"
elseif ( cell == 948 )
Player->PositionCell 0 0 0 0 "Tel Mora, Liette's House"
elseif ( cell == 949 )
Player->PositionCell 0 0 0 0 "Tel Mora, Lower Tower"
elseif ( cell == 950 )
Player->PositionCell 0 0 0 0 "Tel Mora, Nona's House"
elseif ( cell == 951 )
Player->PositionCell 0 0 0 0 "Tel Mora, Radras: Smith"
elseif ( cell == 952 )
Player->PositionCell 0 0 0 0 "Tel Mora, The Covenant"
elseif ( cell == 953 )
Player->PositionCell 0 0 0 0 "Tel Mora, Tower Services"
elseif ( cell == 954 )
Player->PositionCell 0 0 0 0 "Tel Mora, Upper Tower"
elseif ( cell == 955 )
Player->PositionCell 0 0 0 0 "Tel Uvirith, Arelas' House"
elseif ( cell == 956 )
Player->PositionCell 0 0 0 0 "Tel Uvirith, Menas' House"
elseif ( cell == 957 )
Player->PositionCell 0 0 0 0 "Tel Uvirith, Omavel's House"
elseif ( cell == 958 )
Player->PositionCell 0 0 0 0 "Tel Uvirith, Seleth's House"
elseif ( cell == 959 )
Player->PositionCell 0 0 0 0 "Tel Uvirith, Tower Dungeon"
elseif ( cell == 960 )
Player->PositionCell 0 0 0 0 "Tel Uvirith, Tower Lower"
elseif ( cell == 961 )
Player->PositionCell 0 0 0 0 "Tel Uvirith, Tower Upper"
elseif ( cell == 962 )
Player->PositionCell 0 0 0 0 "Tel Vos, Aryon's Chambers"
elseif ( cell == 963 )
Player->PositionCell 0 0 0 0 "Tel Vos, Barracks and Armory"
elseif ( cell == 964 )
Player->PositionCell 0 0 0 0 "Tel Vos, Central Tower"
elseif ( cell == 965 )
Player->PositionCell 0 0 0 0 "Tel Vos, Dungeon"
elseif ( cell == 966 )
Player->PositionCell 0 0 0 0 "Tel Vos, Jail"
elseif ( cell == 967 )
Player->PositionCell 0 0 0 0 "Tel Vos, Northeastern Tower"
elseif ( cell == 968 )
Player->PositionCell 0 0 0 0 "Tel Vos, Services Tower"
elseif ( cell == 969 )
Player->PositionCell 0 0 0 0 "Tel Vos, Southern Tower"
elseif ( cell == 970 )
Player->PositionCell 0 0 0 0 "Telasero, Lower Level"
elseif ( cell == 971 )
Player->PositionCell 0 0 0 0 "Telasero, Propylon Chamber"
elseif ( cell == 972 )
Player->PositionCell 0 0 0 0 "Telasero, Upper Level"
elseif ( cell == 973 )
Player->PositionCell 0 0 0 0 "Telvayn Ancestral Tomb"
elseif ( cell == 974 )
Player->PositionCell 0 0 0 0 "Thalas Ancestral Tomb"
elseif ( cell == 975 )
Player->PositionCell 0 0 0 0 "Tharys Ancestral Tomb"
elseif ( cell == 976 )
Player->PositionCell 0 0 0 0 "Thelas Ancestral Tomb"
elseif ( cell == 977 )
Player->PositionCell 0 0 0 0 "Thiralas Ancestral Tomb"
elseif ( cell == 978 )
Player->PositionCell 0 0 0 0 "Tin-Ahhe"
elseif ( cell == 979 )
Player->PositionCell 0 0 0 0 "ToddTest"
elseif ( cell == 980 )
Player->PositionCell 0 0 0 0 "Tower of Tel Fyr, Hall of Fyr"
elseif ( cell == 981 )
Player->PositionCell 0 0 0 0 "Tower of Tel Fyr, Onyx Hall"
elseif ( cell == 982 )
Player->PositionCell 0 0 0 0 "Tukushapal"
elseif ( cell == 983 )
Player->PositionCell 0 0 0 0 "Tukushapal, Sepulcher"
elseif ( cell == 984 )
Player->PositionCell 0 0 0 0 "Tureynulal, Bladder of Clovis"
elseif ( cell == 985 )
Player->PositionCell 0 0 0 0 "Tureynulal, Eye of Duggan"
elseif ( cell == 986 )
Player->PositionCell 0 0 0 0 "Tureynulal, Eye of Thom Wye"
elseif ( cell == 987 )
Player->PositionCell 0 0 0 0 "Tureynulal, Kagrenac's Library"
elseif ( cell == 988 )
Player->PositionCell 0 0 0 0 "Tusenend, Shrine"
elseif ( cell == 989 )
Player->PositionCell 0 0 0 0 "Ularradallaku, Shrine"
elseif ( cell == 990 )
Player->PositionCell 0 0 0 0 "Ules Manor"
elseif ( cell == 991 )
Player->PositionCell 0 0 0 0 "Ules Manor, Slave Shack"
elseif ( cell == 992 )
Player->PositionCell 0 0 0 0 "Ules Manor, Slavemaster's Shack"
elseif ( cell == 993 )
Player->PositionCell 0 0 0 0 "Ulummusa"
elseif ( cell == 994 )
Player->PositionCell 0 0 0 0 "Uncharted Shipwreck, Lower Level"
elseif ( cell == 995 )
Player->PositionCell 0 0 0 0 "Unchartered Shipwreck, Cabin"
elseif ( cell == 996 )
Player->PositionCell 0 0 0 0 "Unchartered Shipwreck, Upper Level"
elseif ( cell == 997 )
Player->PositionCell 0 0 0 0 "Unexplored Shipwreck, Cabin"
elseif ( cell == 998 )
Player->PositionCell 0 0 0 0 "Unexplored Shipwreck, Lower Level"
elseif ( cell == 999 )
Player->PositionCell 0 0 0 0 "Unexplored Shipwreck, Upper Level"
elseif ( cell == 1000 )
Player->PositionCell 0 0 0 0 "Unknown Shipwreck, Cabin"
elseif ( cell == 1001 )
Player->PositionCell 0 0 0 0 "Unknown Shipwreck, Lower Level"
elseif ( cell == 1002 )
Player->PositionCell 0 0 0 0 "Unknown Shipwreck, Upper Level"
elseif ( cell == 1003 )
Player->PositionCell 0 0 0 0 "Unmarked Shipwreck, Lower Level"
elseif ( cell == 1004 )
Player->PositionCell 0 0 0 0 "Unmarked Shipwreck, Upper Level"
elseif ( cell == 1005 )
Player->PositionCell 0 0 0 0 "Urshilaku Camp, Ahasour's Yurt"
elseif ( cell == 1006 )
Player->PositionCell 0 0 0 0 "Urshilaku Camp, Ashkhan's Yurt"
elseif ( cell == 1007 )
Player->PositionCell 0 0 0 0 "Urshilaku Camp, Kurapli's Yurt"
elseif ( cell == 1008 )
Player->PositionCell 0 0 0 0 "Urshilaku Camp, Maeli's Yurt"
elseif ( cell == 1009 )
Player->PositionCell 0 0 0 0 "Urshilaku Camp, Sakiran's Yurt"
elseif ( cell == 1010 )
Player->PositionCell 0 0 0 0 "Urshilaku Camp, Shara's Yurt"
elseif ( cell == 1011 )
Player->PositionCell 0 0 0 0 "Urshilaku Camp, Shimsun's Yurt"
elseif ( cell == 1012 )
Player->PositionCell 0 0 0 0 "Urshilaku Camp, Wise Woman's Yurt"
elseif ( cell == 1013 )
Player->PositionCell 0 0 0 0 "Urshilaku Camp, Zabamund's Yurt"
elseif ( cell == 1014 )
Player->PositionCell 0 0 0 0 "Urshilaku Camp, Zanummu's Yurt"
elseif ( cell == 1015 )
Player->PositionCell 0 0 0 0 "Urshilaku, Astral Burial"
elseif ( cell == 1016 )
Player->PositionCell 0 0 0 0 "Urshilaku, Fragile Burial"
elseif ( cell == 1017 )
Player->PositionCell 0 0 0 0 "Urshilaku, Juno Burial"
elseif ( cell == 1018 )
Player->PositionCell 0 0 0 0 "Urshilaku, Kakuna Burial"
elseif ( cell == 1019 )
Player->PositionCell 0 0 0 0 "Urshilaku, Karma Burial"
elseif ( cell == 1020 )
Player->PositionCell 0 0 0 0 "Urshilaku, Kefka Burial"
elseif ( cell == 1021 )
Player->PositionCell 0 0 0 0 "Urshilaku, Laterus Burial"
elseif ( cell == 1022 )
Player->PositionCell 0 0 0 0 "Uveran Ancestral Tomb"
elseif ( cell == 1023 )
Player->PositionCell 0 0 0 0 "Valenvaryon, Durz's Hut"
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setCell_Sub8"

End

# vn_Teleport_setCell_Sub9 ====================================================
Begin vn_Teleport_setCell_Sub9

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

if ( cell == 1024 )
Player->PositionCell 0 0 0 0 "Valenvaryon, Gashna's Hut"
elseif ( cell == 1025 )
Player->PositionCell 0 0 0 0 "Valenvaryon, Lambug's Hut"
elseif ( cell == 1026 )
Player->PositionCell 0 0 0 0 "Valenvaryon, Lurog's Hut"
elseif ( cell == 1027 )
Player->PositionCell 0 0 0 0 "Valenvaryon, Propylon Chamber"
elseif ( cell == 1028 )
Player->PositionCell 0 0 0 0 "Valenvaryon, Umug's Hut"
elseif ( cell == 1029 )
Player->PositionCell 0 0 0 0 "Vandus Ancestral Tomb"
elseif ( cell == 1030 )
Player->PositionCell 0 0 0 0 "Vansunalit Egg Mine"
elseif ( cell == 1031 )
Player->PositionCell 0 0 0 0 "Vas, Entry Level"
elseif ( cell == 1032 )
Player->PositionCell 0 0 0 0 "Vas, Tower"
elseif ( cell == 1033 )
Player->PositionCell 0 0 0 0 "Vassamsi Grotto"
elseif ( cell == 1034 )
Player->PositionCell 0 0 0 0 "Vassir-Didanat Cave"
elseif ( cell == 1035 )
Player->PositionCell 0 0 0 0 "Velas Ancestral Tomb"
elseif ( cell == 1036 )
Player->PositionCell 0 0 0 0 "Veloth Ancestral Tomb"
elseif ( cell == 1037 )
Player->PositionCell 0 0 0 0 "Vemynal, Hall of Torque"
elseif ( cell == 1038 )
Player->PositionCell 0 0 0 0 "Vemynal, Outer Fortress"
elseif ( cell == 1039 )
Player->PositionCell 0 0 0 0 "Venim Ancestral Tomb"
elseif ( cell == 1040 )
Player->PositionCell 0 0 0 0 "Verelnim Ancestral Tomb"
elseif ( cell == 1041 )
Player->PositionCell 0 0 0 0 "Vivec, Agrippina Herennia: Clothier"
elseif ( cell == 1042 )
Player->PositionCell 0 0 0 0 "Vivec, Alusaron: Smith"
elseif ( cell == 1043 )
Player->PositionCell 0 0 0 0 "Vivec, Andilu Drothan: Alchemist"
elseif ( cell == 1044 )
Player->PositionCell 0 0 0 0 "Vivec, Arena Canalworks"
elseif ( cell == 1045 )
Player->PositionCell 0 0 0 0 "Vivec, Arena Fighters Quarters"
elseif ( cell == 1046 )
Player->PositionCell 0 0 0 0 "Vivec, Arena Fighters Training"
elseif ( cell == 1047 )
Player->PositionCell 0 0 0 0 "Vivec, Arena Hidden Area"
elseif ( cell == 1048 )
Player->PositionCell 0 0 0 0 "Vivec, Arena Holding Cells"
elseif ( cell == 1049 )
Player->PositionCell 0 0 0 0 "Vivec, Arena Pit"
elseif ( cell == 1050 )
Player->PositionCell 0 0 0 0 "Vivec, Arena Storage"
elseif ( cell == 1051 )
Player->PositionCell 0 0 0 0 "Vivec, Arena Underworks"
elseif ( cell == 1052 )
Player->PositionCell 0 0 0 0 "Vivec, Arena Waistworks"
elseif ( cell == 1053 )
Player->PositionCell 0 0 0 0 "Vivec, Aurane Frernis: Apothecary"
elseif ( cell == 1054 )
Player->PositionCell 0 0 0 0 "Vivec, Black Shalk Cornerclub"
elseif ( cell == 1055 )
Player->PositionCell 0 0 0 0 "Vivec, Canon Offices"
elseif ( cell == 1056 )
Player->PositionCell 0 0 0 0 "Vivec, Canon Quarters"
elseif ( cell == 1057 )
Player->PositionCell 0 0 0 0 "Vivec, Curio Manor"
elseif ( cell == 1058 )
Player->PositionCell 0 0 0 0 "Vivec, Dralor Manor"
elseif ( cell == 1059 )
Player->PositionCell 0 0 0 0 "Vivec, Elven Nations Cornerclub"
elseif ( cell == 1060 )
Player->PositionCell 0 0 0 0 "Vivec, Foreign Quarter Canalworks"
elseif ( cell == 1061 )
Player->PositionCell 0 0 0 0 "Vivec, Foreign Quarter Lower Waistworks"
elseif ( cell == 1062 )
Player->PositionCell 0 0 0 0 "Vivec, Foreign Quarter Plaza"
elseif ( cell == 1063 )
Player->PositionCell 0 0 0 0 "Vivec, Foreign Quarter Tomb"
elseif ( cell == 1064 )
Player->PositionCell 0 0 0 0 "Vivec, Foreign Quarter Underworks"
elseif ( cell == 1065 )
Player->PositionCell 0 0 0 0 "Vivec, Foreign Quarter Upper Waistworks"
elseif ( cell == 1066 )
Player->PositionCell 0 0 0 0 "Vivec, Guild of Fighters"
elseif ( cell == 1067 )
Player->PositionCell 0 0 0 0 "Vivec, Guild of Mages"
elseif ( cell == 1068 )
Player->PositionCell 0 0 0 0 "Vivec, Hall of Justice"
elseif ( cell == 1069 )
Player->PositionCell 0 0 0 0 "Vivec, Hall of Justice Secret Library"
elseif ( cell == 1070 )
Player->PositionCell 0 0 0 0 "Vivec, Hall of Wisdom"
elseif ( cell == 1071 )
Player->PositionCell 0 0 0 0 "Vivec, Hall Underworks"
elseif ( cell == 1072 )
Player->PositionCell 0 0 0 0 "Vivec, High Fane"
elseif ( cell == 1073 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu Alchemist"
elseif ( cell == 1074 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu Ancestral Vaults"
elseif ( cell == 1075 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu Canalworks"
elseif ( cell == 1076 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu Edryno Arethi's House"
elseif ( cell == 1077 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu General Goods"
elseif ( cell == 1078 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu Pawnbroker"
elseif ( cell == 1079 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu Plaza"
elseif ( cell == 1080 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu Prison Cells"
elseif ( cell == 1081 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu Records"
elseif ( cell == 1082 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu Temple"
elseif ( cell == 1083 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu Treasury"
elseif ( cell == 1084 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu Underworks"
elseif ( cell == 1085 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu Vaults"
elseif ( cell == 1086 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu Waistworks"
elseif ( cell == 1087 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaalu Weaponsmith"
elseif ( cell == 1088 )
Player->PositionCell 0 0 0 0 "Vivec, Hlaren Residence"
elseif ( cell == 1089 )
Player->PositionCell 0 0 0 0 "Vivec, J'Rasha: Healer"
elseif ( cell == 1090 )
Player->PositionCell 0 0 0 0 "Vivec, Jeanne: Trader"
elseif ( cell == 1091 )
Player->PositionCell 0 0 0 0 "Vivec, Jobasha's Rare Books"
elseif ( cell == 1092 )
Player->PositionCell 0 0 0 0 "Vivec, Justice Offices"
elseif ( cell == 1093 )
Player->PositionCell 0 0 0 0 "Vivec, Library of Vivec"
elseif ( cell == 1094 )
Player->PositionCell 0 0 0 0 "Vivec, Lucretinaus Olcinius: Trader"
elseif ( cell == 1095 )
Player->PositionCell 0 0 0 0 "Vivec, Mevel Fererus: Trader"
elseif ( cell == 1096 )
Player->PositionCell 0 0 0 0 "Vivec, Milo's Quarters"
elseif ( cell == 1097 )
Player->PositionCell 0 0 0 0 "Vivec, Miun-Gei: Enchanter"
elseif ( cell == 1098 )
Player->PositionCell 0 0 0 0 "Vivec, No Name Club"
elseif ( cell == 1099 )
Player->PositionCell 0 0 0 0 "Vivec, Office of the Watch"
elseif ( cell == 1100 )
Player->PositionCell 0 0 0 0 "Vivec, Ordinator Barracks"
elseif ( cell == 1101 )
Player->PositionCell 0 0 0 0 "Vivec, Palace of Vivec"
elseif ( cell == 1102 )
Player->PositionCell 0 0 0 0 "Vivec, Puzzle Canal, Center"
elseif ( cell == 1103 )
Player->PositionCell 0 0 0 0 "Vivec, Puzzle Canal, Level 1"
elseif ( cell == 1104 )
Player->PositionCell 0 0 0 0 "Vivec, Puzzle Canal, Level 2"
elseif ( cell == 1105 )
Player->PositionCell 0 0 0 0 "Vivec, Puzzle Canal, Level 3"
elseif ( cell == 1106 )
Player->PositionCell 0 0 0 0 "Vivec, Puzzle Canal, Level 4"
elseif ( cell == 1107 )
Player->PositionCell 0 0 0 0 "Vivec, Puzzle Canal, Level 5"
elseif ( cell == 1108 )
Player->PositionCell 0 0 0 0 "Vivec, Ralen Tilvur: Smith"
elseif ( cell == 1109 )
Player->PositionCell 0 0 0 0 "Vivec, Redoran Ancestral Vaults"
elseif ( cell == 1110 )
Player->PositionCell 0 0 0 0 "Vivec, Redoran Canalworks"
elseif ( cell == 1111 )
Player->PositionCell 0 0 0 0 "Vivec, Redoran Plaza"
elseif ( cell == 1112 )
Player->PositionCell 0 0 0 0 "Vivec, Redoran Prison Cells"
elseif ( cell == 1113 )
Player->PositionCell 0 0 0 0 "Vivec, Redoran Records"
elseif ( cell == 1114 )
Player->PositionCell 0 0 0 0 "Vivec, Redoran Scout & Drillmaster"
elseif ( cell == 1115 )
Player->PositionCell 0 0 0 0 "Vivec, Redoran Smith"
elseif ( cell == 1116 )
Player->PositionCell 0 0 0 0 "Vivec, Redoran Temple Shrine"
elseif ( cell == 1117 )
Player->PositionCell 0 0 0 0 "Vivec, Redoran Trader"
elseif ( cell == 1118 )
Player->PositionCell 0 0 0 0 "Vivec, Redoran Treasury"
elseif ( cell == 1119 )
Player->PositionCell 0 0 0 0 "Vivec, Redoran Underworks"
elseif ( cell == 1120 )
Player->PositionCell 0 0 0 0 "Vivec, Redoran Vaults"
elseif ( cell == 1121 )
Player->PositionCell 0 0 0 0 "Vivec, Redoran Waistworks"
elseif ( cell == 1122 )
Player->PositionCell 0 0 0 0 "Vivec, Saren Manor"
elseif ( cell == 1123 )
Player->PositionCell 0 0 0 0 "Vivec, Simine Fralinie: Bookseller"
elseif ( cell == 1124 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Canal North-One"
elseif ( cell == 1125 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Canal North-Three"
elseif ( cell == 1126 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Canal North-Two"
elseif ( cell == 1127 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Canal South-One"
elseif ( cell == 1128 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Canal South-Three"
elseif ( cell == 1129 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Canal South-Two"
elseif ( cell == 1130 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Canalworks"
elseif ( cell == 1131 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Glassworker's Hall"
elseif ( cell == 1132 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Plaza"
elseif ( cell == 1133 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Potter's Hall"
elseif ( cell == 1134 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Storage"
elseif ( cell == 1135 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Underworks"
elseif ( cell == 1136 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Waist North-One"
elseif ( cell == 1137 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Waist North-Two"
elseif ( cell == 1138 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Waist South-One"
elseif ( cell == 1139 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Waist South-Two"
elseif ( cell == 1140 )
Player->PositionCell 0 0 0 0 "Vivec, St. Delyn Waistworks"
elseif ( cell == 1141 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Brewers and Fishmongers Hall"
elseif ( cell == 1142 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Canal North-One"
elseif ( cell == 1143 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Canal North-Three"
elseif ( cell == 1144 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Canal North-Two"
elseif ( cell == 1145 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Canal South-One"
elseif ( cell == 1146 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Canal South-Three"
elseif ( cell == 1147 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Canal South-Two"
elseif ( cell == 1148 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Canalworks"
elseif ( cell == 1149 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Farmers and Laborers Hall"
elseif ( cell == 1150 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Haunted Manor"
elseif ( cell == 1151 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Plaza"
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setCell_Sub9"

End

# vn_Teleport_setCell_SubA ====================================================
Begin vn_Teleport_setCell_SubA

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

if ( cell == 1152 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Storage"
elseif ( cell == 1153 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Tailors and Dyers Hall"
elseif ( cell == 1154 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Tanners and Miners Hall"
elseif ( cell == 1155 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Temple"
elseif ( cell == 1156 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Underworks"
elseif ( cell == 1157 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Upper North-One"
elseif ( cell == 1158 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Upper North-Two"
elseif ( cell == 1159 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Upper South-One"
elseif ( cell == 1160 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Waist North-One"
elseif ( cell == 1161 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Waist North-Two"
elseif ( cell == 1162 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Waist South-One"
elseif ( cell == 1163 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Waist South-Two"
elseif ( cell == 1164 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Waistworks"
elseif ( cell == 1165 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Yngling Manor"
elseif ( cell == 1166 )
Player->PositionCell 0 0 0 0 "Vivec, St. Olms Yngling Manor Basement"
elseif ( cell == 1167 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Alchemist"
elseif ( cell == 1168 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Apothecary"
elseif ( cell == 1169 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Canalworks"
elseif ( cell == 1170 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Enchanter"
elseif ( cell == 1171 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Mage"
elseif ( cell == 1172 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Monster Lab"
elseif ( cell == 1173 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Plaza"
elseif ( cell == 1174 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Prison Cells"
elseif ( cell == 1175 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Sorcerer"
elseif ( cell == 1176 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Temple"
elseif ( cell == 1177 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Tower"
elseif ( cell == 1178 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Underworks"
elseif ( cell == 1179 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Upper Storage"
elseif ( cell == 1180 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Vault"
elseif ( cell == 1181 )
Player->PositionCell 0 0 0 0 "Vivec, Telvanni Waistworks"
elseif ( cell == 1182 )
Player->PositionCell 0 0 0 0 "Vivec, Temporary Telvanni Housing"
elseif ( cell == 1183 )
Player->PositionCell 0 0 0 0 "Vivec, Tervur Braven: Trader"
elseif ( cell == 1184 )
Player->PositionCell 0 0 0 0 "Vivec, The Abbey of St. Delyn the Wise"
elseif ( cell == 1185 )
Player->PositionCell 0 0 0 0 "Vivec, The Flowers of Gold"
elseif ( cell == 1186 )
Player->PositionCell 0 0 0 0 "Vivec, The Lizard's Head"
elseif ( cell == 1187 )
Player->PositionCell 0 0 0 0 "Vos, Dreynos Elvul's Farmhouse"
elseif ( cell == 1188 )
Player->PositionCell 0 0 0 0 "Vos, Fanisea Irano's Farmhouse"
elseif ( cell == 1189 )
Player->PositionCell 0 0 0 0 "Vos, Ienasa Radas's Farmhouse"
elseif ( cell == 1190 )
Player->PositionCell 0 0 0 0 "Vos, Maela Kaushad's Farmhouse"
elseif ( cell == 1191 )
Player->PositionCell 0 0 0 0 "Vos, Mandyn Ralas's Farmhouse"
elseif ( cell == 1192 )
Player->PositionCell 0 0 0 0 "Vos, Menus Felas's Farmhouse"
elseif ( cell == 1193 )
Player->PositionCell 0 0 0 0 "Vos, Runethyne Andas's Farmhouse"
elseif ( cell == 1194 )
Player->PositionCell 0 0 0 0 "Vos, Thilse Aralas's Farmhouse"
elseif ( cell == 1195 )
Player->PositionCell 0 0 0 0 "Vos, Trilam Drolnor's Farmhouse"
elseif ( cell == 1196 )
Player->PositionCell 0 0 0 0 "Vos, Ulvil Llothas's Farmhouse"
elseif ( cell == 1197 )
Player->PositionCell 0 0 0 0 "Vos, Varo Tradehouse"
elseif ( cell == 1198 )
Player->PositionCell 0 0 0 0 "Vos, Varo Tradehouse Entrance"
elseif ( cell == 1199 )
Player->PositionCell 0 0 0 0 "Vos, Varo Tradehouse Storage"
elseif ( cell == 1200 )
Player->PositionCell 0 0 0 0 "Vos, Vos Chapel"
elseif ( cell == 1201 )
Player->PositionCell 0 0 0 0 "Yakanalit"
elseif ( cell == 1202 )
Player->PositionCell 0 0 0 0 "Yakaridan Camp, Kitbael's Yurt"
elseif ( cell == 1203 )
Player->PositionCell 0 0 0 0 "Yakin"
elseif ( cell == 1204 )
Player->PositionCell 0 0 0 0 "Yakin, Shrine"
elseif ( cell == 1205 )
Player->PositionCell 0 0 0 0 "Yanemus Mine"
elseif ( cell == 1206 )
Player->PositionCell 0 0 0 0 "Yansirramus, Shrine"
elseif ( cell == 1207 )
Player->PositionCell 0 0 0 0 "Yasammidan, Shrine"
elseif ( cell == 1208 )
Player->PositionCell 0 0 0 0 "Yasamsi"
elseif ( cell == 1209 )
Player->PositionCell 0 0 0 0 "Yassu Mine"
elseif ( cell == 1210 )
Player->PositionCell 0 0 0 0 "Yesamsi"
elseif ( cell == 1211 )
Player->PositionCell 0 0 0 0 "Zainab Camp, Ababael Timsar-Dadisun's Yurt"
elseif ( cell == 1212 )
Player->PositionCell 0 0 0 0 "Zainab Camp, Ashibaal's Yurt"
elseif ( cell == 1213 )
Player->PositionCell 0 0 0 0 "Zainab Camp, Ashkhan's Yurt"
elseif ( cell == 1214 )
Player->PositionCell 0 0 0 0 "Zainab Camp, Ashur-Dan's Yurt"
elseif ( cell == 1215 )
Player->PositionCell 0 0 0 0 "Zainab Camp, Kuda's Yurt"
elseif ( cell == 1216 )
Player->PositionCell 0 0 0 0 "Zainab Camp, Kummu's Yurt"
elseif ( cell == 1217 )
Player->PositionCell 0 0 0 0 "Zainab Camp, Minassour's Yurt"
elseif ( cell == 1218 )
Player->PositionCell 0 0 0 0 "Zainab Camp, Patababi's Yurt"
elseif ( cell == 1219 )
Player->PositionCell 0 0 0 0 "Zainab Camp, Tussi's Yurt"
elseif ( cell == 1220 )
Player->PositionCell 0 0 0 0 "Zainab Camp, Wise Woman's Yurt"
elseif ( cell == 1221 )
Player->PositionCell 0 0 0 0 "Zainsipilu"
elseif ( cell == 1222 )
Player->PositionCell 0 0 0 0 "Zaintirari"
elseif ( cell == 1223 )
Player->PositionCell 0 0 0 0 "Zaintiraris, Shrine"
elseif ( cell == 1224 )
Player->PositionCell 0 0 0 0 "Zalkin Grotto"
elseif ( cell == 1225 )
Player->PositionCell 0 0 0 0 "Zalkin-Sul Egg Mine"
elseif ( cell == 1226 )
Player->PositionCell 0 0 0 0 "Zanabi"
elseif ( cell == 1227 )
Player->PositionCell 0 0 0 0 "Zebabi"
elseif ( cell == 1228 )
Player->PositionCell 0 0 0 0 "Zenarbael"
elseif ( cell == 1229 )
Player->PositionCell 0 0 0 0 "Zergonipal, Shrine"
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setCell_SubA"

End

# vn_Teleport_setGrid_Sub1 ====================================================
Begin vn_Teleport_setGrid_Sub1

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

; y=-19, -29<=x<=23
if ( posy >= -155648 )
if ( posy < -147456 )
if ( posx < -229376 )
Player->Position -233472 -151552 0 0
elseif ( posx < -221184 )
Player->Position -225280 -151552 0 0
elseif ( posx < -212992 )
Player->Position -217088 -151552 0 0
elseif ( posx < -204800 )
Player->Position -208896 -151552 0 0
elseif ( posx < -196608 )
Player->Position -200704 -151552 0 0
elseif ( posx < -188416 )
Player->Position -192512 -151552 0 0
elseif ( posx < -180224 )
Player->Position -184320 -151552 0 0
elseif ( posx < -172032 )
Player->Position -176128 -151552 0 0
elseif ( posx < -163840 )
Player->Position -167936 -151552 0 0
elseif ( posx < -155648 )
Player->Position -159744 -151552 0 0
elseif ( posx < -147456 )
Player->Position -151552 -151552 0 0
elseif ( posx < -139264 )
Player->Position -143360 -151552 0 0
elseif ( posx < -131072 )
Player->Position -135168 -151552 0 0
elseif ( posx < -122880 )
Player->Position -126976 -151552 0 0
elseif ( posx < -114688 )
Player->Position -118784 -151552 0 0
elseif ( posx < -106496 )
Player->Position -110592 -151552 0 0
elseif ( posx < -98304 )
Player->Position -102400 -151552 0 0
elseif ( posx < -90112 )
Player->Position -94208 -151552 0 0
elseif ( posx < -81920 )
Player->Position -86016 -151552 0 0
elseif ( posx < -73728 )
Player->Position -77824 -151552 0 0
elseif ( posx < -65536 )
Player->Position -69632 -151552 0 0
elseif ( posx < -57344 )
Player->Position -61440 -151552 0 0
elseif ( posx < -49152 )
Player->Position -53248 -151552 0 0
elseif ( posx < -40960 )
Player->Position -45056 -151552 0 0
elseif ( posx < -32768 )
Player->Position -36864 -151552 0 0
elseif ( posx < -24576 )
Player->Position -28672 -151552 0 0
elseif ( posx < -16384 )
Player->Position -20480 -151552 0 0
elseif ( posx < -8192 )
Player->Position -12288 -151552 0 0
elseif ( posx < 0 )
Player->Position -4096 -151552 0 0
elseif ( posx < 8192 )
Player->Position 4096 -151552 0 0
elseif ( posx < 16384 )
Player->Position 12288 -151552 0 0
elseif ( posx < 24576 )
Player->Position 20480 -151552 0 0
elseif ( posx < 32768 )
Player->Position 28672 -151552 0 0
elseif ( posx < 40960 )
Player->Position 36864 -151552 0 0
elseif ( posx < 49152 )
Player->Position 45056 -151552 0 0
elseif ( posx < 57344 )
Player->Position 53248 -151552 0 0
elseif ( posx < 65536 )
Player->Position 61440 -151552 0 0
elseif ( posx < 73728 )
Player->Position 69632 -151552 0 0
elseif ( posx < 81920 )
Player->Position 77824 -151552 0 0
elseif ( posx < 90112 )
Player->Position 86016 -151552 0 0
elseif ( posx < 98304 )
Player->Position 94208 -151552 0 0
elseif ( posx < 106496 )
Player->Position 102400 -151552 0 0
elseif ( posx < 114688 )
Player->Position 110592 -151552 0 0
elseif ( posx < 122880 )
Player->Position 118784 -151552 0 0
elseif ( posx < 131072 )
Player->Position 126976 -151552 0 0
elseif ( posx < 139264 )
Player->Position 135168 -151552 0 0
elseif ( posx < 147456 )
Player->Position 143360 -151552 0 0
elseif ( posx < 155648 )
Player->Position 151552 -151552 0 0
elseif ( posx < 163840 )
Player->Position 159744 -151552 0 0
elseif ( posx < 172032 )
Player->Position 167936 -151552 0 0
elseif ( posx < 180224 )
Player->Position 176128 -151552 0 0
elseif ( posx < 188416 )
Player->Position 184320 -151552 0 0
elseif ( posx < 196608 )
Player->Position 192512 -151552 0 0
endif
endif
endif

; y=-18, -29<=x<=23
if ( posy >= -147456 )
if ( posy < -139264 )
if ( posx < -229376 )
Player->Position -233472 -143360 0 0
elseif ( posx < -221184 )
Player->Position -225280 -143360 0 0
elseif ( posx < -212992 )
Player->Position -217088 -143360 0 0
elseif ( posx < -204800 )
Player->Position -208896 -143360 0 0
elseif ( posx < -196608 )
Player->Position -200704 -143360 0 0
elseif ( posx < -188416 )
Player->Position -192512 -143360 0 0
elseif ( posx < -180224 )
Player->Position -184320 -143360 0 0
elseif ( posx < -172032 )
Player->Position -176128 -143360 0 0
elseif ( posx < -163840 )
Player->Position -167936 -143360 0 0
elseif ( posx < -155648 )
Player->Position -159744 -143360 0 0
elseif ( posx < -147456 )
Player->Position -151552 -143360 0 0
elseif ( posx < -139264 )
Player->Position -143360 -143360 0 0
elseif ( posx < -131072 )
Player->Position -135168 -143360 0 0
elseif ( posx < -122880 )
Player->Position -126976 -143360 0 0
elseif ( posx < -114688 )
Player->Position -118784 -143360 0 0
elseif ( posx < -106496 )
Player->Position -110592 -143360 0 0
elseif ( posx < -98304 )
Player->Position -102400 -143360 0 0
elseif ( posx < -90112 )
Player->Position -94208 -143360 0 0
elseif ( posx < -81920 )
Player->Position -86016 -143360 0 0
elseif ( posx < -73728 )
Player->Position -77824 -143360 0 0
elseif ( posx < -65536 )
Player->Position -69632 -143360 0 0
elseif ( posx < -57344 )
Player->Position -61440 -143360 0 0
elseif ( posx < -49152 )
Player->Position -53248 -143360 0 0
elseif ( posx < -40960 )
Player->Position -45056 -143360 0 0
elseif ( posx < -32768 )
Player->Position -36864 -143360 0 0
elseif ( posx < -24576 )
Player->Position -28672 -143360 0 0
elseif ( posx < -16384 )
Player->Position -20480 -143360 0 0
elseif ( posx < -8192 )
Player->Position -12288 -143360 0 0
elseif ( posx < 0 )
Player->Position -4096 -143360 0 0
elseif ( posx < 8192 )
Player->Position 4096 -143360 0 0
elseif ( posx < 16384 )
Player->Position 12288 -143360 0 0
elseif ( posx < 24576 )
Player->Position 20480 -143360 0 0
elseif ( posx < 32768 )
Player->Position 28672 -143360 0 0
elseif ( posx < 40960 )
Player->Position 36864 -143360 0 0
elseif ( posx < 49152 )
Player->Position 45056 -143360 0 0
elseif ( posx < 57344 )
Player->Position 53248 -143360 0 0
elseif ( posx < 65536 )
Player->Position 61440 -143360 0 0
elseif ( posx < 73728 )
Player->Position 69632 -143360 0 0
elseif ( posx < 81920 )
Player->Position 77824 -143360 0 0
elseif ( posx < 90112 )
Player->Position 86016 -143360 0 0
elseif ( posx < 98304 )
Player->Position 94208 -143360 0 0
elseif ( posx < 106496 )
Player->Position 102400 -143360 0 0
elseif ( posx < 114688 )
Player->Position 110592 -143360 0 0
elseif ( posx < 122880 )
Player->Position 118784 -143360 0 0
elseif ( posx < 131072 )
Player->Position 126976 -143360 0 0
elseif ( posx < 139264 )
Player->Position 135168 -143360 0 0
elseif ( posx < 147456 )
Player->Position 143360 -143360 0 0
elseif ( posx < 155648 )
Player->Position 151552 -143360 0 0
elseif ( posx < 163840 )
Player->Position 159744 -143360 0 0
elseif ( posx < 172032 )
Player->Position 167936 -143360 0 0
elseif ( posx < 180224 )
Player->Position 176128 -143360 0 0
elseif ( posx < 188416 )
Player->Position 184320 -143360 0 0
elseif ( posx < 196608 )
Player->Position 192512 -143360 0 0
endif
endif
endif

; y=-17, -29<=x<=23
if ( posy >= -139264 )
if ( posy < -131072 )
if ( posx < -229376 )
Player->Position -233472 -135168 0 0
elseif ( posx < -221184 )
Player->Position -225280 -135168 0 0
elseif ( posx < -212992 )
Player->Position -217088 -135168 0 0
elseif ( posx < -204800 )
Player->Position -208896 -135168 0 0
elseif ( posx < -196608 )
Player->Position -200704 -135168 0 0
elseif ( posx < -188416 )
Player->Position -192512 -135168 0 0
elseif ( posx < -180224 )
Player->Position -184320 -135168 0 0
elseif ( posx < -172032 )
Player->Position -176128 -135168 0 0
elseif ( posx < -163840 )
Player->Position -167936 -135168 0 0
elseif ( posx < -155648 )
Player->Position -159744 -135168 0 0
elseif ( posx < -147456 )
Player->Position -151552 -135168 0 0
elseif ( posx < -139264 )
Player->Position -143360 -135168 0 0
elseif ( posx < -131072 )
Player->Position -135168 -135168 0 0
elseif ( posx < -122880 )
Player->Position -126976 -135168 0 0
elseif ( posx < -114688 )
Player->Position -118784 -135168 0 0
elseif ( posx < -106496 )
Player->Position -110592 -135168 0 0
elseif ( posx < -98304 )
Player->Position -102400 -135168 0 0
elseif ( posx < -90112 )
Player->Position -94208 -135168 0 0
elseif ( posx < -81920 )
Player->Position -86016 -135168 0 0
elseif ( posx < -73728 )
Player->Position -77824 -135168 0 0
elseif ( posx < -65536 )
Player->Position -69632 -135168 0 0
elseif ( posx < -57344 )
Player->Position -61440 -135168 0 0
elseif ( posx < -49152 )
Player->Position -53248 -135168 0 0
elseif ( posx < -40960 )
Player->Position -45056 -135168 0 0
elseif ( posx < -32768 )
Player->Position -36864 -135168 0 0
elseif ( posx < -24576 )
Player->Position -28672 -135168 0 0
elseif ( posx < -16384 )
Player->Position -20480 -135168 0 0
elseif ( posx < -8192 )
Player->Position -12288 -135168 0 0
elseif ( posx < 0 )
Player->Position -4096 -135168 0 0
elseif ( posx < 8192 )
Player->Position 4096 -135168 0 0
elseif ( posx < 16384 )
Player->Position 12288 -135168 0 0
elseif ( posx < 24576 )
Player->Position 20480 -135168 0 0
elseif ( posx < 32768 )
Player->Position 28672 -135168 0 0
elseif ( posx < 40960 )
Player->Position 36864 -135168 0 0
elseif ( posx < 49152 )
Player->Position 45056 -135168 0 0
elseif ( posx < 57344 )
Player->Position 53248 -135168 0 0
elseif ( posx < 65536 )
Player->Position 61440 -135168 0 0
elseif ( posx < 73728 )
Player->Position 69632 -135168 0 0
elseif ( posx < 81920 )
Player->Position 77824 -135168 0 0
elseif ( posx < 90112 )
Player->Position 86016 -135168 0 0
elseif ( posx < 98304 )
Player->Position 94208 -135168 0 0
elseif ( posx < 106496 )
Player->Position 102400 -135168 0 0
elseif ( posx < 114688 )
Player->Position 110592 -135168 0 0
elseif ( posx < 122880 )
Player->Position 118784 -135168 0 0
elseif ( posx < 131072 )
Player->Position 126976 -135168 0 0
elseif ( posx < 139264 )
Player->Position 135168 -135168 0 0
elseif ( posx < 147456 )
Player->Position 143360 -135168 0 0
elseif ( posx < 155648 )
Player->Position 151552 -135168 0 0
elseif ( posx < 163840 )
Player->Position 159744 -135168 0 0
elseif ( posx < 172032 )
Player->Position 167936 -135168 0 0
elseif ( posx < 180224 )
Player->Position 176128 -135168 0 0
elseif ( posx < 188416 )
Player->Position 184320 -135168 0 0
elseif ( posx < 196608 )
Player->Position 192512 -135168 0 0
endif
endif
endif

; y=-16, -29<=x<=23
if ( posy >= -131072 )
if ( posy < -122880 )
if ( posx < -229376 )
Player->Position -233472 -126976 0 0
elseif ( posx < -221184 )
Player->Position -225280 -126976 0 0
elseif ( posx < -212992 )
Player->Position -217088 -126976 0 0
elseif ( posx < -204800 )
Player->Position -208896 -126976 0 0
elseif ( posx < -196608 )
Player->Position -200704 -126976 0 0
elseif ( posx < -188416 )
Player->Position -192512 -126976 0 0
elseif ( posx < -180224 )
Player->Position -184320 -126976 0 0
elseif ( posx < -172032 )
Player->Position -176128 -126976 0 0
elseif ( posx < -163840 )
Player->Position -167936 -126976 0 0
elseif ( posx < -155648 )
Player->Position -159744 -126976 0 0
elseif ( posx < -147456 )
Player->Position -151552 -126976 0 0
elseif ( posx < -139264 )
Player->Position -143360 -126976 0 0
elseif ( posx < -131072 )
Player->Position -135168 -126976 0 0
elseif ( posx < -122880 )
Player->Position -126976 -126976 0 0
elseif ( posx < -114688 )
Player->Position -118784 -126976 0 0
elseif ( posx < -106496 )
Player->Position -110592 -126976 0 0
elseif ( posx < -98304 )
Player->Position -102400 -126976 0 0
elseif ( posx < -90112 )
Player->Position -94208 -126976 0 0
elseif ( posx < -81920 )
Player->Position -86016 -126976 0 0
elseif ( posx < -73728 )
Player->Position -77824 -126976 0 0
elseif ( posx < -65536 )
Player->Position -69632 -126976 0 0
elseif ( posx < -57344 )
Player->Position -61440 -126976 0 0
elseif ( posx < -49152 )
Player->Position -53248 -126976 0 0
elseif ( posx < -40960 )
Player->Position -45056 -126976 0 0
elseif ( posx < -32768 )
Player->Position -36864 -126976 0 0
elseif ( posx < -24576 )
Player->Position -28672 -126976 0 0
elseif ( posx < -16384 )
Player->Position -20480 -126976 0 0
elseif ( posx < -8192 )
Player->Position -12288 -126976 0 0
elseif ( posx < 0 )
Player->Position -4096 -126976 0 0
elseif ( posx < 8192 )
Player->Position 4096 -126976 0 0
elseif ( posx < 16384 )
Player->Position 12288 -126976 0 0
elseif ( posx < 24576 )
Player->Position 20480 -126976 0 0
elseif ( posx < 32768 )
Player->Position 28672 -126976 0 0
elseif ( posx < 40960 )
Player->Position 36864 -126976 0 0
elseif ( posx < 49152 )
Player->Position 45056 -126976 0 0
elseif ( posx < 57344 )
Player->Position 53248 -126976 0 0
elseif ( posx < 65536 )
Player->Position 61440 -126976 0 0
elseif ( posx < 73728 )
Player->Position 69632 -126976 0 0
elseif ( posx < 81920 )
Player->Position 77824 -126976 0 0
elseif ( posx < 90112 )
Player->Position 86016 -126976 0 0
elseif ( posx < 98304 )
Player->Position 94208 -126976 0 0
elseif ( posx < 106496 )
Player->Position 102400 -126976 0 0
elseif ( posx < 114688 )
Player->Position 110592 -126976 0 0
elseif ( posx < 122880 )
Player->Position 118784 -126976 0 0
elseif ( posx < 131072 )
Player->Position 126976 -126976 0 0
elseif ( posx < 139264 )
Player->Position 135168 -126976 0 0
elseif ( posx < 147456 )
Player->Position 143360 -126976 0 0
elseif ( posx < 155648 )
Player->Position 151552 -126976 0 0
elseif ( posx < 163840 )
Player->Position 159744 -126976 0 0
elseif ( posx < 172032 )
Player->Position 167936 -126976 0 0
elseif ( posx < 180224 )
Player->Position 176128 -126976 0 0
elseif ( posx < 188416 )
Player->Position 184320 -126976 0 0
elseif ( posx < 196608 )
Player->Position 192512 -126976 0 0
endif
endif
endif

; y=-15, -29<=x<=23
if ( posy >= -122880 )
if ( posy < -114688 )
if ( posx < -229376 )
Player->Position -233472 -118784 0 0
elseif ( posx < -221184 )
Player->Position -225280 -118784 0 0
elseif ( posx < -212992 )
Player->Position -217088 -118784 0 0
elseif ( posx < -204800 )
Player->Position -208896 -118784 0 0
elseif ( posx < -196608 )
Player->Position -200704 -118784 0 0
elseif ( posx < -188416 )
Player->Position -192512 -118784 0 0
elseif ( posx < -180224 )
Player->Position -184320 -118784 0 0
elseif ( posx < -172032 )
Player->Position -176128 -118784 0 0
elseif ( posx < -163840 )
Player->Position -167936 -118784 0 0
elseif ( posx < -155648 )
Player->Position -159744 -118784 0 0
elseif ( posx < -147456 )
Player->Position -151552 -118784 0 0
elseif ( posx < -139264 )
Player->Position -143360 -118784 0 0
elseif ( posx < -131072 )
Player->Position -135168 -118784 0 0
elseif ( posx < -122880 )
Player->Position -126976 -118784 0 0
elseif ( posx < -114688 )
Player->Position -118784 -118784 0 0
elseif ( posx < -106496 )
Player->Position -110592 -118784 0 0
elseif ( posx < -98304 )
Player->Position -102400 -118784 0 0
elseif ( posx < -90112 )
Player->Position -94208 -118784 0 0
elseif ( posx < -81920 )
Player->Position -86016 -118784 0 0
elseif ( posx < -73728 )
Player->Position -77824 -118784 0 0
elseif ( posx < -65536 )
Player->Position -69632 -118784 0 0
elseif ( posx < -57344 )
Player->Position -61440 -118784 0 0
elseif ( posx < -49152 )
Player->Position -53248 -118784 0 0
elseif ( posx < -40960 )
Player->Position -45056 -118784 0 0
elseif ( posx < -32768 )
Player->Position -36864 -118784 0 0
elseif ( posx < -24576 )
Player->Position -28672 -118784 0 0
elseif ( posx < -16384 )
Player->Position -20480 -118784 0 0
elseif ( posx < -8192 )
Player->Position -12288 -118784 0 0
elseif ( posx < 0 )
Player->Position -4096 -118784 0 0
elseif ( posx < 8192 )
Player->Position 4096 -118784 0 0
elseif ( posx < 16384 )
Player->Position 12288 -118784 0 0
elseif ( posx < 24576 )
Player->Position 20480 -118784 0 0
elseif ( posx < 32768 )
Player->Position 28672 -118784 0 0
elseif ( posx < 40960 )
Player->Position 36864 -118784 0 0
elseif ( posx < 49152 )
Player->Position 45056 -118784 0 0
elseif ( posx < 57344 )
Player->Position 53248 -118784 0 0
elseif ( posx < 65536 )
Player->Position 61440 -118784 0 0
elseif ( posx < 73728 )
Player->Position 69632 -118784 0 0
elseif ( posx < 81920 )
Player->Position 77824 -118784 0 0
elseif ( posx < 90112 )
Player->Position 86016 -118784 0 0
elseif ( posx < 98304 )
Player->Position 94208 -118784 0 0
elseif ( posx < 106496 )
Player->Position 102400 -118784 0 0
elseif ( posx < 114688 )
Player->Position 110592 -118784 0 0
elseif ( posx < 122880 )
Player->Position 118784 -118784 0 0
elseif ( posx < 131072 )
Player->Position 126976 -118784 0 0
elseif ( posx < 139264 )
Player->Position 135168 -118784 0 0
elseif ( posx < 147456 )
Player->Position 143360 -118784 0 0
elseif ( posx < 155648 )
Player->Position 151552 -118784 0 0
elseif ( posx < 163840 )
Player->Position 159744 -118784 0 0
elseif ( posx < 172032 )
Player->Position 167936 -118784 0 0
elseif ( posx < 180224 )
Player->Position 176128 -118784 0 0
elseif ( posx < 188416 )
Player->Position 184320 -118784 0 0
elseif ( posx < 196608 )
Player->Position 192512 -118784 0 0
endif
endif
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setGrid_Sub1"

End

# vn_Teleport_setGrid_Sub2 ====================================================
Begin vn_Teleport_setGrid_Sub2

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

; y=-14, -29<=x<=23
if ( posy >= -114688 )
if ( posy < -106496 )
if ( posx < -229376 )
Player->Position -233472 -110592 0 0
elseif ( posx < -221184 )
Player->Position -225280 -110592 0 0
elseif ( posx < -212992 )
Player->Position -217088 -110592 0 0
elseif ( posx < -204800 )
Player->Position -208896 -110592 0 0
elseif ( posx < -196608 )
Player->Position -200704 -110592 0 0
elseif ( posx < -188416 )
Player->Position -192512 -110592 0 0
elseif ( posx < -180224 )
Player->Position -184320 -110592 0 0
elseif ( posx < -172032 )
Player->Position -176128 -110592 0 0
elseif ( posx < -163840 )
Player->Position -167936 -110592 0 0
elseif ( posx < -155648 )
Player->Position -159744 -110592 0 0
elseif ( posx < -147456 )
Player->Position -151552 -110592 0 0
elseif ( posx < -139264 )
Player->Position -143360 -110592 0 0
elseif ( posx < -131072 )
Player->Position -135168 -110592 0 0
elseif ( posx < -122880 )
Player->Position -126976 -110592 0 0
elseif ( posx < -114688 )
Player->Position -118784 -110592 0 0
elseif ( posx < -106496 )
Player->Position -110592 -110592 0 0
elseif ( posx < -98304 )
Player->Position -102400 -110592 0 0
elseif ( posx < -90112 )
Player->Position -94208 -110592 0 0
elseif ( posx < -81920 )
Player->Position -86016 -110592 0 0
elseif ( posx < -73728 )
Player->Position -77824 -110592 0 0
elseif ( posx < -65536 )
Player->Position -69632 -110592 0 0
elseif ( posx < -57344 )
Player->Position -61440 -110592 0 0
elseif ( posx < -49152 )
Player->Position -53248 -110592 0 0
elseif ( posx < -40960 )
Player->Position -45056 -110592 0 0
elseif ( posx < -32768 )
Player->Position -36864 -110592 0 0
elseif ( posx < -24576 )
Player->Position -28672 -110592 0 0
elseif ( posx < -16384 )
Player->Position -20480 -110592 0 0
elseif ( posx < -8192 )
Player->Position -12288 -110592 0 0
elseif ( posx < 0 )
Player->Position -4096 -110592 0 0
elseif ( posx < 8192 )
Player->Position 4096 -110592 0 0
elseif ( posx < 16384 )
Player->Position 12288 -110592 0 0
elseif ( posx < 24576 )
Player->Position 20480 -110592 0 0
elseif ( posx < 32768 )
Player->Position 28672 -110592 0 0
elseif ( posx < 40960 )
Player->Position 36864 -110592 0 0
elseif ( posx < 49152 )
Player->Position 45056 -110592 0 0
elseif ( posx < 57344 )
Player->Position 53248 -110592 0 0
elseif ( posx < 65536 )
Player->Position 61440 -110592 0 0
elseif ( posx < 73728 )
Player->Position 69632 -110592 0 0
elseif ( posx < 81920 )
Player->Position 77824 -110592 0 0
elseif ( posx < 90112 )
Player->Position 86016 -110592 0 0
elseif ( posx < 98304 )
Player->Position 94208 -110592 0 0
elseif ( posx < 106496 )
Player->Position 102400 -110592 0 0
elseif ( posx < 114688 )
Player->Position 110592 -110592 0 0
elseif ( posx < 122880 )
Player->Position 118784 -110592 0 0
elseif ( posx < 131072 )
Player->Position 126976 -110592 0 0
elseif ( posx < 139264 )
Player->Position 135168 -110592 0 0
elseif ( posx < 147456 )
Player->Position 143360 -110592 0 0
elseif ( posx < 155648 )
Player->Position 151552 -110592 0 0
elseif ( posx < 163840 )
Player->Position 159744 -110592 0 0
elseif ( posx < 172032 )
Player->Position 167936 -110592 0 0
elseif ( posx < 180224 )
Player->Position 176128 -110592 0 0
elseif ( posx < 188416 )
Player->Position 184320 -110592 0 0
elseif ( posx < 196608 )
Player->Position 192512 -110592 0 0
endif
endif
endif

; y=-13, -29<=x<=23
if ( posy >= -106496 )
if ( posy < -98304 )
if ( posx < -229376 )
Player->Position -233472 -102400 0 0
elseif ( posx < -221184 )
Player->Position -225280 -102400 0 0
elseif ( posx < -212992 )
Player->Position -217088 -102400 0 0
elseif ( posx < -204800 )
Player->Position -208896 -102400 0 0
elseif ( posx < -196608 )
Player->Position -200704 -102400 0 0
elseif ( posx < -188416 )
Player->Position -192512 -102400 0 0
elseif ( posx < -180224 )
Player->Position -184320 -102400 0 0
elseif ( posx < -172032 )
Player->Position -176128 -102400 0 0
elseif ( posx < -163840 )
Player->Position -167936 -102400 0 0
elseif ( posx < -155648 )
Player->Position -159744 -102400 0 0
elseif ( posx < -147456 )
Player->Position -151552 -102400 0 0
elseif ( posx < -139264 )
Player->Position -143360 -102400 0 0
elseif ( posx < -131072 )
Player->Position -135168 -102400 0 0
elseif ( posx < -122880 )
Player->Position -126976 -102400 0 0
elseif ( posx < -114688 )
Player->Position -118784 -102400 0 0
elseif ( posx < -106496 )
Player->Position -110592 -102400 0 0
elseif ( posx < -98304 )
Player->Position -102400 -102400 0 0
elseif ( posx < -90112 )
Player->Position -94208 -102400 0 0
elseif ( posx < -81920 )
Player->Position -86016 -102400 0 0
elseif ( posx < -73728 )
Player->Position -77824 -102400 0 0
elseif ( posx < -65536 )
Player->Position -69632 -102400 0 0
elseif ( posx < -57344 )
Player->Position -61440 -102400 0 0
elseif ( posx < -49152 )
Player->Position -53248 -102400 0 0
elseif ( posx < -40960 )
Player->Position -45056 -102400 0 0
elseif ( posx < -32768 )
Player->Position -36864 -102400 0 0
elseif ( posx < -24576 )
Player->Position -28672 -102400 0 0
elseif ( posx < -16384 )
Player->Position -20480 -102400 0 0
elseif ( posx < -8192 )
Player->Position -12288 -102400 0 0
elseif ( posx < 0 )
Player->Position -4096 -102400 0 0
elseif ( posx < 8192 )
Player->Position 4096 -102400 0 0
elseif ( posx < 16384 )
Player->Position 12288 -102400 0 0
elseif ( posx < 24576 )
Player->Position 20480 -102400 0 0
elseif ( posx < 32768 )
Player->Position 28672 -102400 0 0
elseif ( posx < 40960 )
Player->Position 36864 -102400 0 0
elseif ( posx < 49152 )
Player->Position 45056 -102400 0 0
elseif ( posx < 57344 )
Player->Position 53248 -102400 0 0
elseif ( posx < 65536 )
Player->Position 61440 -102400 0 0
elseif ( posx < 73728 )
Player->Position 69632 -102400 0 0
elseif ( posx < 81920 )
Player->Position 77824 -102400 0 0
elseif ( posx < 90112 )
Player->Position 86016 -102400 0 0
elseif ( posx < 98304 )
Player->Position 94208 -102400 0 0
elseif ( posx < 106496 )
Player->Position 102400 -102400 0 0
elseif ( posx < 114688 )
Player->Position 110592 -102400 0 0
elseif ( posx < 122880 )
Player->Position 118784 -102400 0 0
elseif ( posx < 131072 )
Player->Position 126976 -102400 0 0
elseif ( posx < 139264 )
Player->Position 135168 -102400 0 0
elseif ( posx < 147456 )
Player->Position 143360 -102400 0 0
elseif ( posx < 155648 )
Player->Position 151552 -102400 0 0
elseif ( posx < 163840 )
Player->Position 159744 -102400 0 0
elseif ( posx < 172032 )
Player->Position 167936 -102400 0 0
elseif ( posx < 180224 )
Player->Position 176128 -102400 0 0
elseif ( posx < 188416 )
Player->Position 184320 -102400 0 0
elseif ( posx < 196608 )
Player->Position 192512 -102400 0 0
endif
endif
endif

; y=-12, -29<=x<=23
if ( posy >= -98304 )
if ( posy < -90112 )
if ( posx < -229376 )
Player->Position -233472 -94208 0 0
elseif ( posx < -221184 )
Player->Position -225280 -94208 0 0
elseif ( posx < -212992 )
Player->Position -217088 -94208 0 0
elseif ( posx < -204800 )
Player->Position -208896 -94208 0 0
elseif ( posx < -196608 )
Player->Position -200704 -94208 0 0
elseif ( posx < -188416 )
Player->Position -192512 -94208 0 0
elseif ( posx < -180224 )
Player->Position -184320 -94208 0 0
elseif ( posx < -172032 )
Player->Position -176128 -94208 0 0
elseif ( posx < -163840 )
Player->Position -167936 -94208 0 0
elseif ( posx < -155648 )
Player->Position -159744 -94208 0 0
elseif ( posx < -147456 )
Player->Position -151552 -94208 0 0
elseif ( posx < -139264 )
Player->Position -143360 -94208 0 0
elseif ( posx < -131072 )
Player->Position -135168 -94208 0 0
elseif ( posx < -122880 )
Player->Position -126976 -94208 0 0
elseif ( posx < -114688 )
Player->Position -118784 -94208 0 0
elseif ( posx < -106496 )
Player->Position -110592 -94208 0 0
elseif ( posx < -98304 )
Player->Position -102400 -94208 0 0
elseif ( posx < -90112 )
Player->Position -94208 -94208 0 0
elseif ( posx < -81920 )
Player->Position -86016 -94208 0 0
elseif ( posx < -73728 )
Player->Position -77824 -94208 0 0
elseif ( posx < -65536 )
Player->Position -69632 -94208 0 0
elseif ( posx < -57344 )
Player->Position -61440 -94208 0 0
elseif ( posx < -49152 )
Player->Position -53248 -94208 0 0
elseif ( posx < -40960 )
Player->Position -45056 -94208 0 0
elseif ( posx < -32768 )
Player->Position -36864 -94208 0 0
elseif ( posx < -24576 )
Player->Position -28672 -94208 0 0
elseif ( posx < -16384 )
Player->Position -20480 -94208 0 0
elseif ( posx < -8192 )
Player->Position -12288 -94208 0 0
elseif ( posx < 0 )
Player->Position -4096 -94208 0 0
elseif ( posx < 8192 )
Player->Position 4096 -94208 0 0
elseif ( posx < 16384 )
Player->Position 12288 -94208 0 0
elseif ( posx < 24576 )
Player->Position 20480 -94208 0 0
elseif ( posx < 32768 )
Player->Position 28672 -94208 0 0
elseif ( posx < 40960 )
Player->Position 36864 -94208 0 0
elseif ( posx < 49152 )
Player->Position 45056 -94208 0 0
elseif ( posx < 57344 )
Player->Position 53248 -94208 0 0
elseif ( posx < 65536 )
Player->Position 61440 -94208 0 0
elseif ( posx < 73728 )
Player->Position 69632 -94208 0 0
elseif ( posx < 81920 )
Player->Position 77824 -94208 0 0
elseif ( posx < 90112 )
Player->Position 86016 -94208 0 0
elseif ( posx < 98304 )
Player->Position 94208 -94208 0 0
elseif ( posx < 106496 )
Player->Position 102400 -94208 0 0
elseif ( posx < 114688 )
Player->Position 110592 -94208 0 0
elseif ( posx < 122880 )
Player->Position 118784 -94208 0 0
elseif ( posx < 131072 )
Player->Position 126976 -94208 0 0
elseif ( posx < 139264 )
Player->Position 135168 -94208 0 0
elseif ( posx < 147456 )
Player->Position 143360 -94208 0 0
elseif ( posx < 155648 )
Player->Position 151552 -94208 0 0
elseif ( posx < 163840 )
Player->Position 159744 -94208 0 0
elseif ( posx < 172032 )
Player->Position 167936 -94208 0 0
elseif ( posx < 180224 )
Player->Position 176128 -94208 0 0
elseif ( posx < 188416 )
Player->Position 184320 -94208 0 0
elseif ( posx < 196608 )
Player->Position 192512 -94208 0 0
endif
endif
endif

; y=-11, -29<=x<=23
if ( posy >= -90112 )
if ( posy < -81920 )
if ( posx < -229376 )
Player->Position -233472 -86016 0 0
elseif ( posx < -221184 )
Player->Position -225280 -86016 0 0
elseif ( posx < -212992 )
Player->Position -217088 -86016 0 0
elseif ( posx < -204800 )
Player->Position -208896 -86016 0 0
elseif ( posx < -196608 )
Player->Position -200704 -86016 0 0
elseif ( posx < -188416 )
Player->Position -192512 -86016 0 0
elseif ( posx < -180224 )
Player->Position -184320 -86016 0 0
elseif ( posx < -172032 )
Player->Position -176128 -86016 0 0
elseif ( posx < -163840 )
Player->Position -167936 -86016 0 0
elseif ( posx < -155648 )
Player->Position -159744 -86016 0 0
elseif ( posx < -147456 )
Player->Position -151552 -86016 0 0
elseif ( posx < -139264 )
Player->Position -143360 -86016 0 0
elseif ( posx < -131072 )
Player->Position -135168 -86016 0 0
elseif ( posx < -122880 )
Player->Position -126976 -86016 0 0
elseif ( posx < -114688 )
Player->Position -118784 -86016 0 0
elseif ( posx < -106496 )
Player->Position -110592 -86016 0 0
elseif ( posx < -98304 )
Player->Position -102400 -86016 0 0
elseif ( posx < -90112 )
Player->Position -94208 -86016 0 0
elseif ( posx < -81920 )
Player->Position -86016 -86016 0 0
elseif ( posx < -73728 )
Player->Position -77824 -86016 0 0
elseif ( posx < -65536 )
Player->Position -69632 -86016 0 0
elseif ( posx < -57344 )
Player->Position -61440 -86016 0 0
elseif ( posx < -49152 )
Player->Position -53248 -86016 0 0
elseif ( posx < -40960 )
Player->Position -45056 -86016 0 0
elseif ( posx < -32768 )
Player->Position -36864 -86016 0 0
elseif ( posx < -24576 )
Player->Position -28672 -86016 0 0
elseif ( posx < -16384 )
Player->Position -20480 -86016 0 0
elseif ( posx < -8192 )
Player->Position -12288 -86016 0 0
elseif ( posx < 0 )
Player->Position -4096 -86016 0 0
elseif ( posx < 8192 )
Player->Position 4096 -86016 0 0
elseif ( posx < 16384 )
Player->Position 12288 -86016 0 0
elseif ( posx < 24576 )
Player->Position 20480 -86016 0 0
elseif ( posx < 32768 )
Player->Position 28672 -86016 0 0
elseif ( posx < 40960 )
Player->Position 36864 -86016 0 0
elseif ( posx < 49152 )
Player->Position 45056 -86016 0 0
elseif ( posx < 57344 )
Player->Position 53248 -86016 0 0
elseif ( posx < 65536 )
Player->Position 61440 -86016 0 0
elseif ( posx < 73728 )
Player->Position 69632 -86016 0 0
elseif ( posx < 81920 )
Player->Position 77824 -86016 0 0
elseif ( posx < 90112 )
Player->Position 86016 -86016 0 0
elseif ( posx < 98304 )
Player->Position 94208 -86016 0 0
elseif ( posx < 106496 )
Player->Position 102400 -86016 0 0
elseif ( posx < 114688 )
Player->Position 110592 -86016 0 0
elseif ( posx < 122880 )
Player->Position 118784 -86016 0 0
elseif ( posx < 131072 )
Player->Position 126976 -86016 0 0
elseif ( posx < 139264 )
Player->Position 135168 -86016 0 0
elseif ( posx < 147456 )
Player->Position 143360 -86016 0 0
elseif ( posx < 155648 )
Player->Position 151552 -86016 0 0
elseif ( posx < 163840 )
Player->Position 159744 -86016 0 0
elseif ( posx < 172032 )
Player->Position 167936 -86016 0 0
elseif ( posx < 180224 )
Player->Position 176128 -86016 0 0
elseif ( posx < 188416 )
Player->Position 184320 -86016 0 0
elseif ( posx < 196608 )
Player->Position 192512 -86016 0 0
endif
endif
endif

; y=-10, -29<=x<=23
if ( posy >= -81920 )
if ( posy < -73728 )
if ( posx < -229376 )
Player->Position -233472 -77824 0 0
elseif ( posx < -221184 )
Player->Position -225280 -77824 0 0
elseif ( posx < -212992 )
Player->Position -217088 -77824 0 0
elseif ( posx < -204800 )
Player->Position -208896 -77824 0 0
elseif ( posx < -196608 )
Player->Position -200704 -77824 0 0
elseif ( posx < -188416 )
Player->Position -192512 -77824 0 0
elseif ( posx < -180224 )
Player->Position -184320 -77824 0 0
elseif ( posx < -172032 )
Player->Position -176128 -77824 0 0
elseif ( posx < -163840 )
Player->Position -167936 -77824 0 0
elseif ( posx < -155648 )
Player->Position -159744 -77824 0 0
elseif ( posx < -147456 )
Player->Position -151552 -77824 0 0
elseif ( posx < -139264 )
Player->Position -143360 -77824 0 0
elseif ( posx < -131072 )
Player->Position -135168 -77824 0 0
elseif ( posx < -122880 )
Player->Position -126976 -77824 0 0
elseif ( posx < -114688 )
Player->Position -118784 -77824 0 0
elseif ( posx < -106496 )
Player->Position -110592 -77824 0 0
elseif ( posx < -98304 )
Player->Position -102400 -77824 0 0
elseif ( posx < -90112 )
Player->Position -94208 -77824 0 0
elseif ( posx < -81920 )
Player->Position -86016 -77824 0 0
elseif ( posx < -73728 )
Player->Position -77824 -77824 0 0
elseif ( posx < -65536 )
Player->Position -69632 -77824 0 0
elseif ( posx < -57344 )
Player->Position -61440 -77824 0 0
elseif ( posx < -49152 )
Player->Position -53248 -77824 0 0
elseif ( posx < -40960 )
Player->Position -45056 -77824 0 0
elseif ( posx < -32768 )
Player->Position -36864 -77824 0 0
elseif ( posx < -24576 )
Player->Position -28672 -77824 0 0
elseif ( posx < -16384 )
Player->Position -20480 -77824 0 0
elseif ( posx < -8192 )
Player->Position -12288 -77824 0 0
elseif ( posx < 0 )
Player->Position -4096 -77824 0 0
elseif ( posx < 8192 )
Player->Position 4096 -77824 0 0
elseif ( posx < 16384 )
Player->Position 12288 -77824 0 0
elseif ( posx < 24576 )
Player->Position 20480 -77824 0 0
elseif ( posx < 32768 )
Player->Position 28672 -77824 0 0
elseif ( posx < 40960 )
Player->Position 36864 -77824 0 0
elseif ( posx < 49152 )
Player->Position 45056 -77824 0 0
elseif ( posx < 57344 )
Player->Position 53248 -77824 0 0
elseif ( posx < 65536 )
Player->Position 61440 -77824 0 0
elseif ( posx < 73728 )
Player->Position 69632 -77824 0 0
elseif ( posx < 81920 )
Player->Position 77824 -77824 0 0
elseif ( posx < 90112 )
Player->Position 86016 -77824 0 0
elseif ( posx < 98304 )
Player->Position 94208 -77824 0 0
elseif ( posx < 106496 )
Player->Position 102400 -77824 0 0
elseif ( posx < 114688 )
Player->Position 110592 -77824 0 0
elseif ( posx < 122880 )
Player->Position 118784 -77824 0 0
elseif ( posx < 131072 )
Player->Position 126976 -77824 0 0
elseif ( posx < 139264 )
Player->Position 135168 -77824 0 0
elseif ( posx < 147456 )
Player->Position 143360 -77824 0 0
elseif ( posx < 155648 )
Player->Position 151552 -77824 0 0
elseif ( posx < 163840 )
Player->Position 159744 -77824 0 0
elseif ( posx < 172032 )
Player->Position 167936 -77824 0 0
elseif ( posx < 180224 )
Player->Position 176128 -77824 0 0
elseif ( posx < 188416 )
Player->Position 184320 -77824 0 0
elseif ( posx < 196608 )
Player->Position 192512 -77824 0 0
endif
endif
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setGrid_Sub2"

End

# vn_Teleport_setGrid_Sub3 ====================================================
Begin vn_Teleport_setGrid_Sub3

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

; y=-9, -29<=x<=23
if ( posy >= -73728 )
if ( posy < -65536 )
if ( posx < -229376 )
Player->Position -233472 -69632 0 0
elseif ( posx < -221184 )
Player->Position -225280 -69632 0 0
elseif ( posx < -212992 )
Player->Position -217088 -69632 0 0
elseif ( posx < -204800 )
Player->Position -208896 -69632 0 0
elseif ( posx < -196608 )
Player->Position -200704 -69632 0 0
elseif ( posx < -188416 )
Player->Position -192512 -69632 0 0
elseif ( posx < -180224 )
Player->Position -184320 -69632 0 0
elseif ( posx < -172032 )
Player->Position -176128 -69632 0 0
elseif ( posx < -163840 )
Player->Position -167936 -69632 0 0
elseif ( posx < -155648 )
Player->Position -159744 -69632 0 0
elseif ( posx < -147456 )
Player->Position -151552 -69632 0 0
elseif ( posx < -139264 )
Player->Position -143360 -69632 0 0
elseif ( posx < -131072 )
Player->Position -135168 -69632 0 0
elseif ( posx < -122880 )
Player->Position -126976 -69632 0 0
elseif ( posx < -114688 )
Player->Position -118784 -69632 0 0
elseif ( posx < -106496 )
Player->Position -110592 -69632 0 0
elseif ( posx < -98304 )
Player->Position -102400 -69632 0 0
elseif ( posx < -90112 )
Player->Position -94208 -69632 0 0
elseif ( posx < -81920 )
Player->Position -86016 -69632 0 0
elseif ( posx < -73728 )
Player->Position -77824 -69632 0 0
elseif ( posx < -65536 )
Player->Position -69632 -69632 0 0
elseif ( posx < -57344 )
Player->Position -61440 -69632 0 0
elseif ( posx < -49152 )
Player->Position -53248 -69632 0 0
elseif ( posx < -40960 )
Player->Position -45056 -69632 0 0
elseif ( posx < -32768 )
Player->Position -36864 -69632 0 0
elseif ( posx < -24576 )
Player->Position -28672 -69632 0 0
elseif ( posx < -16384 )
Player->Position -20480 -69632 0 0
elseif ( posx < -8192 )
Player->Position -12288 -69632 0 0
elseif ( posx < 0 )
Player->Position -4096 -69632 0 0
elseif ( posx < 8192 )
Player->Position 4096 -69632 0 0
elseif ( posx < 16384 )
Player->Position 12288 -69632 0 0
elseif ( posx < 24576 )
Player->Position 20480 -69632 0 0
elseif ( posx < 32768 )
Player->Position 28672 -69632 0 0
elseif ( posx < 40960 )
Player->Position 36864 -69632 0 0
elseif ( posx < 49152 )
Player->Position 45056 -69632 0 0
elseif ( posx < 57344 )
Player->Position 53248 -69632 0 0
elseif ( posx < 65536 )
Player->Position 61440 -69632 0 0
elseif ( posx < 73728 )
Player->Position 69632 -69632 0 0
elseif ( posx < 81920 )
Player->Position 77824 -69632 0 0
elseif ( posx < 90112 )
Player->Position 86016 -69632 0 0
elseif ( posx < 98304 )
Player->Position 94208 -69632 0 0
elseif ( posx < 106496 )
Player->Position 102400 -69632 0 0
elseif ( posx < 114688 )
Player->Position 110592 -69632 0 0
elseif ( posx < 122880 )
Player->Position 118784 -69632 0 0
elseif ( posx < 131072 )
Player->Position 126976 -69632 0 0
elseif ( posx < 139264 )
Player->Position 135168 -69632 0 0
elseif ( posx < 147456 )
Player->Position 143360 -69632 0 0
elseif ( posx < 155648 )
Player->Position 151552 -69632 0 0
elseif ( posx < 163840 )
Player->Position 159744 -69632 0 0
elseif ( posx < 172032 )
Player->Position 167936 -69632 0 0
elseif ( posx < 180224 )
Player->Position 176128 -69632 0 0
elseif ( posx < 188416 )
Player->Position 184320 -69632 0 0
elseif ( posx < 196608 )
Player->Position 192512 -69632 0 0
endif
endif
endif

; y=-8, -29<=x<=23
if ( posy >= -65536 )
if ( posy < -57344 )
if ( posx < -229376 )
Player->Position -233472 -61440 0 0
elseif ( posx < -221184 )
Player->Position -225280 -61440 0 0
elseif ( posx < -212992 )
Player->Position -217088 -61440 0 0
elseif ( posx < -204800 )
Player->Position -208896 -61440 0 0
elseif ( posx < -196608 )
Player->Position -200704 -61440 0 0
elseif ( posx < -188416 )
Player->Position -192512 -61440 0 0
elseif ( posx < -180224 )
Player->Position -184320 -61440 0 0
elseif ( posx < -172032 )
Player->Position -176128 -61440 0 0
elseif ( posx < -163840 )
Player->Position -167936 -61440 0 0
elseif ( posx < -155648 )
Player->Position -159744 -61440 0 0
elseif ( posx < -147456 )
Player->Position -151552 -61440 0 0
elseif ( posx < -139264 )
Player->Position -143360 -61440 0 0
elseif ( posx < -131072 )
Player->Position -135168 -61440 0 0
elseif ( posx < -122880 )
Player->Position -126976 -61440 0 0
elseif ( posx < -114688 )
Player->Position -118784 -61440 0 0
elseif ( posx < -106496 )
Player->Position -110592 -61440 0 0
elseif ( posx < -98304 )
Player->Position -102400 -61440 0 0
elseif ( posx < -90112 )
Player->Position -94208 -61440 0 0
elseif ( posx < -81920 )
Player->Position -86016 -61440 0 0
elseif ( posx < -73728 )
Player->Position -77824 -61440 0 0
elseif ( posx < -65536 )
Player->Position -69632 -61440 0 0
elseif ( posx < -57344 )
Player->Position -61440 -61440 0 0
elseif ( posx < -49152 )
Player->Position -53248 -61440 0 0
elseif ( posx < -40960 )
Player->Position -45056 -61440 0 0
elseif ( posx < -32768 )
Player->Position -36864 -61440 0 0
elseif ( posx < -24576 )
Player->Position -28672 -61440 0 0
elseif ( posx < -16384 )
Player->Position -20480 -61440 0 0
elseif ( posx < -8192 )
Player->Position -12288 -61440 0 0
elseif ( posx < 0 )
Player->Position -4096 -61440 0 0
elseif ( posx < 8192 )
Player->Position 4096 -61440 0 0
elseif ( posx < 16384 )
Player->Position 12288 -61440 0 0
elseif ( posx < 24576 )
Player->Position 20480 -61440 0 0
elseif ( posx < 32768 )
Player->Position 28672 -61440 0 0
elseif ( posx < 40960 )
Player->Position 36864 -61440 0 0
elseif ( posx < 49152 )
Player->Position 45056 -61440 0 0
elseif ( posx < 57344 )
Player->Position 53248 -61440 0 0
elseif ( posx < 65536 )
Player->Position 61440 -61440 0 0
elseif ( posx < 73728 )
Player->Position 69632 -61440 0 0
elseif ( posx < 81920 )
Player->Position 77824 -61440 0 0
elseif ( posx < 90112 )
Player->Position 86016 -61440 0 0
elseif ( posx < 98304 )
Player->Position 94208 -61440 0 0
elseif ( posx < 106496 )
Player->Position 102400 -61440 0 0
elseif ( posx < 114688 )
Player->Position 110592 -61440 0 0
elseif ( posx < 122880 )
Player->Position 118784 -61440 0 0
elseif ( posx < 131072 )
Player->Position 126976 -61440 0 0
elseif ( posx < 139264 )
Player->Position 135168 -61440 0 0
elseif ( posx < 147456 )
Player->Position 143360 -61440 0 0
elseif ( posx < 155648 )
Player->Position 151552 -61440 0 0
elseif ( posx < 163840 )
Player->Position 159744 -61440 0 0
elseif ( posx < 172032 )
Player->Position 167936 -61440 0 0
elseif ( posx < 180224 )
Player->Position 176128 -61440 0 0
elseif ( posx < 188416 )
Player->Position 184320 -61440 0 0
elseif ( posx < 196608 )
Player->Position 192512 -61440 0 0
endif
endif
endif

; y=-7, -29<=x<=23
if ( posy >= -57344 )
if ( posy < -49152 )
if ( posx < -229376 )
Player->Position -233472 -53248 0 0
elseif ( posx < -221184 )
Player->Position -225280 -53248 0 0
elseif ( posx < -212992 )
Player->Position -217088 -53248 0 0
elseif ( posx < -204800 )
Player->Position -208896 -53248 0 0
elseif ( posx < -196608 )
Player->Position -200704 -53248 0 0
elseif ( posx < -188416 )
Player->Position -192512 -53248 0 0
elseif ( posx < -180224 )
Player->Position -184320 -53248 0 0
elseif ( posx < -172032 )
Player->Position -176128 -53248 0 0
elseif ( posx < -163840 )
Player->Position -167936 -53248 0 0
elseif ( posx < -155648 )
Player->Position -159744 -53248 0 0
elseif ( posx < -147456 )
Player->Position -151552 -53248 0 0
elseif ( posx < -139264 )
Player->Position -143360 -53248 0 0
elseif ( posx < -131072 )
Player->Position -135168 -53248 0 0
elseif ( posx < -122880 )
Player->Position -126976 -53248 0 0
elseif ( posx < -114688 )
Player->Position -118784 -53248 0 0
elseif ( posx < -106496 )
Player->Position -110592 -53248 0 0
elseif ( posx < -98304 )
Player->Position -102400 -53248 0 0
elseif ( posx < -90112 )
Player->Position -94208 -53248 0 0
elseif ( posx < -81920 )
Player->Position -86016 -53248 0 0
elseif ( posx < -73728 )
Player->Position -77824 -53248 0 0
elseif ( posx < -65536 )
Player->Position -69632 -53248 0 0
elseif ( posx < -57344 )
Player->Position -61440 -53248 0 0
elseif ( posx < -49152 )
Player->Position -53248 -53248 0 0
elseif ( posx < -40960 )
Player->Position -45056 -53248 0 0
elseif ( posx < -32768 )
Player->Position -36864 -53248 0 0
elseif ( posx < -24576 )
Player->Position -28672 -53248 0 0
elseif ( posx < -16384 )
Player->Position -20480 -53248 0 0
elseif ( posx < -8192 )
Player->Position -12288 -53248 0 0
elseif ( posx < 0 )
Player->Position -4096 -53248 0 0
elseif ( posx < 8192 )
Player->Position 4096 -53248 0 0
elseif ( posx < 16384 )
Player->Position 12288 -53248 0 0
elseif ( posx < 24576 )
Player->Position 20480 -53248 0 0
elseif ( posx < 32768 )
Player->Position 28672 -53248 0 0
elseif ( posx < 40960 )
Player->Position 36864 -53248 0 0
elseif ( posx < 49152 )
Player->Position 45056 -53248 0 0
elseif ( posx < 57344 )
Player->Position 53248 -53248 0 0
elseif ( posx < 65536 )
Player->Position 61440 -53248 0 0
elseif ( posx < 73728 )
Player->Position 69632 -53248 0 0
elseif ( posx < 81920 )
Player->Position 77824 -53248 0 0
elseif ( posx < 90112 )
Player->Position 86016 -53248 0 0
elseif ( posx < 98304 )
Player->Position 94208 -53248 0 0
elseif ( posx < 106496 )
Player->Position 102400 -53248 0 0
elseif ( posx < 114688 )
Player->Position 110592 -53248 0 0
elseif ( posx < 122880 )
Player->Position 118784 -53248 0 0
elseif ( posx < 131072 )
Player->Position 126976 -53248 0 0
elseif ( posx < 139264 )
Player->Position 135168 -53248 0 0
elseif ( posx < 147456 )
Player->Position 143360 -53248 0 0
elseif ( posx < 155648 )
Player->Position 151552 -53248 0 0
elseif ( posx < 163840 )
Player->Position 159744 -53248 0 0
elseif ( posx < 172032 )
Player->Position 167936 -53248 0 0
elseif ( posx < 180224 )
Player->Position 176128 -53248 0 0
elseif ( posx < 188416 )
Player->Position 184320 -53248 0 0
elseif ( posx < 196608 )
Player->Position 192512 -53248 0 0
endif
endif
endif

; y=-6, -29<=x<=23
if ( posy >= -49152 )
if ( posy < -40960 )
if ( posx < -229376 )
Player->Position -233472 -45056 0 0
elseif ( posx < -221184 )
Player->Position -225280 -45056 0 0
elseif ( posx < -212992 )
Player->Position -217088 -45056 0 0
elseif ( posx < -204800 )
Player->Position -208896 -45056 0 0
elseif ( posx < -196608 )
Player->Position -200704 -45056 0 0
elseif ( posx < -188416 )
Player->Position -192512 -45056 0 0
elseif ( posx < -180224 )
Player->Position -184320 -45056 0 0
elseif ( posx < -172032 )
Player->Position -176128 -45056 0 0
elseif ( posx < -163840 )
Player->Position -167936 -45056 0 0
elseif ( posx < -155648 )
Player->Position -159744 -45056 0 0
elseif ( posx < -147456 )
Player->Position -151552 -45056 0 0
elseif ( posx < -139264 )
Player->Position -143360 -45056 0 0
elseif ( posx < -131072 )
Player->Position -135168 -45056 0 0
elseif ( posx < -122880 )
Player->Position -126976 -45056 0 0
elseif ( posx < -114688 )
Player->Position -118784 -45056 0 0
elseif ( posx < -106496 )
Player->Position -110592 -45056 0 0
elseif ( posx < -98304 )
Player->Position -102400 -45056 0 0
elseif ( posx < -90112 )
Player->Position -94208 -45056 0 0
elseif ( posx < -81920 )
Player->Position -86016 -45056 0 0
elseif ( posx < -73728 )
Player->Position -77824 -45056 0 0
elseif ( posx < -65536 )
Player->Position -69632 -45056 0 0
elseif ( posx < -57344 )
Player->Position -61440 -45056 0 0
elseif ( posx < -49152 )
Player->Position -53248 -45056 0 0
elseif ( posx < -40960 )
Player->Position -45056 -45056 0 0
elseif ( posx < -32768 )
Player->Position -36864 -45056 0 0
elseif ( posx < -24576 )
Player->Position -28672 -45056 0 0
elseif ( posx < -16384 )
Player->Position -20480 -45056 0 0
elseif ( posx < -8192 )
Player->Position -12288 -45056 0 0
elseif ( posx < 0 )
Player->Position -4096 -45056 0 0
elseif ( posx < 8192 )
Player->Position 4096 -45056 0 0
elseif ( posx < 16384 )
Player->Position 12288 -45056 0 0
elseif ( posx < 24576 )
Player->Position 20480 -45056 0 0
elseif ( posx < 32768 )
Player->Position 28672 -45056 0 0
elseif ( posx < 40960 )
Player->Position 36864 -45056 0 0
elseif ( posx < 49152 )
Player->Position 45056 -45056 0 0
elseif ( posx < 57344 )
Player->Position 53248 -45056 0 0
elseif ( posx < 65536 )
Player->Position 61440 -45056 0 0
elseif ( posx < 73728 )
Player->Position 69632 -45056 0 0
elseif ( posx < 81920 )
Player->Position 77824 -45056 0 0
elseif ( posx < 90112 )
Player->Position 86016 -45056 0 0
elseif ( posx < 98304 )
Player->Position 94208 -45056 0 0
elseif ( posx < 106496 )
Player->Position 102400 -45056 0 0
elseif ( posx < 114688 )
Player->Position 110592 -45056 0 0
elseif ( posx < 122880 )
Player->Position 118784 -45056 0 0
elseif ( posx < 131072 )
Player->Position 126976 -45056 0 0
elseif ( posx < 139264 )
Player->Position 135168 -45056 0 0
elseif ( posx < 147456 )
Player->Position 143360 -45056 0 0
elseif ( posx < 155648 )
Player->Position 151552 -45056 0 0
elseif ( posx < 163840 )
Player->Position 159744 -45056 0 0
elseif ( posx < 172032 )
Player->Position 167936 -45056 0 0
elseif ( posx < 180224 )
Player->Position 176128 -45056 0 0
elseif ( posx < 188416 )
Player->Position 184320 -45056 0 0
elseif ( posx < 196608 )
Player->Position 192512 -45056 0 0
endif
endif
endif

; y=-5, -29<=x<=23
if ( posy >= -40960 )
if ( posy < -32768 )
if ( posx < -229376 )
Player->Position -233472 -36864 0 0
elseif ( posx < -221184 )
Player->Position -225280 -36864 0 0
elseif ( posx < -212992 )
Player->Position -217088 -36864 0 0
elseif ( posx < -204800 )
Player->Position -208896 -36864 0 0
elseif ( posx < -196608 )
Player->Position -200704 -36864 0 0
elseif ( posx < -188416 )
Player->Position -192512 -36864 0 0
elseif ( posx < -180224 )
Player->Position -184320 -36864 0 0
elseif ( posx < -172032 )
Player->Position -176128 -36864 0 0
elseif ( posx < -163840 )
Player->Position -167936 -36864 0 0
elseif ( posx < -155648 )
Player->Position -159744 -36864 0 0
elseif ( posx < -147456 )
Player->Position -151552 -36864 0 0
elseif ( posx < -139264 )
Player->Position -143360 -36864 0 0
elseif ( posx < -131072 )
Player->Position -135168 -36864 0 0
elseif ( posx < -122880 )
Player->Position -126976 -36864 0 0
elseif ( posx < -114688 )
Player->Position -118784 -36864 0 0
elseif ( posx < -106496 )
Player->Position -110592 -36864 0 0
elseif ( posx < -98304 )
Player->Position -102400 -36864 0 0
elseif ( posx < -90112 )
Player->Position -94208 -36864 0 0
elseif ( posx < -81920 )
Player->Position -86016 -36864 0 0
elseif ( posx < -73728 )
Player->Position -77824 -36864 0 0
elseif ( posx < -65536 )
Player->Position -69632 -36864 0 0
elseif ( posx < -57344 )
Player->Position -61440 -36864 0 0
elseif ( posx < -49152 )
Player->Position -53248 -36864 0 0
elseif ( posx < -40960 )
Player->Position -45056 -36864 0 0
elseif ( posx < -32768 )
Player->Position -36864 -36864 0 0
elseif ( posx < -24576 )
Player->Position -28672 -36864 0 0
elseif ( posx < -16384 )
Player->Position -20480 -36864 0 0
elseif ( posx < -8192 )
Player->Position -12288 -36864 0 0
elseif ( posx < 0 )
Player->Position -4096 -36864 0 0
elseif ( posx < 8192 )
Player->Position 4096 -36864 0 0
elseif ( posx < 16384 )
Player->Position 12288 -36864 0 0
elseif ( posx < 24576 )
Player->Position 20480 -36864 0 0
elseif ( posx < 32768 )
Player->Position 28672 -36864 0 0
elseif ( posx < 40960 )
Player->Position 36864 -36864 0 0
elseif ( posx < 49152 )
Player->Position 45056 -36864 0 0
elseif ( posx < 57344 )
Player->Position 53248 -36864 0 0
elseif ( posx < 65536 )
Player->Position 61440 -36864 0 0
elseif ( posx < 73728 )
Player->Position 69632 -36864 0 0
elseif ( posx < 81920 )
Player->Position 77824 -36864 0 0
elseif ( posx < 90112 )
Player->Position 86016 -36864 0 0
elseif ( posx < 98304 )
Player->Position 94208 -36864 0 0
elseif ( posx < 106496 )
Player->Position 102400 -36864 0 0
elseif ( posx < 114688 )
Player->Position 110592 -36864 0 0
elseif ( posx < 122880 )
Player->Position 118784 -36864 0 0
elseif ( posx < 131072 )
Player->Position 126976 -36864 0 0
elseif ( posx < 139264 )
Player->Position 135168 -36864 0 0
elseif ( posx < 147456 )
Player->Position 143360 -36864 0 0
elseif ( posx < 155648 )
Player->Position 151552 -36864 0 0
elseif ( posx < 163840 )
Player->Position 159744 -36864 0 0
elseif ( posx < 172032 )
Player->Position 167936 -36864 0 0
elseif ( posx < 180224 )
Player->Position 176128 -36864 0 0
elseif ( posx < 188416 )
Player->Position 184320 -36864 0 0
elseif ( posx < 196608 )
Player->Position 192512 -36864 0 0
endif
endif
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setGrid_Sub3"

End

# vn_Teleport_setGrid_Sub4 ====================================================
Begin vn_Teleport_setGrid_Sub4

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

; y=-4, -29<=x<=23
if ( posy >= -32768 )
if ( posy < -24576 )
if ( posx < -229376 )
Player->Position -233472 -28672 0 0
elseif ( posx < -221184 )
Player->Position -225280 -28672 0 0
elseif ( posx < -212992 )
Player->Position -217088 -28672 0 0
elseif ( posx < -204800 )
Player->Position -208896 -28672 0 0
elseif ( posx < -196608 )
Player->Position -200704 -28672 0 0
elseif ( posx < -188416 )
Player->Position -192512 -28672 0 0
elseif ( posx < -180224 )
Player->Position -184320 -28672 0 0
elseif ( posx < -172032 )
Player->Position -176128 -28672 0 0
elseif ( posx < -163840 )
Player->Position -167936 -28672 0 0
elseif ( posx < -155648 )
Player->Position -159744 -28672 0 0
elseif ( posx < -147456 )
Player->Position -151552 -28672 0 0
elseif ( posx < -139264 )
Player->Position -143360 -28672 0 0
elseif ( posx < -131072 )
Player->Position -135168 -28672 0 0
elseif ( posx < -122880 )
Player->Position -126976 -28672 0 0
elseif ( posx < -114688 )
Player->Position -118784 -28672 0 0
elseif ( posx < -106496 )
Player->Position -110592 -28672 0 0
elseif ( posx < -98304 )
Player->Position -102400 -28672 0 0
elseif ( posx < -90112 )
Player->Position -94208 -28672 0 0
elseif ( posx < -81920 )
Player->Position -86016 -28672 0 0
elseif ( posx < -73728 )
Player->Position -77824 -28672 0 0
elseif ( posx < -65536 )
Player->Position -69632 -28672 0 0
elseif ( posx < -57344 )
Player->Position -61440 -28672 0 0
elseif ( posx < -49152 )
Player->Position -53248 -28672 0 0
elseif ( posx < -40960 )
Player->Position -45056 -28672 0 0
elseif ( posx < -32768 )
Player->Position -36864 -28672 0 0
elseif ( posx < -24576 )
Player->Position -28672 -28672 0 0
elseif ( posx < -16384 )
Player->Position -20480 -28672 0 0
elseif ( posx < -8192 )
Player->Position -12288 -28672 0 0
elseif ( posx < 0 )
Player->Position -4096 -28672 0 0
elseif ( posx < 8192 )
Player->Position 4096 -28672 0 0
elseif ( posx < 16384 )
Player->Position 12288 -28672 0 0
elseif ( posx < 24576 )
Player->Position 20480 -28672 0 0
elseif ( posx < 32768 )
Player->Position 28672 -28672 0 0
elseif ( posx < 40960 )
Player->Position 36864 -28672 0 0
elseif ( posx < 49152 )
Player->Position 45056 -28672 0 0
elseif ( posx < 57344 )
Player->Position 53248 -28672 0 0
elseif ( posx < 65536 )
Player->Position 61440 -28672 0 0
elseif ( posx < 73728 )
Player->Position 69632 -28672 0 0
elseif ( posx < 81920 )
Player->Position 77824 -28672 0 0
elseif ( posx < 90112 )
Player->Position 86016 -28672 0 0
elseif ( posx < 98304 )
Player->Position 94208 -28672 0 0
elseif ( posx < 106496 )
Player->Position 102400 -28672 0 0
elseif ( posx < 114688 )
Player->Position 110592 -28672 0 0
elseif ( posx < 122880 )
Player->Position 118784 -28672 0 0
elseif ( posx < 131072 )
Player->Position 126976 -28672 0 0
elseif ( posx < 139264 )
Player->Position 135168 -28672 0 0
elseif ( posx < 147456 )
Player->Position 143360 -28672 0 0
elseif ( posx < 155648 )
Player->Position 151552 -28672 0 0
elseif ( posx < 163840 )
Player->Position 159744 -28672 0 0
elseif ( posx < 172032 )
Player->Position 167936 -28672 0 0
elseif ( posx < 180224 )
Player->Position 176128 -28672 0 0
elseif ( posx < 188416 )
Player->Position 184320 -28672 0 0
elseif ( posx < 196608 )
Player->Position 192512 -28672 0 0
endif
endif
endif

; y=-3, -29<=x<=23
if ( posy >= -24576 )
if ( posy < -16384 )
if ( posx < -229376 )
Player->Position -233472 -20480 0 0
elseif ( posx < -221184 )
Player->Position -225280 -20480 0 0
elseif ( posx < -212992 )
Player->Position -217088 -20480 0 0
elseif ( posx < -204800 )
Player->Position -208896 -20480 0 0
elseif ( posx < -196608 )
Player->Position -200704 -20480 0 0
elseif ( posx < -188416 )
Player->Position -192512 -20480 0 0
elseif ( posx < -180224 )
Player->Position -184320 -20480 0 0
elseif ( posx < -172032 )
Player->Position -176128 -20480 0 0
elseif ( posx < -163840 )
Player->Position -167936 -20480 0 0
elseif ( posx < -155648 )
Player->Position -159744 -20480 0 0
elseif ( posx < -147456 )
Player->Position -151552 -20480 0 0
elseif ( posx < -139264 )
Player->Position -143360 -20480 0 0
elseif ( posx < -131072 )
Player->Position -135168 -20480 0 0
elseif ( posx < -122880 )
Player->Position -126976 -20480 0 0
elseif ( posx < -114688 )
Player->Position -118784 -20480 0 0
elseif ( posx < -106496 )
Player->Position -110592 -20480 0 0
elseif ( posx < -98304 )
Player->Position -102400 -20480 0 0
elseif ( posx < -90112 )
Player->Position -94208 -20480 0 0
elseif ( posx < -81920 )
Player->Position -86016 -20480 0 0
elseif ( posx < -73728 )
Player->Position -77824 -20480 0 0
elseif ( posx < -65536 )
Player->Position -69632 -20480 0 0
elseif ( posx < -57344 )
Player->Position -61440 -20480 0 0
elseif ( posx < -49152 )
Player->Position -53248 -20480 0 0
elseif ( posx < -40960 )
Player->Position -45056 -20480 0 0
elseif ( posx < -32768 )
Player->Position -36864 -20480 0 0
elseif ( posx < -24576 )
Player->Position -28672 -20480 0 0
elseif ( posx < -16384 )
Player->Position -20480 -20480 0 0
elseif ( posx < -8192 )
Player->Position -12288 -20480 0 0
elseif ( posx < 0 )
Player->Position -4096 -20480 0 0
elseif ( posx < 8192 )
Player->Position 4096 -20480 0 0
elseif ( posx < 16384 )
Player->Position 12288 -20480 0 0
elseif ( posx < 24576 )
Player->Position 20480 -20480 0 0
elseif ( posx < 32768 )
Player->Position 28672 -20480 0 0
elseif ( posx < 40960 )
Player->Position 36864 -20480 0 0
elseif ( posx < 49152 )
Player->Position 45056 -20480 0 0
elseif ( posx < 57344 )
Player->Position 53248 -20480 0 0
elseif ( posx < 65536 )
Player->Position 61440 -20480 0 0
elseif ( posx < 73728 )
Player->Position 69632 -20480 0 0
elseif ( posx < 81920 )
Player->Position 77824 -20480 0 0
elseif ( posx < 90112 )
Player->Position 86016 -20480 0 0
elseif ( posx < 98304 )
Player->Position 94208 -20480 0 0
elseif ( posx < 106496 )
Player->Position 102400 -20480 0 0
elseif ( posx < 114688 )
Player->Position 110592 -20480 0 0
elseif ( posx < 122880 )
Player->Position 118784 -20480 0 0
elseif ( posx < 131072 )
Player->Position 126976 -20480 0 0
elseif ( posx < 139264 )
Player->Position 135168 -20480 0 0
elseif ( posx < 147456 )
Player->Position 143360 -20480 0 0
elseif ( posx < 155648 )
Player->Position 151552 -20480 0 0
elseif ( posx < 163840 )
Player->Position 159744 -20480 0 0
elseif ( posx < 172032 )
Player->Position 167936 -20480 0 0
elseif ( posx < 180224 )
Player->Position 176128 -20480 0 0
elseif ( posx < 188416 )
Player->Position 184320 -20480 0 0
elseif ( posx < 196608 )
Player->Position 192512 -20480 0 0
endif
endif
endif

; y=-2, -29<=x<=23
if ( posy >= -16384 )
if ( posy < -8192 )
if ( posx < -229376 )
Player->Position -233472 -12288 0 0
elseif ( posx < -221184 )
Player->Position -225280 -12288 0 0
elseif ( posx < -212992 )
Player->Position -217088 -12288 0 0
elseif ( posx < -204800 )
Player->Position -208896 -12288 0 0
elseif ( posx < -196608 )
Player->Position -200704 -12288 0 0
elseif ( posx < -188416 )
Player->Position -192512 -12288 0 0
elseif ( posx < -180224 )
Player->Position -184320 -12288 0 0
elseif ( posx < -172032 )
Player->Position -176128 -12288 0 0
elseif ( posx < -163840 )
Player->Position -167936 -12288 0 0
elseif ( posx < -155648 )
Player->Position -159744 -12288 0 0
elseif ( posx < -147456 )
Player->Position -151552 -12288 0 0
elseif ( posx < -139264 )
Player->Position -143360 -12288 0 0
elseif ( posx < -131072 )
Player->Position -135168 -12288 0 0
elseif ( posx < -122880 )
Player->Position -126976 -12288 0 0
elseif ( posx < -114688 )
Player->Position -118784 -12288 0 0
elseif ( posx < -106496 )
Player->Position -110592 -12288 0 0
elseif ( posx < -98304 )
Player->Position -102400 -12288 0 0
elseif ( posx < -90112 )
Player->Position -94208 -12288 0 0
elseif ( posx < -81920 )
Player->Position -86016 -12288 0 0
elseif ( posx < -73728 )
Player->Position -77824 -12288 0 0
elseif ( posx < -65536 )
Player->Position -69632 -12288 0 0
elseif ( posx < -57344 )
Player->Position -61440 -12288 0 0
elseif ( posx < -49152 )
Player->Position -53248 -12288 0 0
elseif ( posx < -40960 )
Player->Position -45056 -12288 0 0
elseif ( posx < -32768 )
Player->Position -36864 -12288 0 0
elseif ( posx < -24576 )
Player->Position -28672 -12288 0 0
elseif ( posx < -16384 )
Player->Position -20480 -12288 0 0
elseif ( posx < -8192 )
Player->Position -12288 -12288 0 0
elseif ( posx < 0 )
Player->Position -4096 -12288 0 0
elseif ( posx < 8192 )
Player->Position 4096 -12288 0 0
elseif ( posx < 16384 )
Player->Position 12288 -12288 0 0
elseif ( posx < 24576 )
Player->Position 20480 -12288 0 0
elseif ( posx < 32768 )
Player->Position 28672 -12288 0 0
elseif ( posx < 40960 )
Player->Position 36864 -12288 0 0
elseif ( posx < 49152 )
Player->Position 45056 -12288 0 0
elseif ( posx < 57344 )
Player->Position 53248 -12288 0 0
elseif ( posx < 65536 )
Player->Position 61440 -12288 0 0
elseif ( posx < 73728 )
Player->Position 69632 -12288 0 0
elseif ( posx < 81920 )
Player->Position 77824 -12288 0 0
elseif ( posx < 90112 )
Player->Position 86016 -12288 0 0
elseif ( posx < 98304 )
Player->Position 94208 -12288 0 0
elseif ( posx < 106496 )
Player->Position 102400 -12288 0 0
elseif ( posx < 114688 )
Player->Position 110592 -12288 0 0
elseif ( posx < 122880 )
Player->Position 118784 -12288 0 0
elseif ( posx < 131072 )
Player->Position 126976 -12288 0 0
elseif ( posx < 139264 )
Player->Position 135168 -12288 0 0
elseif ( posx < 147456 )
Player->Position 143360 -12288 0 0
elseif ( posx < 155648 )
Player->Position 151552 -12288 0 0
elseif ( posx < 163840 )
Player->Position 159744 -12288 0 0
elseif ( posx < 172032 )
Player->Position 167936 -12288 0 0
elseif ( posx < 180224 )
Player->Position 176128 -12288 0 0
elseif ( posx < 188416 )
Player->Position 184320 -12288 0 0
elseif ( posx < 196608 )
Player->Position 192512 -12288 0 0
endif
endif
endif

; y=-1, -29<=x<=23
if ( posy >= -8192 )
if ( posy < 0 )
if ( posx < -229376 )
Player->Position -233472 -4096 0 0
elseif ( posx < -221184 )
Player->Position -225280 -4096 0 0
elseif ( posx < -212992 )
Player->Position -217088 -4096 0 0
elseif ( posx < -204800 )
Player->Position -208896 -4096 0 0
elseif ( posx < -196608 )
Player->Position -200704 -4096 0 0
elseif ( posx < -188416 )
Player->Position -192512 -4096 0 0
elseif ( posx < -180224 )
Player->Position -184320 -4096 0 0
elseif ( posx < -172032 )
Player->Position -176128 -4096 0 0
elseif ( posx < -163840 )
Player->Position -167936 -4096 0 0
elseif ( posx < -155648 )
Player->Position -159744 -4096 0 0
elseif ( posx < -147456 )
Player->Position -151552 -4096 0 0
elseif ( posx < -139264 )
Player->Position -143360 -4096 0 0
elseif ( posx < -131072 )
Player->Position -135168 -4096 0 0
elseif ( posx < -122880 )
Player->Position -126976 -4096 0 0
elseif ( posx < -114688 )
Player->Position -118784 -4096 0 0
elseif ( posx < -106496 )
Player->Position -110592 -4096 0 0
elseif ( posx < -98304 )
Player->Position -102400 -4096 0 0
elseif ( posx < -90112 )
Player->Position -94208 -4096 0 0
elseif ( posx < -81920 )
Player->Position -86016 -4096 0 0
elseif ( posx < -73728 )
Player->Position -77824 -4096 0 0
elseif ( posx < -65536 )
Player->Position -69632 -4096 0 0
elseif ( posx < -57344 )
Player->Position -61440 -4096 0 0
elseif ( posx < -49152 )
Player->Position -53248 -4096 0 0
elseif ( posx < -40960 )
Player->Position -45056 -4096 0 0
elseif ( posx < -32768 )
Player->Position -36864 -4096 0 0
elseif ( posx < -24576 )
Player->Position -28672 -4096 0 0
elseif ( posx < -16384 )
Player->Position -20480 -4096 0 0
elseif ( posx < -8192 )
Player->Position -12288 -4096 0 0
elseif ( posx < 0 )
Player->Position -4096 -4096 0 0
elseif ( posx < 8192 )
Player->Position 4096 -4096 0 0
elseif ( posx < 16384 )
Player->Position 12288 -4096 0 0
elseif ( posx < 24576 )
Player->Position 20480 -4096 0 0
elseif ( posx < 32768 )
Player->Position 28672 -4096 0 0
elseif ( posx < 40960 )
Player->Position 36864 -4096 0 0
elseif ( posx < 49152 )
Player->Position 45056 -4096 0 0
elseif ( posx < 57344 )
Player->Position 53248 -4096 0 0
elseif ( posx < 65536 )
Player->Position 61440 -4096 0 0
elseif ( posx < 73728 )
Player->Position 69632 -4096 0 0
elseif ( posx < 81920 )
Player->Position 77824 -4096 0 0
elseif ( posx < 90112 )
Player->Position 86016 -4096 0 0
elseif ( posx < 98304 )
Player->Position 94208 -4096 0 0
elseif ( posx < 106496 )
Player->Position 102400 -4096 0 0
elseif ( posx < 114688 )
Player->Position 110592 -4096 0 0
elseif ( posx < 122880 )
Player->Position 118784 -4096 0 0
elseif ( posx < 131072 )
Player->Position 126976 -4096 0 0
elseif ( posx < 139264 )
Player->Position 135168 -4096 0 0
elseif ( posx < 147456 )
Player->Position 143360 -4096 0 0
elseif ( posx < 155648 )
Player->Position 151552 -4096 0 0
elseif ( posx < 163840 )
Player->Position 159744 -4096 0 0
elseif ( posx < 172032 )
Player->Position 167936 -4096 0 0
elseif ( posx < 180224 )
Player->Position 176128 -4096 0 0
elseif ( posx < 188416 )
Player->Position 184320 -4096 0 0
elseif ( posx < 196608 )
Player->Position 192512 -4096 0 0
endif
endif
endif

; y=0, -29<=x<=23
if ( posy >= 0 )
if ( posy < 8192 )
if ( posx < -229376 )
Player->Position -233472 4096 0 0
elseif ( posx < -221184 )
Player->Position -225280 4096 0 0
elseif ( posx < -212992 )
Player->Position -217088 4096 0 0
elseif ( posx < -204800 )
Player->Position -208896 4096 0 0
elseif ( posx < -196608 )
Player->Position -200704 4096 0 0
elseif ( posx < -188416 )
Player->Position -192512 4096 0 0
elseif ( posx < -180224 )
Player->Position -184320 4096 0 0
elseif ( posx < -172032 )
Player->Position -176128 4096 0 0
elseif ( posx < -163840 )
Player->Position -167936 4096 0 0
elseif ( posx < -155648 )
Player->Position -159744 4096 0 0
elseif ( posx < -147456 )
Player->Position -151552 4096 0 0
elseif ( posx < -139264 )
Player->Position -143360 4096 0 0
elseif ( posx < -131072 )
Player->Position -135168 4096 0 0
elseif ( posx < -122880 )
Player->Position -126976 4096 0 0
elseif ( posx < -114688 )
Player->Position -118784 4096 0 0
elseif ( posx < -106496 )
Player->Position -110592 4096 0 0
elseif ( posx < -98304 )
Player->Position -102400 4096 0 0
elseif ( posx < -90112 )
Player->Position -94208 4096 0 0
elseif ( posx < -81920 )
Player->Position -86016 4096 0 0
elseif ( posx < -73728 )
Player->Position -77824 4096 0 0
elseif ( posx < -65536 )
Player->Position -69632 4096 0 0
elseif ( posx < -57344 )
Player->Position -61440 4096 0 0
elseif ( posx < -49152 )
Player->Position -53248 4096 0 0
elseif ( posx < -40960 )
Player->Position -45056 4096 0 0
elseif ( posx < -32768 )
Player->Position -36864 4096 0 0
elseif ( posx < -24576 )
Player->Position -28672 4096 0 0
elseif ( posx < -16384 )
Player->Position -20480 4096 0 0
elseif ( posx < -8192 )
Player->Position -12288 4096 0 0
elseif ( posx < 0 )
Player->Position -4096 4096 0 0
elseif ( posx < 8192 )
Player->Position 4096 4096 0 0
elseif ( posx < 16384 )
Player->Position 12288 4096 0 0
elseif ( posx < 24576 )
Player->Position 20480 4096 0 0
elseif ( posx < 32768 )
Player->Position 28672 4096 0 0
elseif ( posx < 40960 )
Player->Position 36864 4096 0 0
elseif ( posx < 49152 )
Player->Position 45056 4096 0 0
elseif ( posx < 57344 )
Player->Position 53248 4096 0 0
elseif ( posx < 65536 )
Player->Position 61440 4096 0 0
elseif ( posx < 73728 )
Player->Position 69632 4096 0 0
elseif ( posx < 81920 )
Player->Position 77824 4096 0 0
elseif ( posx < 90112 )
Player->Position 86016 4096 0 0
elseif ( posx < 98304 )
Player->Position 94208 4096 0 0
elseif ( posx < 106496 )
Player->Position 102400 4096 0 0
elseif ( posx < 114688 )
Player->Position 110592 4096 0 0
elseif ( posx < 122880 )
Player->Position 118784 4096 0 0
elseif ( posx < 131072 )
Player->Position 126976 4096 0 0
elseif ( posx < 139264 )
Player->Position 135168 4096 0 0
elseif ( posx < 147456 )
Player->Position 143360 4096 0 0
elseif ( posx < 155648 )
Player->Position 151552 4096 0 0
elseif ( posx < 163840 )
Player->Position 159744 4096 0 0
elseif ( posx < 172032 )
Player->Position 167936 4096 0 0
elseif ( posx < 180224 )
Player->Position 176128 4096 0 0
elseif ( posx < 188416 )
Player->Position 184320 4096 0 0
elseif ( posx < 196608 )
Player->Position 192512 4096 0 0
endif
endif
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setGrid_Sub4"

End

# vn_Teleport_setGrid_Sub5 ====================================================
Begin vn_Teleport_setGrid_Sub5

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

; y=1, -29<=x<=23
if ( posy >= 8192 )
if ( posy < 16384 )
if ( posx < -229376 )
Player->Position -233472 12288 0 0
elseif ( posx < -221184 )
Player->Position -225280 12288 0 0
elseif ( posx < -212992 )
Player->Position -217088 12288 0 0
elseif ( posx < -204800 )
Player->Position -208896 12288 0 0
elseif ( posx < -196608 )
Player->Position -200704 12288 0 0
elseif ( posx < -188416 )
Player->Position -192512 12288 0 0
elseif ( posx < -180224 )
Player->Position -184320 12288 0 0
elseif ( posx < -172032 )
Player->Position -176128 12288 0 0
elseif ( posx < -163840 )
Player->Position -167936 12288 0 0
elseif ( posx < -155648 )
Player->Position -159744 12288 0 0
elseif ( posx < -147456 )
Player->Position -151552 12288 0 0
elseif ( posx < -139264 )
Player->Position -143360 12288 0 0
elseif ( posx < -131072 )
Player->Position -135168 12288 0 0
elseif ( posx < -122880 )
Player->Position -126976 12288 0 0
elseif ( posx < -114688 )
Player->Position -118784 12288 0 0
elseif ( posx < -106496 )
Player->Position -110592 12288 0 0
elseif ( posx < -98304 )
Player->Position -102400 12288 0 0
elseif ( posx < -90112 )
Player->Position -94208 12288 0 0
elseif ( posx < -81920 )
Player->Position -86016 12288 0 0
elseif ( posx < -73728 )
Player->Position -77824 12288 0 0
elseif ( posx < -65536 )
Player->Position -69632 12288 0 0
elseif ( posx < -57344 )
Player->Position -61440 12288 0 0
elseif ( posx < -49152 )
Player->Position -53248 12288 0 0
elseif ( posx < -40960 )
Player->Position -45056 12288 0 0
elseif ( posx < -32768 )
Player->Position -36864 12288 0 0
elseif ( posx < -24576 )
Player->Position -28672 12288 0 0
elseif ( posx < -16384 )
Player->Position -20480 12288 0 0
elseif ( posx < -8192 )
Player->Position -12288 12288 0 0
elseif ( posx < 0 )
Player->Position -4096 12288 0 0
elseif ( posx < 8192 )
Player->Position 4096 12288 0 0
elseif ( posx < 16384 )
Player->Position 12288 12288 0 0
elseif ( posx < 24576 )
Player->Position 20480 12288 0 0
elseif ( posx < 32768 )
Player->Position 28672 12288 0 0
elseif ( posx < 40960 )
Player->Position 36864 12288 0 0
elseif ( posx < 49152 )
Player->Position 45056 12288 0 0
elseif ( posx < 57344 )
Player->Position 53248 12288 0 0
elseif ( posx < 65536 )
Player->Position 61440 12288 0 0
elseif ( posx < 73728 )
Player->Position 69632 12288 0 0
elseif ( posx < 81920 )
Player->Position 77824 12288 0 0
elseif ( posx < 90112 )
Player->Position 86016 12288 0 0
elseif ( posx < 98304 )
Player->Position 94208 12288 0 0
elseif ( posx < 106496 )
Player->Position 102400 12288 0 0
elseif ( posx < 114688 )
Player->Position 110592 12288 0 0
elseif ( posx < 122880 )
Player->Position 118784 12288 0 0
elseif ( posx < 131072 )
Player->Position 126976 12288 0 0
elseif ( posx < 139264 )
Player->Position 135168 12288 0 0
elseif ( posx < 147456 )
Player->Position 143360 12288 0 0
elseif ( posx < 155648 )
Player->Position 151552 12288 0 0
elseif ( posx < 163840 )
Player->Position 159744 12288 0 0
elseif ( posx < 172032 )
Player->Position 167936 12288 0 0
elseif ( posx < 180224 )
Player->Position 176128 12288 0 0
elseif ( posx < 188416 )
Player->Position 184320 12288 0 0
elseif ( posx < 196608 )
Player->Position 192512 12288 0 0
endif
endif
endif

; y=2, -29<=x<=23
if ( posy >= 16384 )
if ( posy < 24576 )
if ( posx < -229376 )
Player->Position -233472 20480 0 0
elseif ( posx < -221184 )
Player->Position -225280 20480 0 0
elseif ( posx < -212992 )
Player->Position -217088 20480 0 0
elseif ( posx < -204800 )
Player->Position -208896 20480 0 0
elseif ( posx < -196608 )
Player->Position -200704 20480 0 0
elseif ( posx < -188416 )
Player->Position -192512 20480 0 0
elseif ( posx < -180224 )
Player->Position -184320 20480 0 0
elseif ( posx < -172032 )
Player->Position -176128 20480 0 0
elseif ( posx < -163840 )
Player->Position -167936 20480 0 0
elseif ( posx < -155648 )
Player->Position -159744 20480 0 0
elseif ( posx < -147456 )
Player->Position -151552 20480 0 0
elseif ( posx < -139264 )
Player->Position -143360 20480 0 0
elseif ( posx < -131072 )
Player->Position -135168 20480 0 0
elseif ( posx < -122880 )
Player->Position -126976 20480 0 0
elseif ( posx < -114688 )
Player->Position -118784 20480 0 0
elseif ( posx < -106496 )
Player->Position -110592 20480 0 0
elseif ( posx < -98304 )
Player->Position -102400 20480 0 0
elseif ( posx < -90112 )
Player->Position -94208 20480 0 0
elseif ( posx < -81920 )
Player->Position -86016 20480 0 0
elseif ( posx < -73728 )
Player->Position -77824 20480 0 0
elseif ( posx < -65536 )
Player->Position -69632 20480 0 0
elseif ( posx < -57344 )
Player->Position -61440 20480 0 0
elseif ( posx < -49152 )
Player->Position -53248 20480 0 0
elseif ( posx < -40960 )
Player->Position -45056 20480 0 0
elseif ( posx < -32768 )
Player->Position -36864 20480 0 0
elseif ( posx < -24576 )
Player->Position -28672 20480 0 0
elseif ( posx < -16384 )
Player->Position -20480 20480 0 0
elseif ( posx < -8192 )
Player->Position -12288 20480 0 0
elseif ( posx < 0 )
Player->Position -4096 20480 0 0
elseif ( posx < 8192 )
Player->Position 4096 20480 0 0
elseif ( posx < 16384 )
Player->Position 12288 20480 0 0
elseif ( posx < 24576 )
Player->Position 20480 20480 0 0
elseif ( posx < 32768 )
Player->Position 28672 20480 0 0
elseif ( posx < 40960 )
Player->Position 36864 20480 0 0
elseif ( posx < 49152 )
Player->Position 45056 20480 0 0
elseif ( posx < 57344 )
Player->Position 53248 20480 0 0
elseif ( posx < 65536 )
Player->Position 61440 20480 0 0
elseif ( posx < 73728 )
Player->Position 69632 20480 0 0
elseif ( posx < 81920 )
Player->Position 77824 20480 0 0
elseif ( posx < 90112 )
Player->Position 86016 20480 0 0
elseif ( posx < 98304 )
Player->Position 94208 20480 0 0
elseif ( posx < 106496 )
Player->Position 102400 20480 0 0
elseif ( posx < 114688 )
Player->Position 110592 20480 0 0
elseif ( posx < 122880 )
Player->Position 118784 20480 0 0
elseif ( posx < 131072 )
Player->Position 126976 20480 0 0
elseif ( posx < 139264 )
Player->Position 135168 20480 0 0
elseif ( posx < 147456 )
Player->Position 143360 20480 0 0
elseif ( posx < 155648 )
Player->Position 151552 20480 0 0
elseif ( posx < 163840 )
Player->Position 159744 20480 0 0
elseif ( posx < 172032 )
Player->Position 167936 20480 0 0
elseif ( posx < 180224 )
Player->Position 176128 20480 0 0
elseif ( posx < 188416 )
Player->Position 184320 20480 0 0
elseif ( posx < 196608 )
Player->Position 192512 20480 0 0
endif
endif
endif

; y=3, -29<=x<=23
if ( posy >= 24576 )
if ( posy < 32768 )
if ( posx < -229376 )
Player->Position -233472 28672 0 0
elseif ( posx < -221184 )
Player->Position -225280 28672 0 0
elseif ( posx < -212992 )
Player->Position -217088 28672 0 0
elseif ( posx < -204800 )
Player->Position -208896 28672 0 0
elseif ( posx < -196608 )
Player->Position -200704 28672 0 0
elseif ( posx < -188416 )
Player->Position -192512 28672 0 0
elseif ( posx < -180224 )
Player->Position -184320 28672 0 0
elseif ( posx < -172032 )
Player->Position -176128 28672 0 0
elseif ( posx < -163840 )
Player->Position -167936 28672 0 0
elseif ( posx < -155648 )
Player->Position -159744 28672 0 0
elseif ( posx < -147456 )
Player->Position -151552 28672 0 0
elseif ( posx < -139264 )
Player->Position -143360 28672 0 0
elseif ( posx < -131072 )
Player->Position -135168 28672 0 0
elseif ( posx < -122880 )
Player->Position -126976 28672 0 0
elseif ( posx < -114688 )
Player->Position -118784 28672 0 0
elseif ( posx < -106496 )
Player->Position -110592 28672 0 0
elseif ( posx < -98304 )
Player->Position -102400 28672 0 0
elseif ( posx < -90112 )
Player->Position -94208 28672 0 0
elseif ( posx < -81920 )
Player->Position -86016 28672 0 0
elseif ( posx < -73728 )
Player->Position -77824 28672 0 0
elseif ( posx < -65536 )
Player->Position -69632 28672 0 0
elseif ( posx < -57344 )
Player->Position -61440 28672 0 0
elseif ( posx < -49152 )
Player->Position -53248 28672 0 0
elseif ( posx < -40960 )
Player->Position -45056 28672 0 0
elseif ( posx < -32768 )
Player->Position -36864 28672 0 0
elseif ( posx < -24576 )
Player->Position -28672 28672 0 0
elseif ( posx < -16384 )
Player->Position -20480 28672 0 0
elseif ( posx < -8192 )
Player->Position -12288 28672 0 0
elseif ( posx < 0 )
Player->Position -4096 28672 0 0
elseif ( posx < 8192 )
Player->Position 4096 28672 0 0
elseif ( posx < 16384 )
Player->Position 12288 28672 0 0
elseif ( posx < 24576 )
Player->Position 20480 28672 0 0
elseif ( posx < 32768 )
Player->Position 28672 28672 0 0
elseif ( posx < 40960 )
Player->Position 36864 28672 0 0
elseif ( posx < 49152 )
Player->Position 45056 28672 0 0
elseif ( posx < 57344 )
Player->Position 53248 28672 0 0
elseif ( posx < 65536 )
Player->Position 61440 28672 0 0
elseif ( posx < 73728 )
Player->Position 69632 28672 0 0
elseif ( posx < 81920 )
Player->Position 77824 28672 0 0
elseif ( posx < 90112 )
Player->Position 86016 28672 0 0
elseif ( posx < 98304 )
Player->Position 94208 28672 0 0
elseif ( posx < 106496 )
Player->Position 102400 28672 0 0
elseif ( posx < 114688 )
Player->Position 110592 28672 0 0
elseif ( posx < 122880 )
Player->Position 118784 28672 0 0
elseif ( posx < 131072 )
Player->Position 126976 28672 0 0
elseif ( posx < 139264 )
Player->Position 135168 28672 0 0
elseif ( posx < 147456 )
Player->Position 143360 28672 0 0
elseif ( posx < 155648 )
Player->Position 151552 28672 0 0
elseif ( posx < 163840 )
Player->Position 159744 28672 0 0
elseif ( posx < 172032 )
Player->Position 167936 28672 0 0
elseif ( posx < 180224 )
Player->Position 176128 28672 0 0
elseif ( posx < 188416 )
Player->Position 184320 28672 0 0
elseif ( posx < 196608 )
Player->Position 192512 28672 0 0
endif
endif
endif

; y=4, -29<=x<=23
if ( posy >= 32768 )
if ( posy < 40960 )
if ( posx < -229376 )
Player->Position -233472 36864 0 0
elseif ( posx < -221184 )
Player->Position -225280 36864 0 0
elseif ( posx < -212992 )
Player->Position -217088 36864 0 0
elseif ( posx < -204800 )
Player->Position -208896 36864 0 0
elseif ( posx < -196608 )
Player->Position -200704 36864 0 0
elseif ( posx < -188416 )
Player->Position -192512 36864 0 0
elseif ( posx < -180224 )
Player->Position -184320 36864 0 0
elseif ( posx < -172032 )
Player->Position -176128 36864 0 0
elseif ( posx < -163840 )
Player->Position -167936 36864 0 0
elseif ( posx < -155648 )
Player->Position -159744 36864 0 0
elseif ( posx < -147456 )
Player->Position -151552 36864 0 0
elseif ( posx < -139264 )
Player->Position -143360 36864 0 0
elseif ( posx < -131072 )
Player->Position -135168 36864 0 0
elseif ( posx < -122880 )
Player->Position -126976 36864 0 0
elseif ( posx < -114688 )
Player->Position -118784 36864 0 0
elseif ( posx < -106496 )
Player->Position -110592 36864 0 0
elseif ( posx < -98304 )
Player->Position -102400 36864 0 0
elseif ( posx < -90112 )
Player->Position -94208 36864 0 0
elseif ( posx < -81920 )
Player->Position -86016 36864 0 0
elseif ( posx < -73728 )
Player->Position -77824 36864 0 0
elseif ( posx < -65536 )
Player->Position -69632 36864 0 0
elseif ( posx < -57344 )
Player->Position -61440 36864 0 0
elseif ( posx < -49152 )
Player->Position -53248 36864 0 0
elseif ( posx < -40960 )
Player->Position -45056 36864 0 0
elseif ( posx < -32768 )
Player->Position -36864 36864 0 0
elseif ( posx < -24576 )
Player->Position -28672 36864 0 0
elseif ( posx < -16384 )
Player->Position -20480 36864 0 0
elseif ( posx < -8192 )
Player->Position -12288 36864 0 0
elseif ( posx < 0 )
Player->Position -4096 36864 0 0
elseif ( posx < 8192 )
Player->Position 4096 36864 0 0
elseif ( posx < 16384 )
Player->Position 12288 36864 0 0
elseif ( posx < 24576 )
Player->Position 20480 36864 0 0
elseif ( posx < 32768 )
Player->Position 28672 36864 0 0
elseif ( posx < 40960 )
Player->Position 36864 36864 0 0
elseif ( posx < 49152 )
Player->Position 45056 36864 0 0
elseif ( posx < 57344 )
Player->Position 53248 36864 0 0
elseif ( posx < 65536 )
Player->Position 61440 36864 0 0
elseif ( posx < 73728 )
Player->Position 69632 36864 0 0
elseif ( posx < 81920 )
Player->Position 77824 36864 0 0
elseif ( posx < 90112 )
Player->Position 86016 36864 0 0
elseif ( posx < 98304 )
Player->Position 94208 36864 0 0
elseif ( posx < 106496 )
Player->Position 102400 36864 0 0
elseif ( posx < 114688 )
Player->Position 110592 36864 0 0
elseif ( posx < 122880 )
Player->Position 118784 36864 0 0
elseif ( posx < 131072 )
Player->Position 126976 36864 0 0
elseif ( posx < 139264 )
Player->Position 135168 36864 0 0
elseif ( posx < 147456 )
Player->Position 143360 36864 0 0
elseif ( posx < 155648 )
Player->Position 151552 36864 0 0
elseif ( posx < 163840 )
Player->Position 159744 36864 0 0
elseif ( posx < 172032 )
Player->Position 167936 36864 0 0
elseif ( posx < 180224 )
Player->Position 176128 36864 0 0
elseif ( posx < 188416 )
Player->Position 184320 36864 0 0
elseif ( posx < 196608 )
Player->Position 192512 36864 0 0
endif
endif
endif

; y=5, -29<=x<=23
if ( posy >= 40960 )
if ( posy < 49152 )
if ( posx < -229376 )
Player->Position -233472 45056 0 0
elseif ( posx < -221184 )
Player->Position -225280 45056 0 0
elseif ( posx < -212992 )
Player->Position -217088 45056 0 0
elseif ( posx < -204800 )
Player->Position -208896 45056 0 0
elseif ( posx < -196608 )
Player->Position -200704 45056 0 0
elseif ( posx < -188416 )
Player->Position -192512 45056 0 0
elseif ( posx < -180224 )
Player->Position -184320 45056 0 0
elseif ( posx < -172032 )
Player->Position -176128 45056 0 0
elseif ( posx < -163840 )
Player->Position -167936 45056 0 0
elseif ( posx < -155648 )
Player->Position -159744 45056 0 0
elseif ( posx < -147456 )
Player->Position -151552 45056 0 0
elseif ( posx < -139264 )
Player->Position -143360 45056 0 0
elseif ( posx < -131072 )
Player->Position -135168 45056 0 0
elseif ( posx < -122880 )
Player->Position -126976 45056 0 0
elseif ( posx < -114688 )
Player->Position -118784 45056 0 0
elseif ( posx < -106496 )
Player->Position -110592 45056 0 0
elseif ( posx < -98304 )
Player->Position -102400 45056 0 0
elseif ( posx < -90112 )
Player->Position -94208 45056 0 0
elseif ( posx < -81920 )
Player->Position -86016 45056 0 0
elseif ( posx < -73728 )
Player->Position -77824 45056 0 0
elseif ( posx < -65536 )
Player->Position -69632 45056 0 0
elseif ( posx < -57344 )
Player->Position -61440 45056 0 0
elseif ( posx < -49152 )
Player->Position -53248 45056 0 0
elseif ( posx < -40960 )
Player->Position -45056 45056 0 0
elseif ( posx < -32768 )
Player->Position -36864 45056 0 0
elseif ( posx < -24576 )
Player->Position -28672 45056 0 0
elseif ( posx < -16384 )
Player->Position -20480 45056 0 0
elseif ( posx < -8192 )
Player->Position -12288 45056 0 0
elseif ( posx < 0 )
Player->Position -4096 45056 0 0
elseif ( posx < 8192 )
Player->Position 4096 45056 0 0
elseif ( posx < 16384 )
Player->Position 12288 45056 0 0
elseif ( posx < 24576 )
Player->Position 20480 45056 0 0
elseif ( posx < 32768 )
Player->Position 28672 45056 0 0
elseif ( posx < 40960 )
Player->Position 36864 45056 0 0
elseif ( posx < 49152 )
Player->Position 45056 45056 0 0
elseif ( posx < 57344 )
Player->Position 53248 45056 0 0
elseif ( posx < 65536 )
Player->Position 61440 45056 0 0
elseif ( posx < 73728 )
Player->Position 69632 45056 0 0
elseif ( posx < 81920 )
Player->Position 77824 45056 0 0
elseif ( posx < 90112 )
Player->Position 86016 45056 0 0
elseif ( posx < 98304 )
Player->Position 94208 45056 0 0
elseif ( posx < 106496 )
Player->Position 102400 45056 0 0
elseif ( posx < 114688 )
Player->Position 110592 45056 0 0
elseif ( posx < 122880 )
Player->Position 118784 45056 0 0
elseif ( posx < 131072 )
Player->Position 126976 45056 0 0
elseif ( posx < 139264 )
Player->Position 135168 45056 0 0
elseif ( posx < 147456 )
Player->Position 143360 45056 0 0
elseif ( posx < 155648 )
Player->Position 151552 45056 0 0
elseif ( posx < 163840 )
Player->Position 159744 45056 0 0
elseif ( posx < 172032 )
Player->Position 167936 45056 0 0
elseif ( posx < 180224 )
Player->Position 176128 45056 0 0
elseif ( posx < 188416 )
Player->Position 184320 45056 0 0
elseif ( posx < 196608 )
Player->Position 192512 45056 0 0
endif
endif
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setGrid_Sub5"

End

# vn_Teleport_setGrid_Sub6 ====================================================
Begin vn_Teleport_setGrid_Sub6

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

; y=6, -29<=x<=23
if ( posy >= 49152 )
if ( posy < 57344 )
if ( posx < -229376 )
Player->Position -233472 53248 0 0
elseif ( posx < -221184 )
Player->Position -225280 53248 0 0
elseif ( posx < -212992 )
Player->Position -217088 53248 0 0
elseif ( posx < -204800 )
Player->Position -208896 53248 0 0
elseif ( posx < -196608 )
Player->Position -200704 53248 0 0
elseif ( posx < -188416 )
Player->Position -192512 53248 0 0
elseif ( posx < -180224 )
Player->Position -184320 53248 0 0
elseif ( posx < -172032 )
Player->Position -176128 53248 0 0
elseif ( posx < -163840 )
Player->Position -167936 53248 0 0
elseif ( posx < -155648 )
Player->Position -159744 53248 0 0
elseif ( posx < -147456 )
Player->Position -151552 53248 0 0
elseif ( posx < -139264 )
Player->Position -143360 53248 0 0
elseif ( posx < -131072 )
Player->Position -135168 53248 0 0
elseif ( posx < -122880 )
Player->Position -126976 53248 0 0
elseif ( posx < -114688 )
Player->Position -118784 53248 0 0
elseif ( posx < -106496 )
Player->Position -110592 53248 0 0
elseif ( posx < -98304 )
Player->Position -102400 53248 0 0
elseif ( posx < -90112 )
Player->Position -94208 53248 0 0
elseif ( posx < -81920 )
Player->Position -86016 53248 0 0
elseif ( posx < -73728 )
Player->Position -77824 53248 0 0
elseif ( posx < -65536 )
Player->Position -69632 53248 0 0
elseif ( posx < -57344 )
Player->Position -61440 53248 0 0
elseif ( posx < -49152 )
Player->Position -53248 53248 0 0
elseif ( posx < -40960 )
Player->Position -45056 53248 0 0
elseif ( posx < -32768 )
Player->Position -36864 53248 0 0
elseif ( posx < -24576 )
Player->Position -28672 53248 0 0
elseif ( posx < -16384 )
Player->Position -20480 53248 0 0
elseif ( posx < -8192 )
Player->Position -12288 53248 0 0
elseif ( posx < 0 )
Player->Position -4096 53248 0 0
elseif ( posx < 8192 )
Player->Position 4096 53248 0 0
elseif ( posx < 16384 )
Player->Position 12288 53248 0 0
elseif ( posx < 24576 )
Player->Position 20480 53248 0 0
elseif ( posx < 32768 )
Player->Position 28672 53248 0 0
elseif ( posx < 40960 )
Player->Position 36864 53248 0 0
elseif ( posx < 49152 )
Player->Position 45056 53248 0 0
elseif ( posx < 57344 )
Player->Position 53248 53248 0 0
elseif ( posx < 65536 )
Player->Position 61440 53248 0 0
elseif ( posx < 73728 )
Player->Position 69632 53248 0 0
elseif ( posx < 81920 )
Player->Position 77824 53248 0 0
elseif ( posx < 90112 )
Player->Position 86016 53248 0 0
elseif ( posx < 98304 )
Player->Position 94208 53248 0 0
elseif ( posx < 106496 )
Player->Position 102400 53248 0 0
elseif ( posx < 114688 )
Player->Position 110592 53248 0 0
elseif ( posx < 122880 )
Player->Position 118784 53248 0 0
elseif ( posx < 131072 )
Player->Position 126976 53248 0 0
elseif ( posx < 139264 )
Player->Position 135168 53248 0 0
elseif ( posx < 147456 )
Player->Position 143360 53248 0 0
elseif ( posx < 155648 )
Player->Position 151552 53248 0 0
elseif ( posx < 163840 )
Player->Position 159744 53248 0 0
elseif ( posx < 172032 )
Player->Position 167936 53248 0 0
elseif ( posx < 180224 )
Player->Position 176128 53248 0 0
elseif ( posx < 188416 )
Player->Position 184320 53248 0 0
elseif ( posx < 196608 )
Player->Position 192512 53248 0 0
endif
endif
endif

; y=7, -29<=x<=23
if ( posy >= 57344 )
if ( posy < 65536 )
if ( posx < -229376 )
Player->Position -233472 61440 0 0
elseif ( posx < -221184 )
Player->Position -225280 61440 0 0
elseif ( posx < -212992 )
Player->Position -217088 61440 0 0
elseif ( posx < -204800 )
Player->Position -208896 61440 0 0
elseif ( posx < -196608 )
Player->Position -200704 61440 0 0
elseif ( posx < -188416 )
Player->Position -192512 61440 0 0
elseif ( posx < -180224 )
Player->Position -184320 61440 0 0
elseif ( posx < -172032 )
Player->Position -176128 61440 0 0
elseif ( posx < -163840 )
Player->Position -167936 61440 0 0
elseif ( posx < -155648 )
Player->Position -159744 61440 0 0
elseif ( posx < -147456 )
Player->Position -151552 61440 0 0
elseif ( posx < -139264 )
Player->Position -143360 61440 0 0
elseif ( posx < -131072 )
Player->Position -135168 61440 0 0
elseif ( posx < -122880 )
Player->Position -126976 61440 0 0
elseif ( posx < -114688 )
Player->Position -118784 61440 0 0
elseif ( posx < -106496 )
Player->Position -110592 61440 0 0
elseif ( posx < -98304 )
Player->Position -102400 61440 0 0
elseif ( posx < -90112 )
Player->Position -94208 61440 0 0
elseif ( posx < -81920 )
Player->Position -86016 61440 0 0
elseif ( posx < -73728 )
Player->Position -77824 61440 0 0
elseif ( posx < -65536 )
Player->Position -69632 61440 0 0
elseif ( posx < -57344 )
Player->Position -61440 61440 0 0
elseif ( posx < -49152 )
Player->Position -53248 61440 0 0
elseif ( posx < -40960 )
Player->Position -45056 61440 0 0
elseif ( posx < -32768 )
Player->Position -36864 61440 0 0
elseif ( posx < -24576 )
Player->Position -28672 61440 0 0
elseif ( posx < -16384 )
Player->Position -20480 61440 0 0
elseif ( posx < -8192 )
Player->Position -12288 61440 0 0
elseif ( posx < 0 )
Player->Position -4096 61440 0 0
elseif ( posx < 8192 )
Player->Position 4096 61440 0 0
elseif ( posx < 16384 )
Player->Position 12288 61440 0 0
elseif ( posx < 24576 )
Player->Position 20480 61440 0 0
elseif ( posx < 32768 )
Player->Position 28672 61440 0 0
elseif ( posx < 40960 )
Player->Position 36864 61440 0 0
elseif ( posx < 49152 )
Player->Position 45056 61440 0 0
elseif ( posx < 57344 )
Player->Position 53248 61440 0 0
elseif ( posx < 65536 )
Player->Position 61440 61440 0 0
elseif ( posx < 73728 )
Player->Position 69632 61440 0 0
elseif ( posx < 81920 )
Player->Position 77824 61440 0 0
elseif ( posx < 90112 )
Player->Position 86016 61440 0 0
elseif ( posx < 98304 )
Player->Position 94208 61440 0 0
elseif ( posx < 106496 )
Player->Position 102400 61440 0 0
elseif ( posx < 114688 )
Player->Position 110592 61440 0 0
elseif ( posx < 122880 )
Player->Position 118784 61440 0 0
elseif ( posx < 131072 )
Player->Position 126976 61440 0 0
elseif ( posx < 139264 )
Player->Position 135168 61440 0 0
elseif ( posx < 147456 )
Player->Position 143360 61440 0 0
elseif ( posx < 155648 )
Player->Position 151552 61440 0 0
elseif ( posx < 163840 )
Player->Position 159744 61440 0 0
elseif ( posx < 172032 )
Player->Position 167936 61440 0 0
elseif ( posx < 180224 )
Player->Position 176128 61440 0 0
elseif ( posx < 188416 )
Player->Position 184320 61440 0 0
elseif ( posx < 196608 )
Player->Position 192512 61440 0 0
endif
endif
endif

; y=8, -29<=x<=23
if ( posy >= 65536 )
if ( posy < 73728 )
if ( posx < -229376 )
Player->Position -233472 69632 0 0
elseif ( posx < -221184 )
Player->Position -225280 69632 0 0
elseif ( posx < -212992 )
Player->Position -217088 69632 0 0
elseif ( posx < -204800 )
Player->Position -208896 69632 0 0
elseif ( posx < -196608 )
Player->Position -200704 69632 0 0
elseif ( posx < -188416 )
Player->Position -192512 69632 0 0
elseif ( posx < -180224 )
Player->Position -184320 69632 0 0
elseif ( posx < -172032 )
Player->Position -176128 69632 0 0
elseif ( posx < -163840 )
Player->Position -167936 69632 0 0
elseif ( posx < -155648 )
Player->Position -159744 69632 0 0
elseif ( posx < -147456 )
Player->Position -151552 69632 0 0
elseif ( posx < -139264 )
Player->Position -143360 69632 0 0
elseif ( posx < -131072 )
Player->Position -135168 69632 0 0
elseif ( posx < -122880 )
Player->Position -126976 69632 0 0
elseif ( posx < -114688 )
Player->Position -118784 69632 0 0
elseif ( posx < -106496 )
Player->Position -110592 69632 0 0
elseif ( posx < -98304 )
Player->Position -102400 69632 0 0
elseif ( posx < -90112 )
Player->Position -94208 69632 0 0
elseif ( posx < -81920 )
Player->Position -86016 69632 0 0
elseif ( posx < -73728 )
Player->Position -77824 69632 0 0
elseif ( posx < -65536 )
Player->Position -69632 69632 0 0
elseif ( posx < -57344 )
Player->Position -61440 69632 0 0
elseif ( posx < -49152 )
Player->Position -53248 69632 0 0
elseif ( posx < -40960 )
Player->Position -45056 69632 0 0
elseif ( posx < -32768 )
Player->Position -36864 69632 0 0
elseif ( posx < -24576 )
Player->Position -28672 69632 0 0
elseif ( posx < -16384 )
Player->Position -20480 69632 0 0
elseif ( posx < -8192 )
Player->Position -12288 69632 0 0
elseif ( posx < 0 )
Player->Position -4096 69632 0 0
elseif ( posx < 8192 )
Player->Position 4096 69632 0 0
elseif ( posx < 16384 )
Player->Position 12288 69632 0 0
elseif ( posx < 24576 )
Player->Position 20480 69632 0 0
elseif ( posx < 32768 )
Player->Position 28672 69632 0 0
elseif ( posx < 40960 )
Player->Position 36864 69632 0 0
elseif ( posx < 49152 )
Player->Position 45056 69632 0 0
elseif ( posx < 57344 )
Player->Position 53248 69632 0 0
elseif ( posx < 65536 )
Player->Position 61440 69632 0 0
elseif ( posx < 73728 )
Player->Position 69632 69632 0 0
elseif ( posx < 81920 )
Player->Position 77824 69632 0 0
elseif ( posx < 90112 )
Player->Position 86016 69632 0 0
elseif ( posx < 98304 )
Player->Position 94208 69632 0 0
elseif ( posx < 106496 )
Player->Position 102400 69632 0 0
elseif ( posx < 114688 )
Player->Position 110592 69632 0 0
elseif ( posx < 122880 )
Player->Position 118784 69632 0 0
elseif ( posx < 131072 )
Player->Position 126976 69632 0 0
elseif ( posx < 139264 )
Player->Position 135168 69632 0 0
elseif ( posx < 147456 )
Player->Position 143360 69632 0 0
elseif ( posx < 155648 )
Player->Position 151552 69632 0 0
elseif ( posx < 163840 )
Player->Position 159744 69632 0 0
elseif ( posx < 172032 )
Player->Position 167936 69632 0 0
elseif ( posx < 180224 )
Player->Position 176128 69632 0 0
elseif ( posx < 188416 )
Player->Position 184320 69632 0 0
elseif ( posx < 196608 )
Player->Position 192512 69632 0 0
endif
endif
endif

; y=9, -29<=x<=23
if ( posy >= 73728 )
if ( posy < 81920 )
if ( posx < -229376 )
Player->Position -233472 77824 0 0
elseif ( posx < -221184 )
Player->Position -225280 77824 0 0
elseif ( posx < -212992 )
Player->Position -217088 77824 0 0
elseif ( posx < -204800 )
Player->Position -208896 77824 0 0
elseif ( posx < -196608 )
Player->Position -200704 77824 0 0
elseif ( posx < -188416 )
Player->Position -192512 77824 0 0
elseif ( posx < -180224 )
Player->Position -184320 77824 0 0
elseif ( posx < -172032 )
Player->Position -176128 77824 0 0
elseif ( posx < -163840 )
Player->Position -167936 77824 0 0
elseif ( posx < -155648 )
Player->Position -159744 77824 0 0
elseif ( posx < -147456 )
Player->Position -151552 77824 0 0
elseif ( posx < -139264 )
Player->Position -143360 77824 0 0
elseif ( posx < -131072 )
Player->Position -135168 77824 0 0
elseif ( posx < -122880 )
Player->Position -126976 77824 0 0
elseif ( posx < -114688 )
Player->Position -118784 77824 0 0
elseif ( posx < -106496 )
Player->Position -110592 77824 0 0
elseif ( posx < -98304 )
Player->Position -102400 77824 0 0
elseif ( posx < -90112 )
Player->Position -94208 77824 0 0
elseif ( posx < -81920 )
Player->Position -86016 77824 0 0
elseif ( posx < -73728 )
Player->Position -77824 77824 0 0
elseif ( posx < -65536 )
Player->Position -69632 77824 0 0
elseif ( posx < -57344 )
Player->Position -61440 77824 0 0
elseif ( posx < -49152 )
Player->Position -53248 77824 0 0
elseif ( posx < -40960 )
Player->Position -45056 77824 0 0
elseif ( posx < -32768 )
Player->Position -36864 77824 0 0
elseif ( posx < -24576 )
Player->Position -28672 77824 0 0
elseif ( posx < -16384 )
Player->Position -20480 77824 0 0
elseif ( posx < -8192 )
Player->Position -12288 77824 0 0
elseif ( posx < 0 )
Player->Position -4096 77824 0 0
elseif ( posx < 8192 )
Player->Position 4096 77824 0 0
elseif ( posx < 16384 )
Player->Position 12288 77824 0 0
elseif ( posx < 24576 )
Player->Position 20480 77824 0 0
elseif ( posx < 32768 )
Player->Position 28672 77824 0 0
elseif ( posx < 40960 )
Player->Position 36864 77824 0 0
elseif ( posx < 49152 )
Player->Position 45056 77824 0 0
elseif ( posx < 57344 )
Player->Position 53248 77824 0 0
elseif ( posx < 65536 )
Player->Position 61440 77824 0 0
elseif ( posx < 73728 )
Player->Position 69632 77824 0 0
elseif ( posx < 81920 )
Player->Position 77824 77824 0 0
elseif ( posx < 90112 )
Player->Position 86016 77824 0 0
elseif ( posx < 98304 )
Player->Position 94208 77824 0 0
elseif ( posx < 106496 )
Player->Position 102400 77824 0 0
elseif ( posx < 114688 )
Player->Position 110592 77824 0 0
elseif ( posx < 122880 )
Player->Position 118784 77824 0 0
elseif ( posx < 131072 )
Player->Position 126976 77824 0 0
elseif ( posx < 139264 )
Player->Position 135168 77824 0 0
elseif ( posx < 147456 )
Player->Position 143360 77824 0 0
elseif ( posx < 155648 )
Player->Position 151552 77824 0 0
elseif ( posx < 163840 )
Player->Position 159744 77824 0 0
elseif ( posx < 172032 )
Player->Position 167936 77824 0 0
elseif ( posx < 180224 )
Player->Position 176128 77824 0 0
elseif ( posx < 188416 )
Player->Position 184320 77824 0 0
elseif ( posx < 196608 )
Player->Position 192512 77824 0 0
endif
endif
endif

; y=10, -29<=x<=23
if ( posy >= 81920 )
if ( posy < 90112 )
if ( posx < -229376 )
Player->Position -233472 86016 0 0
elseif ( posx < -221184 )
Player->Position -225280 86016 0 0
elseif ( posx < -212992 )
Player->Position -217088 86016 0 0
elseif ( posx < -204800 )
Player->Position -208896 86016 0 0
elseif ( posx < -196608 )
Player->Position -200704 86016 0 0
elseif ( posx < -188416 )
Player->Position -192512 86016 0 0
elseif ( posx < -180224 )
Player->Position -184320 86016 0 0
elseif ( posx < -172032 )
Player->Position -176128 86016 0 0
elseif ( posx < -163840 )
Player->Position -167936 86016 0 0
elseif ( posx < -155648 )
Player->Position -159744 86016 0 0
elseif ( posx < -147456 )
Player->Position -151552 86016 0 0
elseif ( posx < -139264 )
Player->Position -143360 86016 0 0
elseif ( posx < -131072 )
Player->Position -135168 86016 0 0
elseif ( posx < -122880 )
Player->Position -126976 86016 0 0
elseif ( posx < -114688 )
Player->Position -118784 86016 0 0
elseif ( posx < -106496 )
Player->Position -110592 86016 0 0
elseif ( posx < -98304 )
Player->Position -102400 86016 0 0
elseif ( posx < -90112 )
Player->Position -94208 86016 0 0
elseif ( posx < -81920 )
Player->Position -86016 86016 0 0
elseif ( posx < -73728 )
Player->Position -77824 86016 0 0
elseif ( posx < -65536 )
Player->Position -69632 86016 0 0
elseif ( posx < -57344 )
Player->Position -61440 86016 0 0
elseif ( posx < -49152 )
Player->Position -53248 86016 0 0
elseif ( posx < -40960 )
Player->Position -45056 86016 0 0
elseif ( posx < -32768 )
Player->Position -36864 86016 0 0
elseif ( posx < -24576 )
Player->Position -28672 86016 0 0
elseif ( posx < -16384 )
Player->Position -20480 86016 0 0
elseif ( posx < -8192 )
Player->Position -12288 86016 0 0
elseif ( posx < 0 )
Player->Position -4096 86016 0 0
elseif ( posx < 8192 )
Player->Position 4096 86016 0 0
elseif ( posx < 16384 )
Player->Position 12288 86016 0 0
elseif ( posx < 24576 )
Player->Position 20480 86016 0 0
elseif ( posx < 32768 )
Player->Position 28672 86016 0 0
elseif ( posx < 40960 )
Player->Position 36864 86016 0 0
elseif ( posx < 49152 )
Player->Position 45056 86016 0 0
elseif ( posx < 57344 )
Player->Position 53248 86016 0 0
elseif ( posx < 65536 )
Player->Position 61440 86016 0 0
elseif ( posx < 73728 )
Player->Position 69632 86016 0 0
elseif ( posx < 81920 )
Player->Position 77824 86016 0 0
elseif ( posx < 90112 )
Player->Position 86016 86016 0 0
elseif ( posx < 98304 )
Player->Position 94208 86016 0 0
elseif ( posx < 106496 )
Player->Position 102400 86016 0 0
elseif ( posx < 114688 )
Player->Position 110592 86016 0 0
elseif ( posx < 122880 )
Player->Position 118784 86016 0 0
elseif ( posx < 131072 )
Player->Position 126976 86016 0 0
elseif ( posx < 139264 )
Player->Position 135168 86016 0 0
elseif ( posx < 147456 )
Player->Position 143360 86016 0 0
elseif ( posx < 155648 )
Player->Position 151552 86016 0 0
elseif ( posx < 163840 )
Player->Position 159744 86016 0 0
elseif ( posx < 172032 )
Player->Position 167936 86016 0 0
elseif ( posx < 180224 )
Player->Position 176128 86016 0 0
elseif ( posx < 188416 )
Player->Position 184320 86016 0 0
elseif ( posx < 196608 )
Player->Position 192512 86016 0 0
endif
endif
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setGrid_Sub6"

End

# vn_Teleport_setGrid_Sub7 ====================================================
Begin vn_Teleport_setGrid_Sub7

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

; y=11, -29<=x<=23
if ( posy >= 90112 )
if ( posy < 98304 )
if ( posx < -229376 )
Player->Position -233472 94208 0 0
elseif ( posx < -221184 )
Player->Position -225280 94208 0 0
elseif ( posx < -212992 )
Player->Position -217088 94208 0 0
elseif ( posx < -204800 )
Player->Position -208896 94208 0 0
elseif ( posx < -196608 )
Player->Position -200704 94208 0 0
elseif ( posx < -188416 )
Player->Position -192512 94208 0 0
elseif ( posx < -180224 )
Player->Position -184320 94208 0 0
elseif ( posx < -172032 )
Player->Position -176128 94208 0 0
elseif ( posx < -163840 )
Player->Position -167936 94208 0 0
elseif ( posx < -155648 )
Player->Position -159744 94208 0 0
elseif ( posx < -147456 )
Player->Position -151552 94208 0 0
elseif ( posx < -139264 )
Player->Position -143360 94208 0 0
elseif ( posx < -131072 )
Player->Position -135168 94208 0 0
elseif ( posx < -122880 )
Player->Position -126976 94208 0 0
elseif ( posx < -114688 )
Player->Position -118784 94208 0 0
elseif ( posx < -106496 )
Player->Position -110592 94208 0 0
elseif ( posx < -98304 )
Player->Position -102400 94208 0 0
elseif ( posx < -90112 )
Player->Position -94208 94208 0 0
elseif ( posx < -81920 )
Player->Position -86016 94208 0 0
elseif ( posx < -73728 )
Player->Position -77824 94208 0 0
elseif ( posx < -65536 )
Player->Position -69632 94208 0 0
elseif ( posx < -57344 )
Player->Position -61440 94208 0 0
elseif ( posx < -49152 )
Player->Position -53248 94208 0 0
elseif ( posx < -40960 )
Player->Position -45056 94208 0 0
elseif ( posx < -32768 )
Player->Position -36864 94208 0 0
elseif ( posx < -24576 )
Player->Position -28672 94208 0 0
elseif ( posx < -16384 )
Player->Position -20480 94208 0 0
elseif ( posx < -8192 )
Player->Position -12288 94208 0 0
elseif ( posx < 0 )
Player->Position -4096 94208 0 0
elseif ( posx < 8192 )
Player->Position 4096 94208 0 0
elseif ( posx < 16384 )
Player->Position 12288 94208 0 0
elseif ( posx < 24576 )
Player->Position 20480 94208 0 0
elseif ( posx < 32768 )
Player->Position 28672 94208 0 0
elseif ( posx < 40960 )
Player->Position 36864 94208 0 0
elseif ( posx < 49152 )
Player->Position 45056 94208 0 0
elseif ( posx < 57344 )
Player->Position 53248 94208 0 0
elseif ( posx < 65536 )
Player->Position 61440 94208 0 0
elseif ( posx < 73728 )
Player->Position 69632 94208 0 0
elseif ( posx < 81920 )
Player->Position 77824 94208 0 0
elseif ( posx < 90112 )
Player->Position 86016 94208 0 0
elseif ( posx < 98304 )
Player->Position 94208 94208 0 0
elseif ( posx < 106496 )
Player->Position 102400 94208 0 0
elseif ( posx < 114688 )
Player->Position 110592 94208 0 0
elseif ( posx < 122880 )
Player->Position 118784 94208 0 0
elseif ( posx < 131072 )
Player->Position 126976 94208 0 0
elseif ( posx < 139264 )
Player->Position 135168 94208 0 0
elseif ( posx < 147456 )
Player->Position 143360 94208 0 0
elseif ( posx < 155648 )
Player->Position 151552 94208 0 0
elseif ( posx < 163840 )
Player->Position 159744 94208 0 0
elseif ( posx < 172032 )
Player->Position 167936 94208 0 0
elseif ( posx < 180224 )
Player->Position 176128 94208 0 0
elseif ( posx < 188416 )
Player->Position 184320 94208 0 0
elseif ( posx < 196608 )
Player->Position 192512 94208 0 0
endif
endif
endif

; y=12, -29<=x<=23
if ( posy >= 98304 )
if ( posy < 106496 )
if ( posx < -229376 )
Player->Position -233472 102400 0 0
elseif ( posx < -221184 )
Player->Position -225280 102400 0 0
elseif ( posx < -212992 )
Player->Position -217088 102400 0 0
elseif ( posx < -204800 )
Player->Position -208896 102400 0 0
elseif ( posx < -196608 )
Player->Position -200704 102400 0 0
elseif ( posx < -188416 )
Player->Position -192512 102400 0 0
elseif ( posx < -180224 )
Player->Position -184320 102400 0 0
elseif ( posx < -172032 )
Player->Position -176128 102400 0 0
elseif ( posx < -163840 )
Player->Position -167936 102400 0 0
elseif ( posx < -155648 )
Player->Position -159744 102400 0 0
elseif ( posx < -147456 )
Player->Position -151552 102400 0 0
elseif ( posx < -139264 )
Player->Position -143360 102400 0 0
elseif ( posx < -131072 )
Player->Position -135168 102400 0 0
elseif ( posx < -122880 )
Player->Position -126976 102400 0 0
elseif ( posx < -114688 )
Player->Position -118784 102400 0 0
elseif ( posx < -106496 )
Player->Position -110592 102400 0 0
elseif ( posx < -98304 )
Player->Position -102400 102400 0 0
elseif ( posx < -90112 )
Player->Position -94208 102400 0 0
elseif ( posx < -81920 )
Player->Position -86016 102400 0 0
elseif ( posx < -73728 )
Player->Position -77824 102400 0 0
elseif ( posx < -65536 )
Player->Position -69632 102400 0 0
elseif ( posx < -57344 )
Player->Position -61440 102400 0 0
elseif ( posx < -49152 )
Player->Position -53248 102400 0 0
elseif ( posx < -40960 )
Player->Position -45056 102400 0 0
elseif ( posx < -32768 )
Player->Position -36864 102400 0 0
elseif ( posx < -24576 )
Player->Position -28672 102400 0 0
elseif ( posx < -16384 )
Player->Position -20480 102400 0 0
elseif ( posx < -8192 )
Player->Position -12288 102400 0 0
elseif ( posx < 0 )
Player->Position -4096 102400 0 0
elseif ( posx < 8192 )
Player->Position 4096 102400 0 0
elseif ( posx < 16384 )
Player->Position 12288 102400 0 0
elseif ( posx < 24576 )
Player->Position 20480 102400 0 0
elseif ( posx < 32768 )
Player->Position 28672 102400 0 0
elseif ( posx < 40960 )
Player->Position 36864 102400 0 0
elseif ( posx < 49152 )
Player->Position 45056 102400 0 0
elseif ( posx < 57344 )
Player->Position 53248 102400 0 0
elseif ( posx < 65536 )
Player->Position 61440 102400 0 0
elseif ( posx < 73728 )
Player->Position 69632 102400 0 0
elseif ( posx < 81920 )
Player->Position 77824 102400 0 0
elseif ( posx < 90112 )
Player->Position 86016 102400 0 0
elseif ( posx < 98304 )
Player->Position 94208 102400 0 0
elseif ( posx < 106496 )
Player->Position 102400 102400 0 0
elseif ( posx < 114688 )
Player->Position 110592 102400 0 0
elseif ( posx < 122880 )
Player->Position 118784 102400 0 0
elseif ( posx < 131072 )
Player->Position 126976 102400 0 0
elseif ( posx < 139264 )
Player->Position 135168 102400 0 0
elseif ( posx < 147456 )
Player->Position 143360 102400 0 0
elseif ( posx < 155648 )
Player->Position 151552 102400 0 0
elseif ( posx < 163840 )
Player->Position 159744 102400 0 0
elseif ( posx < 172032 )
Player->Position 167936 102400 0 0
elseif ( posx < 180224 )
Player->Position 176128 102400 0 0
elseif ( posx < 188416 )
Player->Position 184320 102400 0 0
elseif ( posx < 196608 )
Player->Position 192512 102400 0 0
endif
endif
endif

; y=13, -29<=x<=23
if ( posy >= 106496 )
if ( posy < 114688 )
if ( posx < -229376 )
Player->Position -233472 110592 0 0
elseif ( posx < -221184 )
Player->Position -225280 110592 0 0
elseif ( posx < -212992 )
Player->Position -217088 110592 0 0
elseif ( posx < -204800 )
Player->Position -208896 110592 0 0
elseif ( posx < -196608 )
Player->Position -200704 110592 0 0
elseif ( posx < -188416 )
Player->Position -192512 110592 0 0
elseif ( posx < -180224 )
Player->Position -184320 110592 0 0
elseif ( posx < -172032 )
Player->Position -176128 110592 0 0
elseif ( posx < -163840 )
Player->Position -167936 110592 0 0
elseif ( posx < -155648 )
Player->Position -159744 110592 0 0
elseif ( posx < -147456 )
Player->Position -151552 110592 0 0
elseif ( posx < -139264 )
Player->Position -143360 110592 0 0
elseif ( posx < -131072 )
Player->Position -135168 110592 0 0
elseif ( posx < -122880 )
Player->Position -126976 110592 0 0
elseif ( posx < -114688 )
Player->Position -118784 110592 0 0
elseif ( posx < -106496 )
Player->Position -110592 110592 0 0
elseif ( posx < -98304 )
Player->Position -102400 110592 0 0
elseif ( posx < -90112 )
Player->Position -94208 110592 0 0
elseif ( posx < -81920 )
Player->Position -86016 110592 0 0
elseif ( posx < -73728 )
Player->Position -77824 110592 0 0
elseif ( posx < -65536 )
Player->Position -69632 110592 0 0
elseif ( posx < -57344 )
Player->Position -61440 110592 0 0
elseif ( posx < -49152 )
Player->Position -53248 110592 0 0
elseif ( posx < -40960 )
Player->Position -45056 110592 0 0
elseif ( posx < -32768 )
Player->Position -36864 110592 0 0
elseif ( posx < -24576 )
Player->Position -28672 110592 0 0
elseif ( posx < -16384 )
Player->Position -20480 110592 0 0
elseif ( posx < -8192 )
Player->Position -12288 110592 0 0
elseif ( posx < 0 )
Player->Position -4096 110592 0 0
elseif ( posx < 8192 )
Player->Position 4096 110592 0 0
elseif ( posx < 16384 )
Player->Position 12288 110592 0 0
elseif ( posx < 24576 )
Player->Position 20480 110592 0 0
elseif ( posx < 32768 )
Player->Position 28672 110592 0 0
elseif ( posx < 40960 )
Player->Position 36864 110592 0 0
elseif ( posx < 49152 )
Player->Position 45056 110592 0 0
elseif ( posx < 57344 )
Player->Position 53248 110592 0 0
elseif ( posx < 65536 )
Player->Position 61440 110592 0 0
elseif ( posx < 73728 )
Player->Position 69632 110592 0 0
elseif ( posx < 81920 )
Player->Position 77824 110592 0 0
elseif ( posx < 90112 )
Player->Position 86016 110592 0 0
elseif ( posx < 98304 )
Player->Position 94208 110592 0 0
elseif ( posx < 106496 )
Player->Position 102400 110592 0 0
elseif ( posx < 114688 )
Player->Position 110592 110592 0 0
elseif ( posx < 122880 )
Player->Position 118784 110592 0 0
elseif ( posx < 131072 )
Player->Position 126976 110592 0 0
elseif ( posx < 139264 )
Player->Position 135168 110592 0 0
elseif ( posx < 147456 )
Player->Position 143360 110592 0 0
elseif ( posx < 155648 )
Player->Position 151552 110592 0 0
elseif ( posx < 163840 )
Player->Position 159744 110592 0 0
elseif ( posx < 172032 )
Player->Position 167936 110592 0 0
elseif ( posx < 180224 )
Player->Position 176128 110592 0 0
elseif ( posx < 188416 )
Player->Position 184320 110592 0 0
elseif ( posx < 196608 )
Player->Position 192512 110592 0 0
endif
endif
endif

; y=14, -29<=x<=23
if ( posy >= 114688 )
if ( posy < 122880 )
if ( posx < -229376 )
Player->Position -233472 118784 0 0
elseif ( posx < -221184 )
Player->Position -225280 118784 0 0
elseif ( posx < -212992 )
Player->Position -217088 118784 0 0
elseif ( posx < -204800 )
Player->Position -208896 118784 0 0
elseif ( posx < -196608 )
Player->Position -200704 118784 0 0
elseif ( posx < -188416 )
Player->Position -192512 118784 0 0
elseif ( posx < -180224 )
Player->Position -184320 118784 0 0
elseif ( posx < -172032 )
Player->Position -176128 118784 0 0
elseif ( posx < -163840 )
Player->Position -167936 118784 0 0
elseif ( posx < -155648 )
Player->Position -159744 118784 0 0
elseif ( posx < -147456 )
Player->Position -151552 118784 0 0
elseif ( posx < -139264 )
Player->Position -143360 118784 0 0
elseif ( posx < -131072 )
Player->Position -135168 118784 0 0
elseif ( posx < -122880 )
Player->Position -126976 118784 0 0
elseif ( posx < -114688 )
Player->Position -118784 118784 0 0
elseif ( posx < -106496 )
Player->Position -110592 118784 0 0
elseif ( posx < -98304 )
Player->Position -102400 118784 0 0
elseif ( posx < -90112 )
Player->Position -94208 118784 0 0
elseif ( posx < -81920 )
Player->Position -86016 118784 0 0
elseif ( posx < -73728 )
Player->Position -77824 118784 0 0
elseif ( posx < -65536 )
Player->Position -69632 118784 0 0
elseif ( posx < -57344 )
Player->Position -61440 118784 0 0
elseif ( posx < -49152 )
Player->Position -53248 118784 0 0
elseif ( posx < -40960 )
Player->Position -45056 118784 0 0
elseif ( posx < -32768 )
Player->Position -36864 118784 0 0
elseif ( posx < -24576 )
Player->Position -28672 118784 0 0
elseif ( posx < -16384 )
Player->Position -20480 118784 0 0
elseif ( posx < -8192 )
Player->Position -12288 118784 0 0
elseif ( posx < 0 )
Player->Position -4096 118784 0 0
elseif ( posx < 8192 )
Player->Position 4096 118784 0 0
elseif ( posx < 16384 )
Player->Position 12288 118784 0 0
elseif ( posx < 24576 )
Player->Position 20480 118784 0 0
elseif ( posx < 32768 )
Player->Position 28672 118784 0 0
elseif ( posx < 40960 )
Player->Position 36864 118784 0 0
elseif ( posx < 49152 )
Player->Position 45056 118784 0 0
elseif ( posx < 57344 )
Player->Position 53248 118784 0 0
elseif ( posx < 65536 )
Player->Position 61440 118784 0 0
elseif ( posx < 73728 )
Player->Position 69632 118784 0 0
elseif ( posx < 81920 )
Player->Position 77824 118784 0 0
elseif ( posx < 90112 )
Player->Position 86016 118784 0 0
elseif ( posx < 98304 )
Player->Position 94208 118784 0 0
elseif ( posx < 106496 )
Player->Position 102400 118784 0 0
elseif ( posx < 114688 )
Player->Position 110592 118784 0 0
elseif ( posx < 122880 )
Player->Position 118784 118784 0 0
elseif ( posx < 131072 )
Player->Position 126976 118784 0 0
elseif ( posx < 139264 )
Player->Position 135168 118784 0 0
elseif ( posx < 147456 )
Player->Position 143360 118784 0 0
elseif ( posx < 155648 )
Player->Position 151552 118784 0 0
elseif ( posx < 163840 )
Player->Position 159744 118784 0 0
elseif ( posx < 172032 )
Player->Position 167936 118784 0 0
elseif ( posx < 180224 )
Player->Position 176128 118784 0 0
elseif ( posx < 188416 )
Player->Position 184320 118784 0 0
elseif ( posx < 196608 )
Player->Position 192512 118784 0 0
endif
endif
endif

; y=15, -29<=x<=23
if ( posy >= 122880 )
if ( posy < 131072 )
if ( posx < -229376 )
Player->Position -233472 126976 0 0
elseif ( posx < -221184 )
Player->Position -225280 126976 0 0
elseif ( posx < -212992 )
Player->Position -217088 126976 0 0
elseif ( posx < -204800 )
Player->Position -208896 126976 0 0
elseif ( posx < -196608 )
Player->Position -200704 126976 0 0
elseif ( posx < -188416 )
Player->Position -192512 126976 0 0
elseif ( posx < -180224 )
Player->Position -184320 126976 0 0
elseif ( posx < -172032 )
Player->Position -176128 126976 0 0
elseif ( posx < -163840 )
Player->Position -167936 126976 0 0
elseif ( posx < -155648 )
Player->Position -159744 126976 0 0
elseif ( posx < -147456 )
Player->Position -151552 126976 0 0
elseif ( posx < -139264 )
Player->Position -143360 126976 0 0
elseif ( posx < -131072 )
Player->Position -135168 126976 0 0
elseif ( posx < -122880 )
Player->Position -126976 126976 0 0
elseif ( posx < -114688 )
Player->Position -118784 126976 0 0
elseif ( posx < -106496 )
Player->Position -110592 126976 0 0
elseif ( posx < -98304 )
Player->Position -102400 126976 0 0
elseif ( posx < -90112 )
Player->Position -94208 126976 0 0
elseif ( posx < -81920 )
Player->Position -86016 126976 0 0
elseif ( posx < -73728 )
Player->Position -77824 126976 0 0
elseif ( posx < -65536 )
Player->Position -69632 126976 0 0
elseif ( posx < -57344 )
Player->Position -61440 126976 0 0
elseif ( posx < -49152 )
Player->Position -53248 126976 0 0
elseif ( posx < -40960 )
Player->Position -45056 126976 0 0
elseif ( posx < -32768 )
Player->Position -36864 126976 0 0
elseif ( posx < -24576 )
Player->Position -28672 126976 0 0
elseif ( posx < -16384 )
Player->Position -20480 126976 0 0
elseif ( posx < -8192 )
Player->Position -12288 126976 0 0
elseif ( posx < 0 )
Player->Position -4096 126976 0 0
elseif ( posx < 8192 )
Player->Position 4096 126976 0 0
elseif ( posx < 16384 )
Player->Position 12288 126976 0 0
elseif ( posx < 24576 )
Player->Position 20480 126976 0 0
elseif ( posx < 32768 )
Player->Position 28672 126976 0 0
elseif ( posx < 40960 )
Player->Position 36864 126976 0 0
elseif ( posx < 49152 )
Player->Position 45056 126976 0 0
elseif ( posx < 57344 )
Player->Position 53248 126976 0 0
elseif ( posx < 65536 )
Player->Position 61440 126976 0 0
elseif ( posx < 73728 )
Player->Position 69632 126976 0 0
elseif ( posx < 81920 )
Player->Position 77824 126976 0 0
elseif ( posx < 90112 )
Player->Position 86016 126976 0 0
elseif ( posx < 98304 )
Player->Position 94208 126976 0 0
elseif ( posx < 106496 )
Player->Position 102400 126976 0 0
elseif ( posx < 114688 )
Player->Position 110592 126976 0 0
elseif ( posx < 122880 )
Player->Position 118784 126976 0 0
elseif ( posx < 131072 )
Player->Position 126976 126976 0 0
elseif ( posx < 139264 )
Player->Position 135168 126976 0 0
elseif ( posx < 147456 )
Player->Position 143360 126976 0 0
elseif ( posx < 155648 )
Player->Position 151552 126976 0 0
elseif ( posx < 163840 )
Player->Position 159744 126976 0 0
elseif ( posx < 172032 )
Player->Position 167936 126976 0 0
elseif ( posx < 180224 )
Player->Position 176128 126976 0 0
elseif ( posx < 188416 )
Player->Position 184320 126976 0 0
elseif ( posx < 196608 )
Player->Position 192512 126976 0 0
endif
endif
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setGrid_Sub7"

End

# vn_Teleport_setGrid_Sub8 ====================================================
Begin vn_Teleport_setGrid_Sub8

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

; y=16, -29<=x<=23
if ( posy >= 131072 )
if ( posy < 139264 )
if ( posx < -229376 )
Player->Position -233472 135168 0 0
elseif ( posx < -221184 )
Player->Position -225280 135168 0 0
elseif ( posx < -212992 )
Player->Position -217088 135168 0 0
elseif ( posx < -204800 )
Player->Position -208896 135168 0 0
elseif ( posx < -196608 )
Player->Position -200704 135168 0 0
elseif ( posx < -188416 )
Player->Position -192512 135168 0 0
elseif ( posx < -180224 )
Player->Position -184320 135168 0 0
elseif ( posx < -172032 )
Player->Position -176128 135168 0 0
elseif ( posx < -163840 )
Player->Position -167936 135168 0 0
elseif ( posx < -155648 )
Player->Position -159744 135168 0 0
elseif ( posx < -147456 )
Player->Position -151552 135168 0 0
elseif ( posx < -139264 )
Player->Position -143360 135168 0 0
elseif ( posx < -131072 )
Player->Position -135168 135168 0 0
elseif ( posx < -122880 )
Player->Position -126976 135168 0 0
elseif ( posx < -114688 )
Player->Position -118784 135168 0 0
elseif ( posx < -106496 )
Player->Position -110592 135168 0 0
elseif ( posx < -98304 )
Player->Position -102400 135168 0 0
elseif ( posx < -90112 )
Player->Position -94208 135168 0 0
elseif ( posx < -81920 )
Player->Position -86016 135168 0 0
elseif ( posx < -73728 )
Player->Position -77824 135168 0 0
elseif ( posx < -65536 )
Player->Position -69632 135168 0 0
elseif ( posx < -57344 )
Player->Position -61440 135168 0 0
elseif ( posx < -49152 )
Player->Position -53248 135168 0 0
elseif ( posx < -40960 )
Player->Position -45056 135168 0 0
elseif ( posx < -32768 )
Player->Position -36864 135168 0 0
elseif ( posx < -24576 )
Player->Position -28672 135168 0 0
elseif ( posx < -16384 )
Player->Position -20480 135168 0 0
elseif ( posx < -8192 )
Player->Position -12288 135168 0 0
elseif ( posx < 0 )
Player->Position -4096 135168 0 0
elseif ( posx < 8192 )
Player->Position 4096 135168 0 0
elseif ( posx < 16384 )
Player->Position 12288 135168 0 0
elseif ( posx < 24576 )
Player->Position 20480 135168 0 0
elseif ( posx < 32768 )
Player->Position 28672 135168 0 0
elseif ( posx < 40960 )
Player->Position 36864 135168 0 0
elseif ( posx < 49152 )
Player->Position 45056 135168 0 0
elseif ( posx < 57344 )
Player->Position 53248 135168 0 0
elseif ( posx < 65536 )
Player->Position 61440 135168 0 0
elseif ( posx < 73728 )
Player->Position 69632 135168 0 0
elseif ( posx < 81920 )
Player->Position 77824 135168 0 0
elseif ( posx < 90112 )
Player->Position 86016 135168 0 0
elseif ( posx < 98304 )
Player->Position 94208 135168 0 0
elseif ( posx < 106496 )
Player->Position 102400 135168 0 0
elseif ( posx < 114688 )
Player->Position 110592 135168 0 0
elseif ( posx < 122880 )
Player->Position 118784 135168 0 0
elseif ( posx < 131072 )
Player->Position 126976 135168 0 0
elseif ( posx < 139264 )
Player->Position 135168 135168 0 0
elseif ( posx < 147456 )
Player->Position 143360 135168 0 0
elseif ( posx < 155648 )
Player->Position 151552 135168 0 0
elseif ( posx < 163840 )
Player->Position 159744 135168 0 0
elseif ( posx < 172032 )
Player->Position 167936 135168 0 0
elseif ( posx < 180224 )
Player->Position 176128 135168 0 0
elseif ( posx < 188416 )
Player->Position 184320 135168 0 0
elseif ( posx < 196608 )
Player->Position 192512 135168 0 0
endif
endif
endif

; y=17, -29<=x<=23
if ( posy >= 139264 )
if ( posy < 147456 )
if ( posx < -229376 )
Player->Position -233472 143360 0 0
elseif ( posx < -221184 )
Player->Position -225280 143360 0 0
elseif ( posx < -212992 )
Player->Position -217088 143360 0 0
elseif ( posx < -204800 )
Player->Position -208896 143360 0 0
elseif ( posx < -196608 )
Player->Position -200704 143360 0 0
elseif ( posx < -188416 )
Player->Position -192512 143360 0 0
elseif ( posx < -180224 )
Player->Position -184320 143360 0 0
elseif ( posx < -172032 )
Player->Position -176128 143360 0 0
elseif ( posx < -163840 )
Player->Position -167936 143360 0 0
elseif ( posx < -155648 )
Player->Position -159744 143360 0 0
elseif ( posx < -147456 )
Player->Position -151552 143360 0 0
elseif ( posx < -139264 )
Player->Position -143360 143360 0 0
elseif ( posx < -131072 )
Player->Position -135168 143360 0 0
elseif ( posx < -122880 )
Player->Position -126976 143360 0 0
elseif ( posx < -114688 )
Player->Position -118784 143360 0 0
elseif ( posx < -106496 )
Player->Position -110592 143360 0 0
elseif ( posx < -98304 )
Player->Position -102400 143360 0 0
elseif ( posx < -90112 )
Player->Position -94208 143360 0 0
elseif ( posx < -81920 )
Player->Position -86016 143360 0 0
elseif ( posx < -73728 )
Player->Position -77824 143360 0 0
elseif ( posx < -65536 )
Player->Position -69632 143360 0 0
elseif ( posx < -57344 )
Player->Position -61440 143360 0 0
elseif ( posx < -49152 )
Player->Position -53248 143360 0 0
elseif ( posx < -40960 )
Player->Position -45056 143360 0 0
elseif ( posx < -32768 )
Player->Position -36864 143360 0 0
elseif ( posx < -24576 )
Player->Position -28672 143360 0 0
elseif ( posx < -16384 )
Player->Position -20480 143360 0 0
elseif ( posx < -8192 )
Player->Position -12288 143360 0 0
elseif ( posx < 0 )
Player->Position -4096 143360 0 0
elseif ( posx < 8192 )
Player->Position 4096 143360 0 0
elseif ( posx < 16384 )
Player->Position 12288 143360 0 0
elseif ( posx < 24576 )
Player->Position 20480 143360 0 0
elseif ( posx < 32768 )
Player->Position 28672 143360 0 0
elseif ( posx < 40960 )
Player->Position 36864 143360 0 0
elseif ( posx < 49152 )
Player->Position 45056 143360 0 0
elseif ( posx < 57344 )
Player->Position 53248 143360 0 0
elseif ( posx < 65536 )
Player->Position 61440 143360 0 0
elseif ( posx < 73728 )
Player->Position 69632 143360 0 0
elseif ( posx < 81920 )
Player->Position 77824 143360 0 0
elseif ( posx < 90112 )
Player->Position 86016 143360 0 0
elseif ( posx < 98304 )
Player->Position 94208 143360 0 0
elseif ( posx < 106496 )
Player->Position 102400 143360 0 0
elseif ( posx < 114688 )
Player->Position 110592 143360 0 0
elseif ( posx < 122880 )
Player->Position 118784 143360 0 0
elseif ( posx < 131072 )
Player->Position 126976 143360 0 0
elseif ( posx < 139264 )
Player->Position 135168 143360 0 0
elseif ( posx < 147456 )
Player->Position 143360 143360 0 0
elseif ( posx < 155648 )
Player->Position 151552 143360 0 0
elseif ( posx < 163840 )
Player->Position 159744 143360 0 0
elseif ( posx < 172032 )
Player->Position 167936 143360 0 0
elseif ( posx < 180224 )
Player->Position 176128 143360 0 0
elseif ( posx < 188416 )
Player->Position 184320 143360 0 0
elseif ( posx < 196608 )
Player->Position 192512 143360 0 0
endif
endif
endif

; y=18, -29<=x<=23
if ( posy >= 147456 )
if ( posy < 155648 )
if ( posx < -229376 )
Player->Position -233472 151552 0 0
elseif ( posx < -221184 )
Player->Position -225280 151552 0 0
elseif ( posx < -212992 )
Player->Position -217088 151552 0 0
elseif ( posx < -204800 )
Player->Position -208896 151552 0 0
elseif ( posx < -196608 )
Player->Position -200704 151552 0 0
elseif ( posx < -188416 )
Player->Position -192512 151552 0 0
elseif ( posx < -180224 )
Player->Position -184320 151552 0 0
elseif ( posx < -172032 )
Player->Position -176128 151552 0 0
elseif ( posx < -163840 )
Player->Position -167936 151552 0 0
elseif ( posx < -155648 )
Player->Position -159744 151552 0 0
elseif ( posx < -147456 )
Player->Position -151552 151552 0 0
elseif ( posx < -139264 )
Player->Position -143360 151552 0 0
elseif ( posx < -131072 )
Player->Position -135168 151552 0 0
elseif ( posx < -122880 )
Player->Position -126976 151552 0 0
elseif ( posx < -114688 )
Player->Position -118784 151552 0 0
elseif ( posx < -106496 )
Player->Position -110592 151552 0 0
elseif ( posx < -98304 )
Player->Position -102400 151552 0 0
elseif ( posx < -90112 )
Player->Position -94208 151552 0 0
elseif ( posx < -81920 )
Player->Position -86016 151552 0 0
elseif ( posx < -73728 )
Player->Position -77824 151552 0 0
elseif ( posx < -65536 )
Player->Position -69632 151552 0 0
elseif ( posx < -57344 )
Player->Position -61440 151552 0 0
elseif ( posx < -49152 )
Player->Position -53248 151552 0 0
elseif ( posx < -40960 )
Player->Position -45056 151552 0 0
elseif ( posx < -32768 )
Player->Position -36864 151552 0 0
elseif ( posx < -24576 )
Player->Position -28672 151552 0 0
elseif ( posx < -16384 )
Player->Position -20480 151552 0 0
elseif ( posx < -8192 )
Player->Position -12288 151552 0 0
elseif ( posx < 0 )
Player->Position -4096 151552 0 0
elseif ( posx < 8192 )
Player->Position 4096 151552 0 0
elseif ( posx < 16384 )
Player->Position 12288 151552 0 0
elseif ( posx < 24576 )
Player->Position 20480 151552 0 0
elseif ( posx < 32768 )
Player->Position 28672 151552 0 0
elseif ( posx < 40960 )
Player->Position 36864 151552 0 0
elseif ( posx < 49152 )
Player->Position 45056 151552 0 0
elseif ( posx < 57344 )
Player->Position 53248 151552 0 0
elseif ( posx < 65536 )
Player->Position 61440 151552 0 0
elseif ( posx < 73728 )
Player->Position 69632 151552 0 0
elseif ( posx < 81920 )
Player->Position 77824 151552 0 0
elseif ( posx < 90112 )
Player->Position 86016 151552 0 0
elseif ( posx < 98304 )
Player->Position 94208 151552 0 0
elseif ( posx < 106496 )
Player->Position 102400 151552 0 0
elseif ( posx < 114688 )
Player->Position 110592 151552 0 0
elseif ( posx < 122880 )
Player->Position 118784 151552 0 0
elseif ( posx < 131072 )
Player->Position 126976 151552 0 0
elseif ( posx < 139264 )
Player->Position 135168 151552 0 0
elseif ( posx < 147456 )
Player->Position 143360 151552 0 0
elseif ( posx < 155648 )
Player->Position 151552 151552 0 0
elseif ( posx < 163840 )
Player->Position 159744 151552 0 0
elseif ( posx < 172032 )
Player->Position 167936 151552 0 0
elseif ( posx < 180224 )
Player->Position 176128 151552 0 0
elseif ( posx < 188416 )
Player->Position 184320 151552 0 0
elseif ( posx < 196608 )
Player->Position 192512 151552 0 0
endif
endif
endif

; y=19, -29<=x<=23
if ( posy >= 155648 )
if ( posy < 163840 )
if ( posx < -229376 )
Player->Position -233472 159744 0 0
elseif ( posx < -221184 )
Player->Position -225280 159744 0 0
elseif ( posx < -212992 )
Player->Position -217088 159744 0 0
elseif ( posx < -204800 )
Player->Position -208896 159744 0 0
elseif ( posx < -196608 )
Player->Position -200704 159744 0 0
elseif ( posx < -188416 )
Player->Position -192512 159744 0 0
elseif ( posx < -180224 )
Player->Position -184320 159744 0 0
elseif ( posx < -172032 )
Player->Position -176128 159744 0 0
elseif ( posx < -163840 )
Player->Position -167936 159744 0 0
elseif ( posx < -155648 )
Player->Position -159744 159744 0 0
elseif ( posx < -147456 )
Player->Position -151552 159744 0 0
elseif ( posx < -139264 )
Player->Position -143360 159744 0 0
elseif ( posx < -131072 )
Player->Position -135168 159744 0 0
elseif ( posx < -122880 )
Player->Position -126976 159744 0 0
elseif ( posx < -114688 )
Player->Position -118784 159744 0 0
elseif ( posx < -106496 )
Player->Position -110592 159744 0 0
elseif ( posx < -98304 )
Player->Position -102400 159744 0 0
elseif ( posx < -90112 )
Player->Position -94208 159744 0 0
elseif ( posx < -81920 )
Player->Position -86016 159744 0 0
elseif ( posx < -73728 )
Player->Position -77824 159744 0 0
elseif ( posx < -65536 )
Player->Position -69632 159744 0 0
elseif ( posx < -57344 )
Player->Position -61440 159744 0 0
elseif ( posx < -49152 )
Player->Position -53248 159744 0 0
elseif ( posx < -40960 )
Player->Position -45056 159744 0 0
elseif ( posx < -32768 )
Player->Position -36864 159744 0 0
elseif ( posx < -24576 )
Player->Position -28672 159744 0 0
elseif ( posx < -16384 )
Player->Position -20480 159744 0 0
elseif ( posx < -8192 )
Player->Position -12288 159744 0 0
elseif ( posx < 0 )
Player->Position -4096 159744 0 0
elseif ( posx < 8192 )
Player->Position 4096 159744 0 0
elseif ( posx < 16384 )
Player->Position 12288 159744 0 0
elseif ( posx < 24576 )
Player->Position 20480 159744 0 0
elseif ( posx < 32768 )
Player->Position 28672 159744 0 0
elseif ( posx < 40960 )
Player->Position 36864 159744 0 0
elseif ( posx < 49152 )
Player->Position 45056 159744 0 0
elseif ( posx < 57344 )
Player->Position 53248 159744 0 0
elseif ( posx < 65536 )
Player->Position 61440 159744 0 0
elseif ( posx < 73728 )
Player->Position 69632 159744 0 0
elseif ( posx < 81920 )
Player->Position 77824 159744 0 0
elseif ( posx < 90112 )
Player->Position 86016 159744 0 0
elseif ( posx < 98304 )
Player->Position 94208 159744 0 0
elseif ( posx < 106496 )
Player->Position 102400 159744 0 0
elseif ( posx < 114688 )
Player->Position 110592 159744 0 0
elseif ( posx < 122880 )
Player->Position 118784 159744 0 0
elseif ( posx < 131072 )
Player->Position 126976 159744 0 0
elseif ( posx < 139264 )
Player->Position 135168 159744 0 0
elseif ( posx < 147456 )
Player->Position 143360 159744 0 0
elseif ( posx < 155648 )
Player->Position 151552 159744 0 0
elseif ( posx < 163840 )
Player->Position 159744 159744 0 0
elseif ( posx < 172032 )
Player->Position 167936 159744 0 0
elseif ( posx < 180224 )
Player->Position 176128 159744 0 0
elseif ( posx < 188416 )
Player->Position 184320 159744 0 0
elseif ( posx < 196608 )
Player->Position 192512 159744 0 0
endif
endif
endif

; y=20, -29<=x<=23
if ( posy >= 163840 )
if ( posy < 172032 )
if ( posx < -229376 )
Player->Position -233472 167936 0 0
elseif ( posx < -221184 )
Player->Position -225280 167936 0 0
elseif ( posx < -212992 )
Player->Position -217088 167936 0 0
elseif ( posx < -204800 )
Player->Position -208896 167936 0 0
elseif ( posx < -196608 )
Player->Position -200704 167936 0 0
elseif ( posx < -188416 )
Player->Position -192512 167936 0 0
elseif ( posx < -180224 )
Player->Position -184320 167936 0 0
elseif ( posx < -172032 )
Player->Position -176128 167936 0 0
elseif ( posx < -163840 )
Player->Position -167936 167936 0 0
elseif ( posx < -155648 )
Player->Position -159744 167936 0 0
elseif ( posx < -147456 )
Player->Position -151552 167936 0 0
elseif ( posx < -139264 )
Player->Position -143360 167936 0 0
elseif ( posx < -131072 )
Player->Position -135168 167936 0 0
elseif ( posx < -122880 )
Player->Position -126976 167936 0 0
elseif ( posx < -114688 )
Player->Position -118784 167936 0 0
elseif ( posx < -106496 )
Player->Position -110592 167936 0 0
elseif ( posx < -98304 )
Player->Position -102400 167936 0 0
elseif ( posx < -90112 )
Player->Position -94208 167936 0 0
elseif ( posx < -81920 )
Player->Position -86016 167936 0 0
elseif ( posx < -73728 )
Player->Position -77824 167936 0 0
elseif ( posx < -65536 )
Player->Position -69632 167936 0 0
elseif ( posx < -57344 )
Player->Position -61440 167936 0 0
elseif ( posx < -49152 )
Player->Position -53248 167936 0 0
elseif ( posx < -40960 )
Player->Position -45056 167936 0 0
elseif ( posx < -32768 )
Player->Position -36864 167936 0 0
elseif ( posx < -24576 )
Player->Position -28672 167936 0 0
elseif ( posx < -16384 )
Player->Position -20480 167936 0 0
elseif ( posx < -8192 )
Player->Position -12288 167936 0 0
elseif ( posx < 0 )
Player->Position -4096 167936 0 0
elseif ( posx < 8192 )
Player->Position 4096 167936 0 0
elseif ( posx < 16384 )
Player->Position 12288 167936 0 0
elseif ( posx < 24576 )
Player->Position 20480 167936 0 0
elseif ( posx < 32768 )
Player->Position 28672 167936 0 0
elseif ( posx < 40960 )
Player->Position 36864 167936 0 0
elseif ( posx < 49152 )
Player->Position 45056 167936 0 0
elseif ( posx < 57344 )
Player->Position 53248 167936 0 0
elseif ( posx < 65536 )
Player->Position 61440 167936 0 0
elseif ( posx < 73728 )
Player->Position 69632 167936 0 0
elseif ( posx < 81920 )
Player->Position 77824 167936 0 0
elseif ( posx < 90112 )
Player->Position 86016 167936 0 0
elseif ( posx < 98304 )
Player->Position 94208 167936 0 0
elseif ( posx < 106496 )
Player->Position 102400 167936 0 0
elseif ( posx < 114688 )
Player->Position 110592 167936 0 0
elseif ( posx < 122880 )
Player->Position 118784 167936 0 0
elseif ( posx < 131072 )
Player->Position 126976 167936 0 0
elseif ( posx < 139264 )
Player->Position 135168 167936 0 0
elseif ( posx < 147456 )
Player->Position 143360 167936 0 0
elseif ( posx < 155648 )
Player->Position 151552 167936 0 0
elseif ( posx < 163840 )
Player->Position 159744 167936 0 0
elseif ( posx < 172032 )
Player->Position 167936 167936 0 0
elseif ( posx < 180224 )
Player->Position 176128 167936 0 0
elseif ( posx < 188416 )
Player->Position 184320 167936 0 0
elseif ( posx < 196608 )
Player->Position 192512 167936 0 0
endif
endif
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setGrid_Sub8"

End

# vn_Teleport_setGrid_Sub9 ====================================================
Begin vn_Teleport_setGrid_Sub9

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

; y=21, -29<=x<=23
if ( posy >= 172032 )
if ( posy < 180224 )
if ( posx < -229376 )
Player->Position -233472 176128 0 0
elseif ( posx < -221184 )
Player->Position -225280 176128 0 0
elseif ( posx < -212992 )
Player->Position -217088 176128 0 0
elseif ( posx < -204800 )
Player->Position -208896 176128 0 0
elseif ( posx < -196608 )
Player->Position -200704 176128 0 0
elseif ( posx < -188416 )
Player->Position -192512 176128 0 0
elseif ( posx < -180224 )
Player->Position -184320 176128 0 0
elseif ( posx < -172032 )
Player->Position -176128 176128 0 0
elseif ( posx < -163840 )
Player->Position -167936 176128 0 0
elseif ( posx < -155648 )
Player->Position -159744 176128 0 0
elseif ( posx < -147456 )
Player->Position -151552 176128 0 0
elseif ( posx < -139264 )
Player->Position -143360 176128 0 0
elseif ( posx < -131072 )
Player->Position -135168 176128 0 0
elseif ( posx < -122880 )
Player->Position -126976 176128 0 0
elseif ( posx < -114688 )
Player->Position -118784 176128 0 0
elseif ( posx < -106496 )
Player->Position -110592 176128 0 0
elseif ( posx < -98304 )
Player->Position -102400 176128 0 0
elseif ( posx < -90112 )
Player->Position -94208 176128 0 0
elseif ( posx < -81920 )
Player->Position -86016 176128 0 0
elseif ( posx < -73728 )
Player->Position -77824 176128 0 0
elseif ( posx < -65536 )
Player->Position -69632 176128 0 0
elseif ( posx < -57344 )
Player->Position -61440 176128 0 0
elseif ( posx < -49152 )
Player->Position -53248 176128 0 0
elseif ( posx < -40960 )
Player->Position -45056 176128 0 0
elseif ( posx < -32768 )
Player->Position -36864 176128 0 0
elseif ( posx < -24576 )
Player->Position -28672 176128 0 0
elseif ( posx < -16384 )
Player->Position -20480 176128 0 0
elseif ( posx < -8192 )
Player->Position -12288 176128 0 0
elseif ( posx < 0 )
Player->Position -4096 176128 0 0
elseif ( posx < 8192 )
Player->Position 4096 176128 0 0
elseif ( posx < 16384 )
Player->Position 12288 176128 0 0
elseif ( posx < 24576 )
Player->Position 20480 176128 0 0
elseif ( posx < 32768 )
Player->Position 28672 176128 0 0
elseif ( posx < 40960 )
Player->Position 36864 176128 0 0
elseif ( posx < 49152 )
Player->Position 45056 176128 0 0
elseif ( posx < 57344 )
Player->Position 53248 176128 0 0
elseif ( posx < 65536 )
Player->Position 61440 176128 0 0
elseif ( posx < 73728 )
Player->Position 69632 176128 0 0
elseif ( posx < 81920 )
Player->Position 77824 176128 0 0
elseif ( posx < 90112 )
Player->Position 86016 176128 0 0
elseif ( posx < 98304 )
Player->Position 94208 176128 0 0
elseif ( posx < 106496 )
Player->Position 102400 176128 0 0
elseif ( posx < 114688 )
Player->Position 110592 176128 0 0
elseif ( posx < 122880 )
Player->Position 118784 176128 0 0
elseif ( posx < 131072 )
Player->Position 126976 176128 0 0
elseif ( posx < 139264 )
Player->Position 135168 176128 0 0
elseif ( posx < 147456 )
Player->Position 143360 176128 0 0
elseif ( posx < 155648 )
Player->Position 151552 176128 0 0
elseif ( posx < 163840 )
Player->Position 159744 176128 0 0
elseif ( posx < 172032 )
Player->Position 167936 176128 0 0
elseif ( posx < 180224 )
Player->Position 176128 176128 0 0
elseif ( posx < 188416 )
Player->Position 184320 176128 0 0
elseif ( posx < 196608 )
Player->Position 192512 176128 0 0
endif
endif
endif

; y=22, -29<=x<=23
if ( posy >= 180224 )
if ( posy < 188416 )
if ( posx < -229376 )
Player->Position -233472 184320 0 0
elseif ( posx < -221184 )
Player->Position -225280 184320 0 0
elseif ( posx < -212992 )
Player->Position -217088 184320 0 0
elseif ( posx < -204800 )
Player->Position -208896 184320 0 0
elseif ( posx < -196608 )
Player->Position -200704 184320 0 0
elseif ( posx < -188416 )
Player->Position -192512 184320 0 0
elseif ( posx < -180224 )
Player->Position -184320 184320 0 0
elseif ( posx < -172032 )
Player->Position -176128 184320 0 0
elseif ( posx < -163840 )
Player->Position -167936 184320 0 0
elseif ( posx < -155648 )
Player->Position -159744 184320 0 0
elseif ( posx < -147456 )
Player->Position -151552 184320 0 0
elseif ( posx < -139264 )
Player->Position -143360 184320 0 0
elseif ( posx < -131072 )
Player->Position -135168 184320 0 0
elseif ( posx < -122880 )
Player->Position -126976 184320 0 0
elseif ( posx < -114688 )
Player->Position -118784 184320 0 0
elseif ( posx < -106496 )
Player->Position -110592 184320 0 0
elseif ( posx < -98304 )
Player->Position -102400 184320 0 0
elseif ( posx < -90112 )
Player->Position -94208 184320 0 0
elseif ( posx < -81920 )
Player->Position -86016 184320 0 0
elseif ( posx < -73728 )
Player->Position -77824 184320 0 0
elseif ( posx < -65536 )
Player->Position -69632 184320 0 0
elseif ( posx < -57344 )
Player->Position -61440 184320 0 0
elseif ( posx < -49152 )
Player->Position -53248 184320 0 0
elseif ( posx < -40960 )
Player->Position -45056 184320 0 0
elseif ( posx < -32768 )
Player->Position -36864 184320 0 0
elseif ( posx < -24576 )
Player->Position -28672 184320 0 0
elseif ( posx < -16384 )
Player->Position -20480 184320 0 0
elseif ( posx < -8192 )
Player->Position -12288 184320 0 0
elseif ( posx < 0 )
Player->Position -4096 184320 0 0
elseif ( posx < 8192 )
Player->Position 4096 184320 0 0
elseif ( posx < 16384 )
Player->Position 12288 184320 0 0
elseif ( posx < 24576 )
Player->Position 20480 184320 0 0
elseif ( posx < 32768 )
Player->Position 28672 184320 0 0
elseif ( posx < 40960 )
Player->Position 36864 184320 0 0
elseif ( posx < 49152 )
Player->Position 45056 184320 0 0
elseif ( posx < 57344 )
Player->Position 53248 184320 0 0
elseif ( posx < 65536 )
Player->Position 61440 184320 0 0
elseif ( posx < 73728 )
Player->Position 69632 184320 0 0
elseif ( posx < 81920 )
Player->Position 77824 184320 0 0
elseif ( posx < 90112 )
Player->Position 86016 184320 0 0
elseif ( posx < 98304 )
Player->Position 94208 184320 0 0
elseif ( posx < 106496 )
Player->Position 102400 184320 0 0
elseif ( posx < 114688 )
Player->Position 110592 184320 0 0
elseif ( posx < 122880 )
Player->Position 118784 184320 0 0
elseif ( posx < 131072 )
Player->Position 126976 184320 0 0
elseif ( posx < 139264 )
Player->Position 135168 184320 0 0
elseif ( posx < 147456 )
Player->Position 143360 184320 0 0
elseif ( posx < 155648 )
Player->Position 151552 184320 0 0
elseif ( posx < 163840 )
Player->Position 159744 184320 0 0
elseif ( posx < 172032 )
Player->Position 167936 184320 0 0
elseif ( posx < 180224 )
Player->Position 176128 184320 0 0
elseif ( posx < 188416 )
Player->Position 184320 184320 0 0
elseif ( posx < 196608 )
Player->Position 192512 184320 0 0
endif
endif
endif

; y=23, -29<=x<=23
if ( posy >= 188416 )
if ( posy < 196608 )
if ( posx < -229376 )
Player->Position -233472 192512 0 0
elseif ( posx < -221184 )
Player->Position -225280 192512 0 0
elseif ( posx < -212992 )
Player->Position -217088 192512 0 0
elseif ( posx < -204800 )
Player->Position -208896 192512 0 0
elseif ( posx < -196608 )
Player->Position -200704 192512 0 0
elseif ( posx < -188416 )
Player->Position -192512 192512 0 0
elseif ( posx < -180224 )
Player->Position -184320 192512 0 0
elseif ( posx < -172032 )
Player->Position -176128 192512 0 0
elseif ( posx < -163840 )
Player->Position -167936 192512 0 0
elseif ( posx < -155648 )
Player->Position -159744 192512 0 0
elseif ( posx < -147456 )
Player->Position -151552 192512 0 0
elseif ( posx < -139264 )
Player->Position -143360 192512 0 0
elseif ( posx < -131072 )
Player->Position -135168 192512 0 0
elseif ( posx < -122880 )
Player->Position -126976 192512 0 0
elseif ( posx < -114688 )
Player->Position -118784 192512 0 0
elseif ( posx < -106496 )
Player->Position -110592 192512 0 0
elseif ( posx < -98304 )
Player->Position -102400 192512 0 0
elseif ( posx < -90112 )
Player->Position -94208 192512 0 0
elseif ( posx < -81920 )
Player->Position -86016 192512 0 0
elseif ( posx < -73728 )
Player->Position -77824 192512 0 0
elseif ( posx < -65536 )
Player->Position -69632 192512 0 0
elseif ( posx < -57344 )
Player->Position -61440 192512 0 0
elseif ( posx < -49152 )
Player->Position -53248 192512 0 0
elseif ( posx < -40960 )
Player->Position -45056 192512 0 0
elseif ( posx < -32768 )
Player->Position -36864 192512 0 0
elseif ( posx < -24576 )
Player->Position -28672 192512 0 0
elseif ( posx < -16384 )
Player->Position -20480 192512 0 0
elseif ( posx < -8192 )
Player->Position -12288 192512 0 0
elseif ( posx < 0 )
Player->Position -4096 192512 0 0
elseif ( posx < 8192 )
Player->Position 4096 192512 0 0
elseif ( posx < 16384 )
Player->Position 12288 192512 0 0
elseif ( posx < 24576 )
Player->Position 20480 192512 0 0
elseif ( posx < 32768 )
Player->Position 28672 192512 0 0
elseif ( posx < 40960 )
Player->Position 36864 192512 0 0
elseif ( posx < 49152 )
Player->Position 45056 192512 0 0
elseif ( posx < 57344 )
Player->Position 53248 192512 0 0
elseif ( posx < 65536 )
Player->Position 61440 192512 0 0
elseif ( posx < 73728 )
Player->Position 69632 192512 0 0
elseif ( posx < 81920 )
Player->Position 77824 192512 0 0
elseif ( posx < 90112 )
Player->Position 86016 192512 0 0
elseif ( posx < 98304 )
Player->Position 94208 192512 0 0
elseif ( posx < 106496 )
Player->Position 102400 192512 0 0
elseif ( posx < 114688 )
Player->Position 110592 192512 0 0
elseif ( posx < 122880 )
Player->Position 118784 192512 0 0
elseif ( posx < 131072 )
Player->Position 126976 192512 0 0
elseif ( posx < 139264 )
Player->Position 135168 192512 0 0
elseif ( posx < 147456 )
Player->Position 143360 192512 0 0
elseif ( posx < 155648 )
Player->Position 151552 192512 0 0
elseif ( posx < 163840 )
Player->Position 159744 192512 0 0
elseif ( posx < 172032 )
Player->Position 167936 192512 0 0
elseif ( posx < 180224 )
Player->Position 176128 192512 0 0
elseif ( posx < 188416 )
Player->Position 184320 192512 0 0
elseif ( posx < 196608 )
Player->Position 192512 192512 0 0
endif
endif
endif

; y=24, -29<=x<=23
if ( posy >= 196608 )
if ( posy < 204800 )
if ( posx < -229376 )
Player->Position -233472 200704 0 0
elseif ( posx < -221184 )
Player->Position -225280 200704 0 0
elseif ( posx < -212992 )
Player->Position -217088 200704 0 0
elseif ( posx < -204800 )
Player->Position -208896 200704 0 0
elseif ( posx < -196608 )
Player->Position -200704 200704 0 0
elseif ( posx < -188416 )
Player->Position -192512 200704 0 0
elseif ( posx < -180224 )
Player->Position -184320 200704 0 0
elseif ( posx < -172032 )
Player->Position -176128 200704 0 0
elseif ( posx < -163840 )
Player->Position -167936 200704 0 0
elseif ( posx < -155648 )
Player->Position -159744 200704 0 0
elseif ( posx < -147456 )
Player->Position -151552 200704 0 0
elseif ( posx < -139264 )
Player->Position -143360 200704 0 0
elseif ( posx < -131072 )
Player->Position -135168 200704 0 0
elseif ( posx < -122880 )
Player->Position -126976 200704 0 0
elseif ( posx < -114688 )
Player->Position -118784 200704 0 0
elseif ( posx < -106496 )
Player->Position -110592 200704 0 0
elseif ( posx < -98304 )
Player->Position -102400 200704 0 0
elseif ( posx < -90112 )
Player->Position -94208 200704 0 0
elseif ( posx < -81920 )
Player->Position -86016 200704 0 0
elseif ( posx < -73728 )
Player->Position -77824 200704 0 0
elseif ( posx < -65536 )
Player->Position -69632 200704 0 0
elseif ( posx < -57344 )
Player->Position -61440 200704 0 0
elseif ( posx < -49152 )
Player->Position -53248 200704 0 0
elseif ( posx < -40960 )
Player->Position -45056 200704 0 0
elseif ( posx < -32768 )
Player->Position -36864 200704 0 0
elseif ( posx < -24576 )
Player->Position -28672 200704 0 0
elseif ( posx < -16384 )
Player->Position -20480 200704 0 0
elseif ( posx < -8192 )
Player->Position -12288 200704 0 0
elseif ( posx < 0 )
Player->Position -4096 200704 0 0
elseif ( posx < 8192 )
Player->Position 4096 200704 0 0
elseif ( posx < 16384 )
Player->Position 12288 200704 0 0
elseif ( posx < 24576 )
Player->Position 20480 200704 0 0
elseif ( posx < 32768 )
Player->Position 28672 200704 0 0
elseif ( posx < 40960 )
Player->Position 36864 200704 0 0
elseif ( posx < 49152 )
Player->Position 45056 200704 0 0
elseif ( posx < 57344 )
Player->Position 53248 200704 0 0
elseif ( posx < 65536 )
Player->Position 61440 200704 0 0
elseif ( posx < 73728 )
Player->Position 69632 200704 0 0
elseif ( posx < 81920 )
Player->Position 77824 200704 0 0
elseif ( posx < 90112 )
Player->Position 86016 200704 0 0
elseif ( posx < 98304 )
Player->Position 94208 200704 0 0
elseif ( posx < 106496 )
Player->Position 102400 200704 0 0
elseif ( posx < 114688 )
Player->Position 110592 200704 0 0
elseif ( posx < 122880 )
Player->Position 118784 200704 0 0
elseif ( posx < 131072 )
Player->Position 126976 200704 0 0
elseif ( posx < 139264 )
Player->Position 135168 200704 0 0
elseif ( posx < 147456 )
Player->Position 143360 200704 0 0
elseif ( posx < 155648 )
Player->Position 151552 200704 0 0
elseif ( posx < 163840 )
Player->Position 159744 200704 0 0
elseif ( posx < 172032 )
Player->Position 167936 200704 0 0
elseif ( posx < 180224 )
Player->Position 176128 200704 0 0
elseif ( posx < 188416 )
Player->Position 184320 200704 0 0
elseif ( posx < 196608 )
Player->Position 192512 200704 0 0
endif
endif
endif

; y=25, -29<=x<=23
if ( posy >= 204800 )
if ( posy < 212992 )
if ( posx < -229376 )
Player->Position -233472 208896 0 0
elseif ( posx < -221184 )
Player->Position -225280 208896 0 0
elseif ( posx < -212992 )
Player->Position -217088 208896 0 0
elseif ( posx < -204800 )
Player->Position -208896 208896 0 0
elseif ( posx < -196608 )
Player->Position -200704 208896 0 0
elseif ( posx < -188416 )
Player->Position -192512 208896 0 0
elseif ( posx < -180224 )
Player->Position -184320 208896 0 0
elseif ( posx < -172032 )
Player->Position -176128 208896 0 0
elseif ( posx < -163840 )
Player->Position -167936 208896 0 0
elseif ( posx < -155648 )
Player->Position -159744 208896 0 0
elseif ( posx < -147456 )
Player->Position -151552 208896 0 0
elseif ( posx < -139264 )
Player->Position -143360 208896 0 0
elseif ( posx < -131072 )
Player->Position -135168 208896 0 0
elseif ( posx < -122880 )
Player->Position -126976 208896 0 0
elseif ( posx < -114688 )
Player->Position -118784 208896 0 0
elseif ( posx < -106496 )
Player->Position -110592 208896 0 0
elseif ( posx < -98304 )
Player->Position -102400 208896 0 0
elseif ( posx < -90112 )
Player->Position -94208 208896 0 0
elseif ( posx < -81920 )
Player->Position -86016 208896 0 0
elseif ( posx < -73728 )
Player->Position -77824 208896 0 0
elseif ( posx < -65536 )
Player->Position -69632 208896 0 0
elseif ( posx < -57344 )
Player->Position -61440 208896 0 0
elseif ( posx < -49152 )
Player->Position -53248 208896 0 0
elseif ( posx < -40960 )
Player->Position -45056 208896 0 0
elseif ( posx < -32768 )
Player->Position -36864 208896 0 0
elseif ( posx < -24576 )
Player->Position -28672 208896 0 0
elseif ( posx < -16384 )
Player->Position -20480 208896 0 0
elseif ( posx < -8192 )
Player->Position -12288 208896 0 0
elseif ( posx < 0 )
Player->Position -4096 208896 0 0
elseif ( posx < 8192 )
Player->Position 4096 208896 0 0
elseif ( posx < 16384 )
Player->Position 12288 208896 0 0
elseif ( posx < 24576 )
Player->Position 20480 208896 0 0
elseif ( posx < 32768 )
Player->Position 28672 208896 0 0
elseif ( posx < 40960 )
Player->Position 36864 208896 0 0
elseif ( posx < 49152 )
Player->Position 45056 208896 0 0
elseif ( posx < 57344 )
Player->Position 53248 208896 0 0
elseif ( posx < 65536 )
Player->Position 61440 208896 0 0
elseif ( posx < 73728 )
Player->Position 69632 208896 0 0
elseif ( posx < 81920 )
Player->Position 77824 208896 0 0
elseif ( posx < 90112 )
Player->Position 86016 208896 0 0
elseif ( posx < 98304 )
Player->Position 94208 208896 0 0
elseif ( posx < 106496 )
Player->Position 102400 208896 0 0
elseif ( posx < 114688 )
Player->Position 110592 208896 0 0
elseif ( posx < 122880 )
Player->Position 118784 208896 0 0
elseif ( posx < 131072 )
Player->Position 126976 208896 0 0
elseif ( posx < 139264 )
Player->Position 135168 208896 0 0
elseif ( posx < 147456 )
Player->Position 143360 208896 0 0
elseif ( posx < 155648 )
Player->Position 151552 208896 0 0
elseif ( posx < 163840 )
Player->Position 159744 208896 0 0
elseif ( posx < 172032 )
Player->Position 167936 208896 0 0
elseif ( posx < 180224 )
Player->Position 176128 208896 0 0
elseif ( posx < 188416 )
Player->Position 184320 208896 0 0
elseif ( posx < 196608 )
Player->Position 192512 208896 0 0
endif
endif
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setGrid_Sub9"

End

# vn_Teleport_setGrid_SubA ====================================================
Begin vn_Teleport_setGrid_SubA

short cell
float posx
float posy
float posz
float angle

set cell to vn_TeleportCell
set posx to vn_PosX
set posy to vn_PosY
set posz to vn_PosZ
set angle to vn_Angle

; y=26, -29<=x<=23
if ( posy >= 212992 )
if ( posy < 221184 )
if ( posx < -229376 )
Player->Position -233472 217088 0 0
elseif ( posx < -221184 )
Player->Position -225280 217088 0 0
elseif ( posx < -212992 )
Player->Position -217088 217088 0 0
elseif ( posx < -204800 )
Player->Position -208896 217088 0 0
elseif ( posx < -196608 )
Player->Position -200704 217088 0 0
elseif ( posx < -188416 )
Player->Position -192512 217088 0 0
elseif ( posx < -180224 )
Player->Position -184320 217088 0 0
elseif ( posx < -172032 )
Player->Position -176128 217088 0 0
elseif ( posx < -163840 )
Player->Position -167936 217088 0 0
elseif ( posx < -155648 )
Player->Position -159744 217088 0 0
elseif ( posx < -147456 )
Player->Position -151552 217088 0 0
elseif ( posx < -139264 )
Player->Position -143360 217088 0 0
elseif ( posx < -131072 )
Player->Position -135168 217088 0 0
elseif ( posx < -122880 )
Player->Position -126976 217088 0 0
elseif ( posx < -114688 )
Player->Position -118784 217088 0 0
elseif ( posx < -106496 )
Player->Position -110592 217088 0 0
elseif ( posx < -98304 )
Player->Position -102400 217088 0 0
elseif ( posx < -90112 )
Player->Position -94208 217088 0 0
elseif ( posx < -81920 )
Player->Position -86016 217088 0 0
elseif ( posx < -73728 )
Player->Position -77824 217088 0 0
elseif ( posx < -65536 )
Player->Position -69632 217088 0 0
elseif ( posx < -57344 )
Player->Position -61440 217088 0 0
elseif ( posx < -49152 )
Player->Position -53248 217088 0 0
elseif ( posx < -40960 )
Player->Position -45056 217088 0 0
elseif ( posx < -32768 )
Player->Position -36864 217088 0 0
elseif ( posx < -24576 )
Player->Position -28672 217088 0 0
elseif ( posx < -16384 )
Player->Position -20480 217088 0 0
elseif ( posx < -8192 )
Player->Position -12288 217088 0 0
elseif ( posx < 0 )
Player->Position -4096 217088 0 0
elseif ( posx < 8192 )
Player->Position 4096 217088 0 0
elseif ( posx < 16384 )
Player->Position 12288 217088 0 0
elseif ( posx < 24576 )
Player->Position 20480 217088 0 0
elseif ( posx < 32768 )
Player->Position 28672 217088 0 0
elseif ( posx < 40960 )
Player->Position 36864 217088 0 0
elseif ( posx < 49152 )
Player->Position 45056 217088 0 0
elseif ( posx < 57344 )
Player->Position 53248 217088 0 0
elseif ( posx < 65536 )
Player->Position 61440 217088 0 0
elseif ( posx < 73728 )
Player->Position 69632 217088 0 0
elseif ( posx < 81920 )
Player->Position 77824 217088 0 0
elseif ( posx < 90112 )
Player->Position 86016 217088 0 0
elseif ( posx < 98304 )
Player->Position 94208 217088 0 0
elseif ( posx < 106496 )
Player->Position 102400 217088 0 0
elseif ( posx < 114688 )
Player->Position 110592 217088 0 0
elseif ( posx < 122880 )
Player->Position 118784 217088 0 0
elseif ( posx < 131072 )
Player->Position 126976 217088 0 0
elseif ( posx < 139264 )
Player->Position 135168 217088 0 0
elseif ( posx < 147456 )
Player->Position 143360 217088 0 0
elseif ( posx < 155648 )
Player->Position 151552 217088 0 0
elseif ( posx < 163840 )
Player->Position 159744 217088 0 0
elseif ( posx < 172032 )
Player->Position 167936 217088 0 0
elseif ( posx < 180224 )
Player->Position 176128 217088 0 0
elseif ( posx < 188416 )
Player->Position 184320 217088 0 0
elseif ( posx < 196608 )
Player->Position 192512 217088 0 0
endif
endif
endif

; y=27, -29<=x<=23
if ( posy >= 221184 )
if ( posy < 229376 )
if ( posx < -229376 )
Player->Position -233472 225280 0 0
elseif ( posx < -221184 )
Player->Position -225280 225280 0 0
elseif ( posx < -212992 )
Player->Position -217088 225280 0 0
elseif ( posx < -204800 )
Player->Position -208896 225280 0 0
elseif ( posx < -196608 )
Player->Position -200704 225280 0 0
elseif ( posx < -188416 )
Player->Position -192512 225280 0 0
elseif ( posx < -180224 )
Player->Position -184320 225280 0 0
elseif ( posx < -172032 )
Player->Position -176128 225280 0 0
elseif ( posx < -163840 )
Player->Position -167936 225280 0 0
elseif ( posx < -155648 )
Player->Position -159744 225280 0 0
elseif ( posx < -147456 )
Player->Position -151552 225280 0 0
elseif ( posx < -139264 )
Player->Position -143360 225280 0 0
elseif ( posx < -131072 )
Player->Position -135168 225280 0 0
elseif ( posx < -122880 )
Player->Position -126976 225280 0 0
elseif ( posx < -114688 )
Player->Position -118784 225280 0 0
elseif ( posx < -106496 )
Player->Position -110592 225280 0 0
elseif ( posx < -98304 )
Player->Position -102400 225280 0 0
elseif ( posx < -90112 )
Player->Position -94208 225280 0 0
elseif ( posx < -81920 )
Player->Position -86016 225280 0 0
elseif ( posx < -73728 )
Player->Position -77824 225280 0 0
elseif ( posx < -65536 )
Player->Position -69632 225280 0 0
elseif ( posx < -57344 )
Player->Position -61440 225280 0 0
elseif ( posx < -49152 )
Player->Position -53248 225280 0 0
elseif ( posx < -40960 )
Player->Position -45056 225280 0 0
elseif ( posx < -32768 )
Player->Position -36864 225280 0 0
elseif ( posx < -24576 )
Player->Position -28672 225280 0 0
elseif ( posx < -16384 )
Player->Position -20480 225280 0 0
elseif ( posx < -8192 )
Player->Position -12288 225280 0 0
elseif ( posx < 0 )
Player->Position -4096 225280 0 0
elseif ( posx < 8192 )
Player->Position 4096 225280 0 0
elseif ( posx < 16384 )
Player->Position 12288 225280 0 0
elseif ( posx < 24576 )
Player->Position 20480 225280 0 0
elseif ( posx < 32768 )
Player->Position 28672 225280 0 0
elseif ( posx < 40960 )
Player->Position 36864 225280 0 0
elseif ( posx < 49152 )
Player->Position 45056 225280 0 0
elseif ( posx < 57344 )
Player->Position 53248 225280 0 0
elseif ( posx < 65536 )
Player->Position 61440 225280 0 0
elseif ( posx < 73728 )
Player->Position 69632 225280 0 0
elseif ( posx < 81920 )
Player->Position 77824 225280 0 0
elseif ( posx < 90112 )
Player->Position 86016 225280 0 0
elseif ( posx < 98304 )
Player->Position 94208 225280 0 0
elseif ( posx < 106496 )
Player->Position 102400 225280 0 0
elseif ( posx < 114688 )
Player->Position 110592 225280 0 0
elseif ( posx < 122880 )
Player->Position 118784 225280 0 0
elseif ( posx < 131072 )
Player->Position 126976 225280 0 0
elseif ( posx < 139264 )
Player->Position 135168 225280 0 0
elseif ( posx < 147456 )
Player->Position 143360 225280 0 0
elseif ( posx < 155648 )
Player->Position 151552 225280 0 0
elseif ( posx < 163840 )
Player->Position 159744 225280 0 0
elseif ( posx < 172032 )
Player->Position 167936 225280 0 0
elseif ( posx < 180224 )
Player->Position 176128 225280 0 0
elseif ( posx < 188416 )
Player->Position 184320 225280 0 0
elseif ( posx < 196608 )
Player->Position 192512 225280 0 0
endif
endif
endif

; y=28, -29<=x<=23
if ( posy >= 229376 )
if ( posy < 237568 )
if ( posx < -229376 )
Player->Position -233472 233472 0 0
elseif ( posx < -221184 )
Player->Position -225280 233472 0 0
elseif ( posx < -212992 )
Player->Position -217088 233472 0 0
elseif ( posx < -204800 )
Player->Position -208896 233472 0 0
elseif ( posx < -196608 )
Player->Position -200704 233472 0 0
elseif ( posx < -188416 )
Player->Position -192512 233472 0 0
elseif ( posx < -180224 )
Player->Position -184320 233472 0 0
elseif ( posx < -172032 )
Player->Position -176128 233472 0 0
elseif ( posx < -163840 )
Player->Position -167936 233472 0 0
elseif ( posx < -155648 )
Player->Position -159744 233472 0 0
elseif ( posx < -147456 )
Player->Position -151552 233472 0 0
elseif ( posx < -139264 )
Player->Position -143360 233472 0 0
elseif ( posx < -131072 )
Player->Position -135168 233472 0 0
elseif ( posx < -122880 )
Player->Position -126976 233472 0 0
elseif ( posx < -114688 )
Player->Position -118784 233472 0 0
elseif ( posx < -106496 )
Player->Position -110592 233472 0 0
elseif ( posx < -98304 )
Player->Position -102400 233472 0 0
elseif ( posx < -90112 )
Player->Position -94208 233472 0 0
elseif ( posx < -81920 )
Player->Position -86016 233472 0 0
elseif ( posx < -73728 )
Player->Position -77824 233472 0 0
elseif ( posx < -65536 )
Player->Position -69632 233472 0 0
elseif ( posx < -57344 )
Player->Position -61440 233472 0 0
elseif ( posx < -49152 )
Player->Position -53248 233472 0 0
elseif ( posx < -40960 )
Player->Position -45056 233472 0 0
elseif ( posx < -32768 )
Player->Position -36864 233472 0 0
elseif ( posx < -24576 )
Player->Position -28672 233472 0 0
elseif ( posx < -16384 )
Player->Position -20480 233472 0 0
elseif ( posx < -8192 )
Player->Position -12288 233472 0 0
elseif ( posx < 0 )
Player->Position -4096 233472 0 0
elseif ( posx < 8192 )
Player->Position 4096 233472 0 0
elseif ( posx < 16384 )
Player->Position 12288 233472 0 0
elseif ( posx < 24576 )
Player->Position 20480 233472 0 0
elseif ( posx < 32768 )
Player->Position 28672 233472 0 0
elseif ( posx < 40960 )
Player->Position 36864 233472 0 0
elseif ( posx < 49152 )
Player->Position 45056 233472 0 0
elseif ( posx < 57344 )
Player->Position 53248 233472 0 0
elseif ( posx < 65536 )
Player->Position 61440 233472 0 0
elseif ( posx < 73728 )
Player->Position 69632 233472 0 0
elseif ( posx < 81920 )
Player->Position 77824 233472 0 0
elseif ( posx < 90112 )
Player->Position 86016 233472 0 0
elseif ( posx < 98304 )
Player->Position 94208 233472 0 0
elseif ( posx < 106496 )
Player->Position 102400 233472 0 0
elseif ( posx < 114688 )
Player->Position 110592 233472 0 0
elseif ( posx < 122880 )
Player->Position 118784 233472 0 0
elseif ( posx < 131072 )
Player->Position 126976 233472 0 0
elseif ( posx < 139264 )
Player->Position 135168 233472 0 0
elseif ( posx < 147456 )
Player->Position 143360 233472 0 0
elseif ( posx < 155648 )
Player->Position 151552 233472 0 0
elseif ( posx < 163840 )
Player->Position 159744 233472 0 0
elseif ( posx < 172032 )
Player->Position 167936 233472 0 0
elseif ( posx < 180224 )
Player->Position 176128 233472 0 0
elseif ( posx < 188416 )
Player->Position 184320 233472 0 0
elseif ( posx < 196608 )
Player->Position 192512 233472 0 0
endif
endif
endif

Player->SetPos x posx
Player->SetPos y posy
Player->SetPos z posz
Player->SetAngle z angle

StopScript "vn_Teleport_setGrid_SubA"

End

# vn_testmortarscript =========================================================
Begin vn_testmortarscript

if ( OnActivate == 1 )
	StartScript "vn_addingredients"
	MessageBox "Lich potion ingredients added to your inventory"
endif

End

# vn_togglebrotherhood ========================================================
Begin vn_togglebrotherhood

; MessageBox "tdb script started"
StopScript "vn_togglebrotherhood"

End

# vn_unremovable ==============================================================
Begin vn_unremovable

if ( OnActivate == 1 )
	; MessageBox, "This item cannot be removed"
endif

End

# vn_used_potion ==============================================================
Begin vn_used_potion

short doonce

if ( doOnce == 0 )
	StartScript "vn_removelichpotion"
	set doOnce to 1
endif

End

# vn_used_potion_f ============================================================
Begin vn_used_potion_f

short doonce

if ( doOnce == 0 )
	StartScript "vn_removefailedlichpotion"
	set doOnce to 1
endif

End

# vn_vampinit =================================================================
Begin vn_vampinit

; temporary script for testing
StartScript "vampire_quarra_pc"
set vn_lich_potion_consumed to 2
StartScript "vn_lichquickinit"
StopScript "vn_vampinit"

End

# vn_vialscript ===============================================================
Begin vn_vialscript

short state
short failed
short vampfailed
short failscore
short button
float luck
float alchemy
float number
float temp
float temp2
float temp3
float temp4
float temp5
float chance
short doonce

; states
; 1 button check. -->2|3|5
; 2 potion mixing. -- > 6
; 3 to be disabled. -->4.
; 4 nulls script.
; 5 Activate -- > 6
; 6 doing nothing

if ( state == 4 )
	return
endif

if ( state == 3 )
	Disable ; still exists in the game world... 
	; but shouldn't be too much of a problem since it only returns.
	set state to 4
endif

if ( OnActivate == 1 )
	MessageBox "What do you wish to do?" "Add ingredients" "Mix potion" "Pick up"
	set state to 1
endif

if ( state == 5 ) 
	set state to 6
	Activate
endif

if ( state == 1 )
	set button to GetButtonPressed
	if ( button == -1 )
		return
	endif
	if ( button == 0 )
		set state to 5
		return
	endif
	if ( button == 1 )

		; MessageBox "Normal check"
		set failed to 0
		set vampfailed to 0

		; NORMAL INGRED CHECK
		if ( GetItemCount ingred_coprinus_01 != 1 )
			set failed to 1
		elseif ( GetItemCount ingred_noble_sedge_01 != 1 )
			set failed to 1
		elseif ( GetItemCount ingred_lloramor_spines_01 != 1 )
			set failed to 1
		elseif ( GetItemCount ingred_russula_01 != 1 )
			set failed to 1
		elseif ( GetItemCount ingred_daedras_heart_01 != 1 ) ; if ( not one daedra heart )
			if ( GetItemCount ingred_ghoul_heart_01 != 1 )  ; and not one ghoul heart
				set failed to 1
			endif
		elseif ( GetItemCount ingred_daedras_heart_01 == 1 )
			if ( GetItemCount ingred_ghoul_heart_01 == 1 )  ; and one ghoul heart
				set failed to 1
			endif
		elseif ( GetItemCount ingred_belladonna_01 != 1 )
			if ( GetItemCount ingred_belladonna_02 != 1 )
				set failed to 1
			endif
		elseif ( GetItemCount ingred_belladonna_01 == 1 )
			if ( GetItemCount ingred_belladonna_01 == 1 )
				set failed to 1
			endif
		; any other items ruin potion -- too much code, don't bother...
		elseif ( GetItemCount ingred_trama_root_01 != 0 )
			set failed to 1
		endif

		; MessageBox "vamp check"

		; VAMPIRE INGRED CHECK
		if ( GetItemCount ingred_ash_salts_01 != 5 )
			set vampfailed to 1
		elseif ( GetItemCount ingred_bonemeal_01 != 3 )
			set vampfailed to 1
		elseif ( GetItemCount ingred_corprus_weepings_01 != 1 )
			set vampfailed to 1
		elseif ( GetItemCount ingred_daedras_heart_01 != 1 )
			set vampfailed to 1
		elseif ( GetItemCount ingred_ghoul_heart_01 != 1 )
			set vampfailed to 1
		elseif ( GetItemCount ingred_ectoplasm_01 != 2 )
			set vampfailed to 1
		elseif ( GetItemCount ingred_fire_salts_01 != 1 )
			set vampfailed to 1
		elseif ( GetItemCount ingred_frost_salts_01 != 1 )
			set vampfailed to 1
		elseif ( GetItemCount ingred_gravedust_01 != 5 )
			set vampfailed to 1
		elseif ( GetItemCount ingred_void_salts_01 != 1 )
			set vampfailed to 1
		elseif ( GetItemCount ingred_red_lichen_01 != 1 )
			set vampfailed to 1
		elseif ( GetItemCount ingred_vampire_dust_01 != 1 )
			set vampfailed to 1
		endif

		set state to 2
	endif
	if ( button == 2 )
		set state to 3
		Player->AddItem "vn_enchantedvial" 1
	endif
endif

if ( state == 2 )
	; MessageBox "Checking success"
	set failscore to ( failed + vampfailed )
	; MessageBox "Score set"

	if ( failscore == 2 )
		Player->AddItem "vn_lichpotion_failed" 1
		MessageBox "Well... it seems like the potion was successfully made, but you can't be sure"
	else ; must = 1 since 0 is impossible
		set number to Random100
		set luck to ( Player->GetLuck )
		set alchemy to ( Player->GetAlchemy ) 
		set temp2 to ( alchemy / 2 )
		set temp3 to ( luck / 5 )
		set temp4 to ( temp2 + temp3 )
		set chance to ( temp4 + 30 ) ; 30 to 100 gives chance of success
		; MessageBox, "chance was %.2f and Random was %.2f", chance, number
		if ( number <= chance )
			if ( vampfailed == 0 )
				Player->AddItem "vn_lichpotion_vamp" 1
			else
				Player->AddItem "vn_lichpotion" 1
			endif			
		else
			Player->AddItem "vn_lichpotion_failed" 1
		endif
		set temp to ( chance - number ) ; these will be used to determine if ( you know whether you failed. )
		set temp4 to ( 100 - alchemy )
		set temp2 to ( temp4 / 2 ) ; 0 to 50 zero if ( highly skilled )
		set temp3 to ( 0 - temp2 ) ; 0 to -50 zero if ( highly skilled )
		if ( temp >= temp2 )
			MessageBox "You are almost certain you made the potion correctly. It should work.... shouldn't it?"
		elseif ( temp <= temp3 )
			MessageBox "You're pretty sure that something went wrong when you mixed that potion... it might be wise not to use it"
		else
			MessageBox "Well... it seems like the potion was successfully made, but you really can't be sure"
		endif
	endif
	set state to 3
endif

End

# vn_waypointscript ===========================================================
Begin vn_waypointscript

; didn't wotrk, nuke it...

short button
float timer

; if ( vn_waypointstate == 0 )
;	if ( GetInterior == 1 )
;		MessageBox "Waypoint can only be set in an exterior cell" "Ok"
;		set vn_waypointstate to 10
;	else
;		MessageBox "set current location as which waypoint?" "Waypoint 1" "Waypoint 2" "Waypoint 3" "Cancel"
;		set vn_waypointstate to 1
;	endif
;	; if we're in an interior, cancel the call
;	; otherwise, ask which waypoint to set, and set it
; endif
;
; if ( vn_waypointstate == 1 )
;	set button to GetButtonPressed
;	if ( button == -1 )
;		return
;	elseif ( button == 0 )
;		set vn_waypoint1x to ( Player->GetPos, x )
;		set vn_waypoint1y to ( Player->GetPos, y )
;		set vn_waypoint1z to ( Player->GetPos, z )
;		MessageBox "Waypoint 1 set"
;		set vn_waypointstate to 10
;	elseif ( button == 1 )
;		set vn_waypoint2x to ( Player->GetPos, x )
;		set vn_waypoint2y to ( Player->GetPos, y )
;		set vn_waypoint2z to ( Player->GetPos, z )
;		MessageBox "Waypoint 2 set"
;		set vn_waypointstate to 10
;	elseif ( button == 2 )
;		set vn_waypoint3x to ( Player->GetPos, x )
;		set vn_waypoint3y to ( Player->GetPos, y )
;		set vn_waypoint3z to ( Player->GetPos, z )
;		MessageBox "Waypoint 3 set"
;		set vn_waypointstate to 10
;	elseif ( button == 3 )
;		set vn_waypointstate to 10		
;	else
;		MessageBox "Error: Unrecognised button" "Ok"
;		set vn_waypointstate to 10
;	endif
; endif
;
; if ( vn_waypointstate == 10 )
;	set timer to ( timer + ( GetSecondsPassed ) )
;	if ( timer > 3 )
;		MessageBox "ending waypoint script"
;		set timer to 0
;		set vn_waypointstate to -1
;		StopScript, vn_waypointscript
;	endif
; endif

End

